{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/3-hexo/source/css/gitalk.css","path":"css/gitalk.css","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/mobile.styl","path":"css/mobile.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/alipay.jpg","path":"img/alipay.jpg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","path":"img/article-list-background.jpeg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/avatar.jpg","path":"img/avatar.jpg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/brown-papersq.png","path":"img/brown-papersq.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/gov.png","path":"img/gov.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/moon.jpg","path":"img/moon.jpg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/road.png","path":"img/road.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/school-book.png","path":"img/school-book.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/weixin.jpg","path":"img/weixin.jpg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/gitalk.js","path":"js/gitalk.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/gitment.js","path":"js/gitment.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/iconfont.js","path":"js/iconfont.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","path":"js/jquery.pjax.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/script.js","path":"js/script.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/search.js","path":"js/search.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/js/titleTip.js","path":"js/titleTip.js","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","path":"css/fonts/icomoon.eot","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","path":"css/fonts/icomoon.svg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","path":"css/fonts/icomoon.ttf","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","path":"css/fonts/icomoon.woff","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","path":"css/fonts/iconfont.eot","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","path":"css/fonts/iconfont.svg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","path":"css/fonts/iconfont.ttf","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","path":"css/fonts/iconfont.woff","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff2","path":"css/fonts/iconfont.woff2","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/selection.json","path":"css/fonts/selection.json","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","path":"css/hl_theme/atom-dark.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","path":"css/hl_theme/atom-light.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","path":"css/hl_theme/brown-paper.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","path":"css/hl_theme/darcula.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","path":"css/hl_theme/github-gist.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","path":"css/hl_theme/github.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","path":"css/hl_theme/gruvbox-dark.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","path":"css/hl_theme/gruvbox-light.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","path":"css/hl_theme/kimbie-dark.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","path":"css/hl_theme/kimbie-light.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","path":"css/hl_theme/railscasts.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","path":"css/hl_theme/rainbow.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","path":"css/hl_theme/school-book.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","path":"css/hl_theme/sublime.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","path":"css/hl_theme/sunburst.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","path":"css/hl_theme/zenbum.styl","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/cache/redisTemplate-serialize.png","path":"img/cache/redisTemplate-serialize.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/ddd/ddd-framework.png","path":"img/ddd/ddd-framework.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/ddd/four-color.png","path":"img/ddd/four-color.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/design-model/design-model-type.jpg","path":"img/design-model/design-model-type.jpg","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/uml/uml-line.png","path":"img/uml/uml-line.png","modified":1,"renderable":1},{"_id":"themes/3-hexo/source/img/uml/uml.png","path":"img/uml/uml.png","modified":1,"renderable":1}],"Cache":[{"_id":"themes/3-hexo/.DS_Store","hash":"0770f9d42bfdd8d420de48fed463015e001cf579","modified":1601438273648},{"_id":"themes/3-hexo/.gitignore","hash":"86a50fa08e69cab561892aa5edef24f9081bbde1","modified":1601438273648},{"_id":"themes/3-hexo/LICENSE","hash":"b04140c5f682db2b300428f97bb164fd7f5f18bd","modified":1601438273649},{"_id":"themes/3-hexo/README.md","hash":"a9704a2f258df66cdd4f1ff4c96be972c7052e78","modified":1601445159210},{"_id":"themes/3-hexo/_config.yml","hash":"c650b8c0870fdb93eb5e889a90cafe28a1799a15","modified":1627451640414},{"_id":"themes/3-hexo/languages/en.yml","hash":"53ae29ae1237fc7822df85a6d2f8da6f0078625e","modified":1601438273650},{"_id":"themes/3-hexo/languages/zh-CN.yml","hash":"d2c6d86fe2ff03e6ee9bbc16dff8efe5b47ac297","modified":1601438273650},{"_id":"themes/3-hexo/layout/index.ejs","hash":"80c70add8883741a70678ed55ee021cf98a212c9","modified":1603186032574},{"_id":"themes/3-hexo/layout/indexs.md","hash":"23e1a09a69b8c0cd86a8b7182661751b91c4c968","modified":1609137945915},{"_id":"themes/3-hexo/layout/_partial/article.ejs","hash":"2afeac04cbcfdb4c876345a10121f059417b1d46","modified":1601619971212},{"_id":"themes/3-hexo/source/.DS_Store","hash":"fdcc907c46e093a14b153c5dc8c038461997ed3c","modified":1601438273656},{"_id":"themes/3-hexo/layout/post.ejs","hash":"e1f635d2822b98035e690a5da9b7c7b9d96bc34b","modified":1603185928942},{"_id":"themes/3-hexo/layout/_partial/article_copyright.ejs","hash":"0ebb17d001cb7bb7606c616c380049a2e7124496","modified":1601438273651},{"_id":"themes/3-hexo/layout/_partial/copyright.ejs","hash":"97dab221e6150880caa89baabb82854c98fc5b79","modified":1601619823671},{"_id":"themes/3-hexo/layout/_partial/comment.ejs","hash":"5507b4dfab2032345e012a0c5356f63b01395157","modified":1609137408073},{"_id":"themes/3-hexo/layout/_partial/dashang.ejs","hash":"bc94eee27701b67d238f328737b578e8270989eb","modified":1601438273653},{"_id":"themes/3-hexo/layout/_partial/footer.ejs","hash":"ed479aa9affee3b02a76da06de45a7c40a97a706","modified":1601518976507},{"_id":"themes/3-hexo/layout/_partial/friends.ejs","hash":"d11092791e5c140ff81f2aefa0d1b051f403239d","modified":1601438273653},{"_id":"themes/3-hexo/layout/_partial/full-toc.ejs","hash":"a734c26d86da6697003ed27672c1b9b82b216c82","modified":1601438273653},{"_id":"themes/3-hexo/layout/_partial/header.ejs","hash":"d0b84370ca81c3baa02a05613ff040003acd2985","modified":1601438273654},{"_id":"themes/3-hexo/layout/_partial/mathjax.ejs","hash":"c2e5cef2377884cd79e5f686fe4f74b082744306","modified":1601438273654},{"_id":"themes/3-hexo/layout/_partial/meta.ejs","hash":"8a9e93f9cbe80763264018290da0b14b4bbe8ac5","modified":1601438273654},{"_id":"themes/3-hexo/layout/_partial/nav-left.ejs","hash":"1251a2f965984eb605376be0ca4cf2a40c8c63c3","modified":1601455224432},{"_id":"themes/3-hexo/layout/_partial/nav-right.ejs","hash":"3f9d91215ff36a6bcdaaf86e5b028dafc5a6a6fc","modified":1601438273655},{"_id":"themes/3-hexo/layout/_partial/tag.ejs","hash":"3cf8ba0c6112dfa8089603b8df3e31f70a272715","modified":1601438273655},{"_id":"themes/3-hexo/layout/_partial/toc-ref.ejs","hash":"6406251dabda66ef686d4c15edbc3061b6d828b8","modified":1601438273655},{"_id":"themes/3-hexo/source/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1601438273669},{"_id":"themes/3-hexo/source/css/mobile.styl","hash":"d82da8529e63925bbe6a015e2d4d5841f3202073","modified":1627286489941},{"_id":"themes/3-hexo/source/css/style.styl","hash":"8a533bbcf602209a077bc3001481b205d39ab1b4","modified":1601445003509},{"_id":"themes/3-hexo/source/img/alipay.jpg","hash":"e457d1d3dfefbbd824d154cf756a2c6d10b812a2","modified":1601438273675},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","hash":"4fdf8b3e53dd02d6ee6360aebfadb0cba1fb5633","modified":1601438273676},{"_id":"themes/3-hexo/source/img/avatar.jpg","hash":"a42360089bfa892d803cf5747eab359d90f337f1","modified":1601438273678},{"_id":"themes/3-hexo/source/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1601438273678},{"_id":"themes/3-hexo/source/img/gov.png","hash":"f31c9f47faedf7f33b9580d6284ab891fb697560","modified":1601438273678},{"_id":"themes/3-hexo/source/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1601438273678},{"_id":"themes/3-hexo/source/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1601438273690},{"_id":"themes/3-hexo/source/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1601438273689},{"_id":"themes/3-hexo/source/js/script.js","hash":"03fc06177b47fd6bac7ae393f9712c726272467b","modified":1601438273689},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1601438273689},{"_id":"themes/3-hexo/layout/_partial/comments/disqus.ejs","hash":"cd0022ce7e6d6efb07a00e87477cdf791f7f6703","modified":1609137578878},{"_id":"themes/3-hexo/layout/_partial/comments/gitalk.ejs","hash":"fbd3c7d72c8354d700918390c6cbfc0a11408277","modified":1601438273651},{"_id":"themes/3-hexo/layout/_partial/comments/click2show.ejs","hash":"fa6675230f8c313236604e26926b142f4f418bdd","modified":1601438273651},{"_id":"themes/3-hexo/layout/_partial/comments/giteement.ejs","hash":"9675f488eb1c6ceb93321009fa5a2eae5a4c949b","modified":1609137682523},{"_id":"themes/3-hexo/layout/_partial/comments/gitment.ejs","hash":"f16442568b43d034faaa8e3507f5ae8da34c7b72","modified":1601438273652},{"_id":"themes/3-hexo/layout/_partial/comments/livere.ejs","hash":"e820aa16b5ed4e024616b5e2d424925820d43e56","modified":1601438273652},{"_id":"themes/3-hexo/layout/_partial/comments/utteranc.ejs","hash":"c76773b96860940083baf16470b7b80ac098e645","modified":1601438273652},{"_id":"themes/3-hexo/source/css/_partial/comment.styl","hash":"2a9b5ffb759be85545a89f6d1194579a800f51a5","modified":1601438273657},{"_id":"themes/3-hexo/source/css/_partial/dashang.styl","hash":"f6447a2ac407228e1d53e3455db2919ac0e9f094","modified":1601438273657},{"_id":"themes/3-hexo/source/css/_partial/fade.styl","hash":"4f687cbc74caf8a0887f5e89250284a9bce8b5c1","modified":1601438273658},{"_id":"themes/3-hexo/source/css/_partial/font.styl","hash":"cb6d7cc1ba37bdffd248c61fd6b8b26ce44b9ee5","modified":1601622673195},{"_id":"themes/3-hexo/source/js/titleTip.js","hash":"81dca549063e29ba3a4a278f0f4388eba8a2167b","modified":1601438273690},{"_id":"themes/3-hexo/source/css/_partial/full-toc.styl","hash":"49a66e262d8f5196a14c4a30fd752dced69e6140","modified":1601454359137},{"_id":"themes/3-hexo/source/css/_partial/nav-left.styl","hash":"13b0174ac8f7dded790c160266bac10a0a4b579f","modified":1601522192666},{"_id":"themes/3-hexo/source/css/_partial/nav-right.styl","hash":"2848081c36377b47ff87686f7464a624bd991b88","modified":1601623438225},{"_id":"themes/3-hexo/source/css/_partial/nprogress.styl","hash":"65efbddd23a264e7d1e85f4073228526770e833c","modified":1601438273661},{"_id":"themes/3-hexo/source/css/_partial/num-load.styl","hash":"4b996440bba8ec755aa70bc6d074d7dbba55ec0c","modified":1601438273662},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1601438273663},{"_id":"themes/3-hexo/source/css/_partial/post.styl","hash":"b0c4397ff8258b4de121ae7f4993dad1cef44f30","modified":1601622829618},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","hash":"37ac1ef28b03f46bf3ad2606c86f0e1ec3e4405f","modified":1601438273663},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1601438273664},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1601438273664},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","hash":"b14b8624988ff069aff3145f88c0d7ac49052bd3","modified":1601438273665},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","hash":"13974fe35fca836e870a960ecb11b7eca2e036f8","modified":1601438273665},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","hash":"140829ecf12d30c6e18d8dc6dc0c188a66addd25","modified":1601438273667},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","hash":"0d2d4559f1ac4fa801eb8cc099fa5bf9dcf955ef","modified":1601438273667},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff2","hash":"b0317a0b2ebb1181a8bf5a97d03556dd54538645","modified":1601438273667},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","hash":"f3eb4e5feda9cbd6242ccf44ca064e2979b5d719","modified":1601438273670},{"_id":"themes/3-hexo/source/css/fonts/selection.json","hash":"57c7f100019d57b512aab509185cb0a6eb9aa4c8","modified":1601438273668},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","hash":"5e05b19832c1099bd9d284bc3ed00dc8a3d7ee23","modified":1601438273671},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","hash":"2bfc14f27ccca108b4b3755782de8366e8bd001e","modified":1601438273671},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","hash":"03af387edcc1cf8c18d12e9c440fd51b6cf425b6","modified":1601438273670},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","hash":"553987211d3323a7dfc0b08786b183a3435978c9","modified":1601438273670},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","hash":"53276ff1f224f691dfe811e82c0af7f4476abf5d","modified":1601438273671},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","hash":"315ad610d303caba9eac80a7d51002193a15478a","modified":1601438273671},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","hash":"1bece084b1dbbbd4af064f05feffd8c332b96a48","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","hash":"e9c190f9ffc37a13cac430512e4e0c760205be4a","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","hash":"0c3ccd0d64e7504c7061d246dc32737f502f64e4","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","hash":"a6e8cfd2202afd7893f5268f3437421e35066e7b","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","hash":"e5c37646a9d9c1094f9aab7a7c65a4b242e8db00","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","hash":"51659351b391a2be5c68728bb51b7ad467c5e0db","modified":1601438273672},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","hash":"501d75ef0f4385bea24d9b9b4cc434ba68d4be27","modified":1601438273673},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","hash":"2aa9817e68fb2ed216781ea04b733039ebe18214","modified":1601438273673},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","hash":"933a3b196d01254dea5e6f48105ea15e210ae000","modified":1601438273673},{"_id":"themes/3-hexo/source/img/cache/redisTemplate-serialize.png","hash":"befbf5f80d088f754be6a5ce3bfbe2709f1c2a8c","modified":1612267455221},{"_id":"themes/3-hexo/source/img/ddd/four-color.png","hash":"40cae7376e963aa4e978055a81c301a7179ed0a7","modified":1606919368214},{"_id":"themes/3-hexo/source/img/uml/uml-line.png","hash":"e8c82f1b6afb89bb14abef8e8492eefc6a56a42b","modified":1608895018241},{"_id":"themes/3-hexo/source/img/moon.jpg","hash":"21c3a55fea9ba6648719007bdd988928e4cec911","modified":1601520694288},{"_id":"themes/3-hexo/source/img/weixin.jpg","hash":"8dafb22561698d0758fba9ea2a45abf6ad3512a2","modified":1601438273681},{"_id":"themes/3-hexo/source/img/design-model/design-model-type.jpg","hash":"16f2174838bbf81a207117a7cbdb7e12a7448d9d","modified":1608954099772},{"_id":"themes/3-hexo/source/img/uml/uml.png","hash":"11754a8f76a759f2d798dfe8a73fad9468c45012","modified":1608894989251},{"_id":"themes/3-hexo/source/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1601438273688},{"_id":"source/_drafts/idea.md","hash":"9f1aa0e886624b2819994c9937d43e03b3bb1ad1","modified":1606456356453},{"_id":"source/_drafts/oauth2.md","hash":"e85802756bdbb9792612bf4a6d784c62c5dc2e08","modified":1626936675238},{"_id":"source/_drafts/user.md","hash":"3d5c44b3e8f8bb293a7d2be1b857d5e00b1bdd6d","modified":1630996093417},{"_id":"source/_drafts/java.md","hash":"7918c1f37b417c07ba6181a4604e457ad075c126","modified":1630908800899},{"_id":"source/_posts/devops/check.md","hash":"f1283179aef15ab1eba9777054c8398c6d8a7c62","modified":1627286354151},{"_id":"source/_posts/devops/docker.md","hash":"f0afc31a1a9544f79b01823513bb481413bc1a6c","modified":1627286354119},{"_id":"source/_posts/devops/istio.md","hash":"8f77b358e44766d132c098419e306365598703e3","modified":1627286354113},{"_id":"source/_posts/devops/ldap.md","hash":"29371e0daa9f9d1b79a9f159ac05df49f410850b","modified":1627286354170},{"_id":"source/_posts/devops/nginx.md","hash":"9baae67aae9c1ed6d46e19385a29aff58e3ed6c4","modified":1627286354107},{"_id":"source/_posts/devops/skywalking.md","hash":"c8ed622eb8922f7fdf9287dbc6047294e3d0ec27","modified":1627286354138},{"_id":"source/_posts/framework/cola.md","hash":"ea06932180e3336fd5976980a744fcdfba67feae","modified":1608020699493},{"_id":"source/_posts/framework/design-model.md","hash":"499f53070aa776fa3782c3f8fa3cda3571e8c275","modified":1609236074548},{"_id":"source/_posts/framework/oauth2.md","hash":"55d19c8621ec93adf17228bec579822d571f28f3","modified":1608970412222},{"_id":"source/_posts/other/hexo.md","hash":"2451124da0643d08a4939c20feb1f186994e9a7c","modified":1627286354157},{"_id":"source/_posts/framework/ddd.md","hash":"cfd3c84a1a0592b249aa9dd0b81b1b5678829fd1","modified":1608971981019},{"_id":"source/_posts/other/software.md","hash":"0ae7b43945f9c47620e24fe0d184d725145821d7","modified":1627286354134},{"_id":"source/_posts/frontend/vue.md","hash":"ee9a60401bd483da6c1979675a06cd931dc84eb6","modified":1627286014738},{"_id":"source/_posts/test/test.md","hash":"8fe0c9eed84bce37da73c46314c317c2e1d82aaf","modified":1627286354178},{"_id":"source/_posts/thinking/book.md","hash":"7f330a3e264e3711c67a009a6db6f8c1920fc8c9","modified":1631240411232},{"_id":"source/_posts/backend/mq/kafka.md","hash":"cc5e597d28b8788bd10e22231fa6c80b909e0223","modified":1629337077007},{"_id":"source/_posts/thinking/ali-words.md","hash":"0a76d50f3d5c50f207ea8ee7a21ecf86569c63f9","modified":1627286354126},{"_id":"source/_posts/backend/other/jimu-report.md","hash":"1ba5a809bdcf94fc66a78b8f50744053f065e5e7","modified":1628073723736},{"_id":"source/_posts/backend/service/zookeeper.md","hash":"bdb98d63bca7ee11f3367c226be45b6541873049","modified":1629337123084},{"_id":"source/_posts/backend/service/nacos.md","hash":"412048f743c0715b83e824bf75e2e6a1a0fb2f20","modified":1629337123092},{"_id":"source/_posts/backend/spring/spring-boot.md","hash":"9c0b5a4302c2edbaf56d8eddf9a0bcc2665fc084","modified":1629337016124},{"_id":"source/_posts/backend/spring/mybatis.md","hash":"befd453ede7df0e88cf01a96301c044c685ee353","modified":1629337016118},{"_id":"source/_posts/backend/storage/mysql-other.md","hash":"b433363edc3316bac04b0fe672a858e93ac954e1","modified":1627285108785},{"_id":"source/_posts/backend/spring/springcloud-gateway.md","hash":"29dd3bb8623327d134f4ca680f35077497a978c3","modified":1629337016137},{"_id":"source/_posts/framework/design/uml.md","hash":"5d469a923f94335cdac9130ad302125493b5f53e","modified":1627286354145},{"_id":"source/_posts/backend/storage/redis.md","hash":"da4a0ef9badc52ae3f9c0e7343bac5a4a68f4dff","modified":1627285108767},{"_id":"source/_posts/backend/storage/canal.md","hash":"c23271f9d03e318e87b399c2d4c16349703db881","modified":1627286239950},{"_id":"source/_posts/backend/storage/mysql.md","hash":"f999b0d5eabfb76187a11489916c40d869152562","modified":1628560559458},{"_id":"source/_posts/backend/java/build/gradle.md","hash":"9b832069da84ec8d990cb990a20cd5c69ede0b32","modified":1611207847480},{"_id":"source/_posts/backend/java/thread/threadPool.md","hash":"b32e9d76e1d480bb3f71c8af84c09bd0d120dcb1","modified":1612852049796},{"_id":"source/_posts/backend/java/netty/io.md","hash":"251ebab4624a4b20180d6b444f3e25e8f02a1a46","modified":1628653594044},{"_id":"source/_posts/backend/java/utils/mybatis-plus.md","hash":"54a4c312ed82e1c7600eae72284b1a2af717630a","modified":1616222431408},{"_id":"source/_posts/backend/java/utils/excel.md","hash":"ec9c89a70d7fd7f83fd6a9b4ebd260fa142bd7a8","modified":1608971735306},{"_id":"source/_posts/backend/spring/framework/springframework-1.md","hash":"63a2d04bbca9c78f111517a64d42803d0e24a46a","modified":1629337016130},{"_id":"source/_posts/backend/java/utils/convert/map-struct.md","hash":"8ea52cf949c1275e132ed3e5f14a5c0b314657c4","modified":1616222284436},{"_id":"source/_posts/backend/spring/framework/springframework-2.md","hash":"d64fbddac18a65ed6f2405b9d61cf57c1ab72afd","modified":1629337305039},{"_id":"source/_posts/backend/java/utils/swagger.md","hash":"7bf8a21e0606f08341c69caa2001dda24f830c05","modified":1608971131533},{"_id":"source/_posts/backend/java/utils/convert/orika.md","hash":"a76466b868508136cce892435bee5cd2e1c13a2d","modified":1622599936056},{"_id":"themes/3-hexo/source/img/ddd/ddd-framework.png","hash":"4044ccda34b32aea7feb45e38c00a849ed400d3c","modified":1608279088749},{"_id":"themes/3-hexo/source/js/gitalk.js","hash":"a75ead28e6a1fab2a006cc7332ca2d2e868ce8e1","modified":1601438273686},{"_id":"themes/3-hexo/source/img/road.png","hash":"dbca25351cc63ca6feb690dd368f58e8d71543ba","modified":1601450845821},{"_id":"public/search.xml","hash":"55dfa8fbf893725af9343cb4ba5828831b32f5bf","modified":1631243213172},{"_id":"public/2021/08/17/backend/spring/mybatis/index.html","hash":"5a3bfa1b73ca2304d418fe64c8e4ffb8ad214fae","modified":1631243213172},{"_id":"public/2021/08/11/backend/java/netty/io/index.html","hash":"23102525821be9a45523e192030f4c378b5c2803","modified":1631243213172},{"_id":"public/2021/08/04/backend/other/jimu-report/index.html","hash":"7807cd9b9a2347e13cd995086ab60c8b1660fa37","modified":1631243213172},{"_id":"public/2021/07/26/backend/spring/framework/springframework-2/index.html","hash":"a7e1043ee6bbb4f18285e2e1c85987a750f7fccb","modified":1631243213172},{"_id":"public/2021/07/20/backend/storage/mysql/index.html","hash":"7d108321d4a42c0cc0f572d2748ae88185180659","modified":1631243213172},{"_id":"public/2021/06/26/backend/spring/framework/springframework-1/index.html","hash":"98dca35251fdd28dea012fb64af549a178e3b6dc","modified":1631243213172},{"_id":"public/2021/06/15/backend/spring/springcloud-gateway/index.html","hash":"728d9d894ba41446dee1121ef2eca80d093abfc6","modified":1631243213172},{"_id":"public/2021/05/19/devops/skywalking/index.html","hash":"3604379bdee6413025d7208fab9ee9cf35dcacb7","modified":1631243213172},{"_id":"public/2021/05/18/devops/istio/index.html","hash":"24cc503f51c56e71a19db0c213c607cb2163ab05","modified":1631243213172},{"_id":"public/2021/04/28/frontend/vue/index.html","hash":"1e96b1307d2335d0e8bdafd93c64ac73edd5e557","modified":1631243213172},{"_id":"public/2021/04/16/devops/docker/index.html","hash":"984e246ed659a96a310d2ab77e613f9c753bcac0","modified":1631243213172},{"_id":"public/2021/04/13/test/test/index.html","hash":"a064a817c33f0b54d3173ce059af6fdff64320f1","modified":1631243213172},{"_id":"public/2021/04/13/backend/service/nacos/index.html","hash":"1c1179afce817d4094c575a41a3f0a0c4e61e9ac","modified":1631243213172},{"_id":"public/2021/04/05/devops/nginx/index.html","hash":"2323a11a72bc2f7afb5800d0e417c37cf4848d5c","modified":1631243213172},{"_id":"public/2021/03/22/backend/spring/spring-boot/index.html","hash":"e16254fd5832c1fc16e9c1cc4eba64a9c8a07730","modified":1631243213172},{"_id":"public/2021/03/20/backend/java/utils/convert/orika/index.html","hash":"3463816c83cd811bea05535bf4a50e4eda4d075a","modified":1631243213172},{"_id":"public/2021/02/18/devops/ldap/index.html","hash":"14fe3ded1e5e1abc04ec9d197a6029616432a34f","modified":1631243213172},{"_id":"public/2021/02/09/devops/check/index.html","hash":"9b09658ca5aab79985a8f02a9891bd21ef386c0f","modified":1631243213172},{"_id":"public/2021/02/09/backend/java/thread/threadPool/index.html","hash":"83dafbd5747f9780aa13cd744cc30df508e9480a","modified":1631243213172},{"_id":"public/2021/02/03/backend/mq/kafka/index.html","hash":"4b614e4fc15906ce0152bf44d0b09982a19f9b21","modified":1631243213172},{"_id":"public/2021/02/02/backend/storage/redis/index.html","hash":"40be155bc995cc9a9d8eabe8e795da3be14a7ec1","modified":1631243213172},{"_id":"public/2021/01/21/backend/java/build/gradle/index.html","hash":"a5ea133a0bbff8960b24a5efff12e596c6ee4fd4","modified":1631243213172},{"_id":"public/2020/12/25/framework/design/uml/index.html","hash":"205db63a9f7e80c6baac6f08f4e164dcc7837183","modified":1631243213172},{"_id":"public/2020/12/15/framework/cola/index.html","hash":"2c98316c34197545b9fda9eeb675886cb658928c","modified":1631243213172},{"_id":"public/2020/12/10/backend/java/utils/mybatis-plus/index.html","hash":"d138d238d53b7750ab95ae520781b09b95fb093a","modified":1631243213172},{"_id":"public/2020/11/17/framework/oauth2/index.html","hash":"afe7a623fd7c3f593b0a0dd48cecb457f2a25e8d","modified":1631243213172},{"_id":"public/2020/11/11/backend/java/utils/swagger/index.html","hash":"f04a671a9d34dfbd71ea2c3c5131d8c069882c2f","modified":1631243213172},{"_id":"public/2020/11/04/thinking/ali-words/index.html","hash":"63900237a0c973151a7a822390d9699d976786c2","modified":1631243213172},{"_id":"public/2020/10/29/backend/service/zookeeper/index.html","hash":"6ba35a84d253cb3abc9ccce4f1320359db908684","modified":1631243213172},{"_id":"public/2020/10/20/backend/java/utils/excel/index.html","hash":"4d462f72a46e2128fec7732ff2976fb59bc03e8f","modified":1631243213172},{"_id":"public/2020/10/09/framework/ddd/index.html","hash":"91bec8369f0c0dd6507866a304049a5ae8ded714","modified":1631243213172},{"_id":"public/2020/10/02/backend/storage/mysql-other/index.html","hash":"3bc74463eb62918221c9fc48b0e177609a857c87","modified":1631243213172},{"_id":"public/2020/10/02/backend/storage/canal/index.html","hash":"c82f40366513f803724077661908cb9e34cc7183","modified":1631243213172},{"_id":"public/2020/10/02/backend/java/utils/convert/map-struct/index.html","hash":"e4bd012e55a70a06059a9b2b987825015f921895","modified":1631243213172},{"_id":"public/2020/10/02/framework/design-model/index.html","hash":"8933142dab97194e6d7ba44ec1f333f61abbed9f","modified":1631243213172},{"_id":"public/2020/10/02/thinking/book/index.html","hash":"6aa92a18914fc767532d8805175afd88ec3db36f","modified":1631243213172},{"_id":"public/2020/10/02/other/software/index.html","hash":"9682b0453a35c9a94da085d283aebe455457c80b","modified":1631243213172},{"_id":"public/2020/09/30/other/hexo/index.html","hash":"a5550d69d934ac33d2def978b320424b161c5917","modified":1631243213172},{"_id":"public/archives/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/page/2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/page/3/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/page/4/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/page/2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/09/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/10/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/11/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2020/12/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/page/2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/page/3/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/01/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/02/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/03/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/04/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/05/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/06/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/07/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/archives/2021/08/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/page/2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/运维/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/架构/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/其他/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/前端/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/测试/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/思考/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/消息队列/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/三方集成/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/服务治理/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/框架/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/存储/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/项目编译/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/io/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/线程池/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/categories/后端/工具/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/page/2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/page/3/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/page/4/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/oauth2/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/devops/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/docker/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/istio/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/ldap/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/nginx/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/skywalking/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/COLA/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/DDD/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/tool/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/vue/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/test/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/常用语/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/思维/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/message/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/kafka/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/三方集成/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/nacos/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/动态配置/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/注册中心/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/zookeeper/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/分布式锁/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/多数据源/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/springboot/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/gateway/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/mysql/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/canal/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/cache/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/uml/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/类图/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/项目编译/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/io/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/线程池/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/utils/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/SpringFramework/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/tags/设计模式/index.html","hash":"e937741ce5fce770ba4c4dedfb4950b5f5e9120a","modified":1631243213172},{"_id":"public/img/article-list-background.jpeg","hash":"4fdf8b3e53dd02d6ee6360aebfadb0cba1fb5633","modified":1631243213172},{"_id":"public/img/avatar.jpg","hash":"a42360089bfa892d803cf5747eab359d90f337f1","modified":1631243213172},{"_id":"public/img/gov.png","hash":"f31c9f47faedf7f33b9580d6284ab891fb697560","modified":1631243213172},{"_id":"public/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1631243213172},{"_id":"public/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1631243213172},{"_id":"public/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1631243213172},{"_id":"public/css/fonts/icomoon.svg","hash":"37ac1ef28b03f46bf3ad2606c86f0e1ec3e4405f","modified":1631243213172},{"_id":"public/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1631243213172},{"_id":"public/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1631243213172},{"_id":"public/css/fonts/iconfont.eot","hash":"b14b8624988ff069aff3145f88c0d7ac49052bd3","modified":1631243213172},{"_id":"public/css/fonts/iconfont.ttf","hash":"140829ecf12d30c6e18d8dc6dc0c188a66addd25","modified":1631243213172},{"_id":"public/css/fonts/iconfont.woff","hash":"0d2d4559f1ac4fa801eb8cc099fa5bf9dcf955ef","modified":1631243213172},{"_id":"public/css/fonts/iconfont.woff2","hash":"b0317a0b2ebb1181a8bf5a97d03556dd54538645","modified":1631243213172},{"_id":"public/img/cache/redisTemplate-serialize.png","hash":"befbf5f80d088f754be6a5ce3bfbe2709f1c2a8c","modified":1631243213172},{"_id":"public/img/ddd/four-color.png","hash":"40cae7376e963aa4e978055a81c301a7179ed0a7","modified":1631243213172},{"_id":"public/img/uml/uml-line.png","hash":"e8c82f1b6afb89bb14abef8e8492eefc6a56a42b","modified":1631243213172},{"_id":"public/img/alipay.jpg","hash":"e457d1d3dfefbbd824d154cf756a2c6d10b812a2","modified":1631243213172},{"_id":"public/img/moon.jpg","hash":"21c3a55fea9ba6648719007bdd988928e4cec911","modified":1631243213172},{"_id":"public/css/fonts/iconfont.svg","hash":"13974fe35fca836e870a960ecb11b7eca2e036f8","modified":1631243213172},{"_id":"public/img/design-model/design-model-type.jpg","hash":"16f2174838bbf81a207117a7cbdb7e12a7448d9d","modified":1631243213172},{"_id":"public/img/uml/uml.png","hash":"11754a8f76a759f2d798dfe8a73fad9468c45012","modified":1631243213172},{"_id":"public/img/weixin.jpg","hash":"8dafb22561698d0758fba9ea2a45abf6ad3512a2","modified":1631243213172},{"_id":"public/css/mobile.css","hash":"55bbb9303075ccbab2c75744b2486d9f0e247be8","modified":1631243213172},{"_id":"public/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1631243213172},{"_id":"public/js/titleTip.js","hash":"81dca549063e29ba3a4a278f0f4388eba8a2167b","modified":1631243213172},{"_id":"public/css/hl_theme/atom-dark.css","hash":"88d11052a24e8100af6248eb4dbe1ce7b0e96408","modified":1631243213172},{"_id":"public/css/hl_theme/atom-light.css","hash":"d31edb9816dae6b01410028bceb91757a962f780","modified":1631243213172},{"_id":"public/css/hl_theme/brown-paper.css","hash":"500c8e750373f6656ff49a7857c871ceedcf8777","modified":1631243213172},{"_id":"public/css/hl_theme/darcula.css","hash":"4341074bae4bc9f0b86e32b623e27babc0159b6e","modified":1631243213172},{"_id":"public/css/hl_theme/github-gist.css","hash":"7a41c1c479d09df875f99f1f6d94aac42e9e2ad0","modified":1631243213172},{"_id":"public/css/hl_theme/github.css","hash":"e05a0806a508a26b9f3f3794b6b588ec6504ad3f","modified":1631243213172},{"_id":"public/css/hl_theme/gruvbox-dark.css","hash":"8c440d9b4ee19ac03eaee3c6af78ba52e5ba5535","modified":1631243213172},{"_id":"public/css/hl_theme/gruvbox-light.css","hash":"30514aaa242a34647aa666cfca4fc74c595ea8f2","modified":1631243213172},{"_id":"public/css/hl_theme/kimbie-dark.css","hash":"728527fcc308da454722c119b89e6da3025bd1e3","modified":1631243213172},{"_id":"public/css/hl_theme/kimbie-light.css","hash":"0c61926c989163faefb031d27bce3e287d6e10f2","modified":1631243213172},{"_id":"public/css/hl_theme/railscasts.css","hash":"511f2fd2a84d426e5da5cb17880cc08f73beb002","modified":1631243213172},{"_id":"public/css/hl_theme/rainbow.css","hash":"7ff4251938076ddb7e4e49413db82653e5b61321","modified":1631243213172},{"_id":"public/css/hl_theme/school-book.css","hash":"ffbbcd13a74ac2404262c50b7a43053dfd0096ff","modified":1631243213172},{"_id":"public/css/hl_theme/sublime.css","hash":"f65c5b116d9213afb9c324384a2f3bc86cb71121","modified":1631243213172},{"_id":"public/css/hl_theme/sunburst.css","hash":"8a135abac1512cf430d1d1ad2304b79afa1a4d6e","modified":1631243213172},{"_id":"public/css/hl_theme/zenbum.css","hash":"0a78f74a93568e20b32ca7427c719e9bae9a0b55","modified":1631243213172},{"_id":"public/css/style.css","hash":"47e6996707d9e4028cb4641a4451af7ec46b9cf4","modified":1631243213172},{"_id":"public/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1631243213172},{"_id":"public/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1631243213172},{"_id":"public/js/script.js","hash":"03fc06177b47fd6bac7ae393f9712c726272467b","modified":1631243213172},{"_id":"public/css/fonts/selection.json","hash":"047b615ea32dc48dae5b964061427d41feaaafdf","modified":1631243213172},{"_id":"public/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1631243213172},{"_id":"public/img/ddd/ddd-framework.png","hash":"4044ccda34b32aea7feb45e38c00a849ed400d3c","modified":1631243213172},{"_id":"public/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1631243213172},{"_id":"public/img/road.png","hash":"dbca25351cc63ca6feb690dd368f58e8d71543ba","modified":1631243213172},{"_id":"public/js/gitalk.js","hash":"a75ead28e6a1fab2a006cc7332ca2d2e868ce8e1","modified":1631243213172}],"Category":[{"name":"后端","_id":"cktds3bch0003fms69xishgw2"},{"name":"运维","_id":"cktds3bct000dfms670abhvg2"},{"name":"java","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bcz000ifms64mw2ehpy"},{"name":"安全","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bdn0013fms62gj184vp"},{"name":"架构","_id":"cktds3be3001ffms6bbsb9dzt"},{"name":"其他","_id":"cktds3bel001yfms688zw75xo"},{"name":"前端","_id":"cktds3bez002afms6d7pphj01"},{"name":"测试","_id":"cktds3bf5002hfms6be5k5d83"},{"name":"思考","_id":"cktds3bfa002ofms6b4lvb3h9"},{"name":"消息队列","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bfj0030fms65w5a0c6n"},{"name":"三方集成","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bfl0036fms6bwgz8xfp"},{"name":"服务治理","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bfm0039fms63gp306vi"},{"name":"框架","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bfp003jfms6b9ut0bnl"},{"name":"存储","_id":"cktds3bfs003wfms64sv0d5jd"},{"name":"项目编译","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bg6004efms65z5r7szy"},{"name":"io","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bgb004kfms6f7r325dv"},{"name":"线程池","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bgd004ofms622v49dcw"},{"name":"工具","parent":"cktds3bch0003fms69xishgw2","_id":"cktds3bgf004tfms64w4u7z7d"}],"Data":[],"Page":[],"Post":[{"_content":"### idea无限试用(2020.1.4可用，其他不知道)\n- mac\n```shell script\n#!/bin/sh\n# reset jetbrains ide evals\n\nOS_NAME=$(uname -s)\nJB_PRODUCTS=\"IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode\"\n\nif [ $OS_NAME == \"Darwin\" ]; then\n\techo 'macOS:'\n\n\tfor PRD in $JB_PRODUCTS; do\n    \trm -rf ~/Library/Preferences/${PRD}*/eval\n    \trm -rf ~/Library/Application\\ Support/JetBrains/${PRD}*/eval\n\tdone\nelif [ $OS_NAME == \"Linux\" ]; then\n\techo 'Linux:'\n\n\tfor PRD in $JB_PRODUCTS; do\n    \trm -rf ~/.${PRD}*/config/eval\n\tdone\nelse\n\techo 'unsupport'\n\texit\nfi\n\necho 'done.'\n```\n\n- windows\n```shell script\nSet oShell = CreateObject(\"WScript.Shell\")\nSet oFS = CreateObject(\"Scripting.FileSystemObject\")\nsHomeFolder = oShell.ExpandEnvironmentStrings(\"%USERPROFILE%\")\nsJBDataFolder = oShell.ExpandEnvironmentStrings(\"%APPDATA%\") + \"\\JetBrains\"\n\nSet re = New RegExp\nre.Global     = True\nre.IgnoreCase = True\nre.Pattern    = \"\\.?(IntelliJIdea|GoLand|CLion|PyCharm|DataGrip|RubyMine|AppCode|PhpStorm|WebStorm|Rider).*\"\n\nSub removeEval(ByVal file, ByVal sEvalPath)\n\tbMatch = re.Test(file.Name)\n    If Not bMatch Then\n\t\tExit Sub\n\tEnd If\n\n\tIf oFS.FolderExists(sEvalPath) Then\n\t\toFS.DeleteFolder sEvalPath, True \n\tEnd If\nEnd Sub\n\nIf oFS.FolderExists(sHomeFolder) Then\n\tFor Each oFile In oFS.GetFolder(sHomeFolder).SubFolders\n    \tremoveEval oFile, sHomeFolder + \"\\\" + oFile.Name + \"\\config\\eval\"\n\tNext\nEnd If\n\nIf oFS.FolderExists(sJBDataFolder) Then\n\tFor Each oFile In oFS.GetFolder(sJBDataFolder).SubFolders\n\t    removeEval oFile, sJBDataFolder + \"\\\" + oFile.Name + \"\\eval\"\n\tNext\nEnd If\n\nMsgBox \"done\"\n```","source":"_drafts/idea.md","raw":"### idea无限试用(2020.1.4可用，其他不知道)\n- mac\n```shell script\n#!/bin/sh\n# reset jetbrains ide evals\n\nOS_NAME=$(uname -s)\nJB_PRODUCTS=\"IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode\"\n\nif [ $OS_NAME == \"Darwin\" ]; then\n\techo 'macOS:'\n\n\tfor PRD in $JB_PRODUCTS; do\n    \trm -rf ~/Library/Preferences/${PRD}*/eval\n    \trm -rf ~/Library/Application\\ Support/JetBrains/${PRD}*/eval\n\tdone\nelif [ $OS_NAME == \"Linux\" ]; then\n\techo 'Linux:'\n\n\tfor PRD in $JB_PRODUCTS; do\n    \trm -rf ~/.${PRD}*/config/eval\n\tdone\nelse\n\techo 'unsupport'\n\texit\nfi\n\necho 'done.'\n```\n\n- windows\n```shell script\nSet oShell = CreateObject(\"WScript.Shell\")\nSet oFS = CreateObject(\"Scripting.FileSystemObject\")\nsHomeFolder = oShell.ExpandEnvironmentStrings(\"%USERPROFILE%\")\nsJBDataFolder = oShell.ExpandEnvironmentStrings(\"%APPDATA%\") + \"\\JetBrains\"\n\nSet re = New RegExp\nre.Global     = True\nre.IgnoreCase = True\nre.Pattern    = \"\\.?(IntelliJIdea|GoLand|CLion|PyCharm|DataGrip|RubyMine|AppCode|PhpStorm|WebStorm|Rider).*\"\n\nSub removeEval(ByVal file, ByVal sEvalPath)\n\tbMatch = re.Test(file.Name)\n    If Not bMatch Then\n\t\tExit Sub\n\tEnd If\n\n\tIf oFS.FolderExists(sEvalPath) Then\n\t\toFS.DeleteFolder sEvalPath, True \n\tEnd If\nEnd Sub\n\nIf oFS.FolderExists(sHomeFolder) Then\n\tFor Each oFile In oFS.GetFolder(sHomeFolder).SubFolders\n    \tremoveEval oFile, sHomeFolder + \"\\\" + oFile.Name + \"\\config\\eval\"\n\tNext\nEnd If\n\nIf oFS.FolderExists(sJBDataFolder) Then\n\tFor Each oFile In oFS.GetFolder(sJBDataFolder).SubFolders\n\t    removeEval oFile, sJBDataFolder + \"\\\" + oFile.Name + \"\\eval\"\n\tNext\nEnd If\n\nMsgBox \"done\"\n```","slug":"idea","published":0,"date":"2020-11-27T05:50:47.273Z","updated":"2020-11-27T05:52:36.453Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bc00000fms6d3ma1tmk","content":"<h3 id=\"idea无限试用-2020-1-4可用，其他不知道\"><a href=\"#idea无限试用-2020-1-4可用，其他不知道\" class=\"headerlink\" title=\"idea无限试用(2020.1.4可用，其他不知道)\"></a>idea无限试用(2020.1.4可用，其他不知道)</h3><ul>\n<li>mac<pre><code class=\"shell\">#!/bin/sh\n# reset jetbrains ide evals\n</code></pre>\n</li>\n</ul>\n<p>OS_NAME=$(uname -s)<br>JB_PRODUCTS=”IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode”</p>\n<p>if [ $OS_NAME == “Darwin” ]; then<br>    echo ‘macOS:’</p>\n<pre><code>for PRD in $JB_PRODUCTS; do\n    rm -rf ~/Library/Preferences/$&#123;PRD&#125;*/eval\n    rm -rf ~/Library/Application\\ Support/JetBrains/$&#123;PRD&#125;*/eval\ndone</code></pre>\n<p>elif [ $OS_NAME == “Linux” ]; then<br>    echo ‘Linux:’</p>\n<pre><code>for PRD in $JB_PRODUCTS; do\n    rm -rf ~/.$&#123;PRD&#125;*/config/eval\ndone</code></pre>\n<p>else<br>    echo ‘unsupport’<br>    exit<br>fi</p>\n<p>echo ‘done.’</p>\n<pre><code>\n- windows\n```shell script\nSet oShell = CreateObject(&quot;WScript.Shell&quot;)\nSet oFS = CreateObject(&quot;Scripting.FileSystemObject&quot;)\nsHomeFolder = oShell.ExpandEnvironmentStrings(&quot;%USERPROFILE%&quot;)\nsJBDataFolder = oShell.ExpandEnvironmentStrings(&quot;%APPDATA%&quot;) + &quot;\\JetBrains&quot;\n\nSet re = New RegExp\nre.Global     = True\nre.IgnoreCase = True\nre.Pattern    = &quot;\\.?(IntelliJIdea|GoLand|CLion|PyCharm|DataGrip|RubyMine|AppCode|PhpStorm|WebStorm|Rider).*&quot;\n\nSub removeEval(ByVal file, ByVal sEvalPath)\n    bMatch = re.Test(file.Name)\n    If Not bMatch Then\n        Exit Sub\n    End If\n\n    If oFS.FolderExists(sEvalPath) Then\n        oFS.DeleteFolder sEvalPath, True \n    End If\nEnd Sub\n\nIf oFS.FolderExists(sHomeFolder) Then\n    For Each oFile In oFS.GetFolder(sHomeFolder).SubFolders\n        removeEval oFile, sHomeFolder + &quot;\\&quot; + oFile.Name + &quot;\\config\\eval&quot;\n    Next\nEnd If\n\nIf oFS.FolderExists(sJBDataFolder) Then\n    For Each oFile In oFS.GetFolder(sJBDataFolder).SubFolders\n        removeEval oFile, sJBDataFolder + &quot;\\&quot; + oFile.Name + &quot;\\eval&quot;\n    Next\nEnd If\n\nMsgBox &quot;done&quot;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"idea无限试用-2020-1-4可用，其他不知道\"><a href=\"#idea无限试用-2020-1-4可用，其他不知道\" class=\"headerlink\" title=\"idea无限试用(2020.1.4可用，其他不知道)\"></a>idea无限试用(2020.1.4可用，其他不知道)</h3><ul>\n<li>mac<pre><code class=\"shell\">#!/bin/sh\n# reset jetbrains ide evals\n</code></pre>\n</li>\n</ul>\n<p>OS_NAME=$(uname -s)<br>JB_PRODUCTS=”IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode”</p>\n<p>if [ $OS_NAME == “Darwin” ]; then<br>    echo ‘macOS:’</p>\n<pre><code>for PRD in $JB_PRODUCTS; do\n    rm -rf ~/Library/Preferences/$&#123;PRD&#125;*/eval\n    rm -rf ~/Library/Application\\ Support/JetBrains/$&#123;PRD&#125;*/eval\ndone</code></pre>\n<p>elif [ $OS_NAME == “Linux” ]; then<br>    echo ‘Linux:’</p>\n<pre><code>for PRD in $JB_PRODUCTS; do\n    rm -rf ~/.$&#123;PRD&#125;*/config/eval\ndone</code></pre>\n<p>else<br>    echo ‘unsupport’<br>    exit<br>fi</p>\n<p>echo ‘done.’</p>\n<pre><code>\n- windows\n```shell script\nSet oShell = CreateObject(&quot;WScript.Shell&quot;)\nSet oFS = CreateObject(&quot;Scripting.FileSystemObject&quot;)\nsHomeFolder = oShell.ExpandEnvironmentStrings(&quot;%USERPROFILE%&quot;)\nsJBDataFolder = oShell.ExpandEnvironmentStrings(&quot;%APPDATA%&quot;) + &quot;\\JetBrains&quot;\n\nSet re = New RegExp\nre.Global     = True\nre.IgnoreCase = True\nre.Pattern    = &quot;\\.?(IntelliJIdea|GoLand|CLion|PyCharm|DataGrip|RubyMine|AppCode|PhpStorm|WebStorm|Rider).*&quot;\n\nSub removeEval(ByVal file, ByVal sEvalPath)\n    bMatch = re.Test(file.Name)\n    If Not bMatch Then\n        Exit Sub\n    End If\n\n    If oFS.FolderExists(sEvalPath) Then\n        oFS.DeleteFolder sEvalPath, True \n    End If\nEnd Sub\n\nIf oFS.FolderExists(sHomeFolder) Then\n    For Each oFile In oFS.GetFolder(sHomeFolder).SubFolders\n        removeEval oFile, sHomeFolder + &quot;\\&quot; + oFile.Name + &quot;\\config\\eval&quot;\n    Next\nEnd If\n\nIf oFS.FolderExists(sJBDataFolder) Then\n    For Each oFile In oFS.GetFolder(sJBDataFolder).SubFolders\n        removeEval oFile, sJBDataFolder + &quot;\\&quot; + oFile.Name + &quot;\\eval&quot;\n    Next\nEnd If\n\nMsgBox &quot;done&quot;</code></pre>\n"},{"title":"Java","description":"java基础","date":"2021-09-06T06:13:08.000Z","_content":"\n\n### Java\n- [jdk9-jdk16(转)](https://mp.weixin.qq.com/s?__biz=Mzg2MjEwMjI1Mg==&mid=2247522266&idx=1&sn=2bf8c094a4e80e91366d2db7493f1fd0&chksm=ce0e2059f979a94f4725f35155e11d95d6d187b1079462ee5835598ef557b772946d49e03cce&scene=132#wechat_redirect)\n","source":"_drafts/java.md","raw":"---\ntitle: Java\ndescription: java基础\ndate: 2021-09-06 14:13:08\ntags:\n- java\ncategories:\n- 后端\n- java\n---\n\n\n### Java\n- [jdk9-jdk16(转)](https://mp.weixin.qq.com/s?__biz=Mzg2MjEwMjI1Mg==&mid=2247522266&idx=1&sn=2bf8c094a4e80e91366d2db7493f1fd0&chksm=ce0e2059f979a94f4725f35155e11d95d6d187b1079462ee5835598ef557b772946d49e03cce&scene=132#wechat_redirect)\n","slug":"java","published":0,"updated":"2021-09-06T06:13:20.899Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcc0001fms6e86ccog4","content":"<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><ul>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=Mzg2MjEwMjI1Mg==&mid=2247522266&idx=1&sn=2bf8c094a4e80e91366d2db7493f1fd0&chksm=ce0e2059f979a94f4725f35155e11d95d6d187b1079462ee5835598ef557b772946d49e03cce&scene=132#wechat_redirect\">jdk9-jdk16(转)</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><ul>\n<li><a href=\"https://mp.weixin.qq.com/s?__biz=Mzg2MjEwMjI1Mg==&mid=2247522266&idx=1&sn=2bf8c094a4e80e91366d2db7493f1fd0&chksm=ce0e2059f979a94f4725f35155e11d95d6d187b1079462ee5835598ef557b772946d49e03cce&scene=132#wechat_redirect\">jdk9-jdk16(转)</a></li>\n</ul>\n"},{"title":"Oauth2","description":"鉴权框架","date":"2020-11-08T02:37:12.000Z","_content":"\n### 安全框架\n- [SpringSecurity](https://docs.spring.io/spring-security/site/docs/4.1.0.RELEASE/reference/htmlsingle/#what-is-acegi-security)\n- [Oauth2](https://oauth.net/2/)\n- [LDAP](http://www.ldap.org.cn/)\n\n### 自定义获取token逻辑\n- 添加配置\n```textmate\n在自定义AuthorizationServerConfigurerAdapter的继承类中，添加配置\nendpoints.pathMapping(\"/oauth/token\", \"/my/login\");\n```\n- Controller\n```java\nclass UserController{\n    /**\n     * 只有映射的接口，security框架才会将principal信息填充进去\n     * parameters: 生成token所需的入参; \n     * principal: 安全框架所需用户信息\n     */\n    @ApiOperation(value = \"获取token接口\", notes = \"用于获取token接口\")\n    @PostMapping(value = \"/my/login\")\n    public Result<LoginReslut> login(@RequestParam Map<String, String> parameters,\n                                Principal principal){\n        return xxx;\n    }\n}\n```\n","source":"_drafts/oauth2.md","raw":"---\ntitle: Oauth2\ndescription: 鉴权框架 \ndate: 2020-11-08 10:37:12\ntags:\n- oauth2\ncategories:\n- 后端\n- 安全\n---\n\n### 安全框架\n- [SpringSecurity](https://docs.spring.io/spring-security/site/docs/4.1.0.RELEASE/reference/htmlsingle/#what-is-acegi-security)\n- [Oauth2](https://oauth.net/2/)\n- [LDAP](http://www.ldap.org.cn/)\n\n### 自定义获取token逻辑\n- 添加配置\n```textmate\n在自定义AuthorizationServerConfigurerAdapter的继承类中，添加配置\nendpoints.pathMapping(\"/oauth/token\", \"/my/login\");\n```\n- Controller\n```java\nclass UserController{\n    /**\n     * 只有映射的接口，security框架才会将principal信息填充进去\n     * parameters: 生成token所需的入参; \n     * principal: 安全框架所需用户信息\n     */\n    @ApiOperation(value = \"获取token接口\", notes = \"用于获取token接口\")\n    @PostMapping(value = \"/my/login\")\n    public Result<LoginReslut> login(@RequestParam Map<String, String> parameters,\n                                Principal principal){\n        return xxx;\n    }\n}\n```\n","slug":"oauth2","published":0,"updated":"2021-07-22T06:51:15.238Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcf0002fms6daxn3mrh","content":"<h3 id=\"安全框架\"><a href=\"#安全框架\" class=\"headerlink\" title=\"安全框架\"></a>安全框架</h3><ul>\n<li><a href=\"https://docs.spring.io/spring-security/site/docs/4.1.0.RELEASE/reference/htmlsingle/#what-is-acegi-security\">SpringSecurity</a></li>\n<li><a href=\"https://oauth.net/2/\">Oauth2</a></li>\n<li><a href=\"http://www.ldap.org.cn/\">LDAP</a></li>\n</ul>\n<h3 id=\"自定义获取token逻辑\"><a href=\"#自定义获取token逻辑\" class=\"headerlink\" title=\"自定义获取token逻辑\"></a>自定义获取token逻辑</h3><ul>\n<li>添加配置<pre><code class=\"textmate\">在自定义AuthorizationServerConfigurerAdapter的继承类中，添加配置\nendpoints.pathMapping(&quot;/oauth/token&quot;, &quot;/my/login&quot;);</code></pre>\n</li>\n<li>Controller<pre><code class=\"java\">class UserController&#123;\n  /**\n   * 只有映射的接口，security框架才会将principal信息填充进去\n   * parameters: 生成token所需的入参; \n   * principal: 安全框架所需用户信息\n   */\n  @ApiOperation(value = &quot;获取token接口&quot;, notes = &quot;用于获取token接口&quot;)\n  @PostMapping(value = &quot;/my/login&quot;)\n  public Result&lt;LoginReslut&gt; login(@RequestParam Map&lt;String, String&gt; parameters,\n                              Principal principal)&#123;\n      return xxx;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安全框架\"><a href=\"#安全框架\" class=\"headerlink\" title=\"安全框架\"></a>安全框架</h3><ul>\n<li><a href=\"https://docs.spring.io/spring-security/site/docs/4.1.0.RELEASE/reference/htmlsingle/#what-is-acegi-security\">SpringSecurity</a></li>\n<li><a href=\"https://oauth.net/2/\">Oauth2</a></li>\n<li><a href=\"http://www.ldap.org.cn/\">LDAP</a></li>\n</ul>\n<h3 id=\"自定义获取token逻辑\"><a href=\"#自定义获取token逻辑\" class=\"headerlink\" title=\"自定义获取token逻辑\"></a>自定义获取token逻辑</h3><ul>\n<li>添加配置<pre><code class=\"textmate\">在自定义AuthorizationServerConfigurerAdapter的继承类中，添加配置\nendpoints.pathMapping(&quot;/oauth/token&quot;, &quot;/my/login&quot;);</code></pre>\n</li>\n<li>Controller<pre><code class=\"java\">class UserController&#123;\n  /**\n   * 只有映射的接口，security框架才会将principal信息填充进去\n   * parameters: 生成token所需的入参; \n   * principal: 安全框架所需用户信息\n   */\n  @ApiOperation(value = &quot;获取token接口&quot;, notes = &quot;用于获取token接口&quot;)\n  @PostMapping(value = &quot;/my/login&quot;)\n  public Result&lt;LoginReslut&gt; login(@RequestParam Map&lt;String, String&gt; parameters,\n                              Principal principal)&#123;\n      return xxx;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n"},{"_content":"## 用户系统设计\n### RBAC 和 ABAC的优势及劣势\n- [相关链接](https://mp.weixin.qq.com/s/bG_7bIIO7NUNC1j0fP1TGQ)\n```textmate\n我们在前面文章中说过，RBAC在应对复杂场景的时候会显得很吃力，但是它有没有好处呢？答案是当然有，它的好处显而易见就是简单且容易理解，我们很容易想象，一般不是开发者的这种用户创建一个角色是多么的容易，但是你如果让他去写一个策略的json，那他怕是要骂娘，因为一般人根本都不知道json是干嘛的，所以就更不可能会写json。\n\nABAC的优点就是RBAC的缺点，它可以胜任在复杂场景下的鉴权工作，但是不知道读者们注意到了上面的json中没有菜单信息 这一点了没，往具体的说就是如果你的系统使用的是个很纯粹的ABAC权限模型，那么，你的系统是不具备管控用户可以渲染的菜单的能力的，这时候肯定有人说，我可以通过一个人的所绑定的策略（ABAC中policy一般都是分配给人的）计算出他能访问的所有API然后去渲染API所绑定的菜单呀，这个想法其实是大错特错的，一方面，因为policy中有的条件是动态的，比如时间，如果纯粹靠计算来的话，那么这一刻和下一刻看到的菜单很有可能是不一样的（因为时间可能也是一种条件），另一方面就是，API和菜单往往不是一一对应关系，也就是说，API上面可能绑定了多个菜单，这时候就会有粒度的问题。\n```\n","source":"_drafts/user.md","raw":"## 用户系统设计\n### RBAC 和 ABAC的优势及劣势\n- [相关链接](https://mp.weixin.qq.com/s/bG_7bIIO7NUNC1j0fP1TGQ)\n```textmate\n我们在前面文章中说过，RBAC在应对复杂场景的时候会显得很吃力，但是它有没有好处呢？答案是当然有，它的好处显而易见就是简单且容易理解，我们很容易想象，一般不是开发者的这种用户创建一个角色是多么的容易，但是你如果让他去写一个策略的json，那他怕是要骂娘，因为一般人根本都不知道json是干嘛的，所以就更不可能会写json。\n\nABAC的优点就是RBAC的缺点，它可以胜任在复杂场景下的鉴权工作，但是不知道读者们注意到了上面的json中没有菜单信息 这一点了没，往具体的说就是如果你的系统使用的是个很纯粹的ABAC权限模型，那么，你的系统是不具备管控用户可以渲染的菜单的能力的，这时候肯定有人说，我可以通过一个人的所绑定的策略（ABAC中policy一般都是分配给人的）计算出他能访问的所有API然后去渲染API所绑定的菜单呀，这个想法其实是大错特错的，一方面，因为policy中有的条件是动态的，比如时间，如果纯粹靠计算来的话，那么这一刻和下一刻看到的菜单很有可能是不一样的（因为时间可能也是一种条件），另一方面就是，API和菜单往往不是一一对应关系，也就是说，API上面可能绑定了多个菜单，这时候就会有粒度的问题。\n```\n","slug":"user","published":0,"date":"2021-09-07T06:26:31.309Z","updated":"2021-09-07T06:28:13.417Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcj0005fms6766d0l3o","content":"<h2 id=\"用户系统设计\"><a href=\"#用户系统设计\" class=\"headerlink\" title=\"用户系统设计\"></a>用户系统设计</h2><h3 id=\"RBAC-和-ABAC的优势及劣势\"><a href=\"#RBAC-和-ABAC的优势及劣势\" class=\"headerlink\" title=\"RBAC 和 ABAC的优势及劣势\"></a>RBAC 和 ABAC的优势及劣势</h3><ul>\n<li><a href=\"https://mp.weixin.qq.com/s/bG_7bIIO7NUNC1j0fP1TGQ\">相关链接</a><pre><code class=\"textmate\">我们在前面文章中说过，RBAC在应对复杂场景的时候会显得很吃力，但是它有没有好处呢？答案是当然有，它的好处显而易见就是简单且容易理解，我们很容易想象，一般不是开发者的这种用户创建一个角色是多么的容易，但是你如果让他去写一个策略的json，那他怕是要骂娘，因为一般人根本都不知道json是干嘛的，所以就更不可能会写json。\n</code></pre>\n</li>\n</ul>\n<p>ABAC的优点就是RBAC的缺点，它可以胜任在复杂场景下的鉴权工作，但是不知道读者们注意到了上面的json中没有菜单信息 这一点了没，往具体的说就是如果你的系统使用的是个很纯粹的ABAC权限模型，那么，你的系统是不具备管控用户可以渲染的菜单的能力的，这时候肯定有人说，我可以通过一个人的所绑定的策略（ABAC中policy一般都是分配给人的）计算出他能访问的所有API然后去渲染API所绑定的菜单呀，这个想法其实是大错特错的，一方面，因为policy中有的条件是动态的，比如时间，如果纯粹靠计算来的话，那么这一刻和下一刻看到的菜单很有可能是不一样的（因为时间可能也是一种条件），另一方面就是，API和菜单往往不是一一对应关系，也就是说，API上面可能绑定了多个菜单，这时候就会有粒度的问题。</p>\n<pre><code></code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"用户系统设计\"><a href=\"#用户系统设计\" class=\"headerlink\" title=\"用户系统设计\"></a>用户系统设计</h2><h3 id=\"RBAC-和-ABAC的优势及劣势\"><a href=\"#RBAC-和-ABAC的优势及劣势\" class=\"headerlink\" title=\"RBAC 和 ABAC的优势及劣势\"></a>RBAC 和 ABAC的优势及劣势</h3><ul>\n<li><a href=\"https://mp.weixin.qq.com/s/bG_7bIIO7NUNC1j0fP1TGQ\">相关链接</a><pre><code class=\"textmate\">我们在前面文章中说过，RBAC在应对复杂场景的时候会显得很吃力，但是它有没有好处呢？答案是当然有，它的好处显而易见就是简单且容易理解，我们很容易想象，一般不是开发者的这种用户创建一个角色是多么的容易，但是你如果让他去写一个策略的json，那他怕是要骂娘，因为一般人根本都不知道json是干嘛的，所以就更不可能会写json。\n</code></pre>\n</li>\n</ul>\n<p>ABAC的优点就是RBAC的缺点，它可以胜任在复杂场景下的鉴权工作，但是不知道读者们注意到了上面的json中没有菜单信息 这一点了没，往具体的说就是如果你的系统使用的是个很纯粹的ABAC权限模型，那么，你的系统是不具备管控用户可以渲染的菜单的能力的，这时候肯定有人说，我可以通过一个人的所绑定的策略（ABAC中policy一般都是分配给人的）计算出他能访问的所有API然后去渲染API所绑定的菜单呀，这个想法其实是大错特错的，一方面，因为policy中有的条件是动态的，比如时间，如果纯粹靠计算来的话，那么这一刻和下一刻看到的菜单很有可能是不一样的（因为时间可能也是一种条件），另一方面就是，API和菜单往往不是一一对应关系，也就是说，API上面可能绑定了多个菜单，这时候就会有粒度的问题。</p>\n<pre><code></code></pre>\n"},{"title":"服务常见问题排查","date":"2021-02-09T09:08:25.000Z","_content":"\n### 死锁问题排查\n- 模拟死锁\n\n```java\n@Slf4j\npublic class ThreadTest {\n\n    public static String a1 = \"a1\";\n    public static String a2 = \"a2\";\n\n    public static void main(String[] args) {\n        new Thread(new PrintA()).start();\n        new Thread(new PrintB()).start();\n    }\n}\n```\n```java\n@Slf4j\nclass PrintA implements Runnable{\n    @SneakyThrows\n    @Override\n    public void run() {\n        synchronized (ThreadTest.a1){\n            log.info(\"PrintA =====> a1\");\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a2){\n                log.info(\"PrintA =====> a2\");\n            }\n        }\n    }\n}\n```\n```java\n@Slf4j\nclass PrintB implements Runnable{\n\n    @SneakyThrows\n    @Override\n    public void run() {\n        synchronized (ThreadTest.a2){\n            log.info(\"PrintB =====> a2\");\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a1){\n                log.info(\"PrintB =====> a1\");\n            }\n        }\n    }\n}\n```\n\n- 排查命令\n\n```shell\n# 查找到运行中java进程\njps -l\n\n# 查看进程堆栈信息\njstack pid\n\n# 查看服务gc情况\njstat -gcutil pid 1000\n```\n\n- 工具\n\n```textmate\n1.gceasy网站\n https://www.gceasy.io\n \n2.jconsole 或者 jvisualvm\n```\n\n### 频繁FullGC问题排查\n\n- 模拟频繁GC\n\n```java\n@Slf4j\npublic class OOMTest extends TestCore {\n\n    @Autowired\n    private ThreadPoolConfig poolConfig;\n\n    @Test\n    public void newInstance(){\n        for(;;){\n            ConcurrentHashMap map = new ConcurrentHashMap<>(3000);\n            map.put(\"a\",\"b\");\n            log.info(\"{} size={}\",map.toString(),map.size());\n        }\n    }\n}\n```\n\n- 排查\n\n```textmate\n1.配置项目启动参数\n    #出现 OOM 时生成堆 dump: \n    -XX:+HeapDumpOnOutOfMemoryError\n    #生成堆文件地址：\n    -XX:HeapDumpPath=/home/project/jvmlogs/\n\n2.查看哪些对象较大\n    jmap -histo pid | head -20\n\n3.通过指令排查(堆栈较大的话可能会将系统卡死)\n    jmap -dump:file=文件名.dump [pid]\n    # format=b 指定为二进制文件\n    jmap -dump:format=b,file=文件名 [pid]\n```\n\n- 分析\n\n```textmate\n工具 \n    1.jhat - jdk自带分析工具\n        jhat <heap-dump-file>  heap-dump-file 是文件的路径和文件名\n        执行后访问浏览器访问 http://localhost:7000/ 查看 \n    2.Eclipse Memory Analyzer(MAT)\n    3.IBM Heap Analyzer\n```\n","source":"_posts/devops/check.md","raw":"---\ntitle: 服务常见问题排查\ndate: 2021-02-09 17:08:25\ntags:\n- devops\ncategories:\n- 运维\n---\n\n### 死锁问题排查\n- 模拟死锁\n\n```java\n@Slf4j\npublic class ThreadTest {\n\n    public static String a1 = \"a1\";\n    public static String a2 = \"a2\";\n\n    public static void main(String[] args) {\n        new Thread(new PrintA()).start();\n        new Thread(new PrintB()).start();\n    }\n}\n```\n```java\n@Slf4j\nclass PrintA implements Runnable{\n    @SneakyThrows\n    @Override\n    public void run() {\n        synchronized (ThreadTest.a1){\n            log.info(\"PrintA =====> a1\");\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a2){\n                log.info(\"PrintA =====> a2\");\n            }\n        }\n    }\n}\n```\n```java\n@Slf4j\nclass PrintB implements Runnable{\n\n    @SneakyThrows\n    @Override\n    public void run() {\n        synchronized (ThreadTest.a2){\n            log.info(\"PrintB =====> a2\");\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a1){\n                log.info(\"PrintB =====> a1\");\n            }\n        }\n    }\n}\n```\n\n- 排查命令\n\n```shell\n# 查找到运行中java进程\njps -l\n\n# 查看进程堆栈信息\njstack pid\n\n# 查看服务gc情况\njstat -gcutil pid 1000\n```\n\n- 工具\n\n```textmate\n1.gceasy网站\n https://www.gceasy.io\n \n2.jconsole 或者 jvisualvm\n```\n\n### 频繁FullGC问题排查\n\n- 模拟频繁GC\n\n```java\n@Slf4j\npublic class OOMTest extends TestCore {\n\n    @Autowired\n    private ThreadPoolConfig poolConfig;\n\n    @Test\n    public void newInstance(){\n        for(;;){\n            ConcurrentHashMap map = new ConcurrentHashMap<>(3000);\n            map.put(\"a\",\"b\");\n            log.info(\"{} size={}\",map.toString(),map.size());\n        }\n    }\n}\n```\n\n- 排查\n\n```textmate\n1.配置项目启动参数\n    #出现 OOM 时生成堆 dump: \n    -XX:+HeapDumpOnOutOfMemoryError\n    #生成堆文件地址：\n    -XX:HeapDumpPath=/home/project/jvmlogs/\n\n2.查看哪些对象较大\n    jmap -histo pid | head -20\n\n3.通过指令排查(堆栈较大的话可能会将系统卡死)\n    jmap -dump:file=文件名.dump [pid]\n    # format=b 指定为二进制文件\n    jmap -dump:format=b,file=文件名 [pid]\n```\n\n- 分析\n\n```textmate\n工具 \n    1.jhat - jdk自带分析工具\n        jhat <heap-dump-file>  heap-dump-file 是文件的路径和文件名\n        执行后访问浏览器访问 http://localhost:7000/ 查看 \n    2.Eclipse Memory Analyzer(MAT)\n    3.IBM Heap Analyzer\n```\n","slug":"devops/check","published":1,"updated":"2021-07-26T07:59:14.151Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcl0006fms687foex7v","content":"<h3 id=\"死锁问题排查\"><a href=\"#死锁问题排查\" class=\"headerlink\" title=\"死锁问题排查\"></a>死锁问题排查</h3><ul>\n<li>模拟死锁</li>\n</ul>\n<pre><code class=\"java\">@Slf4j\npublic class ThreadTest &#123;\n\n    public static String a1 = &quot;a1&quot;;\n    public static String a2 = &quot;a2&quot;;\n\n    public static void main(String[] args) &#123;\n        new Thread(new PrintA()).start();\n        new Thread(new PrintB()).start();\n    &#125;\n&#125;</code></pre>\n<pre><code class=\"java\">@Slf4j\nclass PrintA implements Runnable&#123;\n    @SneakyThrows\n    @Override\n    public void run() &#123;\n        synchronized (ThreadTest.a1)&#123;\n            log.info(&quot;PrintA =====&gt; a1&quot;);\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a2)&#123;\n                log.info(&quot;PrintA =====&gt; a2&quot;);\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<pre><code class=\"java\">@Slf4j\nclass PrintB implements Runnable&#123;\n\n    @SneakyThrows\n    @Override\n    public void run() &#123;\n        synchronized (ThreadTest.a2)&#123;\n            log.info(&quot;PrintB =====&gt; a2&quot;);\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a1)&#123;\n                log.info(&quot;PrintB =====&gt; a1&quot;);\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<ul>\n<li>排查命令</li>\n</ul>\n<pre><code class=\"shell\"># 查找到运行中java进程\njps -l\n\n# 查看进程堆栈信息\njstack pid\n\n# 查看服务gc情况\njstat -gcutil pid 1000</code></pre>\n<ul>\n<li>工具</li>\n</ul>\n<pre><code class=\"textmate\">1.gceasy网站\n https://www.gceasy.io\n\n2.jconsole 或者 jvisualvm</code></pre>\n<h3 id=\"频繁FullGC问题排查\"><a href=\"#频繁FullGC问题排查\" class=\"headerlink\" title=\"频繁FullGC问题排查\"></a>频繁FullGC问题排查</h3><ul>\n<li>模拟频繁GC</li>\n</ul>\n<pre><code class=\"java\">@Slf4j\npublic class OOMTest extends TestCore &#123;\n\n    @Autowired\n    private ThreadPoolConfig poolConfig;\n\n    @Test\n    public void newInstance()&#123;\n        for(;;)&#123;\n            ConcurrentHashMap map = new ConcurrentHashMap&lt;&gt;(3000);\n            map.put(&quot;a&quot;,&quot;b&quot;);\n            log.info(&quot;&#123;&#125; size=&#123;&#125;&quot;,map.toString(),map.size());\n        &#125;\n    &#125;\n&#125;</code></pre>\n<ul>\n<li>排查</li>\n</ul>\n<pre><code class=\"textmate\">1.配置项目启动参数\n    #出现 OOM 时生成堆 dump: \n    -XX:+HeapDumpOnOutOfMemoryError\n    #生成堆文件地址：\n    -XX:HeapDumpPath=/home/project/jvmlogs/\n\n2.查看哪些对象较大\n    jmap -histo pid | head -20\n\n3.通过指令排查(堆栈较大的话可能会将系统卡死)\n    jmap -dump:file=文件名.dump [pid]\n    # format=b 指定为二进制文件\n    jmap -dump:format=b,file=文件名 [pid]</code></pre>\n<ul>\n<li>分析</li>\n</ul>\n<pre><code class=\"textmate\">工具 \n    1.jhat - jdk自带分析工具\n        jhat &lt;heap-dump-file&gt;  heap-dump-file 是文件的路径和文件名\n        执行后访问浏览器访问 http://localhost:7000/ 查看 \n    2.Eclipse Memory Analyzer(MAT)\n    3.IBM Heap Analyzer</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"死锁问题排查\"><a href=\"#死锁问题排查\" class=\"headerlink\" title=\"死锁问题排查\"></a>死锁问题排查</h3><ul>\n<li>模拟死锁</li>\n</ul>\n<pre><code class=\"java\">@Slf4j\npublic class ThreadTest &#123;\n\n    public static String a1 = &quot;a1&quot;;\n    public static String a2 = &quot;a2&quot;;\n\n    public static void main(String[] args) &#123;\n        new Thread(new PrintA()).start();\n        new Thread(new PrintB()).start();\n    &#125;\n&#125;</code></pre>\n<pre><code class=\"java\">@Slf4j\nclass PrintA implements Runnable&#123;\n    @SneakyThrows\n    @Override\n    public void run() &#123;\n        synchronized (ThreadTest.a1)&#123;\n            log.info(&quot;PrintA =====&gt; a1&quot;);\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a2)&#123;\n                log.info(&quot;PrintA =====&gt; a2&quot;);\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<pre><code class=\"java\">@Slf4j\nclass PrintB implements Runnable&#123;\n\n    @SneakyThrows\n    @Override\n    public void run() &#123;\n        synchronized (ThreadTest.a2)&#123;\n            log.info(&quot;PrintB =====&gt; a2&quot;);\n            Thread.sleep(3000);\n            synchronized (ThreadTest.a1)&#123;\n                log.info(&quot;PrintB =====&gt; a1&quot;);\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<ul>\n<li>排查命令</li>\n</ul>\n<pre><code class=\"shell\"># 查找到运行中java进程\njps -l\n\n# 查看进程堆栈信息\njstack pid\n\n# 查看服务gc情况\njstat -gcutil pid 1000</code></pre>\n<ul>\n<li>工具</li>\n</ul>\n<pre><code class=\"textmate\">1.gceasy网站\n https://www.gceasy.io\n\n2.jconsole 或者 jvisualvm</code></pre>\n<h3 id=\"频繁FullGC问题排查\"><a href=\"#频繁FullGC问题排查\" class=\"headerlink\" title=\"频繁FullGC问题排查\"></a>频繁FullGC问题排查</h3><ul>\n<li>模拟频繁GC</li>\n</ul>\n<pre><code class=\"java\">@Slf4j\npublic class OOMTest extends TestCore &#123;\n\n    @Autowired\n    private ThreadPoolConfig poolConfig;\n\n    @Test\n    public void newInstance()&#123;\n        for(;;)&#123;\n            ConcurrentHashMap map = new ConcurrentHashMap&lt;&gt;(3000);\n            map.put(&quot;a&quot;,&quot;b&quot;);\n            log.info(&quot;&#123;&#125; size=&#123;&#125;&quot;,map.toString(),map.size());\n        &#125;\n    &#125;\n&#125;</code></pre>\n<ul>\n<li>排查</li>\n</ul>\n<pre><code class=\"textmate\">1.配置项目启动参数\n    #出现 OOM 时生成堆 dump: \n    -XX:+HeapDumpOnOutOfMemoryError\n    #生成堆文件地址：\n    -XX:HeapDumpPath=/home/project/jvmlogs/\n\n2.查看哪些对象较大\n    jmap -histo pid | head -20\n\n3.通过指令排查(堆栈较大的话可能会将系统卡死)\n    jmap -dump:file=文件名.dump [pid]\n    # format=b 指定为二进制文件\n    jmap -dump:format=b,file=文件名 [pid]</code></pre>\n<ul>\n<li>分析</li>\n</ul>\n<pre><code class=\"textmate\">工具 \n    1.jhat - jdk自带分析工具\n        jhat &lt;heap-dump-file&gt;  heap-dump-file 是文件的路径和文件名\n        执行后访问浏览器访问 http://localhost:7000/ 查看 \n    2.Eclipse Memory Analyzer(MAT)\n    3.IBM Heap Analyzer</code></pre>\n"},{"title":"运维相关","date":"2021-04-16T06:19:25.000Z","_content":"### K8S相关\n- [k8s实践(转)](https://k8s.imroc.io/troubleshooting/)\n- [k8s问题定位手册(转)](https://www.processon.com/view/link/5e4662ade4b0d86ec4018e50#map)\n\n### Docker相关\n- [清理Docker](https://dockerwebdev.com/tutorials/clean-up-docker/)\n- [Kubernetes中文社区](https://www.kubernetes.org.cn/kubernetes-pod)\n- [Istio(ServiceMesh)](https://istio.io/latest/zh/docs/setup/getting-started/)\n- [Kiali](https://kiali.io/documentation/latest/runtimes-monitoring/#_quarkus)\n\n#### 本地启动K8S\n```textmate\n1.先下载安装docker desktop(建议3.2.2以上)\n    https://www.docker.com/products/docker-desktop\n\n2.安装好后启动docker desktop\n\n3.设置\n    3.1 Perferences ==> Kubernetes ==> 开启Enable Kubernetes，Show system containers\n    3.2 如果开启不了尝试手动下载k8s相关进行并重启docker desktop\n    3.3 下载与docker desktop中Kubernetes一致的版本\n        https://github.com/maguowei/k8s-docker-desktop-for-mac\n        \n```\n\n#### docker设置\n```textmate\n1.设置开机自启\n    sudo systemctl enable xx\n\n2.配置docker容器自动重启\n    docker update xx --restart=always\n```\n\n#### 清理Docker\n```textmate\nhttps://dockerwebdev.com/tutorials/clean-up-docker\n```\n\n#### 配置阿里云镜像加速\n```textmate\n阿里云控制台->容器服务->镜像加速器->选择不同系统的命令并执行\n```\n\n#### Docker踩坑\n```textmate\n1.目录挂载问题\n    如果要映射具体文件，需要先手工创建好，否则默认是作为文件夹创建的\n```\n\n### 虚拟机-VirtualBox\n#### VirtualBox虚拟机镜像安装工具\n```textmate\n   vargrant 软件(有对应的镜像仓库)\n   vargrant init center/7  ---> 会生成类似dockerfile的文件,支持修改配置\n   vargrant up --> 启动，相当于点虚拟机开机\n   vargrant ssh  ---> ssh链接虚拟机\n   vargrant reload ---> 重启虚拟机\n```\n","source":"_posts/devops/docker.md","raw":"---\ntitle: 运维相关\ndate: 2021-04-16 14:19:25\ntags:\n- docker\ncategories:\n- 运维\n---\n### K8S相关\n- [k8s实践(转)](https://k8s.imroc.io/troubleshooting/)\n- [k8s问题定位手册(转)](https://www.processon.com/view/link/5e4662ade4b0d86ec4018e50#map)\n\n### Docker相关\n- [清理Docker](https://dockerwebdev.com/tutorials/clean-up-docker/)\n- [Kubernetes中文社区](https://www.kubernetes.org.cn/kubernetes-pod)\n- [Istio(ServiceMesh)](https://istio.io/latest/zh/docs/setup/getting-started/)\n- [Kiali](https://kiali.io/documentation/latest/runtimes-monitoring/#_quarkus)\n\n#### 本地启动K8S\n```textmate\n1.先下载安装docker desktop(建议3.2.2以上)\n    https://www.docker.com/products/docker-desktop\n\n2.安装好后启动docker desktop\n\n3.设置\n    3.1 Perferences ==> Kubernetes ==> 开启Enable Kubernetes，Show system containers\n    3.2 如果开启不了尝试手动下载k8s相关进行并重启docker desktop\n    3.3 下载与docker desktop中Kubernetes一致的版本\n        https://github.com/maguowei/k8s-docker-desktop-for-mac\n        \n```\n\n#### docker设置\n```textmate\n1.设置开机自启\n    sudo systemctl enable xx\n\n2.配置docker容器自动重启\n    docker update xx --restart=always\n```\n\n#### 清理Docker\n```textmate\nhttps://dockerwebdev.com/tutorials/clean-up-docker\n```\n\n#### 配置阿里云镜像加速\n```textmate\n阿里云控制台->容器服务->镜像加速器->选择不同系统的命令并执行\n```\n\n#### Docker踩坑\n```textmate\n1.目录挂载问题\n    如果要映射具体文件，需要先手工创建好，否则默认是作为文件夹创建的\n```\n\n### 虚拟机-VirtualBox\n#### VirtualBox虚拟机镜像安装工具\n```textmate\n   vargrant 软件(有对应的镜像仓库)\n   vargrant init center/7  ---> 会生成类似dockerfile的文件,支持修改配置\n   vargrant up --> 启动，相当于点虚拟机开机\n   vargrant ssh  ---> ssh链接虚拟机\n   vargrant reload ---> 重启虚拟机\n```\n","slug":"devops/docker","published":1,"updated":"2021-07-26T07:59:14.119Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcm0007fms6g4rjdt1n","content":"<h3 id=\"K8S相关\"><a href=\"#K8S相关\" class=\"headerlink\" title=\"K8S相关\"></a>K8S相关</h3><ul>\n<li><a href=\"https://k8s.imroc.io/troubleshooting/\">k8s实践(转)</a></li>\n<li><a href=\"https://www.processon.com/view/link/5e4662ade4b0d86ec4018e50#map\">k8s问题定位手册(转)</a></li>\n</ul>\n<h3 id=\"Docker相关\"><a href=\"#Docker相关\" class=\"headerlink\" title=\"Docker相关\"></a>Docker相关</h3><ul>\n<li><a href=\"https://dockerwebdev.com/tutorials/clean-up-docker/\">清理Docker</a></li>\n<li><a href=\"https://www.kubernetes.org.cn/kubernetes-pod\">Kubernetes中文社区</a></li>\n<li><a href=\"https://istio.io/latest/zh/docs/setup/getting-started/\">Istio(ServiceMesh)</a></li>\n<li><a href=\"https://kiali.io/documentation/latest/runtimes-monitoring/#_quarkus\">Kiali</a></li>\n</ul>\n<h4 id=\"本地启动K8S\"><a href=\"#本地启动K8S\" class=\"headerlink\" title=\"本地启动K8S\"></a>本地启动K8S</h4><pre><code class=\"textmate\">1.先下载安装docker desktop(建议3.2.2以上)\n    https://www.docker.com/products/docker-desktop\n\n2.安装好后启动docker desktop\n\n3.设置\n    3.1 Perferences ==&gt; Kubernetes ==&gt; 开启Enable Kubernetes，Show system containers\n    3.2 如果开启不了尝试手动下载k8s相关进行并重启docker desktop\n    3.3 下载与docker desktop中Kubernetes一致的版本\n        https://github.com/maguowei/k8s-docker-desktop-for-mac\n</code></pre>\n<h4 id=\"docker设置\"><a href=\"#docker设置\" class=\"headerlink\" title=\"docker设置\"></a>docker设置</h4><pre><code class=\"textmate\">1.设置开机自启\n    sudo systemctl enable xx\n\n2.配置docker容器自动重启\n    docker update xx --restart=always</code></pre>\n<h4 id=\"清理Docker\"><a href=\"#清理Docker\" class=\"headerlink\" title=\"清理Docker\"></a>清理Docker</h4><pre><code class=\"textmate\">https://dockerwebdev.com/tutorials/clean-up-docker</code></pre>\n<h4 id=\"配置阿里云镜像加速\"><a href=\"#配置阿里云镜像加速\" class=\"headerlink\" title=\"配置阿里云镜像加速\"></a>配置阿里云镜像加速</h4><pre><code class=\"textmate\">阿里云控制台-&gt;容器服务-&gt;镜像加速器-&gt;选择不同系统的命令并执行</code></pre>\n<h4 id=\"Docker踩坑\"><a href=\"#Docker踩坑\" class=\"headerlink\" title=\"Docker踩坑\"></a>Docker踩坑</h4><pre><code class=\"textmate\">1.目录挂载问题\n    如果要映射具体文件，需要先手工创建好，否则默认是作为文件夹创建的</code></pre>\n<h3 id=\"虚拟机-VirtualBox\"><a href=\"#虚拟机-VirtualBox\" class=\"headerlink\" title=\"虚拟机-VirtualBox\"></a>虚拟机-VirtualBox</h3><h4 id=\"VirtualBox虚拟机镜像安装工具\"><a href=\"#VirtualBox虚拟机镜像安装工具\" class=\"headerlink\" title=\"VirtualBox虚拟机镜像安装工具\"></a>VirtualBox虚拟机镜像安装工具</h4><pre><code class=\"textmate\">   vargrant 软件(有对应的镜像仓库)\n   vargrant init center/7  ---&gt; 会生成类似dockerfile的文件,支持修改配置\n   vargrant up --&gt; 启动，相当于点虚拟机开机\n   vargrant ssh  ---&gt; ssh链接虚拟机\n   vargrant reload ---&gt; 重启虚拟机</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"K8S相关\"><a href=\"#K8S相关\" class=\"headerlink\" title=\"K8S相关\"></a>K8S相关</h3><ul>\n<li><a href=\"https://k8s.imroc.io/troubleshooting/\">k8s实践(转)</a></li>\n<li><a href=\"https://www.processon.com/view/link/5e4662ade4b0d86ec4018e50#map\">k8s问题定位手册(转)</a></li>\n</ul>\n<h3 id=\"Docker相关\"><a href=\"#Docker相关\" class=\"headerlink\" title=\"Docker相关\"></a>Docker相关</h3><ul>\n<li><a href=\"https://dockerwebdev.com/tutorials/clean-up-docker/\">清理Docker</a></li>\n<li><a href=\"https://www.kubernetes.org.cn/kubernetes-pod\">Kubernetes中文社区</a></li>\n<li><a href=\"https://istio.io/latest/zh/docs/setup/getting-started/\">Istio(ServiceMesh)</a></li>\n<li><a href=\"https://kiali.io/documentation/latest/runtimes-monitoring/#_quarkus\">Kiali</a></li>\n</ul>\n<h4 id=\"本地启动K8S\"><a href=\"#本地启动K8S\" class=\"headerlink\" title=\"本地启动K8S\"></a>本地启动K8S</h4><pre><code class=\"textmate\">1.先下载安装docker desktop(建议3.2.2以上)\n    https://www.docker.com/products/docker-desktop\n\n2.安装好后启动docker desktop\n\n3.设置\n    3.1 Perferences ==&gt; Kubernetes ==&gt; 开启Enable Kubernetes，Show system containers\n    3.2 如果开启不了尝试手动下载k8s相关进行并重启docker desktop\n    3.3 下载与docker desktop中Kubernetes一致的版本\n        https://github.com/maguowei/k8s-docker-desktop-for-mac\n</code></pre>\n<h4 id=\"docker设置\"><a href=\"#docker设置\" class=\"headerlink\" title=\"docker设置\"></a>docker设置</h4><pre><code class=\"textmate\">1.设置开机自启\n    sudo systemctl enable xx\n\n2.配置docker容器自动重启\n    docker update xx --restart=always</code></pre>\n<h4 id=\"清理Docker\"><a href=\"#清理Docker\" class=\"headerlink\" title=\"清理Docker\"></a>清理Docker</h4><pre><code class=\"textmate\">https://dockerwebdev.com/tutorials/clean-up-docker</code></pre>\n<h4 id=\"配置阿里云镜像加速\"><a href=\"#配置阿里云镜像加速\" class=\"headerlink\" title=\"配置阿里云镜像加速\"></a>配置阿里云镜像加速</h4><pre><code class=\"textmate\">阿里云控制台-&gt;容器服务-&gt;镜像加速器-&gt;选择不同系统的命令并执行</code></pre>\n<h4 id=\"Docker踩坑\"><a href=\"#Docker踩坑\" class=\"headerlink\" title=\"Docker踩坑\"></a>Docker踩坑</h4><pre><code class=\"textmate\">1.目录挂载问题\n    如果要映射具体文件，需要先手工创建好，否则默认是作为文件夹创建的</code></pre>\n<h3 id=\"虚拟机-VirtualBox\"><a href=\"#虚拟机-VirtualBox\" class=\"headerlink\" title=\"虚拟机-VirtualBox\"></a>虚拟机-VirtualBox</h3><h4 id=\"VirtualBox虚拟机镜像安装工具\"><a href=\"#VirtualBox虚拟机镜像安装工具\" class=\"headerlink\" title=\"VirtualBox虚拟机镜像安装工具\"></a>VirtualBox虚拟机镜像安装工具</h4><pre><code class=\"textmate\">   vargrant 软件(有对应的镜像仓库)\n   vargrant init center/7  ---&gt; 会生成类似dockerfile的文件,支持修改配置\n   vargrant up --&gt; 启动，相当于点虚拟机开机\n   vargrant ssh  ---&gt; ssh链接虚拟机\n   vargrant reload ---&gt; 重启虚拟机</code></pre>\n"},{"title":"istio","date":"2021-05-18T08:30:00.000Z","_content":"\n- [官网](https://istio.io/latest/zh/docs/examples/bookinfo/)\n- [istio性能测试](https://www.jianshu.com/p/1f3f62ce3ea9)\n\n### 流量管理\n- 配置基本请求路由\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n    - route:\n        - destination:\n            host: reviews\n            subset: v1\n```\n\n- 按照请求头中用户信息过滤\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n    - match:\n        - headers:\n            end-user:\n              exact: jason\n      route:\n        - destination:\n            host: reviews\n            subset: v2\n    - match:\n        - headers:\n            end-user:\n              exact: aaa\n      route:\n        - destination:\n            host: reviews\n            subset: v2\n    - route:\n        - destination:\n            host: reviews\n            subset: v3\n```\n\n- 故障注入-延迟(jason登录，访问6s后页面才加载出来)\n```yaml\nspec:\n  hosts:\n    - ratings\n  http:\n    - fault:\n        delay:\n          fixedDelay: 7s # 7s延迟\n          percentage:\n            value: 100\n      match:\n        - headers:\n            end-user:\n              exact: jason\n      route:\n        - destination:\n            host: ratings\n            subset: v1\n    - route:\n        - destination:\n            host: ratings\n            subset: v1\n```\n\n- 故障注入-异常(jason登录，50几率访问返回500)\n```yaml\nspec:\n  hosts:\n  - ratings\n  http:\n  - match:\n    - headers:\n        end-user:\n          exact: jason\n    fault:\n      abort:\n        percentage:\n          value: 50\n        httpStatus: 500 #注入500错误\n    route:\n    - destination:\n        host: ratings\n        subset: v1\n  - route:\n    - destination:\n        host: ratings\n        subset: v1\n```\n\n- 流量转移\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n  - route:\n    - destination:\n        host: reviews\n        subset: v1\n      weight: 50\n    - destination:\n        host: reviews\n        subset: v3\n      weight: 50\n```\n\n- 设置请求超时(2s延迟)\n```yaml\nspec:\n  hosts:\n  - ratings\n  http:\n  - fault:\n      delay:\n        percent: 100\n        fixedDelay: 2s\n    route:\n    - destination:\n        host: ratings\n        subset: v1\n```\n","source":"_posts/devops/istio.md","raw":"---\ntitle: istio\ndate: 2021-05-18 16:30:00\ntags:\n- istio \ncategories:\n- 运维\n---\n\n- [官网](https://istio.io/latest/zh/docs/examples/bookinfo/)\n- [istio性能测试](https://www.jianshu.com/p/1f3f62ce3ea9)\n\n### 流量管理\n- 配置基本请求路由\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n    - route:\n        - destination:\n            host: reviews\n            subset: v1\n```\n\n- 按照请求头中用户信息过滤\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n    - match:\n        - headers:\n            end-user:\n              exact: jason\n      route:\n        - destination:\n            host: reviews\n            subset: v2\n    - match:\n        - headers:\n            end-user:\n              exact: aaa\n      route:\n        - destination:\n            host: reviews\n            subset: v2\n    - route:\n        - destination:\n            host: reviews\n            subset: v3\n```\n\n- 故障注入-延迟(jason登录，访问6s后页面才加载出来)\n```yaml\nspec:\n  hosts:\n    - ratings\n  http:\n    - fault:\n        delay:\n          fixedDelay: 7s # 7s延迟\n          percentage:\n            value: 100\n      match:\n        - headers:\n            end-user:\n              exact: jason\n      route:\n        - destination:\n            host: ratings\n            subset: v1\n    - route:\n        - destination:\n            host: ratings\n            subset: v1\n```\n\n- 故障注入-异常(jason登录，50几率访问返回500)\n```yaml\nspec:\n  hosts:\n  - ratings\n  http:\n  - match:\n    - headers:\n        end-user:\n          exact: jason\n    fault:\n      abort:\n        percentage:\n          value: 50\n        httpStatus: 500 #注入500错误\n    route:\n    - destination:\n        host: ratings\n        subset: v1\n  - route:\n    - destination:\n        host: ratings\n        subset: v1\n```\n\n- 流量转移\n```yaml\nspec:\n  hosts:\n    - reviews\n  http:\n  - route:\n    - destination:\n        host: reviews\n        subset: v1\n      weight: 50\n    - destination:\n        host: reviews\n        subset: v3\n      weight: 50\n```\n\n- 设置请求超时(2s延迟)\n```yaml\nspec:\n  hosts:\n  - ratings\n  http:\n  - fault:\n      delay:\n        percent: 100\n        fixedDelay: 2s\n    route:\n    - destination:\n        host: ratings\n        subset: v1\n```\n","slug":"devops/istio","published":1,"updated":"2021-07-26T07:59:14.113Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcq000bfms62yysh7bs","content":"<ul>\n<li><a href=\"https://istio.io/latest/zh/docs/examples/bookinfo/\">官网</a></li>\n<li><a href=\"https://www.jianshu.com/p/1f3f62ce3ea9\">istio性能测试</a></li>\n</ul>\n<h3 id=\"流量管理\"><a href=\"#流量管理\" class=\"headerlink\" title=\"流量管理\"></a>流量管理</h3><ul>\n<li><p>配置基本请求路由</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n  - route:\n      - destination:\n          host: reviews\n          subset: v1</code></pre>\n</li>\n<li><p>按照请求头中用户信息过滤</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n  - match:\n      - headers:\n          end-user:\n            exact: jason\n    route:\n      - destination:\n          host: reviews\n          subset: v2\n  - match:\n      - headers:\n          end-user:\n            exact: aaa\n    route:\n      - destination:\n          host: reviews\n          subset: v2\n  - route:\n      - destination:\n          host: reviews\n          subset: v3</code></pre>\n</li>\n<li><p>故障注入-延迟(jason登录，访问6s后页面才加载出来)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - ratings\nhttp:\n  - fault:\n      delay:\n        fixedDelay: 7s # 7s延迟\n        percentage:\n          value: 100\n    match:\n      - headers:\n          end-user:\n            exact: jason\n    route:\n      - destination:\n          host: ratings\n          subset: v1\n  - route:\n      - destination:\n          host: ratings\n          subset: v1</code></pre>\n</li>\n<li><p>故障注入-异常(jason登录，50几率访问返回500)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n- ratings\nhttp:\n- match:\n  - headers:\n      end-user:\n        exact: jason\n  fault:\n    abort:\n      percentage:\n        value: 50\n      httpStatus: 500 #注入500错误\n  route:\n  - destination:\n      host: ratings\n      subset: v1\n- route:\n  - destination:\n      host: ratings\n      subset: v1</code></pre>\n</li>\n<li><p>流量转移</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n- route:\n  - destination:\n      host: reviews\n      subset: v1\n    weight: 50\n  - destination:\n      host: reviews\n      subset: v3\n    weight: 50</code></pre>\n</li>\n<li><p>设置请求超时(2s延迟)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n- ratings\nhttp:\n- fault:\n    delay:\n      percent: 100\n      fixedDelay: 2s\n  route:\n  - destination:\n      host: ratings\n      subset: v1</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://istio.io/latest/zh/docs/examples/bookinfo/\">官网</a></li>\n<li><a href=\"https://www.jianshu.com/p/1f3f62ce3ea9\">istio性能测试</a></li>\n</ul>\n<h3 id=\"流量管理\"><a href=\"#流量管理\" class=\"headerlink\" title=\"流量管理\"></a>流量管理</h3><ul>\n<li><p>配置基本请求路由</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n  - route:\n      - destination:\n          host: reviews\n          subset: v1</code></pre>\n</li>\n<li><p>按照请求头中用户信息过滤</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n  - match:\n      - headers:\n          end-user:\n            exact: jason\n    route:\n      - destination:\n          host: reviews\n          subset: v2\n  - match:\n      - headers:\n          end-user:\n            exact: aaa\n    route:\n      - destination:\n          host: reviews\n          subset: v2\n  - route:\n      - destination:\n          host: reviews\n          subset: v3</code></pre>\n</li>\n<li><p>故障注入-延迟(jason登录，访问6s后页面才加载出来)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - ratings\nhttp:\n  - fault:\n      delay:\n        fixedDelay: 7s # 7s延迟\n        percentage:\n          value: 100\n    match:\n      - headers:\n          end-user:\n            exact: jason\n    route:\n      - destination:\n          host: ratings\n          subset: v1\n  - route:\n      - destination:\n          host: ratings\n          subset: v1</code></pre>\n</li>\n<li><p>故障注入-异常(jason登录，50几率访问返回500)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n- ratings\nhttp:\n- match:\n  - headers:\n      end-user:\n        exact: jason\n  fault:\n    abort:\n      percentage:\n        value: 50\n      httpStatus: 500 #注入500错误\n  route:\n  - destination:\n      host: ratings\n      subset: v1\n- route:\n  - destination:\n      host: ratings\n      subset: v1</code></pre>\n</li>\n<li><p>流量转移</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n  - reviews\nhttp:\n- route:\n  - destination:\n      host: reviews\n      subset: v1\n    weight: 50\n  - destination:\n      host: reviews\n      subset: v3\n    weight: 50</code></pre>\n</li>\n<li><p>设置请求超时(2s延迟)</p>\n<pre><code class=\"yaml\">spec:\nhosts:\n- ratings\nhttp:\n- fault:\n    delay:\n      percent: 100\n      fixedDelay: 2s\n  route:\n  - destination:\n      host: ratings\n      subset: v1</code></pre>\n</li>\n</ul>\n"},{"title":"LDAP学习笔记","date":"2021-02-18T06:25:55.000Z","_content":"\n### 相关链接\n- [OpenLDAP](https://www.openldap.org/)\n- [LDAP-admin操作指南](https://www.cnblogs.com/xiaomifeng0510/p/9564688.html)\n- [CSDN-Demo](https://blog.csdn.net/weixin_30338461/article/details/98920690)\n- [官方文档及例子(重要)](http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/reference/)\n- [JAVA文档（重要）](http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/apidocs/)\n- [GitHub（大量例子）](https://github.com/spring-projects/spring-ldap)\n\n### 常用名词\n```textmate\no– organization（组织-公司）\nou – organization unit（组织单元-部门）\nc - countryName（国家）\ndc - domainComponent（域名）\nsn – suer name（真实名称）\ncn - common name（常用名称)\n```\n\n### Docker部署LDAP\n- ldap\n```shell\n#用户名 cn=admin,dc=company,dc=com\n#密码 123456\n#注意，\\后面不能有空格\ndocker run \\\n-p 389:389 \\\n-p 636:636 \\\n--name my-ldap \\\n--network bridge \\\n--hostname openldap-host \\\n--env LDAP_ORGANISATION=\"company\" \\\n--env LDAP_DOMAIN=\"company.com\" \\\n--env LDAP_ADMIN_PASSWORD=\"123456\" \\\n--detach osixia/openldap\n```\n\n- ldap-admin\n\n```shell\n#启动后浏览器访问http://localhost:8080\ndocker run \\\n-d \\\n--privileged \\\n-p 8080:80 \\\n--name ldap-admin \\\n--env PHPLDAPADMIN_HTTPS=false \\\n--env PHPLDAPADMIN_LDAP_HOSTS=LDAP服务IP \\\n--detach osixia/phpldapadmin\n```\n\n### 查询用户信息\n#### 方式一\n```java\n@Slf4j\npublic class ldapService{\n    public static void main(String[] args) {\n        try {\n            String bindUserDN = \"cn=admin,dc=company,dc=com\";\n            //用户密码\n            String bindPassword = \"123456\";\n            //ldap服务器IP\n            String url = \"ldap://127.0.0.1:389/dc=company,dc=com\";\n\n            Hashtable<String, String> env = new Hashtable<>();\n            env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\n            env.put(javax.naming.Context.PROVIDER_URL, url);\n            env.put(javax.naming.Context.SECURITY_AUTHENTICATION, \"simple\");\n            env.put(javax.naming.Context.SECURITY_PRINCIPAL, bindUserDN);\n            env.put(javax.naming.Context.SECURITY_CREDENTIALS, bindPassword);\n            env.put(\"java.naming.referral\", \"follow\");\n\n            DirContext ctx = new InitialDirContext(env);\n            log.info(\"ctx={}\", JSON.toJSONString(ctx));\n        } catch (Exception e) {\n            log.info(\"LDAP登录失败 userName={},passWord={},error={}\",username,password,e);\n        }\n        \n    }\n}\n```\n##### 方式二(ldapTemplate)\n- 配置\n```xml\n<!-- ldap -->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-ldap</artifactId>\n    <version>2.3.2.RELEASE</version>\n</dependency>\n```\n```yaml\n  # LDAP连接配置,配置的base是不应该再加到节点的dn里面去的(dc=company,dc=com)\nspring:\n  ldap:\n    urls: ldap://127.0.0.1:389\n    base: dc=company,dc=com\n    username: cn=admin,dc=company,dc=com\n    password: 123456\n```\n\n- 代码(model)\n```java\n@Getter\n@Setter\n@ToString\n@Entry(objectClasses = {\"simpleSecurityObject\", \"organizationalRole\",\"top\"}, base = \"ou=cmdb,ou=People\")\npublic class LdapPerson {\n\n    @Id\n    @JsonIgnore\n    private Name dn;\n\n    /** 用户名 **/\n    @Attribute(name=\"cn\")\n    private String personName;\n\n    @Attribute(name=\"sn\")\n    private String sn;\n\n    @Attribute(name=\"email\")\n    private String email;\n\n    /** 昵称 **/\n    @Attribute(name=\"displayName\")\n    private String displayName;\n\n    @Attribute(name=\"password\")\n    private String password;\n}\n```\n\n- 代码(dao)\n```java\n@Slf4j\npublic class PersonAttributesMapper implements AttributesMapper<LdapPerson> {\n    @Override\n    public LdapPerson mapFromAttributes(Attributes attrs) throws NamingException {\n        LdapPerson person = new LdapPerson();\n        person.setPersonName((String)attrs.get(\"cn\").get());\n\n        //获取密码\n        byte[] bts = (byte[]) attrs.get(\"userpassword\").get();\n        String password = \"\";\n        for(byte bt : bts){\n            password = password + (char)bt;\n        }\n        person.setPassword(password);\n        return person;\n    }\n}\n```\n\n- 代码(service)\n```java\npublic class LoginService{\n    \n    //lookup查询(精确定位查询)\n    public AjaxResult<LdapPerson> ldapCheck(String username, String password) {\n        String dn = String.format(userDN,username);\n        LdapPerson person = ldapTemplate.lookup(dn, new PersonAttributesMapper());\n        log.info(\"LDAP登录 username:{},person={}\",username,JSON.toJSONString(person));\n        if(person == null){\n            return AjaxResult.error(\"账号不存在\");\n        }\n        if(!password.equals(person.getPassword())){\n            log.error(\"LDAP账号对应密码错误,username={},password={},realPwd={}\",username,password,person.getPassword());\n            return AjaxResult.error(\"密码错误\");\n        }\n        return AjaxResult.success(person);\n    }\n    \n    //search(遍历所有节点匹配)\n    public LdapPerson getLdapAccountByName(String name) {\n\n        LdapQuery query = query()\n                .where(\"objectclass\").is(objectclass)\n                .and(\"cn\").is(name);\n\n        List<LdapPerson> persons = ldapTemplate.search(query,new PersonAttributesMapper());\n        if(CollectionUtils.isEmpty(persons)){\n            return null;\n        }\n        return persons.get(0);\n    }\n}\n```\n","source":"_posts/devops/ldap.md","raw":"---\ntitle: LDAP学习笔记\ndate: 2021-02-18 14:25:55\ntags:\n- ldap\ncategories:\n- 运维\n---\n\n### 相关链接\n- [OpenLDAP](https://www.openldap.org/)\n- [LDAP-admin操作指南](https://www.cnblogs.com/xiaomifeng0510/p/9564688.html)\n- [CSDN-Demo](https://blog.csdn.net/weixin_30338461/article/details/98920690)\n- [官方文档及例子(重要)](http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/reference/)\n- [JAVA文档（重要）](http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/apidocs/)\n- [GitHub（大量例子）](https://github.com/spring-projects/spring-ldap)\n\n### 常用名词\n```textmate\no– organization（组织-公司）\nou – organization unit（组织单元-部门）\nc - countryName（国家）\ndc - domainComponent（域名）\nsn – suer name（真实名称）\ncn - common name（常用名称)\n```\n\n### Docker部署LDAP\n- ldap\n```shell\n#用户名 cn=admin,dc=company,dc=com\n#密码 123456\n#注意，\\后面不能有空格\ndocker run \\\n-p 389:389 \\\n-p 636:636 \\\n--name my-ldap \\\n--network bridge \\\n--hostname openldap-host \\\n--env LDAP_ORGANISATION=\"company\" \\\n--env LDAP_DOMAIN=\"company.com\" \\\n--env LDAP_ADMIN_PASSWORD=\"123456\" \\\n--detach osixia/openldap\n```\n\n- ldap-admin\n\n```shell\n#启动后浏览器访问http://localhost:8080\ndocker run \\\n-d \\\n--privileged \\\n-p 8080:80 \\\n--name ldap-admin \\\n--env PHPLDAPADMIN_HTTPS=false \\\n--env PHPLDAPADMIN_LDAP_HOSTS=LDAP服务IP \\\n--detach osixia/phpldapadmin\n```\n\n### 查询用户信息\n#### 方式一\n```java\n@Slf4j\npublic class ldapService{\n    public static void main(String[] args) {\n        try {\n            String bindUserDN = \"cn=admin,dc=company,dc=com\";\n            //用户密码\n            String bindPassword = \"123456\";\n            //ldap服务器IP\n            String url = \"ldap://127.0.0.1:389/dc=company,dc=com\";\n\n            Hashtable<String, String> env = new Hashtable<>();\n            env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\n            env.put(javax.naming.Context.PROVIDER_URL, url);\n            env.put(javax.naming.Context.SECURITY_AUTHENTICATION, \"simple\");\n            env.put(javax.naming.Context.SECURITY_PRINCIPAL, bindUserDN);\n            env.put(javax.naming.Context.SECURITY_CREDENTIALS, bindPassword);\n            env.put(\"java.naming.referral\", \"follow\");\n\n            DirContext ctx = new InitialDirContext(env);\n            log.info(\"ctx={}\", JSON.toJSONString(ctx));\n        } catch (Exception e) {\n            log.info(\"LDAP登录失败 userName={},passWord={},error={}\",username,password,e);\n        }\n        \n    }\n}\n```\n##### 方式二(ldapTemplate)\n- 配置\n```xml\n<!-- ldap -->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-ldap</artifactId>\n    <version>2.3.2.RELEASE</version>\n</dependency>\n```\n```yaml\n  # LDAP连接配置,配置的base是不应该再加到节点的dn里面去的(dc=company,dc=com)\nspring:\n  ldap:\n    urls: ldap://127.0.0.1:389\n    base: dc=company,dc=com\n    username: cn=admin,dc=company,dc=com\n    password: 123456\n```\n\n- 代码(model)\n```java\n@Getter\n@Setter\n@ToString\n@Entry(objectClasses = {\"simpleSecurityObject\", \"organizationalRole\",\"top\"}, base = \"ou=cmdb,ou=People\")\npublic class LdapPerson {\n\n    @Id\n    @JsonIgnore\n    private Name dn;\n\n    /** 用户名 **/\n    @Attribute(name=\"cn\")\n    private String personName;\n\n    @Attribute(name=\"sn\")\n    private String sn;\n\n    @Attribute(name=\"email\")\n    private String email;\n\n    /** 昵称 **/\n    @Attribute(name=\"displayName\")\n    private String displayName;\n\n    @Attribute(name=\"password\")\n    private String password;\n}\n```\n\n- 代码(dao)\n```java\n@Slf4j\npublic class PersonAttributesMapper implements AttributesMapper<LdapPerson> {\n    @Override\n    public LdapPerson mapFromAttributes(Attributes attrs) throws NamingException {\n        LdapPerson person = new LdapPerson();\n        person.setPersonName((String)attrs.get(\"cn\").get());\n\n        //获取密码\n        byte[] bts = (byte[]) attrs.get(\"userpassword\").get();\n        String password = \"\";\n        for(byte bt : bts){\n            password = password + (char)bt;\n        }\n        person.setPassword(password);\n        return person;\n    }\n}\n```\n\n- 代码(service)\n```java\npublic class LoginService{\n    \n    //lookup查询(精确定位查询)\n    public AjaxResult<LdapPerson> ldapCheck(String username, String password) {\n        String dn = String.format(userDN,username);\n        LdapPerson person = ldapTemplate.lookup(dn, new PersonAttributesMapper());\n        log.info(\"LDAP登录 username:{},person={}\",username,JSON.toJSONString(person));\n        if(person == null){\n            return AjaxResult.error(\"账号不存在\");\n        }\n        if(!password.equals(person.getPassword())){\n            log.error(\"LDAP账号对应密码错误,username={},password={},realPwd={}\",username,password,person.getPassword());\n            return AjaxResult.error(\"密码错误\");\n        }\n        return AjaxResult.success(person);\n    }\n    \n    //search(遍历所有节点匹配)\n    public LdapPerson getLdapAccountByName(String name) {\n\n        LdapQuery query = query()\n                .where(\"objectclass\").is(objectclass)\n                .and(\"cn\").is(name);\n\n        List<LdapPerson> persons = ldapTemplate.search(query,new PersonAttributesMapper());\n        if(CollectionUtils.isEmpty(persons)){\n            return null;\n        }\n        return persons.get(0);\n    }\n}\n```\n","slug":"devops/ldap","published":1,"updated":"2021-07-26T07:59:14.170Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcs000cfms64m2dd49k","content":"<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><ul>\n<li><a href=\"https://www.openldap.org/\">OpenLDAP</a></li>\n<li><a href=\"https://www.cnblogs.com/xiaomifeng0510/p/9564688.html\">LDAP-admin操作指南</a></li>\n<li><a href=\"https://blog.csdn.net/weixin_30338461/article/details/98920690\">CSDN-Demo</a></li>\n<li><a href=\"http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/reference/\">官方文档及例子(重要)</a></li>\n<li><a href=\"http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/apidocs/\">JAVA文档（重要）</a></li>\n<li><a href=\"https://github.com/spring-projects/spring-ldap\">GitHub（大量例子）</a></li>\n</ul>\n<h3 id=\"常用名词\"><a href=\"#常用名词\" class=\"headerlink\" title=\"常用名词\"></a>常用名词</h3><pre><code class=\"textmate\">o– organization（组织-公司）\nou – organization unit（组织单元-部门）\nc - countryName（国家）\ndc - domainComponent（域名）\nsn – suer name（真实名称）\ncn - common name（常用名称)</code></pre>\n<h3 id=\"Docker部署LDAP\"><a href=\"#Docker部署LDAP\" class=\"headerlink\" title=\"Docker部署LDAP\"></a>Docker部署LDAP</h3><ul>\n<li><p>ldap<br>```shell<br>#用户名 cn=admin,dc=company,dc=com<br>#密码 123456<br>#注意，\\后面不能有空格<br>docker run \\</p>\n</li>\n<li><p>p 389:389 \\</p>\n</li>\n<li><p>p 636:636 \\</p>\n</li>\n<li><p>-name my-ldap \\</p>\n</li>\n<li><p>-network bridge \\</p>\n</li>\n<li><p>-hostname openldap-host \\</p>\n</li>\n<li><p>-env LDAP_ORGANISATION=”company” \\</p>\n</li>\n<li><p>-env LDAP_DOMAIN=”company.com” \\</p>\n</li>\n<li><p>-env LDAP_ADMIN_PASSWORD=”123456” \\</p>\n</li>\n<li><p>-detach osixia/openldap</p>\n<pre><code></code></pre>\n</li>\n<li><p>ldap-admin</p>\n</li>\n</ul>\n<pre><code class=\"shell\">#启动后浏览器访问http://localhost:8080\ndocker run \\\n-d \\\n--privileged \\\n-p 8080:80 \\\n--name ldap-admin \\\n--env PHPLDAPADMIN_HTTPS=false \\\n--env PHPLDAPADMIN_LDAP_HOSTS=LDAP服务IP \\\n--detach osixia/phpldapadmin</code></pre>\n<h3 id=\"查询用户信息\"><a href=\"#查询用户信息\" class=\"headerlink\" title=\"查询用户信息\"></a>查询用户信息</h3><h4 id=\"方式一\"><a href=\"#方式一\" class=\"headerlink\" title=\"方式一\"></a>方式一</h4><pre><code class=\"java\">@Slf4j\npublic class ldapService&#123;\n    public static void main(String[] args) &#123;\n        try &#123;\n            String bindUserDN = &quot;cn=admin,dc=company,dc=com&quot;;\n            //用户密码\n            String bindPassword = &quot;123456&quot;;\n            //ldap服务器IP\n            String url = &quot;ldap://127.0.0.1:389/dc=company,dc=com&quot;;\n\n            Hashtable&lt;String, String&gt; env = new Hashtable&lt;&gt;();\n            env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.ldap.LdapCtxFactory&quot;);\n            env.put(javax.naming.Context.PROVIDER_URL, url);\n            env.put(javax.naming.Context.SECURITY_AUTHENTICATION, &quot;simple&quot;);\n            env.put(javax.naming.Context.SECURITY_PRINCIPAL, bindUserDN);\n            env.put(javax.naming.Context.SECURITY_CREDENTIALS, bindPassword);\n            env.put(&quot;java.naming.referral&quot;, &quot;follow&quot;);\n\n            DirContext ctx = new InitialDirContext(env);\n            log.info(&quot;ctx=&#123;&#125;&quot;, JSON.toJSONString(ctx));\n        &#125; catch (Exception e) &#123;\n            log.info(&quot;LDAP登录失败 userName=&#123;&#125;,passWord=&#123;&#125;,error=&#123;&#125;&quot;,username,password,e);\n        &#125;\n\n    &#125;\n&#125;</code></pre>\n<h5 id=\"方式二-ldapTemplate\"><a href=\"#方式二-ldapTemplate\" class=\"headerlink\" title=\"方式二(ldapTemplate)\"></a>方式二(ldapTemplate)</h5><ul>\n<li><p>配置</p>\n<pre><code class=\"xml\">&lt;!-- ldap --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-starter-data-ldap&lt;/artifactId&gt;\n  &lt;version&gt;2.3.2.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n<pre><code class=\"yaml\"># LDAP连接配置,配置的base是不应该再加到节点的dn里面去的(dc=company,dc=com)\nspring:\nldap:\n  urls: ldap://127.0.0.1:389\n  base: dc=company,dc=com\n  username: cn=admin,dc=company,dc=com\n  password: 123456</code></pre>\n</li>\n<li><p>代码(model)</p>\n<pre><code class=\"java\">@Getter\n@Setter\n@ToString\n@Entry(objectClasses = &#123;&quot;simpleSecurityObject&quot;, &quot;organizationalRole&quot;,&quot;top&quot;&#125;, base = &quot;ou=cmdb,ou=People&quot;)\npublic class LdapPerson &#123;\n\n  @Id\n  @JsonIgnore\n  private Name dn;\n\n  /** 用户名 **/\n  @Attribute(name=&quot;cn&quot;)\n  private String personName;\n\n  @Attribute(name=&quot;sn&quot;)\n  private String sn;\n\n  @Attribute(name=&quot;email&quot;)\n  private String email;\n\n  /** 昵称 **/\n  @Attribute(name=&quot;displayName&quot;)\n  private String displayName;\n\n  @Attribute(name=&quot;password&quot;)\n  private String password;\n&#125;</code></pre>\n</li>\n<li><p>代码(dao)</p>\n<pre><code class=\"java\">@Slf4j\npublic class PersonAttributesMapper implements AttributesMapper&lt;LdapPerson&gt; &#123;\n  @Override\n  public LdapPerson mapFromAttributes(Attributes attrs) throws NamingException &#123;\n      LdapPerson person = new LdapPerson();\n      person.setPersonName((String)attrs.get(&quot;cn&quot;).get());\n\n      //获取密码\n      byte[] bts = (byte[]) attrs.get(&quot;userpassword&quot;).get();\n      String password = &quot;&quot;;\n      for(byte bt : bts)&#123;\n          password = password + (char)bt;\n      &#125;\n      person.setPassword(password);\n      return person;\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>代码(service)</p>\n<pre><code class=\"java\">public class LoginService&#123;\n\n  //lookup查询(精确定位查询)\n  public AjaxResult&lt;LdapPerson&gt; ldapCheck(String username, String password) &#123;\n      String dn = String.format(userDN,username);\n      LdapPerson person = ldapTemplate.lookup(dn, new PersonAttributesMapper());\n      log.info(&quot;LDAP登录 username:&#123;&#125;,person=&#123;&#125;&quot;,username,JSON.toJSONString(person));\n      if(person == null)&#123;\n          return AjaxResult.error(&quot;账号不存在&quot;);\n      &#125;\n      if(!password.equals(person.getPassword()))&#123;\n          log.error(&quot;LDAP账号对应密码错误,username=&#123;&#125;,password=&#123;&#125;,realPwd=&#123;&#125;&quot;,username,password,person.getPassword());\n          return AjaxResult.error(&quot;密码错误&quot;);\n      &#125;\n      return AjaxResult.success(person);\n  &#125;\n\n  //search(遍历所有节点匹配)\n  public LdapPerson getLdapAccountByName(String name) &#123;\n\n      LdapQuery query = query()\n              .where(&quot;objectclass&quot;).is(objectclass)\n              .and(&quot;cn&quot;).is(name);\n\n      List&lt;LdapPerson&gt; persons = ldapTemplate.search(query,new PersonAttributesMapper());\n      if(CollectionUtils.isEmpty(persons))&#123;\n          return null;\n      &#125;\n      return persons.get(0);\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><ul>\n<li><a href=\"https://www.openldap.org/\">OpenLDAP</a></li>\n<li><a href=\"https://www.cnblogs.com/xiaomifeng0510/p/9564688.html\">LDAP-admin操作指南</a></li>\n<li><a href=\"https://blog.csdn.net/weixin_30338461/article/details/98920690\">CSDN-Demo</a></li>\n<li><a href=\"http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/reference/\">官方文档及例子(重要)</a></li>\n<li><a href=\"http://docs.spring.io/spring-ldap/docs/2.1.0.RELEASE/apidocs/\">JAVA文档（重要）</a></li>\n<li><a href=\"https://github.com/spring-projects/spring-ldap\">GitHub（大量例子）</a></li>\n</ul>\n<h3 id=\"常用名词\"><a href=\"#常用名词\" class=\"headerlink\" title=\"常用名词\"></a>常用名词</h3><pre><code class=\"textmate\">o– organization（组织-公司）\nou – organization unit（组织单元-部门）\nc - countryName（国家）\ndc - domainComponent（域名）\nsn – suer name（真实名称）\ncn - common name（常用名称)</code></pre>\n<h3 id=\"Docker部署LDAP\"><a href=\"#Docker部署LDAP\" class=\"headerlink\" title=\"Docker部署LDAP\"></a>Docker部署LDAP</h3><ul>\n<li><p>ldap<br>```shell<br>#用户名 cn=admin,dc=company,dc=com<br>#密码 123456<br>#注意，\\后面不能有空格<br>docker run \\</p>\n</li>\n<li><p>p 389:389 \\</p>\n</li>\n<li><p>p 636:636 \\</p>\n</li>\n<li><p>-name my-ldap \\</p>\n</li>\n<li><p>-network bridge \\</p>\n</li>\n<li><p>-hostname openldap-host \\</p>\n</li>\n<li><p>-env LDAP_ORGANISATION=”company” \\</p>\n</li>\n<li><p>-env LDAP_DOMAIN=”company.com” \\</p>\n</li>\n<li><p>-env LDAP_ADMIN_PASSWORD=”123456” \\</p>\n</li>\n<li><p>-detach osixia/openldap</p>\n<pre><code></code></pre>\n</li>\n<li><p>ldap-admin</p>\n</li>\n</ul>\n<pre><code class=\"shell\">#启动后浏览器访问http://localhost:8080\ndocker run \\\n-d \\\n--privileged \\\n-p 8080:80 \\\n--name ldap-admin \\\n--env PHPLDAPADMIN_HTTPS=false \\\n--env PHPLDAPADMIN_LDAP_HOSTS=LDAP服务IP \\\n--detach osixia/phpldapadmin</code></pre>\n<h3 id=\"查询用户信息\"><a href=\"#查询用户信息\" class=\"headerlink\" title=\"查询用户信息\"></a>查询用户信息</h3><h4 id=\"方式一\"><a href=\"#方式一\" class=\"headerlink\" title=\"方式一\"></a>方式一</h4><pre><code class=\"java\">@Slf4j\npublic class ldapService&#123;\n    public static void main(String[] args) &#123;\n        try &#123;\n            String bindUserDN = &quot;cn=admin,dc=company,dc=com&quot;;\n            //用户密码\n            String bindPassword = &quot;123456&quot;;\n            //ldap服务器IP\n            String url = &quot;ldap://127.0.0.1:389/dc=company,dc=com&quot;;\n\n            Hashtable&lt;String, String&gt; env = new Hashtable&lt;&gt;();\n            env.put(javax.naming.Context.INITIAL_CONTEXT_FACTORY, &quot;com.sun.jndi.ldap.LdapCtxFactory&quot;);\n            env.put(javax.naming.Context.PROVIDER_URL, url);\n            env.put(javax.naming.Context.SECURITY_AUTHENTICATION, &quot;simple&quot;);\n            env.put(javax.naming.Context.SECURITY_PRINCIPAL, bindUserDN);\n            env.put(javax.naming.Context.SECURITY_CREDENTIALS, bindPassword);\n            env.put(&quot;java.naming.referral&quot;, &quot;follow&quot;);\n\n            DirContext ctx = new InitialDirContext(env);\n            log.info(&quot;ctx=&#123;&#125;&quot;, JSON.toJSONString(ctx));\n        &#125; catch (Exception e) &#123;\n            log.info(&quot;LDAP登录失败 userName=&#123;&#125;,passWord=&#123;&#125;,error=&#123;&#125;&quot;,username,password,e);\n        &#125;\n\n    &#125;\n&#125;</code></pre>\n<h5 id=\"方式二-ldapTemplate\"><a href=\"#方式二-ldapTemplate\" class=\"headerlink\" title=\"方式二(ldapTemplate)\"></a>方式二(ldapTemplate)</h5><ul>\n<li><p>配置</p>\n<pre><code class=\"xml\">&lt;!-- ldap --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-starter-data-ldap&lt;/artifactId&gt;\n  &lt;version&gt;2.3.2.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n<pre><code class=\"yaml\"># LDAP连接配置,配置的base是不应该再加到节点的dn里面去的(dc=company,dc=com)\nspring:\nldap:\n  urls: ldap://127.0.0.1:389\n  base: dc=company,dc=com\n  username: cn=admin,dc=company,dc=com\n  password: 123456</code></pre>\n</li>\n<li><p>代码(model)</p>\n<pre><code class=\"java\">@Getter\n@Setter\n@ToString\n@Entry(objectClasses = &#123;&quot;simpleSecurityObject&quot;, &quot;organizationalRole&quot;,&quot;top&quot;&#125;, base = &quot;ou=cmdb,ou=People&quot;)\npublic class LdapPerson &#123;\n\n  @Id\n  @JsonIgnore\n  private Name dn;\n\n  /** 用户名 **/\n  @Attribute(name=&quot;cn&quot;)\n  private String personName;\n\n  @Attribute(name=&quot;sn&quot;)\n  private String sn;\n\n  @Attribute(name=&quot;email&quot;)\n  private String email;\n\n  /** 昵称 **/\n  @Attribute(name=&quot;displayName&quot;)\n  private String displayName;\n\n  @Attribute(name=&quot;password&quot;)\n  private String password;\n&#125;</code></pre>\n</li>\n<li><p>代码(dao)</p>\n<pre><code class=\"java\">@Slf4j\npublic class PersonAttributesMapper implements AttributesMapper&lt;LdapPerson&gt; &#123;\n  @Override\n  public LdapPerson mapFromAttributes(Attributes attrs) throws NamingException &#123;\n      LdapPerson person = new LdapPerson();\n      person.setPersonName((String)attrs.get(&quot;cn&quot;).get());\n\n      //获取密码\n      byte[] bts = (byte[]) attrs.get(&quot;userpassword&quot;).get();\n      String password = &quot;&quot;;\n      for(byte bt : bts)&#123;\n          password = password + (char)bt;\n      &#125;\n      person.setPassword(password);\n      return person;\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>代码(service)</p>\n<pre><code class=\"java\">public class LoginService&#123;\n\n  //lookup查询(精确定位查询)\n  public AjaxResult&lt;LdapPerson&gt; ldapCheck(String username, String password) &#123;\n      String dn = String.format(userDN,username);\n      LdapPerson person = ldapTemplate.lookup(dn, new PersonAttributesMapper());\n      log.info(&quot;LDAP登录 username:&#123;&#125;,person=&#123;&#125;&quot;,username,JSON.toJSONString(person));\n      if(person == null)&#123;\n          return AjaxResult.error(&quot;账号不存在&quot;);\n      &#125;\n      if(!password.equals(person.getPassword()))&#123;\n          log.error(&quot;LDAP账号对应密码错误,username=&#123;&#125;,password=&#123;&#125;,realPwd=&#123;&#125;&quot;,username,password,person.getPassword());\n          return AjaxResult.error(&quot;密码错误&quot;);\n      &#125;\n      return AjaxResult.success(person);\n  &#125;\n\n  //search(遍历所有节点匹配)\n  public LdapPerson getLdapAccountByName(String name) &#123;\n\n      LdapQuery query = query()\n              .where(&quot;objectclass&quot;).is(objectclass)\n              .and(&quot;cn&quot;).is(name);\n\n      List&lt;LdapPerson&gt; persons = ldapTemplate.search(query,new PersonAttributesMapper());\n      if(CollectionUtils.isEmpty(persons))&#123;\n          return null;\n      &#125;\n      return persons.get(0);\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n"},{"title":"nginx","description":"nginx","date":"2021-04-05T02:26:05.000Z","_content":"\n- [官网](http://nginx.org/)\n- [菜鸟教程-Nginx 安装配置](https://www.runoob.com/linux/nginx-install-setup.html)\n- [Nginx服务器SSL证书安装部署-腾讯云](https://cloud.tencent.com/document/product/400/35244)\n\n### nginx命令\n```textmate\n1.检测配置是否正常\nnginx -t \n\n2.热部署配置\nnginx -s reload\n```\n\n### ssl-nginx配置\n```textmate\n具体参考云厂商ssl证书安装步骤\n1.下载ssl相关文件,服务器开启443端口权限\n2.解压后将文件夹Nginx中文件放到nginx安装目录下(或其他地方)\n3.添加nginx配置文件\n4.重启生效\n```\n\n### 同一域名不同服务配置\n```textmate\nserver {\n    listen       8888;\n    server_name  localhost;\n\n    location /service1/ {\n         proxy_pass http://localhost:7001/;\n    }\n    \n    location /service2/ {\n         proxy_pass http://localhost:7002/;\n    }\n}\n```\n","source":"_posts/devops/nginx.md","raw":"---\ntitle: nginx\ndescription: nginx\n#top: 1\ndate: 2021-04-05 10:26:05\ntags:\n- nginx\n\ncategories:\n- 运维\n---\n\n- [官网](http://nginx.org/)\n- [菜鸟教程-Nginx 安装配置](https://www.runoob.com/linux/nginx-install-setup.html)\n- [Nginx服务器SSL证书安装部署-腾讯云](https://cloud.tencent.com/document/product/400/35244)\n\n### nginx命令\n```textmate\n1.检测配置是否正常\nnginx -t \n\n2.热部署配置\nnginx -s reload\n```\n\n### ssl-nginx配置\n```textmate\n具体参考云厂商ssl证书安装步骤\n1.下载ssl相关文件,服务器开启443端口权限\n2.解压后将文件夹Nginx中文件放到nginx安装目录下(或其他地方)\n3.添加nginx配置文件\n4.重启生效\n```\n\n### 同一域名不同服务配置\n```textmate\nserver {\n    listen       8888;\n    server_name  localhost;\n\n    location /service1/ {\n         proxy_pass http://localhost:7001/;\n    }\n    \n    location /service2/ {\n         proxy_pass http://localhost:7002/;\n    }\n}\n```\n","slug":"devops/nginx","published":1,"updated":"2021-07-26T07:59:14.107Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcv000ffms6fgck34pt","content":"<ul>\n<li><a href=\"http://nginx.org/\">官网</a></li>\n<li><a href=\"https://www.runoob.com/linux/nginx-install-setup.html\">菜鸟教程-Nginx 安装配置</a></li>\n<li><a href=\"https://cloud.tencent.com/document/product/400/35244\">Nginx服务器SSL证书安装部署-腾讯云</a></li>\n</ul>\n<h3 id=\"nginx命令\"><a href=\"#nginx命令\" class=\"headerlink\" title=\"nginx命令\"></a>nginx命令</h3><pre><code class=\"textmate\">1.检测配置是否正常\nnginx -t \n\n2.热部署配置\nnginx -s reload</code></pre>\n<h3 id=\"ssl-nginx配置\"><a href=\"#ssl-nginx配置\" class=\"headerlink\" title=\"ssl-nginx配置\"></a>ssl-nginx配置</h3><pre><code class=\"textmate\">具体参考云厂商ssl证书安装步骤\n1.下载ssl相关文件,服务器开启443端口权限\n2.解压后将文件夹Nginx中文件放到nginx安装目录下(或其他地方)\n3.添加nginx配置文件\n4.重启生效</code></pre>\n<h3 id=\"同一域名不同服务配置\"><a href=\"#同一域名不同服务配置\" class=\"headerlink\" title=\"同一域名不同服务配置\"></a>同一域名不同服务配置</h3><pre><code class=\"textmate\">server &#123;\n    listen       8888;\n    server_name  localhost;\n\n    location /service1/ &#123;\n         proxy_pass http://localhost:7001/;\n    &#125;\n\n    location /service2/ &#123;\n         proxy_pass http://localhost:7002/;\n    &#125;\n&#125;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"http://nginx.org/\">官网</a></li>\n<li><a href=\"https://www.runoob.com/linux/nginx-install-setup.html\">菜鸟教程-Nginx 安装配置</a></li>\n<li><a href=\"https://cloud.tencent.com/document/product/400/35244\">Nginx服务器SSL证书安装部署-腾讯云</a></li>\n</ul>\n<h3 id=\"nginx命令\"><a href=\"#nginx命令\" class=\"headerlink\" title=\"nginx命令\"></a>nginx命令</h3><pre><code class=\"textmate\">1.检测配置是否正常\nnginx -t \n\n2.热部署配置\nnginx -s reload</code></pre>\n<h3 id=\"ssl-nginx配置\"><a href=\"#ssl-nginx配置\" class=\"headerlink\" title=\"ssl-nginx配置\"></a>ssl-nginx配置</h3><pre><code class=\"textmate\">具体参考云厂商ssl证书安装步骤\n1.下载ssl相关文件,服务器开启443端口权限\n2.解压后将文件夹Nginx中文件放到nginx安装目录下(或其他地方)\n3.添加nginx配置文件\n4.重启生效</code></pre>\n<h3 id=\"同一域名不同服务配置\"><a href=\"#同一域名不同服务配置\" class=\"headerlink\" title=\"同一域名不同服务配置\"></a>同一域名不同服务配置</h3><pre><code class=\"textmate\">server &#123;\n    listen       8888;\n    server_name  localhost;\n\n    location /service1/ &#123;\n         proxy_pass http://localhost:7001/;\n    &#125;\n\n    location /service2/ &#123;\n         proxy_pass http://localhost:7002/;\n    &#125;\n&#125;</code></pre>\n"},{"title":"调用链监控-skywalking","date":"2021-05-19T08:52:25.000Z","_content":"\n- [官网](http://skywalking.apache.org/)\n- [下载地址](http://skywalking.apache.org/downloads/)\n- [部署及使用文档(转)](https://www.jianshu.com/p/8b9aad4210c5)\n\n### 常见问题\n- 重启\n```textmate\n原脚本中没有杀掉旧进程，使用jps找到对应服务，然后kill掉再执行bin/startup.sh\n```\n- 支持SpringCloudGateway\n```textmate\n默认情况agent是不支持对spring-cloud-gateway的监控的，需要插件的支持。我们要将optional-plugins下的插件apm-spring-cloud-gateway-2.x-plugin-6.5.0.jar拷贝到plugins下\n```\n","source":"_posts/devops/skywalking.md","raw":"---\ntitle: 调用链监控-skywalking\ndate: 2021-05-19 16:52:25\ntags:\n- skywalking \ncategories:\n- 运维\n---\n\n- [官网](http://skywalking.apache.org/)\n- [下载地址](http://skywalking.apache.org/downloads/)\n- [部署及使用文档(转)](https://www.jianshu.com/p/8b9aad4210c5)\n\n### 常见问题\n- 重启\n```textmate\n原脚本中没有杀掉旧进程，使用jps找到对应服务，然后kill掉再执行bin/startup.sh\n```\n- 支持SpringCloudGateway\n```textmate\n默认情况agent是不支持对spring-cloud-gateway的监控的，需要插件的支持。我们要将optional-plugins下的插件apm-spring-cloud-gateway-2.x-plugin-6.5.0.jar拷贝到plugins下\n```\n","slug":"devops/skywalking","published":1,"updated":"2021-07-26T07:59:14.138Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bcy000hfms66eflafhz","content":"<ul>\n<li><a href=\"http://skywalking.apache.org/\">官网</a></li>\n<li><a href=\"http://skywalking.apache.org/downloads/\">下载地址</a></li>\n<li><a href=\"https://www.jianshu.com/p/8b9aad4210c5\">部署及使用文档(转)</a></li>\n</ul>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li>重启<pre><code class=\"textmate\">原脚本中没有杀掉旧进程，使用jps找到对应服务，然后kill掉再执行bin/startup.sh</code></pre>\n</li>\n<li>支持SpringCloudGateway<pre><code class=\"textmate\">默认情况agent是不支持对spring-cloud-gateway的监控的，需要插件的支持。我们要将optional-plugins下的插件apm-spring-cloud-gateway-2.x-plugin-6.5.0.jar拷贝到plugins下</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"http://skywalking.apache.org/\">官网</a></li>\n<li><a href=\"http://skywalking.apache.org/downloads/\">下载地址</a></li>\n<li><a href=\"https://www.jianshu.com/p/8b9aad4210c5\">部署及使用文档(转)</a></li>\n</ul>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li>重启<pre><code class=\"textmate\">原脚本中没有杀掉旧进程，使用jps找到对应服务，然后kill掉再执行bin/startup.sh</code></pre>\n</li>\n<li>支持SpringCloudGateway<pre><code class=\"textmate\">默认情况agent是不支持对spring-cloud-gateway的监控的，需要插件的支持。我们要将optional-plugins下的插件apm-spring-cloud-gateway-2.x-plugin-6.5.0.jar拷贝到plugins下</code></pre>\n</li>\n</ul>\n"},{"title":"COLA","description":"COLA-整洁面向对象分层架构","date":"2020-12-15T08:24:00.000Z","_content":"\n### 相关网址\n- [COLA 4.0](https://github.com/alibaba/COLA)\n- [COLA 4.0：应用架构的最佳实践](https://blog.csdn.net/significantfrank/article/details/110934799?utm_source=app)","source":"_posts/framework/cola.md","raw":"---\ntitle: COLA\ndescription: COLA-整洁面向对象分层架构\n#top: 1\ndate: 2020-12-15 16:24:00\ntags:\n- COLA\ncategories:\n- 架构\n---\n\n### 相关网址\n- [COLA 4.0](https://github.com/alibaba/COLA)\n- [COLA 4.0：应用架构的最佳实践](https://blog.csdn.net/significantfrank/article/details/110934799?utm_source=app)","slug":"framework/cola","published":1,"updated":"2020-12-15T08:24:59.493Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bd2000kfms67y7f3icg","content":"<h3 id=\"相关网址\"><a href=\"#相关网址\" class=\"headerlink\" title=\"相关网址\"></a>相关网址</h3><ul>\n<li><a href=\"https://github.com/alibaba/COLA\">COLA 4.0</a></li>\n<li><a href=\"https://blog.csdn.net/significantfrank/article/details/110934799?utm_source=app\">COLA 4.0：应用架构的最佳实践</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"相关网址\"><a href=\"#相关网址\" class=\"headerlink\" title=\"相关网址\"></a>相关网址</h3><ul>\n<li><a href=\"https://github.com/alibaba/COLA\">COLA 4.0</a></li>\n<li><a href=\"https://blog.csdn.net/significantfrank/article/details/110934799?utm_source=app\">COLA 4.0：应用架构的最佳实践</a></li>\n</ul>\n"},{"title":"DDD-领域驱动设计","description":"DDD-领域驱动设计","date":"2020-10-09T08:51:54.000Z","_content":"\n- [有赞DDD实践](https://mp.weixin.qq.com/s/9eGZZ2wsZoaCVRy0oKt0iw)\n- [DDD设计](https://www.processon.com/view/5e55d17ee4b069f82a120d06#map)\n\n### 方法论\n```textmate\n六边形架构、洋葱架构、整洁架构、四色原型\nSIDE-EFFECT-FREE模式被称为无副作用模式，熟悉函数时编程的朋友都知道，严格的函数就是一个无副作用的函数，对于一个给定的输入，总是返回固定的结果，通常查询功能就是一个函数，命令功能就不是一个函数，它通常会执行某些修改。\n在DDD架构中，通常会将查询和命令操作分开，我们称之为CQRS(命令查询的责任分离Command Query Responsibility Segregation)，具体落地时，是否将Command和Query分开成两个项目可以看情况决定，大多数情况下放在一个项目可以提高业务内聚性，\n```\n\n#### 六边形架构\n- [起源文章](http://alistair.cockburn.us/Hexagonal+architecture)\n- [相关文章&demo](https://www.jianshu.com/p/c6bb08d9c613)\n- 摘要\n```textmate\n六角架构的初衷是：\n允许应用程序同样由用户，程序，自动化测试或批处理脚本驱动，并与最终的运行时设备和数据库隔离开发和测试。\n```\n\n#### 洋葱架构\n- [在洋葱(Onion)架构中实现领域驱动设计](https://www.infoq.cn/article/2014/11/ddd-onion-architecture)\n- 摘要\n```textmate\n层级关系\n    Core ) Domain ) API ) Infrastructure )\n洋葱架构中的一个重要概念是依赖，外部的层能够访问内部的层，而内部的层则对外部的层一无所知。\n    核心（Core）层是与领域或技术无关的基础构件块，它包含了一些通用的构件块,包含任何技术层面的概念\n    领域（Domain）层是定义业务逻辑的地方，每个类的方法都是按照领域通用语言中的概念进行命名的\n    API 层是领域层的入口，它使用领域中的术语和对象。\n    基础架构（Infrastructure）层是最外部的一层，它包含了对接各种技术的适配器，例如数据库、用户界面以及外部服务。\n```\n\n#### 整洁架构\n- [阿里云-架构整洁之道](https://www.jianshu.com/p/b296ceea673b)\n\n#### 开源框架\n- cola4 \n- DDDLib  \n- Koala\n\n#### 四色原型-需求分析利器\n<img src=\"https://im-fan.gitee.io/img/ddd/four-color.png\"/>\n\n```textmate\n概念\n    “四色原型”是在使用UML建模的时候，把实体分为四类，并标注不同的颜色的一种建模方法。\n    用一句话来概括四色原型就是：一个什么样的人或物品以某种角色在某个时刻或某段时间内参与某个活动。其中“什么样的”就是DESC，“人或物品”就是PPT,”角色”就是ROLE,而“某个时刻或某个时间段内的某个活动”就是MI。\n    四色原型”有一个规则：就是MI（事件）不能与PPT（事物）直接打交道，必须通过ROLE（角色）来打交道。例如：只有买家才能下订单，订单只能通过买家与用户关联\n四色建模法包括\n    时标型（Moment-Interval）对象：具有可追溯性的记录运营或管理数据的时刻或时段对象，用粉红色表示\n    PPT（Party/Place/Thing）对象：代表参与到流程中的参与方/地点/物，用绿色表示\n    角色（Role）对象：在时标型对象与 PPT 对象（通常是参与方）之间参与的角色，用黄色表示\n    描述（Description）对象：对 PPT 对象的一种补充描述，用蓝色表示\n四色原型法设计领域模型的步骤：\n    1.根据需求，采用四色原型分析法建立一个初步的领域模型；\n    2.进一步分析领域模型，识别出哪些是实体，哪些是值对象，哪些是领域服务；\n    3.对实体、值对象进行关联和聚合，提炼出聚合边界和聚合根；\n    4.为聚合根设计仓储（一般情况下，一个聚合分配一个仓储），同时，思考实体、值对象的创建方式，是通过工厂创建，还是直接通过构造函数；\n    5.走查需求场景，验证设计的领域模型的合理性。\n```\n#### 标准项目模块解释\n```textmate\n1.Interface \n    对外提供服务，包括Controller、防腐层-facade、对象转换-assembler、出参入参对象-dto\n2.Application \n    应用层,包括服务层-service(主要作用是操作 聚合根+仓储)\n3.Domain\n    领域层,包括领域对象-entity(主要业务逻辑，可以理解为对象封装操作)、领域服务-EntityService(不属于任何一个领域对象的其他业务或复杂业务逻辑)、值对象-ValueObjects 领域事件-DomainEvent、仓储接口定义-repository\n4.Infrastructure\n    基础设施层,包括持久化设置-PersistenceFacilities(仓储实现)、工具类等；支持以上模块\n```\n\n### DDD核心概念\n- 实体\n- 值对象\n- 聚合\n- 仓储\n- 工厂\n- 仓储\n```textmate\n实体(Entities):具有唯一标识的对象\n值对象(Value Objects): 无需唯一标识的对象\n领域服务(Domain Services): 一些行为无法归类到实体对象或值对象上,本质是一些操作,而非事物\n聚合/聚合根(Aggregates,Aggregate Roots): 聚合是指一组具有内聚关系的相关对象的集合,每个聚合都有一个root和boundary\n工厂(Factories): 创建复杂对象,隐藏创建细节\n仓储(Repository): 提供查找和持久化对象的方法\n```\n\n- DDD架构图\n<img src=\"https://im-fan.gitee.io/img/ddd/ddd-framework.png\"/>\n\n#### 识别领域服务\n```textmate\n主要看它是否满足以下三个特征：\n    1. 服务执行的操作代表了一个领域概念，这个领域概念无法自然地隶属于一个实体或者值对象。\n    2. 被执行的操作涉及到领域中的其他的对象。\n    3. 操作是无状态的。\n```\n\n#### 仓储相关\n- CQRS\n```textmate\n将查询单独划分为应用系统的一个分支，将修改（命令）单独划分为另外一个分支来操作领域对象。这是DDD的另外一种模式，英文简写：CQRS\n```\n","source":"_posts/framework/ddd.md","raw":"---\ntitle: DDD-领域驱动设计\ndescription: DDD-领域驱动设计\n#top: 1\ndate: 2020-10-09 16:51:54\ntags:\n- DDD\ncategories:\n- 架构\n---\n\n- [有赞DDD实践](https://mp.weixin.qq.com/s/9eGZZ2wsZoaCVRy0oKt0iw)\n- [DDD设计](https://www.processon.com/view/5e55d17ee4b069f82a120d06#map)\n\n### 方法论\n```textmate\n六边形架构、洋葱架构、整洁架构、四色原型\nSIDE-EFFECT-FREE模式被称为无副作用模式，熟悉函数时编程的朋友都知道，严格的函数就是一个无副作用的函数，对于一个给定的输入，总是返回固定的结果，通常查询功能就是一个函数，命令功能就不是一个函数，它通常会执行某些修改。\n在DDD架构中，通常会将查询和命令操作分开，我们称之为CQRS(命令查询的责任分离Command Query Responsibility Segregation)，具体落地时，是否将Command和Query分开成两个项目可以看情况决定，大多数情况下放在一个项目可以提高业务内聚性，\n```\n\n#### 六边形架构\n- [起源文章](http://alistair.cockburn.us/Hexagonal+architecture)\n- [相关文章&demo](https://www.jianshu.com/p/c6bb08d9c613)\n- 摘要\n```textmate\n六角架构的初衷是：\n允许应用程序同样由用户，程序，自动化测试或批处理脚本驱动，并与最终的运行时设备和数据库隔离开发和测试。\n```\n\n#### 洋葱架构\n- [在洋葱(Onion)架构中实现领域驱动设计](https://www.infoq.cn/article/2014/11/ddd-onion-architecture)\n- 摘要\n```textmate\n层级关系\n    Core ) Domain ) API ) Infrastructure )\n洋葱架构中的一个重要概念是依赖，外部的层能够访问内部的层，而内部的层则对外部的层一无所知。\n    核心（Core）层是与领域或技术无关的基础构件块，它包含了一些通用的构件块,包含任何技术层面的概念\n    领域（Domain）层是定义业务逻辑的地方，每个类的方法都是按照领域通用语言中的概念进行命名的\n    API 层是领域层的入口，它使用领域中的术语和对象。\n    基础架构（Infrastructure）层是最外部的一层，它包含了对接各种技术的适配器，例如数据库、用户界面以及外部服务。\n```\n\n#### 整洁架构\n- [阿里云-架构整洁之道](https://www.jianshu.com/p/b296ceea673b)\n\n#### 开源框架\n- cola4 \n- DDDLib  \n- Koala\n\n#### 四色原型-需求分析利器\n<img src=\"https://im-fan.gitee.io/img/ddd/four-color.png\"/>\n\n```textmate\n概念\n    “四色原型”是在使用UML建模的时候，把实体分为四类，并标注不同的颜色的一种建模方法。\n    用一句话来概括四色原型就是：一个什么样的人或物品以某种角色在某个时刻或某段时间内参与某个活动。其中“什么样的”就是DESC，“人或物品”就是PPT,”角色”就是ROLE,而“某个时刻或某个时间段内的某个活动”就是MI。\n    四色原型”有一个规则：就是MI（事件）不能与PPT（事物）直接打交道，必须通过ROLE（角色）来打交道。例如：只有买家才能下订单，订单只能通过买家与用户关联\n四色建模法包括\n    时标型（Moment-Interval）对象：具有可追溯性的记录运营或管理数据的时刻或时段对象，用粉红色表示\n    PPT（Party/Place/Thing）对象：代表参与到流程中的参与方/地点/物，用绿色表示\n    角色（Role）对象：在时标型对象与 PPT 对象（通常是参与方）之间参与的角色，用黄色表示\n    描述（Description）对象：对 PPT 对象的一种补充描述，用蓝色表示\n四色原型法设计领域模型的步骤：\n    1.根据需求，采用四色原型分析法建立一个初步的领域模型；\n    2.进一步分析领域模型，识别出哪些是实体，哪些是值对象，哪些是领域服务；\n    3.对实体、值对象进行关联和聚合，提炼出聚合边界和聚合根；\n    4.为聚合根设计仓储（一般情况下，一个聚合分配一个仓储），同时，思考实体、值对象的创建方式，是通过工厂创建，还是直接通过构造函数；\n    5.走查需求场景，验证设计的领域模型的合理性。\n```\n#### 标准项目模块解释\n```textmate\n1.Interface \n    对外提供服务，包括Controller、防腐层-facade、对象转换-assembler、出参入参对象-dto\n2.Application \n    应用层,包括服务层-service(主要作用是操作 聚合根+仓储)\n3.Domain\n    领域层,包括领域对象-entity(主要业务逻辑，可以理解为对象封装操作)、领域服务-EntityService(不属于任何一个领域对象的其他业务或复杂业务逻辑)、值对象-ValueObjects 领域事件-DomainEvent、仓储接口定义-repository\n4.Infrastructure\n    基础设施层,包括持久化设置-PersistenceFacilities(仓储实现)、工具类等；支持以上模块\n```\n\n### DDD核心概念\n- 实体\n- 值对象\n- 聚合\n- 仓储\n- 工厂\n- 仓储\n```textmate\n实体(Entities):具有唯一标识的对象\n值对象(Value Objects): 无需唯一标识的对象\n领域服务(Domain Services): 一些行为无法归类到实体对象或值对象上,本质是一些操作,而非事物\n聚合/聚合根(Aggregates,Aggregate Roots): 聚合是指一组具有内聚关系的相关对象的集合,每个聚合都有一个root和boundary\n工厂(Factories): 创建复杂对象,隐藏创建细节\n仓储(Repository): 提供查找和持久化对象的方法\n```\n\n- DDD架构图\n<img src=\"https://im-fan.gitee.io/img/ddd/ddd-framework.png\"/>\n\n#### 识别领域服务\n```textmate\n主要看它是否满足以下三个特征：\n    1. 服务执行的操作代表了一个领域概念，这个领域概念无法自然地隶属于一个实体或者值对象。\n    2. 被执行的操作涉及到领域中的其他的对象。\n    3. 操作是无状态的。\n```\n\n#### 仓储相关\n- CQRS\n```textmate\n将查询单独划分为应用系统的一个分支，将修改（命令）单独划分为另外一个分支来操作领域对象。这是DDD的另外一种模式，英文简写：CQRS\n```\n","slug":"framework/ddd","published":1,"updated":"2020-12-26T08:39:41.019Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bd4000mfms6585wd6ti","content":"<ul>\n<li><a href=\"https://mp.weixin.qq.com/s/9eGZZ2wsZoaCVRy0oKt0iw\">有赞DDD实践</a></li>\n<li><a href=\"https://www.processon.com/view/5e55d17ee4b069f82a120d06#map\">DDD设计</a></li>\n</ul>\n<h3 id=\"方法论\"><a href=\"#方法论\" class=\"headerlink\" title=\"方法论\"></a>方法论</h3><pre><code class=\"textmate\">六边形架构、洋葱架构、整洁架构、四色原型\nSIDE-EFFECT-FREE模式被称为无副作用模式，熟悉函数时编程的朋友都知道，严格的函数就是一个无副作用的函数，对于一个给定的输入，总是返回固定的结果，通常查询功能就是一个函数，命令功能就不是一个函数，它通常会执行某些修改。\n在DDD架构中，通常会将查询和命令操作分开，我们称之为CQRS(命令查询的责任分离Command Query Responsibility Segregation)，具体落地时，是否将Command和Query分开成两个项目可以看情况决定，大多数情况下放在一个项目可以提高业务内聚性，</code></pre>\n<h4 id=\"六边形架构\"><a href=\"#六边形架构\" class=\"headerlink\" title=\"六边形架构\"></a>六边形架构</h4><ul>\n<li><a href=\"http://alistair.cockburn.us/Hexagonal+architecture\">起源文章</a></li>\n<li><a href=\"https://www.jianshu.com/p/c6bb08d9c613\">相关文章&amp;demo</a></li>\n<li>摘要<pre><code class=\"textmate\">六角架构的初衷是：\n允许应用程序同样由用户，程序，自动化测试或批处理脚本驱动，并与最终的运行时设备和数据库隔离开发和测试。</code></pre>\n</li>\n</ul>\n<h4 id=\"洋葱架构\"><a href=\"#洋葱架构\" class=\"headerlink\" title=\"洋葱架构\"></a>洋葱架构</h4><ul>\n<li><a href=\"https://www.infoq.cn/article/2014/11/ddd-onion-architecture\">在洋葱(Onion)架构中实现领域驱动设计</a></li>\n<li>摘要<pre><code class=\"textmate\">层级关系\n  Core ) Domain ) API ) Infrastructure )\n洋葱架构中的一个重要概念是依赖，外部的层能够访问内部的层，而内部的层则对外部的层一无所知。\n  核心（Core）层是与领域或技术无关的基础构件块，它包含了一些通用的构件块,包含任何技术层面的概念\n  领域（Domain）层是定义业务逻辑的地方，每个类的方法都是按照领域通用语言中的概念进行命名的\n  API 层是领域层的入口，它使用领域中的术语和对象。\n  基础架构（Infrastructure）层是最外部的一层，它包含了对接各种技术的适配器，例如数据库、用户界面以及外部服务。</code></pre>\n</li>\n</ul>\n<h4 id=\"整洁架构\"><a href=\"#整洁架构\" class=\"headerlink\" title=\"整洁架构\"></a>整洁架构</h4><ul>\n<li><a href=\"https://www.jianshu.com/p/b296ceea673b\">阿里云-架构整洁之道</a></li>\n</ul>\n<h4 id=\"开源框架\"><a href=\"#开源框架\" class=\"headerlink\" title=\"开源框架\"></a>开源框架</h4><ul>\n<li>cola4 </li>\n<li>DDDLib  </li>\n<li>Koala</li>\n</ul>\n<h4 id=\"四色原型-需求分析利器\"><a href=\"#四色原型-需求分析利器\" class=\"headerlink\" title=\"四色原型-需求分析利器\"></a>四色原型-需求分析利器</h4><img src=\"https://im-fan.gitee.io/img/ddd/four-color.png\"/>\n\n<pre><code class=\"textmate\">概念\n    “四色原型”是在使用UML建模的时候，把实体分为四类，并标注不同的颜色的一种建模方法。\n    用一句话来概括四色原型就是：一个什么样的人或物品以某种角色在某个时刻或某段时间内参与某个活动。其中“什么样的”就是DESC，“人或物品”就是PPT,”角色”就是ROLE,而“某个时刻或某个时间段内的某个活动”就是MI。\n    四色原型”有一个规则：就是MI（事件）不能与PPT（事物）直接打交道，必须通过ROLE（角色）来打交道。例如：只有买家才能下订单，订单只能通过买家与用户关联\n四色建模法包括\n    时标型（Moment-Interval）对象：具有可追溯性的记录运营或管理数据的时刻或时段对象，用粉红色表示\n    PPT（Party/Place/Thing）对象：代表参与到流程中的参与方/地点/物，用绿色表示\n    角色（Role）对象：在时标型对象与 PPT 对象（通常是参与方）之间参与的角色，用黄色表示\n    描述（Description）对象：对 PPT 对象的一种补充描述，用蓝色表示\n四色原型法设计领域模型的步骤：\n    1.根据需求，采用四色原型分析法建立一个初步的领域模型；\n    2.进一步分析领域模型，识别出哪些是实体，哪些是值对象，哪些是领域服务；\n    3.对实体、值对象进行关联和聚合，提炼出聚合边界和聚合根；\n    4.为聚合根设计仓储（一般情况下，一个聚合分配一个仓储），同时，思考实体、值对象的创建方式，是通过工厂创建，还是直接通过构造函数；\n    5.走查需求场景，验证设计的领域模型的合理性。</code></pre>\n<h4 id=\"标准项目模块解释\"><a href=\"#标准项目模块解释\" class=\"headerlink\" title=\"标准项目模块解释\"></a>标准项目模块解释</h4><pre><code class=\"textmate\">1.Interface \n    对外提供服务，包括Controller、防腐层-facade、对象转换-assembler、出参入参对象-dto\n2.Application \n    应用层,包括服务层-service(主要作用是操作 聚合根+仓储)\n3.Domain\n    领域层,包括领域对象-entity(主要业务逻辑，可以理解为对象封装操作)、领域服务-EntityService(不属于任何一个领域对象的其他业务或复杂业务逻辑)、值对象-ValueObjects 领域事件-DomainEvent、仓储接口定义-repository\n4.Infrastructure\n    基础设施层,包括持久化设置-PersistenceFacilities(仓储实现)、工具类等；支持以上模块</code></pre>\n<h3 id=\"DDD核心概念\"><a href=\"#DDD核心概念\" class=\"headerlink\" title=\"DDD核心概念\"></a>DDD核心概念</h3><ul>\n<li><p>实体</p>\n</li>\n<li><p>值对象</p>\n</li>\n<li><p>聚合</p>\n</li>\n<li><p>仓储</p>\n</li>\n<li><p>工厂</p>\n</li>\n<li><p>仓储</p>\n<pre><code class=\"textmate\">实体(Entities):具有唯一标识的对象\n值对象(Value Objects): 无需唯一标识的对象\n领域服务(Domain Services): 一些行为无法归类到实体对象或值对象上,本质是一些操作,而非事物\n聚合/聚合根(Aggregates,Aggregate Roots): 聚合是指一组具有内聚关系的相关对象的集合,每个聚合都有一个root和boundary\n工厂(Factories): 创建复杂对象,隐藏创建细节\n仓储(Repository): 提供查找和持久化对象的方法</code></pre>\n</li>\n<li><p>DDD架构图</p>\n<img src=\"https://im-fan.gitee.io/img/ddd/ddd-framework.png\"/>\n\n</li>\n</ul>\n<h4 id=\"识别领域服务\"><a href=\"#识别领域服务\" class=\"headerlink\" title=\"识别领域服务\"></a>识别领域服务</h4><pre><code class=\"textmate\">主要看它是否满足以下三个特征：\n    1. 服务执行的操作代表了一个领域概念，这个领域概念无法自然地隶属于一个实体或者值对象。\n    2. 被执行的操作涉及到领域中的其他的对象。\n    3. 操作是无状态的。</code></pre>\n<h4 id=\"仓储相关\"><a href=\"#仓储相关\" class=\"headerlink\" title=\"仓储相关\"></a>仓储相关</h4><ul>\n<li>CQRS<pre><code class=\"textmate\">将查询单独划分为应用系统的一个分支，将修改（命令）单独划分为另外一个分支来操作领域对象。这是DDD的另外一种模式，英文简写：CQRS</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://mp.weixin.qq.com/s/9eGZZ2wsZoaCVRy0oKt0iw\">有赞DDD实践</a></li>\n<li><a href=\"https://www.processon.com/view/5e55d17ee4b069f82a120d06#map\">DDD设计</a></li>\n</ul>\n<h3 id=\"方法论\"><a href=\"#方法论\" class=\"headerlink\" title=\"方法论\"></a>方法论</h3><pre><code class=\"textmate\">六边形架构、洋葱架构、整洁架构、四色原型\nSIDE-EFFECT-FREE模式被称为无副作用模式，熟悉函数时编程的朋友都知道，严格的函数就是一个无副作用的函数，对于一个给定的输入，总是返回固定的结果，通常查询功能就是一个函数，命令功能就不是一个函数，它通常会执行某些修改。\n在DDD架构中，通常会将查询和命令操作分开，我们称之为CQRS(命令查询的责任分离Command Query Responsibility Segregation)，具体落地时，是否将Command和Query分开成两个项目可以看情况决定，大多数情况下放在一个项目可以提高业务内聚性，</code></pre>\n<h4 id=\"六边形架构\"><a href=\"#六边形架构\" class=\"headerlink\" title=\"六边形架构\"></a>六边形架构</h4><ul>\n<li><a href=\"http://alistair.cockburn.us/Hexagonal+architecture\">起源文章</a></li>\n<li><a href=\"https://www.jianshu.com/p/c6bb08d9c613\">相关文章&amp;demo</a></li>\n<li>摘要<pre><code class=\"textmate\">六角架构的初衷是：\n允许应用程序同样由用户，程序，自动化测试或批处理脚本驱动，并与最终的运行时设备和数据库隔离开发和测试。</code></pre>\n</li>\n</ul>\n<h4 id=\"洋葱架构\"><a href=\"#洋葱架构\" class=\"headerlink\" title=\"洋葱架构\"></a>洋葱架构</h4><ul>\n<li><a href=\"https://www.infoq.cn/article/2014/11/ddd-onion-architecture\">在洋葱(Onion)架构中实现领域驱动设计</a></li>\n<li>摘要<pre><code class=\"textmate\">层级关系\n  Core ) Domain ) API ) Infrastructure )\n洋葱架构中的一个重要概念是依赖，外部的层能够访问内部的层，而内部的层则对外部的层一无所知。\n  核心（Core）层是与领域或技术无关的基础构件块，它包含了一些通用的构件块,包含任何技术层面的概念\n  领域（Domain）层是定义业务逻辑的地方，每个类的方法都是按照领域通用语言中的概念进行命名的\n  API 层是领域层的入口，它使用领域中的术语和对象。\n  基础架构（Infrastructure）层是最外部的一层，它包含了对接各种技术的适配器，例如数据库、用户界面以及外部服务。</code></pre>\n</li>\n</ul>\n<h4 id=\"整洁架构\"><a href=\"#整洁架构\" class=\"headerlink\" title=\"整洁架构\"></a>整洁架构</h4><ul>\n<li><a href=\"https://www.jianshu.com/p/b296ceea673b\">阿里云-架构整洁之道</a></li>\n</ul>\n<h4 id=\"开源框架\"><a href=\"#开源框架\" class=\"headerlink\" title=\"开源框架\"></a>开源框架</h4><ul>\n<li>cola4 </li>\n<li>DDDLib  </li>\n<li>Koala</li>\n</ul>\n<h4 id=\"四色原型-需求分析利器\"><a href=\"#四色原型-需求分析利器\" class=\"headerlink\" title=\"四色原型-需求分析利器\"></a>四色原型-需求分析利器</h4><img src=\"https://im-fan.gitee.io/img/ddd/four-color.png\"/>\n\n<pre><code class=\"textmate\">概念\n    “四色原型”是在使用UML建模的时候，把实体分为四类，并标注不同的颜色的一种建模方法。\n    用一句话来概括四色原型就是：一个什么样的人或物品以某种角色在某个时刻或某段时间内参与某个活动。其中“什么样的”就是DESC，“人或物品”就是PPT,”角色”就是ROLE,而“某个时刻或某个时间段内的某个活动”就是MI。\n    四色原型”有一个规则：就是MI（事件）不能与PPT（事物）直接打交道，必须通过ROLE（角色）来打交道。例如：只有买家才能下订单，订单只能通过买家与用户关联\n四色建模法包括\n    时标型（Moment-Interval）对象：具有可追溯性的记录运营或管理数据的时刻或时段对象，用粉红色表示\n    PPT（Party/Place/Thing）对象：代表参与到流程中的参与方/地点/物，用绿色表示\n    角色（Role）对象：在时标型对象与 PPT 对象（通常是参与方）之间参与的角色，用黄色表示\n    描述（Description）对象：对 PPT 对象的一种补充描述，用蓝色表示\n四色原型法设计领域模型的步骤：\n    1.根据需求，采用四色原型分析法建立一个初步的领域模型；\n    2.进一步分析领域模型，识别出哪些是实体，哪些是值对象，哪些是领域服务；\n    3.对实体、值对象进行关联和聚合，提炼出聚合边界和聚合根；\n    4.为聚合根设计仓储（一般情况下，一个聚合分配一个仓储），同时，思考实体、值对象的创建方式，是通过工厂创建，还是直接通过构造函数；\n    5.走查需求场景，验证设计的领域模型的合理性。</code></pre>\n<h4 id=\"标准项目模块解释\"><a href=\"#标准项目模块解释\" class=\"headerlink\" title=\"标准项目模块解释\"></a>标准项目模块解释</h4><pre><code class=\"textmate\">1.Interface \n    对外提供服务，包括Controller、防腐层-facade、对象转换-assembler、出参入参对象-dto\n2.Application \n    应用层,包括服务层-service(主要作用是操作 聚合根+仓储)\n3.Domain\n    领域层,包括领域对象-entity(主要业务逻辑，可以理解为对象封装操作)、领域服务-EntityService(不属于任何一个领域对象的其他业务或复杂业务逻辑)、值对象-ValueObjects 领域事件-DomainEvent、仓储接口定义-repository\n4.Infrastructure\n    基础设施层,包括持久化设置-PersistenceFacilities(仓储实现)、工具类等；支持以上模块</code></pre>\n<h3 id=\"DDD核心概念\"><a href=\"#DDD核心概念\" class=\"headerlink\" title=\"DDD核心概念\"></a>DDD核心概念</h3><ul>\n<li><p>实体</p>\n</li>\n<li><p>值对象</p>\n</li>\n<li><p>聚合</p>\n</li>\n<li><p>仓储</p>\n</li>\n<li><p>工厂</p>\n</li>\n<li><p>仓储</p>\n<pre><code class=\"textmate\">实体(Entities):具有唯一标识的对象\n值对象(Value Objects): 无需唯一标识的对象\n领域服务(Domain Services): 一些行为无法归类到实体对象或值对象上,本质是一些操作,而非事物\n聚合/聚合根(Aggregates,Aggregate Roots): 聚合是指一组具有内聚关系的相关对象的集合,每个聚合都有一个root和boundary\n工厂(Factories): 创建复杂对象,隐藏创建细节\n仓储(Repository): 提供查找和持久化对象的方法</code></pre>\n</li>\n<li><p>DDD架构图</p>\n<img src=\"https://im-fan.gitee.io/img/ddd/ddd-framework.png\"/>\n\n</li>\n</ul>\n<h4 id=\"识别领域服务\"><a href=\"#识别领域服务\" class=\"headerlink\" title=\"识别领域服务\"></a>识别领域服务</h4><pre><code class=\"textmate\">主要看它是否满足以下三个特征：\n    1. 服务执行的操作代表了一个领域概念，这个领域概念无法自然地隶属于一个实体或者值对象。\n    2. 被执行的操作涉及到领域中的其他的对象。\n    3. 操作是无状态的。</code></pre>\n<h4 id=\"仓储相关\"><a href=\"#仓储相关\" class=\"headerlink\" title=\"仓储相关\"></a>仓储相关</h4><ul>\n<li>CQRS<pre><code class=\"textmate\">将查询单独划分为应用系统的一个分支，将修改（命令）单独划分为另外一个分支来操作领域对象。这是DDD的另外一种模式，英文简写：CQRS</code></pre>\n</li>\n</ul>\n"},{"title":"OAuth2学习笔记","description":"oauth2","date":"2020-11-17T01:58:26.000Z","_content":"\n- [参考demo](https://github.com/lexburner/oauth2-demo)\n- [OAuth2 RFC6749中文翻译](https://colobu.com/2017/04/28/oauth2-rfc6749/)\n- [理解OAuth 2.0-阮一峰](http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html)\n- [文档对应demo](https://github.com/im-fan/my-project/tree/release/1.0/my-oauth2)\n\n#### 框架相关\n- OAuth2\n```\n解释：\n    OAuth 2.0是一个关于授权的开放网络协议，它允许用户让第三方网站访问该用户在某一网站上存储的信息和资源，\n    如账户信息，照片，联系人等，而不需要给第三方网站提供某一网站上的账户和密码。\n流程：\n    1、用户打开客户端，客户端要求授权。\n    2、用户同意客户端授权。\n    3、客户端使用上一步提供的授权，向服务器授权层申请令牌。\n    4、授权服务器对客户端进行认证后，同意发放令牌。\n    5、客户端使用令牌，向资源服务器申请资源。\n    6、资源服务器确认令牌，向客户端开放资源。\n```\n- LDAP\n```\n解释：\n    LDAP是一种基于轻量目录访问协议，全称是Lightweight Directory Access Protocol，是由一个为查询、\n    浏览和搜索而优化的数据库构成，它成树状结构组织数据，类似文件目录一样。\n    LDAP单点登录认证主要是改变原有的认证策略，使得需要的软件都通过LDAP服务器进行认证，在统一身份认证后，\n    用户的所有信息都存储在AD Server中，终端用户在需要使用公司内部服务的时候，都需要通过AD服务器进行认证。\n登录流程：\n    1、连接到LDAP服务器。\n    2、绑定到LDAP服务器。\n    3、在LDAP服务器上执行所需要的操作。\n    4、释放LDAP服务器的连接。\n```\n- [CAS(Central Authentication Service-中央式认证服务)](https://www.cnblogs.com/lihuidu/p/6495247.html)\n```\nSSO 仅仅是一种架构，一种设计，而 CAS 则是实现 SSO 的一种手段。两者是抽象与具体的关系。\nCAS即Central Authentication Service模型（中央式认证服务），该协议是为应用提供可信身份认证的单点登录系统，最初是由耶鲁大学开发的。\nCAS 包含两个部分： CAS Server 和 CAS Client。CAS Server 需要独立部署，主要负责对用户的认证工作；CAS Client 负责处理对客户端受保护资源的访问请求，需要登录时，重定向到 CAS Server。\n```\n- 适用场景\n```\nOAuth协议能广泛应用于互联网中，基于大企业的巨大用户量，能减少小网站的注册推广成本，并且能做到更加便捷的资源共享。\nLDAP协议适用于企业用户使用，通过LDAP协议，能较好地管理员工在公司各系统之间的授权与访问。\nCAS模型，作为权威机构开发的系统，具有很好的兼容性与安全性，广泛应用于各大高校等大型组织，能很好地完成大量系统的对接与大量人员的使用。\n```\n\n#### 授权模式\n- 授权码模式（authorization code）\n```\n功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与\"服务提供商\"的认证服务器进行互动。\n```\n- 简化模式（implicit）\n\n- 密码模式（resource owner password credentials）\n- 客户端模式（client credentials）\n\n- 主要配置\n```\nOauth2ServerConfig\nWebSecurityConfigurer\n```\n\n#### 不同授权模式请求\n- 授权码模式(在浏览器中访问接口)\n```\n配置项：需要将返回地址添加到client中\n    clients.redirectUris(\"http://www.baidu.com\")\n    GET http://localhost:8200/oauth/authorize?response_type=code&client_id=client_1&redirect_uri=http://www.baidu.com&state=123\n所需参数解释\n    response_type：表示授权类型，必选项，此处的值固定为\"code\"\n    client_id：表示客户端的ID，必选项\n    redirect_uri：表示重定向URI，可选项\n    scope：表示申请的权限范围，可选项\n    state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。\n```\n\n- 简化模式(在浏览器中访问接口)\n```\n请求地址\n    GET http://localhost:8200/oauth/authorize?response_type=token&client_id=client_1&redirect_uri=http://www.baidu.com&state=123&scope=select\n参数解释：\n    response_type：表示授权类型，此处的值固定为\"token\"，必选项。\n    client_id：表示客户端的ID，必选项。\n    redirect_uri：表示重定向的URI，可选项。\n    scope：表示权限范围，可选项。\n    state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。\n```\n\n- password方式获取toke\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=password&scope=select&client_id=client_1&client_secret=123456&username=user_1&password=123456\n返回信息\n    {\n        \"access_token\": \"39be5ea6-fdcd-4b15-a4dd-1f3dbaf8fc63\",\n        \"token_type\": \"bearer\",\n        \"refresh_token\": \"396e6c5e-9d79-420a-8b25-945098b10c82\",\n        \"expires_in\": 43021,\n        \"scope\": \"select\"\n    }\n参数解释\n    grant_type：表示授权类型，此处的值固定为\"password\"，必选项。\n    username：表示用户名，必选项。\n    password：表示用户的密码，必选项。\n    scope：表示权限范围，可选项。\n```\n\n- client方式获取access_token\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=client_credentials&scope=select&client_id=client_2&client_secret=123456\n返回信息\n    {\n        \"access_token\": \"17fc17a9-83b2-41c3-8621-c727d8329bbd\",\n        \"token_type\": \"bearer\",\n        \"expires_in\": 42400,\n        \"scope\": \"select\"\n    }\n参数解释\n    granttype：表示授权类型，此处的值固定为\"clientcredentials\"，必选项。\n    scope：表示权限范围，可选项。\n```\n\n\n- 刷新token\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=refresh_token&refresh_token=396e6c5e-9d79-420a-8b25-945098b10c82&client_id=client_2&client_secret=123456\n返回信息\n    {\n        \"access_token\": \"e0e64627-f157-4718-81f0-069ca21549ad\",\n        \"token_type\": \"bearer\",\n        \"refresh_token\": \"396e6c5e-9d79-420a-8b25-945098b10c82\",\n        \"expires_in\": 43199,\n        \"scope\": \"select\"\n    }\n```\n\n#### 请求业务接口\n- 请求接口\n```\n配置拦截：\n    HttpSecurity中配置 http.antMatchers(\"/user/**\").authenticated()\n使用client方式获取的access_token\n    GET http://localhost:8200/user/info?access_token=d8f47460-c0a6-4247-9f87-1712bae5325e\n接口可正常返回\n```","source":"_posts/framework/oauth2.md","raw":"---\ntitle: OAuth2学习笔记\ndescription: oauth2\ndate: 2020-11-17 09:58:26\ntags:\n- oauth2\ncategories:\n- 架构\n---\n\n- [参考demo](https://github.com/lexburner/oauth2-demo)\n- [OAuth2 RFC6749中文翻译](https://colobu.com/2017/04/28/oauth2-rfc6749/)\n- [理解OAuth 2.0-阮一峰](http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html)\n- [文档对应demo](https://github.com/im-fan/my-project/tree/release/1.0/my-oauth2)\n\n#### 框架相关\n- OAuth2\n```\n解释：\n    OAuth 2.0是一个关于授权的开放网络协议，它允许用户让第三方网站访问该用户在某一网站上存储的信息和资源，\n    如账户信息，照片，联系人等，而不需要给第三方网站提供某一网站上的账户和密码。\n流程：\n    1、用户打开客户端，客户端要求授权。\n    2、用户同意客户端授权。\n    3、客户端使用上一步提供的授权，向服务器授权层申请令牌。\n    4、授权服务器对客户端进行认证后，同意发放令牌。\n    5、客户端使用令牌，向资源服务器申请资源。\n    6、资源服务器确认令牌，向客户端开放资源。\n```\n- LDAP\n```\n解释：\n    LDAP是一种基于轻量目录访问协议，全称是Lightweight Directory Access Protocol，是由一个为查询、\n    浏览和搜索而优化的数据库构成，它成树状结构组织数据，类似文件目录一样。\n    LDAP单点登录认证主要是改变原有的认证策略，使得需要的软件都通过LDAP服务器进行认证，在统一身份认证后，\n    用户的所有信息都存储在AD Server中，终端用户在需要使用公司内部服务的时候，都需要通过AD服务器进行认证。\n登录流程：\n    1、连接到LDAP服务器。\n    2、绑定到LDAP服务器。\n    3、在LDAP服务器上执行所需要的操作。\n    4、释放LDAP服务器的连接。\n```\n- [CAS(Central Authentication Service-中央式认证服务)](https://www.cnblogs.com/lihuidu/p/6495247.html)\n```\nSSO 仅仅是一种架构，一种设计，而 CAS 则是实现 SSO 的一种手段。两者是抽象与具体的关系。\nCAS即Central Authentication Service模型（中央式认证服务），该协议是为应用提供可信身份认证的单点登录系统，最初是由耶鲁大学开发的。\nCAS 包含两个部分： CAS Server 和 CAS Client。CAS Server 需要独立部署，主要负责对用户的认证工作；CAS Client 负责处理对客户端受保护资源的访问请求，需要登录时，重定向到 CAS Server。\n```\n- 适用场景\n```\nOAuth协议能广泛应用于互联网中，基于大企业的巨大用户量，能减少小网站的注册推广成本，并且能做到更加便捷的资源共享。\nLDAP协议适用于企业用户使用，通过LDAP协议，能较好地管理员工在公司各系统之间的授权与访问。\nCAS模型，作为权威机构开发的系统，具有很好的兼容性与安全性，广泛应用于各大高校等大型组织，能很好地完成大量系统的对接与大量人员的使用。\n```\n\n#### 授权模式\n- 授权码模式（authorization code）\n```\n功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与\"服务提供商\"的认证服务器进行互动。\n```\n- 简化模式（implicit）\n\n- 密码模式（resource owner password credentials）\n- 客户端模式（client credentials）\n\n- 主要配置\n```\nOauth2ServerConfig\nWebSecurityConfigurer\n```\n\n#### 不同授权模式请求\n- 授权码模式(在浏览器中访问接口)\n```\n配置项：需要将返回地址添加到client中\n    clients.redirectUris(\"http://www.baidu.com\")\n    GET http://localhost:8200/oauth/authorize?response_type=code&client_id=client_1&redirect_uri=http://www.baidu.com&state=123\n所需参数解释\n    response_type：表示授权类型，必选项，此处的值固定为\"code\"\n    client_id：表示客户端的ID，必选项\n    redirect_uri：表示重定向URI，可选项\n    scope：表示申请的权限范围，可选项\n    state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。\n```\n\n- 简化模式(在浏览器中访问接口)\n```\n请求地址\n    GET http://localhost:8200/oauth/authorize?response_type=token&client_id=client_1&redirect_uri=http://www.baidu.com&state=123&scope=select\n参数解释：\n    response_type：表示授权类型，此处的值固定为\"token\"，必选项。\n    client_id：表示客户端的ID，必选项。\n    redirect_uri：表示重定向的URI，可选项。\n    scope：表示权限范围，可选项。\n    state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。\n```\n\n- password方式获取toke\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=password&scope=select&client_id=client_1&client_secret=123456&username=user_1&password=123456\n返回信息\n    {\n        \"access_token\": \"39be5ea6-fdcd-4b15-a4dd-1f3dbaf8fc63\",\n        \"token_type\": \"bearer\",\n        \"refresh_token\": \"396e6c5e-9d79-420a-8b25-945098b10c82\",\n        \"expires_in\": 43021,\n        \"scope\": \"select\"\n    }\n参数解释\n    grant_type：表示授权类型，此处的值固定为\"password\"，必选项。\n    username：表示用户名，必选项。\n    password：表示用户的密码，必选项。\n    scope：表示权限范围，可选项。\n```\n\n- client方式获取access_token\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=client_credentials&scope=select&client_id=client_2&client_secret=123456\n返回信息\n    {\n        \"access_token\": \"17fc17a9-83b2-41c3-8621-c727d8329bbd\",\n        \"token_type\": \"bearer\",\n        \"expires_in\": 42400,\n        \"scope\": \"select\"\n    }\n参数解释\n    granttype：表示授权类型，此处的值固定为\"clientcredentials\"，必选项。\n    scope：表示权限范围，可选项。\n```\n\n\n- 刷新token\n```\n请求地址\n    POST http://localhost:8200/oauth/token?grant_type=refresh_token&refresh_token=396e6c5e-9d79-420a-8b25-945098b10c82&client_id=client_2&client_secret=123456\n返回信息\n    {\n        \"access_token\": \"e0e64627-f157-4718-81f0-069ca21549ad\",\n        \"token_type\": \"bearer\",\n        \"refresh_token\": \"396e6c5e-9d79-420a-8b25-945098b10c82\",\n        \"expires_in\": 43199,\n        \"scope\": \"select\"\n    }\n```\n\n#### 请求业务接口\n- 请求接口\n```\n配置拦截：\n    HttpSecurity中配置 http.antMatchers(\"/user/**\").authenticated()\n使用client方式获取的access_token\n    GET http://localhost:8200/user/info?access_token=d8f47460-c0a6-4247-9f87-1712bae5325e\n接口可正常返回\n```","slug":"framework/oauth2","published":1,"updated":"2020-12-26T08:13:32.222Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bd8000qfms6cpkg79qo","content":"<ul>\n<li><a href=\"https://github.com/lexburner/oauth2-demo\">参考demo</a></li>\n<li><a href=\"https://colobu.com/2017/04/28/oauth2-rfc6749/\">OAuth2 RFC6749中文翻译</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\">理解OAuth 2.0-阮一峰</a></li>\n<li><a href=\"https://github.com/im-fan/my-project/tree/release/1.0/my-oauth2\">文档对应demo</a></li>\n</ul>\n<h4 id=\"框架相关\"><a href=\"#框架相关\" class=\"headerlink\" title=\"框架相关\"></a>框架相关</h4><ul>\n<li>OAuth2<pre><code>解释：\n  OAuth 2.0是一个关于授权的开放网络协议，它允许用户让第三方网站访问该用户在某一网站上存储的信息和资源，\n  如账户信息，照片，联系人等，而不需要给第三方网站提供某一网站上的账户和密码。\n流程：\n  1、用户打开客户端，客户端要求授权。\n  2、用户同意客户端授权。\n  3、客户端使用上一步提供的授权，向服务器授权层申请令牌。\n  4、授权服务器对客户端进行认证后，同意发放令牌。\n  5、客户端使用令牌，向资源服务器申请资源。\n  6、资源服务器确认令牌，向客户端开放资源。</code></pre>\n</li>\n<li>LDAP<pre><code>解释：\n  LDAP是一种基于轻量目录访问协议，全称是Lightweight Directory Access Protocol，是由一个为查询、\n  浏览和搜索而优化的数据库构成，它成树状结构组织数据，类似文件目录一样。\n  LDAP单点登录认证主要是改变原有的认证策略，使得需要的软件都通过LDAP服务器进行认证，在统一身份认证后，\n  用户的所有信息都存储在AD Server中，终端用户在需要使用公司内部服务的时候，都需要通过AD服务器进行认证。\n登录流程：\n  1、连接到LDAP服务器。\n  2、绑定到LDAP服务器。\n  3、在LDAP服务器上执行所需要的操作。\n  4、释放LDAP服务器的连接。</code></pre>\n</li>\n<li><a href=\"https://www.cnblogs.com/lihuidu/p/6495247.html\">CAS(Central Authentication Service-中央式认证服务)</a><pre><code>SSO 仅仅是一种架构，一种设计，而 CAS 则是实现 SSO 的一种手段。两者是抽象与具体的关系。\nCAS即Central Authentication Service模型（中央式认证服务），该协议是为应用提供可信身份认证的单点登录系统，最初是由耶鲁大学开发的。\nCAS 包含两个部分： CAS Server 和 CAS Client。CAS Server 需要独立部署，主要负责对用户的认证工作；CAS Client 负责处理对客户端受保护资源的访问请求，需要登录时，重定向到 CAS Server。</code></pre>\n</li>\n<li>适用场景<pre><code>OAuth协议能广泛应用于互联网中，基于大企业的巨大用户量，能减少小网站的注册推广成本，并且能做到更加便捷的资源共享。\nLDAP协议适用于企业用户使用，通过LDAP协议，能较好地管理员工在公司各系统之间的授权与访问。\nCAS模型，作为权威机构开发的系统，具有很好的兼容性与安全性，广泛应用于各大高校等大型组织，能很好地完成大量系统的对接与大量人员的使用。</code></pre>\n</li>\n</ul>\n<h4 id=\"授权模式\"><a href=\"#授权模式\" class=\"headerlink\" title=\"授权模式\"></a>授权模式</h4><ul>\n<li><p>授权码模式（authorization code）</p>\n<pre><code>功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与&quot;服务提供商&quot;的认证服务器进行互动。</code></pre>\n</li>\n<li><p>简化模式（implicit）</p>\n</li>\n<li><p>密码模式（resource owner password credentials）</p>\n</li>\n<li><p>客户端模式（client credentials）</p>\n</li>\n<li><p>主要配置</p>\n<pre><code>Oauth2ServerConfig\nWebSecurityConfigurer</code></pre>\n</li>\n</ul>\n<h4 id=\"不同授权模式请求\"><a href=\"#不同授权模式请求\" class=\"headerlink\" title=\"不同授权模式请求\"></a>不同授权模式请求</h4><ul>\n<li><p>授权码模式(在浏览器中访问接口)</p>\n<pre><code>配置项：需要将返回地址添加到client中\n  clients.redirectUris(&quot;http://www.baidu.com&quot;)\n  GET http://localhost:8200/oauth/authorize?response_type=code&amp;client_id=client_1&amp;redirect_uri=http://www.baidu.com&amp;state=123\n所需参数解释\n  response_type：表示授权类型，必选项，此处的值固定为&quot;code&quot;\n  client_id：表示客户端的ID，必选项\n  redirect_uri：表示重定向URI，可选项\n  scope：表示申请的权限范围，可选项\n  state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。</code></pre>\n</li>\n<li><p>简化模式(在浏览器中访问接口)</p>\n<pre><code>请求地址\n  GET http://localhost:8200/oauth/authorize?response_type=token&amp;client_id=client_1&amp;redirect_uri=http://www.baidu.com&amp;state=123&amp;scope=select\n参数解释：\n  response_type：表示授权类型，此处的值固定为&quot;token&quot;，必选项。\n  client_id：表示客户端的ID，必选项。\n  redirect_uri：表示重定向的URI，可选项。\n  scope：表示权限范围，可选项。\n  state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。</code></pre>\n</li>\n<li><p>password方式获取toke</p>\n<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=password&amp;scope=select&amp;client_id=client_1&amp;client_secret=123456&amp;username=user_1&amp;password=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;39be5ea6-fdcd-4b15-a4dd-1f3dbaf8fc63&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;refresh_token&quot;: &quot;396e6c5e-9d79-420a-8b25-945098b10c82&quot;,\n      &quot;expires_in&quot;: 43021,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;\n参数解释\n  grant_type：表示授权类型，此处的值固定为&quot;password&quot;，必选项。\n  username：表示用户名，必选项。\n  password：表示用户的密码，必选项。\n  scope：表示权限范围，可选项。</code></pre>\n</li>\n<li><p>client方式获取access_token</p>\n<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=client_credentials&amp;scope=select&amp;client_id=client_2&amp;client_secret=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;17fc17a9-83b2-41c3-8621-c727d8329bbd&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;expires_in&quot;: 42400,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;\n参数解释\n  granttype：表示授权类型，此处的值固定为&quot;clientcredentials&quot;，必选项。\n  scope：表示权限范围，可选项。</code></pre>\n</li>\n</ul>\n<ul>\n<li>刷新token<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=refresh_token&amp;refresh_token=396e6c5e-9d79-420a-8b25-945098b10c82&amp;client_id=client_2&amp;client_secret=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;e0e64627-f157-4718-81f0-069ca21549ad&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;refresh_token&quot;: &quot;396e6c5e-9d79-420a-8b25-945098b10c82&quot;,\n      &quot;expires_in&quot;: 43199,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"请求业务接口\"><a href=\"#请求业务接口\" class=\"headerlink\" title=\"请求业务接口\"></a>请求业务接口</h4><ul>\n<li>请求接口<pre><code>配置拦截：\n  HttpSecurity中配置 http.antMatchers(&quot;/user/**&quot;).authenticated()\n使用client方式获取的access_token\n  GET http://localhost:8200/user/info?access_token=d8f47460-c0a6-4247-9f87-1712bae5325e\n接口可正常返回</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://github.com/lexburner/oauth2-demo\">参考demo</a></li>\n<li><a href=\"https://colobu.com/2017/04/28/oauth2-rfc6749/\">OAuth2 RFC6749中文翻译</a></li>\n<li><a href=\"http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\">理解OAuth 2.0-阮一峰</a></li>\n<li><a href=\"https://github.com/im-fan/my-project/tree/release/1.0/my-oauth2\">文档对应demo</a></li>\n</ul>\n<h4 id=\"框架相关\"><a href=\"#框架相关\" class=\"headerlink\" title=\"框架相关\"></a>框架相关</h4><ul>\n<li>OAuth2<pre><code>解释：\n  OAuth 2.0是一个关于授权的开放网络协议，它允许用户让第三方网站访问该用户在某一网站上存储的信息和资源，\n  如账户信息，照片，联系人等，而不需要给第三方网站提供某一网站上的账户和密码。\n流程：\n  1、用户打开客户端，客户端要求授权。\n  2、用户同意客户端授权。\n  3、客户端使用上一步提供的授权，向服务器授权层申请令牌。\n  4、授权服务器对客户端进行认证后，同意发放令牌。\n  5、客户端使用令牌，向资源服务器申请资源。\n  6、资源服务器确认令牌，向客户端开放资源。</code></pre>\n</li>\n<li>LDAP<pre><code>解释：\n  LDAP是一种基于轻量目录访问协议，全称是Lightweight Directory Access Protocol，是由一个为查询、\n  浏览和搜索而优化的数据库构成，它成树状结构组织数据，类似文件目录一样。\n  LDAP单点登录认证主要是改变原有的认证策略，使得需要的软件都通过LDAP服务器进行认证，在统一身份认证后，\n  用户的所有信息都存储在AD Server中，终端用户在需要使用公司内部服务的时候，都需要通过AD服务器进行认证。\n登录流程：\n  1、连接到LDAP服务器。\n  2、绑定到LDAP服务器。\n  3、在LDAP服务器上执行所需要的操作。\n  4、释放LDAP服务器的连接。</code></pre>\n</li>\n<li><a href=\"https://www.cnblogs.com/lihuidu/p/6495247.html\">CAS(Central Authentication Service-中央式认证服务)</a><pre><code>SSO 仅仅是一种架构，一种设计，而 CAS 则是实现 SSO 的一种手段。两者是抽象与具体的关系。\nCAS即Central Authentication Service模型（中央式认证服务），该协议是为应用提供可信身份认证的单点登录系统，最初是由耶鲁大学开发的。\nCAS 包含两个部分： CAS Server 和 CAS Client。CAS Server 需要独立部署，主要负责对用户的认证工作；CAS Client 负责处理对客户端受保护资源的访问请求，需要登录时，重定向到 CAS Server。</code></pre>\n</li>\n<li>适用场景<pre><code>OAuth协议能广泛应用于互联网中，基于大企业的巨大用户量，能减少小网站的注册推广成本，并且能做到更加便捷的资源共享。\nLDAP协议适用于企业用户使用，通过LDAP协议，能较好地管理员工在公司各系统之间的授权与访问。\nCAS模型，作为权威机构开发的系统，具有很好的兼容性与安全性，广泛应用于各大高校等大型组织，能很好地完成大量系统的对接与大量人员的使用。</code></pre>\n</li>\n</ul>\n<h4 id=\"授权模式\"><a href=\"#授权模式\" class=\"headerlink\" title=\"授权模式\"></a>授权模式</h4><ul>\n<li><p>授权码模式（authorization code）</p>\n<pre><code>功能最完整、流程最严密的授权模式。它的特点就是通过客户端的后台服务器，与&quot;服务提供商&quot;的认证服务器进行互动。</code></pre>\n</li>\n<li><p>简化模式（implicit）</p>\n</li>\n<li><p>密码模式（resource owner password credentials）</p>\n</li>\n<li><p>客户端模式（client credentials）</p>\n</li>\n<li><p>主要配置</p>\n<pre><code>Oauth2ServerConfig\nWebSecurityConfigurer</code></pre>\n</li>\n</ul>\n<h4 id=\"不同授权模式请求\"><a href=\"#不同授权模式请求\" class=\"headerlink\" title=\"不同授权模式请求\"></a>不同授权模式请求</h4><ul>\n<li><p>授权码模式(在浏览器中访问接口)</p>\n<pre><code>配置项：需要将返回地址添加到client中\n  clients.redirectUris(&quot;http://www.baidu.com&quot;)\n  GET http://localhost:8200/oauth/authorize?response_type=code&amp;client_id=client_1&amp;redirect_uri=http://www.baidu.com&amp;state=123\n所需参数解释\n  response_type：表示授权类型，必选项，此处的值固定为&quot;code&quot;\n  client_id：表示客户端的ID，必选项\n  redirect_uri：表示重定向URI，可选项\n  scope：表示申请的权限范围，可选项\n  state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。</code></pre>\n</li>\n<li><p>简化模式(在浏览器中访问接口)</p>\n<pre><code>请求地址\n  GET http://localhost:8200/oauth/authorize?response_type=token&amp;client_id=client_1&amp;redirect_uri=http://www.baidu.com&amp;state=123&amp;scope=select\n参数解释：\n  response_type：表示授权类型，此处的值固定为&quot;token&quot;，必选项。\n  client_id：表示客户端的ID，必选项。\n  redirect_uri：表示重定向的URI，可选项。\n  scope：表示权限范围，可选项。\n  state：表示客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值。</code></pre>\n</li>\n<li><p>password方式获取toke</p>\n<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=password&amp;scope=select&amp;client_id=client_1&amp;client_secret=123456&amp;username=user_1&amp;password=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;39be5ea6-fdcd-4b15-a4dd-1f3dbaf8fc63&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;refresh_token&quot;: &quot;396e6c5e-9d79-420a-8b25-945098b10c82&quot;,\n      &quot;expires_in&quot;: 43021,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;\n参数解释\n  grant_type：表示授权类型，此处的值固定为&quot;password&quot;，必选项。\n  username：表示用户名，必选项。\n  password：表示用户的密码，必选项。\n  scope：表示权限范围，可选项。</code></pre>\n</li>\n<li><p>client方式获取access_token</p>\n<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=client_credentials&amp;scope=select&amp;client_id=client_2&amp;client_secret=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;17fc17a9-83b2-41c3-8621-c727d8329bbd&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;expires_in&quot;: 42400,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;\n参数解释\n  granttype：表示授权类型，此处的值固定为&quot;clientcredentials&quot;，必选项。\n  scope：表示权限范围，可选项。</code></pre>\n</li>\n</ul>\n<ul>\n<li>刷新token<pre><code>请求地址\n  POST http://localhost:8200/oauth/token?grant_type=refresh_token&amp;refresh_token=396e6c5e-9d79-420a-8b25-945098b10c82&amp;client_id=client_2&amp;client_secret=123456\n返回信息\n  &#123;\n      &quot;access_token&quot;: &quot;e0e64627-f157-4718-81f0-069ca21549ad&quot;,\n      &quot;token_type&quot;: &quot;bearer&quot;,\n      &quot;refresh_token&quot;: &quot;396e6c5e-9d79-420a-8b25-945098b10c82&quot;,\n      &quot;expires_in&quot;: 43199,\n      &quot;scope&quot;: &quot;select&quot;\n  &#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"请求业务接口\"><a href=\"#请求业务接口\" class=\"headerlink\" title=\"请求业务接口\"></a>请求业务接口</h4><ul>\n<li>请求接口<pre><code>配置拦截：\n  HttpSecurity中配置 http.antMatchers(&quot;/user/**&quot;).authenticated()\n使用client方式获取的access_token\n  GET http://localhost:8200/user/info?access_token=d8f47460-c0a6-4247-9f87-1712bae5325e\n接口可正常返回</code></pre>\n</li>\n</ul>\n"},{"title":"Hexo搭建博客","date":"2020-09-30T06:51:20.000Z","_content":"\n> 记录本博客搭建步骤，适用于Mac/Linux系统，详细介绍及其他系统请参照Hexo官网\n\n\n### 相关链接\n- [Hexo官网](https://hexo.io/zh-cn/)\n- [官网主题](https://hexo.io/themes/)\n- [3-hexo主题](https://github.com/yelog/hexo-theme-3-hexo)\n- [3-hexo主题相关文档](https://yelog.org/2017/03/13/3-hexo-logs/)\n\n### 准备环境\n> mac用户推荐先安装Homebrew，通过Homebrew安装一下软件\n- [Homebrew](https://brew.sh/)\n- 安装Git\n- 安装Node.js\n\n### 安装Hexo\n```textmate\nnpm install -g hexo-cli\n```\n\n### 创建项目\n```shell\n注：my-hexo - 项目名/项目文件夹名\nhexo init my-hexo\ncd my-hexo\nnpm install\n```\n\n### 项目结构\n\n- 目录\n```textmate\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n\n- 目录介绍\n\n```textmate\n1._config.yml\n网站的 配置 信息，您可以在此配置大部分的参数\n2.package.json\n应用程序的信息。\n3.scaffolds\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n4.source\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n5.themes\n主题 文件夹。Hexo 会根据主题来生成静态页面。\n```\n### 配置主题\n- [官网主题](https://hexo.io/themes/)\n- 本博客使用的主题 [3-hexo](https://github.com/yelog/hexo-theme-3-hexo)\n\n```textmate\n1.项目根目录下执行(下载其他主题，修改为themes/xxx即可)\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n2.修改配置\n修改hexo根目录的_config.yml，theme: 3-hexo\n3.主题更新\ncd themes/3-hexo\ngit pull\n\n在此感谢提供主题的作者\n```\n\n### 写作\n- 常用文档命令\n\n```textmate\n1.新建文档\nhexo new [layout] <title>\n\n2.新建草稿文档\nhexo new [layout] <title>\n\n3.草稿<->发布\nhexo publish [layout] <title>\n```\n- 参数介绍\n|参数|值|作用|生成文件的路径|\n|-|-|-|-|\n|layout|post|正式发表的文章|source/_posts|\n|layout|page|静态页面|source|\n|layout|draft|草稿|source/_drafts|\n|title|-|文章标题&文件名|-|\n\n- 文档头部信息格式\n\n```textmate\n---\ntitle: Java\ndate: 2020-09-30 14:51:20\ntags: \n- Java\ncategories: \n- Java\n- 笔记\n---\n```\n\n- 文档头部信息解释\n\n|参数|作用|\n|-|-|\n|title|\t网站标题|\n|subtitle|\t网站副标题|\n|description|\t网站描述|\n|tags|标签，可多个|\n|categories|分类菜单，可定义多级|\n|keywords|\t网站的关键词。支援多个关键词。|\n|author|\t您的名字|\n|language|\t网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 zh-Hans和 zh-CN。|\n|timezone|\t网站时区。Hexo 默认使用您电脑的时区。请参考 时区列表 进行设置，如 America/New_York, Japan, 和 UTC 。一般的，对于中国大陆地区可以使用 Asia/Shanghai。|\n\n### 运行&发布\n- 本地运行\n```textmate\nnpm run server\n```\n- 编译&部署\n```textmate\nhexo clean \nhexo generate\n编译后会生成public文件夹，部署gitpage可以直接指定public为资源文件夹即可\n```\n","source":"_posts/other/hexo.md","raw":"---\ntitle: Hexo搭建博客\ndate: 2020-09-30 14:51:20\ntags: \n- tool\ncategories: \n- 其他\n---\n\n> 记录本博客搭建步骤，适用于Mac/Linux系统，详细介绍及其他系统请参照Hexo官网\n\n\n### 相关链接\n- [Hexo官网](https://hexo.io/zh-cn/)\n- [官网主题](https://hexo.io/themes/)\n- [3-hexo主题](https://github.com/yelog/hexo-theme-3-hexo)\n- [3-hexo主题相关文档](https://yelog.org/2017/03/13/3-hexo-logs/)\n\n### 准备环境\n> mac用户推荐先安装Homebrew，通过Homebrew安装一下软件\n- [Homebrew](https://brew.sh/)\n- 安装Git\n- 安装Node.js\n\n### 安装Hexo\n```textmate\nnpm install -g hexo-cli\n```\n\n### 创建项目\n```shell\n注：my-hexo - 项目名/项目文件夹名\nhexo init my-hexo\ncd my-hexo\nnpm install\n```\n\n### 项目结构\n\n- 目录\n```textmate\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n\n- 目录介绍\n\n```textmate\n1._config.yml\n网站的 配置 信息，您可以在此配置大部分的参数\n2.package.json\n应用程序的信息。\n3.scaffolds\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n4.source\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n5.themes\n主题 文件夹。Hexo 会根据主题来生成静态页面。\n```\n### 配置主题\n- [官网主题](https://hexo.io/themes/)\n- 本博客使用的主题 [3-hexo](https://github.com/yelog/hexo-theme-3-hexo)\n\n```textmate\n1.项目根目录下执行(下载其他主题，修改为themes/xxx即可)\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n2.修改配置\n修改hexo根目录的_config.yml，theme: 3-hexo\n3.主题更新\ncd themes/3-hexo\ngit pull\n\n在此感谢提供主题的作者\n```\n\n### 写作\n- 常用文档命令\n\n```textmate\n1.新建文档\nhexo new [layout] <title>\n\n2.新建草稿文档\nhexo new [layout] <title>\n\n3.草稿<->发布\nhexo publish [layout] <title>\n```\n- 参数介绍\n|参数|值|作用|生成文件的路径|\n|-|-|-|-|\n|layout|post|正式发表的文章|source/_posts|\n|layout|page|静态页面|source|\n|layout|draft|草稿|source/_drafts|\n|title|-|文章标题&文件名|-|\n\n- 文档头部信息格式\n\n```textmate\n---\ntitle: Java\ndate: 2020-09-30 14:51:20\ntags: \n- Java\ncategories: \n- Java\n- 笔记\n---\n```\n\n- 文档头部信息解释\n\n|参数|作用|\n|-|-|\n|title|\t网站标题|\n|subtitle|\t网站副标题|\n|description|\t网站描述|\n|tags|标签，可多个|\n|categories|分类菜单，可定义多级|\n|keywords|\t网站的关键词。支援多个关键词。|\n|author|\t您的名字|\n|language|\t网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 zh-Hans和 zh-CN。|\n|timezone|\t网站时区。Hexo 默认使用您电脑的时区。请参考 时区列表 进行设置，如 America/New_York, Japan, 和 UTC 。一般的，对于中国大陆地区可以使用 Asia/Shanghai。|\n\n### 运行&发布\n- 本地运行\n```textmate\nnpm run server\n```\n- 编译&部署\n```textmate\nhexo clean \nhexo generate\n编译后会生成public文件夹，部署gitpage可以直接指定public为资源文件夹即可\n```\n","slug":"other/hexo","published":1,"updated":"2021-07-26T07:59:14.157Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bdc000tfms63nz12wqn","content":"<blockquote>\n<p>记录本博客搭建步骤，适用于Mac/Linux系统，详细介绍及其他系统请参照Hexo官网</p>\n</blockquote>\n<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><ul>\n<li><a href=\"https://hexo.io/zh-cn/\">Hexo官网</a></li>\n<li><a href=\"https://hexo.io/themes/\">官网主题</a></li>\n<li><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">3-hexo主题</a></li>\n<li><a href=\"https://yelog.org/2017/03/13/3-hexo-logs/\">3-hexo主题相关文档</a></li>\n</ul>\n<h3 id=\"准备环境\"><a href=\"#准备环境\" class=\"headerlink\" title=\"准备环境\"></a>准备环境</h3><blockquote>\n<p>mac用户推荐先安装Homebrew，通过Homebrew安装一下软件</p>\n</blockquote>\n<ul>\n<li><a href=\"https://brew.sh/\">Homebrew</a></li>\n<li>安装Git</li>\n<li>安装Node.js</li>\n</ul>\n<h3 id=\"安装Hexo\"><a href=\"#安装Hexo\" class=\"headerlink\" title=\"安装Hexo\"></a>安装Hexo</h3><pre><code class=\"textmate\">npm install -g hexo-cli</code></pre>\n<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code class=\"shell\">注：my-hexo - 项目名/项目文件夹名\nhexo init my-hexo\ncd my-hexo\nnpm install</code></pre>\n<h3 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h3><ul>\n<li><p>目录</p>\n<pre><code class=\"textmate\">.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes</code></pre>\n</li>\n<li><p>目录介绍</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1._config.yml\n网站的 配置 信息，您可以在此配置大部分的参数\n2.package.json\n应用程序的信息。\n3.scaffolds\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n4.source\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n5.themes\n主题 文件夹。Hexo 会根据主题来生成静态页面。</code></pre>\n<h3 id=\"配置主题\"><a href=\"#配置主题\" class=\"headerlink\" title=\"配置主题\"></a>配置主题</h3><ul>\n<li><a href=\"https://hexo.io/themes/\">官网主题</a></li>\n<li>本博客使用的主题 <a href=\"https://github.com/yelog/hexo-theme-3-hexo\">3-hexo</a></li>\n</ul>\n<pre><code class=\"textmate\">1.项目根目录下执行(下载其他主题，修改为themes/xxx即可)\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n2.修改配置\n修改hexo根目录的_config.yml，theme: 3-hexo\n3.主题更新\ncd themes/3-hexo\ngit pull\n\n在此感谢提供主题的作者</code></pre>\n<h3 id=\"写作\"><a href=\"#写作\" class=\"headerlink\" title=\"写作\"></a>写作</h3><ul>\n<li>常用文档命令</li>\n</ul>\n<pre><code class=\"textmate\">1.新建文档\nhexo new [layout] &lt;title&gt;\n\n2.新建草稿文档\nhexo new [layout] &lt;title&gt;\n\n3.草稿&lt;-&gt;发布\nhexo publish [layout] &lt;title&gt;</code></pre>\n<ul>\n<li><p>参数介绍</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>值</th>\n<th>作用</th>\n<th>生成文件的路径</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>layout</td>\n<td>post</td>\n<td>正式发表的文章</td>\n<td>source/_posts</td>\n</tr>\n<tr>\n<td>layout</td>\n<td>page</td>\n<td>静态页面</td>\n<td>source</td>\n</tr>\n<tr>\n<td>layout</td>\n<td>draft</td>\n<td>草稿</td>\n<td>source/_drafts</td>\n</tr>\n<tr>\n<td>title</td>\n<td>-</td>\n<td>文章标题&amp;文件名</td>\n<td>-</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>文档头部信息格式</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">---\ntitle: Java\ndate: 2020-09-30 14:51:20\ntags: \n- Java\ncategories: \n- Java\n- 笔记\n---</code></pre>\n<ul>\n<li>文档头部信息解释</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>title</td>\n<td>网站标题</td>\n</tr>\n<tr>\n<td>subtitle</td>\n<td>网站副标题</td>\n</tr>\n<tr>\n<td>description</td>\n<td>网站描述</td>\n</tr>\n<tr>\n<td>tags</td>\n<td>标签，可多个</td>\n</tr>\n<tr>\n<td>categories</td>\n<td>分类菜单，可定义多级</td>\n</tr>\n<tr>\n<td>keywords</td>\n<td>网站的关键词。支援多个关键词。</td>\n</tr>\n<tr>\n<td>author</td>\n<td>您的名字</td>\n</tr>\n<tr>\n<td>language</td>\n<td>网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 zh-Hans和 zh-CN。</td>\n</tr>\n<tr>\n<td>timezone</td>\n<td>网站时区。Hexo 默认使用您电脑的时区。请参考 时区列表 进行设置，如 America/New_York, Japan, 和 UTC 。一般的，对于中国大陆地区可以使用 Asia/Shanghai。</td>\n</tr>\n</tbody></table>\n<h3 id=\"运行-amp-发布\"><a href=\"#运行-amp-发布\" class=\"headerlink\" title=\"运行&amp;发布\"></a>运行&amp;发布</h3><ul>\n<li>本地运行<pre><code class=\"textmate\">npm run server</code></pre>\n</li>\n<li>编译&amp;部署<pre><code class=\"textmate\">hexo clean \nhexo generate\n编译后会生成public文件夹，部署gitpage可以直接指定public为资源文件夹即可</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>记录本博客搭建步骤，适用于Mac/Linux系统，详细介绍及其他系统请参照Hexo官网</p>\n</blockquote>\n<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><ul>\n<li><a href=\"https://hexo.io/zh-cn/\">Hexo官网</a></li>\n<li><a href=\"https://hexo.io/themes/\">官网主题</a></li>\n<li><a href=\"https://github.com/yelog/hexo-theme-3-hexo\">3-hexo主题</a></li>\n<li><a href=\"https://yelog.org/2017/03/13/3-hexo-logs/\">3-hexo主题相关文档</a></li>\n</ul>\n<h3 id=\"准备环境\"><a href=\"#准备环境\" class=\"headerlink\" title=\"准备环境\"></a>准备环境</h3><blockquote>\n<p>mac用户推荐先安装Homebrew，通过Homebrew安装一下软件</p>\n</blockquote>\n<ul>\n<li><a href=\"https://brew.sh/\">Homebrew</a></li>\n<li>安装Git</li>\n<li>安装Node.js</li>\n</ul>\n<h3 id=\"安装Hexo\"><a href=\"#安装Hexo\" class=\"headerlink\" title=\"安装Hexo\"></a>安装Hexo</h3><pre><code class=\"textmate\">npm install -g hexo-cli</code></pre>\n<h3 id=\"创建项目\"><a href=\"#创建项目\" class=\"headerlink\" title=\"创建项目\"></a>创建项目</h3><pre><code class=\"shell\">注：my-hexo - 项目名/项目文件夹名\nhexo init my-hexo\ncd my-hexo\nnpm install</code></pre>\n<h3 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h3><ul>\n<li><p>目录</p>\n<pre><code class=\"textmate\">.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes</code></pre>\n</li>\n<li><p>目录介绍</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1._config.yml\n网站的 配置 信息，您可以在此配置大部分的参数\n2.package.json\n应用程序的信息。\n3.scaffolds\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n4.source\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n5.themes\n主题 文件夹。Hexo 会根据主题来生成静态页面。</code></pre>\n<h3 id=\"配置主题\"><a href=\"#配置主题\" class=\"headerlink\" title=\"配置主题\"></a>配置主题</h3><ul>\n<li><a href=\"https://hexo.io/themes/\">官网主题</a></li>\n<li>本博客使用的主题 <a href=\"https://github.com/yelog/hexo-theme-3-hexo\">3-hexo</a></li>\n</ul>\n<pre><code class=\"textmate\">1.项目根目录下执行(下载其他主题，修改为themes/xxx即可)\ngit clone https://github.com/yelog/hexo-theme-3-hexo.git themes/3-hexo\n2.修改配置\n修改hexo根目录的_config.yml，theme: 3-hexo\n3.主题更新\ncd themes/3-hexo\ngit pull\n\n在此感谢提供主题的作者</code></pre>\n<h3 id=\"写作\"><a href=\"#写作\" class=\"headerlink\" title=\"写作\"></a>写作</h3><ul>\n<li>常用文档命令</li>\n</ul>\n<pre><code class=\"textmate\">1.新建文档\nhexo new [layout] &lt;title&gt;\n\n2.新建草稿文档\nhexo new [layout] &lt;title&gt;\n\n3.草稿&lt;-&gt;发布\nhexo publish [layout] &lt;title&gt;</code></pre>\n<ul>\n<li><p>参数介绍</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>值</th>\n<th>作用</th>\n<th>生成文件的路径</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>layout</td>\n<td>post</td>\n<td>正式发表的文章</td>\n<td>source/_posts</td>\n</tr>\n<tr>\n<td>layout</td>\n<td>page</td>\n<td>静态页面</td>\n<td>source</td>\n</tr>\n<tr>\n<td>layout</td>\n<td>draft</td>\n<td>草稿</td>\n<td>source/_drafts</td>\n</tr>\n<tr>\n<td>title</td>\n<td>-</td>\n<td>文章标题&amp;文件名</td>\n<td>-</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>文档头部信息格式</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">---\ntitle: Java\ndate: 2020-09-30 14:51:20\ntags: \n- Java\ncategories: \n- Java\n- 笔记\n---</code></pre>\n<ul>\n<li>文档头部信息解释</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>title</td>\n<td>网站标题</td>\n</tr>\n<tr>\n<td>subtitle</td>\n<td>网站副标题</td>\n</tr>\n<tr>\n<td>description</td>\n<td>网站描述</td>\n</tr>\n<tr>\n<td>tags</td>\n<td>标签，可多个</td>\n</tr>\n<tr>\n<td>categories</td>\n<td>分类菜单，可定义多级</td>\n</tr>\n<tr>\n<td>keywords</td>\n<td>网站的关键词。支援多个关键词。</td>\n</tr>\n<tr>\n<td>author</td>\n<td>您的名字</td>\n</tr>\n<tr>\n<td>language</td>\n<td>网站使用的语言。对于简体中文用户来说，使用不同的主题可能需要设置成不同的值，请参考你的主题的文档自行设置，常见的有 zh-Hans和 zh-CN。</td>\n</tr>\n<tr>\n<td>timezone</td>\n<td>网站时区。Hexo 默认使用您电脑的时区。请参考 时区列表 进行设置，如 America/New_York, Japan, 和 UTC 。一般的，对于中国大陆地区可以使用 Asia/Shanghai。</td>\n</tr>\n</tbody></table>\n<h3 id=\"运行-amp-发布\"><a href=\"#运行-amp-发布\" class=\"headerlink\" title=\"运行&amp;发布\"></a>运行&amp;发布</h3><ul>\n<li>本地运行<pre><code class=\"textmate\">npm run server</code></pre>\n</li>\n<li>编译&amp;部署<pre><code class=\"textmate\">hexo clean \nhexo generate\n编译后会生成public文件夹，部署gitpage可以直接指定public为资源文件夹即可</code></pre>\n</li>\n</ul>\n"},{"title":"软件推荐","date":"2020-10-02T06:34:06.000Z","_content":"\n\n### Mac软件&工具网站\n|主要功能|软件名|相关网址|\n|-|-|-|\n|图片编辑器|PixelStyle||\n|视频播放|IINA||\n|录屏软件|LICEcap||\n|文件比较|Beyond Compare||\n|Markdown编辑工具|Haroopad||\n|Mac包管理工具|Homebrew||\n|Mac破解软件||https://xclient.info|\n|相似网站查询||https://www.similarsites.com|\n","source":"_posts/other/software.md","raw":"---\ntitle: 软件推荐\ndate: 2020-10-02 14:34:06\ntags: \n- tool\ncategories:\n- 其他\n---\n\n\n### Mac软件&工具网站\n|主要功能|软件名|相关网址|\n|-|-|-|\n|图片编辑器|PixelStyle||\n|视频播放|IINA||\n|录屏软件|LICEcap||\n|文件比较|Beyond Compare||\n|Markdown编辑工具|Haroopad||\n|Mac包管理工具|Homebrew||\n|Mac破解软件||https://xclient.info|\n|相似网站查询||https://www.similarsites.com|\n","slug":"other/software","published":1,"updated":"2021-07-26T07:59:14.134Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bdg000xfms66t4tf1i4","content":"<h3 id=\"Mac软件-amp-工具网站\"><a href=\"#Mac软件-amp-工具网站\" class=\"headerlink\" title=\"Mac软件&amp;工具网站\"></a>Mac软件&amp;工具网站</h3><table>\n<thead>\n<tr>\n<th>主要功能</th>\n<th>软件名</th>\n<th>相关网址</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>图片编辑器</td>\n<td>PixelStyle</td>\n<td></td>\n</tr>\n<tr>\n<td>视频播放</td>\n<td>IINA</td>\n<td></td>\n</tr>\n<tr>\n<td>录屏软件</td>\n<td>LICEcap</td>\n<td></td>\n</tr>\n<tr>\n<td>文件比较</td>\n<td>Beyond Compare</td>\n<td></td>\n</tr>\n<tr>\n<td>Markdown编辑工具</td>\n<td>Haroopad</td>\n<td></td>\n</tr>\n<tr>\n<td>Mac包管理工具</td>\n<td>Homebrew</td>\n<td></td>\n</tr>\n<tr>\n<td>Mac破解软件</td>\n<td></td>\n<td><a href=\"https://xclient.info/\">https://xclient.info</a></td>\n</tr>\n<tr>\n<td>相似网站查询</td>\n<td></td>\n<td><a href=\"https://www.similarsites.com/\">https://www.similarsites.com</a></td>\n</tr>\n</tbody></table>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Mac软件-amp-工具网站\"><a href=\"#Mac软件-amp-工具网站\" class=\"headerlink\" title=\"Mac软件&amp;工具网站\"></a>Mac软件&amp;工具网站</h3><table>\n<thead>\n<tr>\n<th>主要功能</th>\n<th>软件名</th>\n<th>相关网址</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>图片编辑器</td>\n<td>PixelStyle</td>\n<td></td>\n</tr>\n<tr>\n<td>视频播放</td>\n<td>IINA</td>\n<td></td>\n</tr>\n<tr>\n<td>录屏软件</td>\n<td>LICEcap</td>\n<td></td>\n</tr>\n<tr>\n<td>文件比较</td>\n<td>Beyond Compare</td>\n<td></td>\n</tr>\n<tr>\n<td>Markdown编辑工具</td>\n<td>Haroopad</td>\n<td></td>\n</tr>\n<tr>\n<td>Mac包管理工具</td>\n<td>Homebrew</td>\n<td></td>\n</tr>\n<tr>\n<td>Mac破解软件</td>\n<td></td>\n<td><a href=\"https://xclient.info/\">https://xclient.info</a></td>\n</tr>\n<tr>\n<td>相似网站查询</td>\n<td></td>\n<td><a href=\"https://www.similarsites.com/\">https://www.similarsites.com</a></td>\n</tr>\n</tbody></table>\n"},{"title":"vue","description":"vue","date":"2021-04-28T03:44:02.000Z","_content":"\n### vue+es6接入Echarts\n#### 1.安装\n```shell\n# echars\nnpm install echarts --save\n```\n\n#### 2.实现图表下钻及还原demo\n```textmate\n<template>\n    <div style=\"display: inline-block\" v-show=\"optionShow\" >\n        <div id=\"option\" :style=\"{width: '800px', height: '600px'}\"></div>\n    </div>\n\n    <div style=\"display: inline-block\" v-show=\"optionSecondShow\" >\n        <div id=\"secondOption\" :style=\"{width: '800px', height: '600px'}\"></div>\n    </div>\n</template>\n\n<script>\n    import * as echarts from 'echarts';\n    export default {\n        name: 'dashboard',\n        data() {\n            return {\n                optionShow: true,\n                // echarts报表\n                option: {},\n                optionSecond: {},\n            }\n        },\n        created(){\n        },\n        mounted(){\n            //调用method中方法！！！\n            let that = this;\n\n            //渲染报表一\n            let myChart = echarts.init(document.getElementById('option'))\n            that.initEcharts();\n            myChart.setOption(that.option);\n\n            //报表二\n            let myChartSecond = echarts.init(document.getElementById('secondOption'))\n            //图表一下钻\n            myChart.on('click', function (params) {\n                console.log(params.name,params.value,params.seriesName);\n\n                //重置值\n                that.secondShowFun()\n                myChartSecond.setOption(that.optionSecond)\n            });\n\n            //点击图表二还原数据\n            myChartSecond.getZr().on('click', function (event) {\n                if (!event.target) {\n                    that.initEcharts();\n                    myChart.setOption(that.option)\n                }\n            });\n\n            //点击图表二下钻\n            myChartSecond.on('click', function (params) {\n                console.log(params.name,params.value,params.seriesName);\n\n                //展示列表\n                that.showTabFun()\n            });\n\n        },\n        methods: {\n            initEcharts(){\n                this.optionShow = true;\n                this.optionSecondShow = false;\n                this.tableShow = false;\n                this.option = {\n                    tooltip: {\n                        trigger: 'axis',\n                        axisPointer: {            // Use axis to trigger tooltip\n                            type: 'shadow'        // 'shadow' as default; can also be 'line' or 'shadow'\n                        }\n                    },\n                    legend: {\n                        data: ['项目一', '项目二', '项目三']\n                    },\n                    grid: {\n                        left: '3%',\n                        right: '4%',\n                        bottom: '3%',\n                        containLabel: true\n                    },\n                    xAxis: {\n                        type: 'value'\n                    },\n                    yAxis: {\n                        type: 'category',\n                        data: ['user-center', 'user-auth', 'uaa-gateway', 'crm', 'ims', 'fms', 'cloud-gateway']\n                    },\n                    series: [\n                        {\n                            name: '项目一',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [320, 302, 301, 334, 390, 330, 320]\n                        },\n                        {\n                            name: '项目二',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [120, 132, 101, 134, 90, 230, 210]\n                        },\n                        {\n                            name: '项目三',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [220, 182, 191, 234, 290, 330, 310]\n                        }\n                    ],\n                };\n            },\n            secondShowFun(){\n                this.optionShow = false;\n                this.optionSecondShow = true;\n                this.optionSecond = {\n                    tooltip: {\n                        trigger: 'axis',\n                        axisPointer: {            // Use axis to trigger tooltip\n                            type: 'shadow'        // 'shadow' as default; can also be 'line' or 'shadow'\n                        }\n                    },\n                    legend: {\n                        data: ['分类一','分类二','分类三']\n                    },\n                    grid: {\n                        left: '3%',\n                        right: '4%',\n                        bottom: '3%',\n                        containLabel: true\n                    },\n                    xAxis: {\n                        type: 'value'\n                    },\n                    yAxis: {\n                        type: 'category',\n                        data: ['子项一', '子项二', '子项三']\n                    },\n                    series : [\n                        {\n                            name: '子项一',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [10,2,3]\n                        },\n                        {\n                            name: '子项二',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [1,3,4]\n                        },\n                        {\n                            name: '子项三',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [2,5,6]\n                        },\n                    ],\n                };\n            },\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .dashboard-editor-container {\n        padding: 32px;\n        background-color: rgb(240, 242, 245);\n        position: relative;\n\n    .chart-wrapper {\n        background: #fff;\n        padding: 16px 16px 0;\n        margin-bottom: 32px;\n    }\n    }\n\n    @media (max-width:1024px) {\n        .chart-wrapper {\n            padding: 8px;\n        }\n    }\n</style>\n```\n\n","source":"_posts/frontend/vue.md","raw":"---\ntitle: vue\ndescription: vue\n#top: 1\ndate: 2021-04-28 11:44:02\ntags:\n- vue\ncategories:\n- 前端\n---\n\n### vue+es6接入Echarts\n#### 1.安装\n```shell\n# echars\nnpm install echarts --save\n```\n\n#### 2.实现图表下钻及还原demo\n```textmate\n<template>\n    <div style=\"display: inline-block\" v-show=\"optionShow\" >\n        <div id=\"option\" :style=\"{width: '800px', height: '600px'}\"></div>\n    </div>\n\n    <div style=\"display: inline-block\" v-show=\"optionSecondShow\" >\n        <div id=\"secondOption\" :style=\"{width: '800px', height: '600px'}\"></div>\n    </div>\n</template>\n\n<script>\n    import * as echarts from 'echarts';\n    export default {\n        name: 'dashboard',\n        data() {\n            return {\n                optionShow: true,\n                // echarts报表\n                option: {},\n                optionSecond: {},\n            }\n        },\n        created(){\n        },\n        mounted(){\n            //调用method中方法！！！\n            let that = this;\n\n            //渲染报表一\n            let myChart = echarts.init(document.getElementById('option'))\n            that.initEcharts();\n            myChart.setOption(that.option);\n\n            //报表二\n            let myChartSecond = echarts.init(document.getElementById('secondOption'))\n            //图表一下钻\n            myChart.on('click', function (params) {\n                console.log(params.name,params.value,params.seriesName);\n\n                //重置值\n                that.secondShowFun()\n                myChartSecond.setOption(that.optionSecond)\n            });\n\n            //点击图表二还原数据\n            myChartSecond.getZr().on('click', function (event) {\n                if (!event.target) {\n                    that.initEcharts();\n                    myChart.setOption(that.option)\n                }\n            });\n\n            //点击图表二下钻\n            myChartSecond.on('click', function (params) {\n                console.log(params.name,params.value,params.seriesName);\n\n                //展示列表\n                that.showTabFun()\n            });\n\n        },\n        methods: {\n            initEcharts(){\n                this.optionShow = true;\n                this.optionSecondShow = false;\n                this.tableShow = false;\n                this.option = {\n                    tooltip: {\n                        trigger: 'axis',\n                        axisPointer: {            // Use axis to trigger tooltip\n                            type: 'shadow'        // 'shadow' as default; can also be 'line' or 'shadow'\n                        }\n                    },\n                    legend: {\n                        data: ['项目一', '项目二', '项目三']\n                    },\n                    grid: {\n                        left: '3%',\n                        right: '4%',\n                        bottom: '3%',\n                        containLabel: true\n                    },\n                    xAxis: {\n                        type: 'value'\n                    },\n                    yAxis: {\n                        type: 'category',\n                        data: ['user-center', 'user-auth', 'uaa-gateway', 'crm', 'ims', 'fms', 'cloud-gateway']\n                    },\n                    series: [\n                        {\n                            name: '项目一',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [320, 302, 301, 334, 390, 330, 320]\n                        },\n                        {\n                            name: '项目二',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [120, 132, 101, 134, 90, 230, 210]\n                        },\n                        {\n                            name: '项目三',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true,\n                                valueAnimation: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [220, 182, 191, 234, 290, 330, 310]\n                        }\n                    ],\n                };\n            },\n            secondShowFun(){\n                this.optionShow = false;\n                this.optionSecondShow = true;\n                this.optionSecond = {\n                    tooltip: {\n                        trigger: 'axis',\n                        axisPointer: {            // Use axis to trigger tooltip\n                            type: 'shadow'        // 'shadow' as default; can also be 'line' or 'shadow'\n                        }\n                    },\n                    legend: {\n                        data: ['分类一','分类二','分类三']\n                    },\n                    grid: {\n                        left: '3%',\n                        right: '4%',\n                        bottom: '3%',\n                        containLabel: true\n                    },\n                    xAxis: {\n                        type: 'value'\n                    },\n                    yAxis: {\n                        type: 'category',\n                        data: ['子项一', '子项二', '子项三']\n                    },\n                    series : [\n                        {\n                            name: '子项一',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [10,2,3]\n                        },\n                        {\n                            name: '子项二',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [1,3,4]\n                        },\n                        {\n                            name: '子项三',\n                            type: 'bar',\n                            stack: 'total',\n                            label: {\n                                show: true\n                            },\n                            emphasis: {\n                                focus: 'series'\n                            },\n                            data: [2,5,6]\n                        },\n                    ],\n                };\n            },\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .dashboard-editor-container {\n        padding: 32px;\n        background-color: rgb(240, 242, 245);\n        position: relative;\n\n    .chart-wrapper {\n        background: #fff;\n        padding: 16px 16px 0;\n        margin-bottom: 32px;\n    }\n    }\n\n    @media (max-width:1024px) {\n        .chart-wrapper {\n            padding: 8px;\n        }\n    }\n</style>\n```\n\n","slug":"frontend/vue","published":1,"updated":"2021-07-26T07:53:34.738Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bdj0011fms6czn0ci9v","content":"<h3 id=\"vue-es6接入Echarts\"><a href=\"#vue-es6接入Echarts\" class=\"headerlink\" title=\"vue+es6接入Echarts\"></a>vue+es6接入Echarts</h3><h4 id=\"1-安装\"><a href=\"#1-安装\" class=\"headerlink\" title=\"1.安装\"></a>1.安装</h4><pre><code class=\"shell\"># echars\nnpm install echarts --save</code></pre>\n<h4 id=\"2-实现图表下钻及还原demo\"><a href=\"#2-实现图表下钻及还原demo\" class=\"headerlink\" title=\"2.实现图表下钻及还原demo\"></a>2.实现图表下钻及还原demo</h4><pre><code class=\"textmate\">&lt;template&gt;\n    &lt;div style=&quot;display: inline-block&quot; v-show=&quot;optionShow&quot; &gt;\n        &lt;div id=&quot;option&quot; :style=&quot;&#123;width: &#39;800px&#39;, height: &#39;600px&#39;&#125;&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div style=&quot;display: inline-block&quot; v-show=&quot;optionSecondShow&quot; &gt;\n        &lt;div id=&quot;secondOption&quot; :style=&quot;&#123;width: &#39;800px&#39;, height: &#39;600px&#39;&#125;&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n    import * as echarts from &#39;echarts&#39;;\n    export default &#123;\n        name: &#39;dashboard&#39;,\n        data() &#123;\n            return &#123;\n                optionShow: true,\n                // echarts报表\n                option: &#123;&#125;,\n                optionSecond: &#123;&#125;,\n            &#125;\n        &#125;,\n        created()&#123;\n        &#125;,\n        mounted()&#123;\n            //调用method中方法！！！\n            let that = this;\n\n            //渲染报表一\n            let myChart = echarts.init(document.getElementById(&#39;option&#39;))\n            that.initEcharts();\n            myChart.setOption(that.option);\n\n            //报表二\n            let myChartSecond = echarts.init(document.getElementById(&#39;secondOption&#39;))\n            //图表一下钻\n            myChart.on(&#39;click&#39;, function (params) &#123;\n                console.log(params.name,params.value,params.seriesName);\n\n                //重置值\n                that.secondShowFun()\n                myChartSecond.setOption(that.optionSecond)\n            &#125;);\n\n            //点击图表二还原数据\n            myChartSecond.getZr().on(&#39;click&#39;, function (event) &#123;\n                if (!event.target) &#123;\n                    that.initEcharts();\n                    myChart.setOption(that.option)\n                &#125;\n            &#125;);\n\n            //点击图表二下钻\n            myChartSecond.on(&#39;click&#39;, function (params) &#123;\n                console.log(params.name,params.value,params.seriesName);\n\n                //展示列表\n                that.showTabFun()\n            &#125;);\n\n        &#125;,\n        methods: &#123;\n            initEcharts()&#123;\n                this.optionShow = true;\n                this.optionSecondShow = false;\n                this.tableShow = false;\n                this.option = &#123;\n                    tooltip: &#123;\n                        trigger: &#39;axis&#39;,\n                        axisPointer: &#123;            // Use axis to trigger tooltip\n                            type: &#39;shadow&#39;        // &#39;shadow&#39; as default; can also be &#39;line&#39; or &#39;shadow&#39;\n                        &#125;\n                    &#125;,\n                    legend: &#123;\n                        data: [&#39;项目一&#39;, &#39;项目二&#39;, &#39;项目三&#39;]\n                    &#125;,\n                    grid: &#123;\n                        left: &#39;3%&#39;,\n                        right: &#39;4%&#39;,\n                        bottom: &#39;3%&#39;,\n                        containLabel: true\n                    &#125;,\n                    xAxis: &#123;\n                        type: &#39;value&#39;\n                    &#125;,\n                    yAxis: &#123;\n                        type: &#39;category&#39;,\n                        data: [&#39;user-center&#39;, &#39;user-auth&#39;, &#39;uaa-gateway&#39;, &#39;crm&#39;, &#39;ims&#39;, &#39;fms&#39;, &#39;cloud-gateway&#39;]\n                    &#125;,\n                    series: [\n                        &#123;\n                            name: &#39;项目一&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [320, 302, 301, 334, 390, 330, 320]\n                        &#125;,\n                        &#123;\n                            name: &#39;项目二&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [120, 132, 101, 134, 90, 230, 210]\n                        &#125;,\n                        &#123;\n                            name: &#39;项目三&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [220, 182, 191, 234, 290, 330, 310]\n                        &#125;\n                    ],\n                &#125;;\n            &#125;,\n            secondShowFun()&#123;\n                this.optionShow = false;\n                this.optionSecondShow = true;\n                this.optionSecond = &#123;\n                    tooltip: &#123;\n                        trigger: &#39;axis&#39;,\n                        axisPointer: &#123;            // Use axis to trigger tooltip\n                            type: &#39;shadow&#39;        // &#39;shadow&#39; as default; can also be &#39;line&#39; or &#39;shadow&#39;\n                        &#125;\n                    &#125;,\n                    legend: &#123;\n                        data: [&#39;分类一&#39;,&#39;分类二&#39;,&#39;分类三&#39;]\n                    &#125;,\n                    grid: &#123;\n                        left: &#39;3%&#39;,\n                        right: &#39;4%&#39;,\n                        bottom: &#39;3%&#39;,\n                        containLabel: true\n                    &#125;,\n                    xAxis: &#123;\n                        type: &#39;value&#39;\n                    &#125;,\n                    yAxis: &#123;\n                        type: &#39;category&#39;,\n                        data: [&#39;子项一&#39;, &#39;子项二&#39;, &#39;子项三&#39;]\n                    &#125;,\n                    series : [\n                        &#123;\n                            name: &#39;子项一&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [10,2,3]\n                        &#125;,\n                        &#123;\n                            name: &#39;子项二&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [1,3,4]\n                        &#125;,\n                        &#123;\n                            name: &#39;子项三&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [2,5,6]\n                        &#125;,\n                    ],\n                &#125;;\n            &#125;,\n        &#125;\n    &#125;\n&lt;/script&gt;\n\n&lt;style lang=&quot;scss&quot; scoped&gt;\n    .dashboard-editor-container &#123;\n        padding: 32px;\n        background-color: rgb(240, 242, 245);\n        position: relative;\n\n    .chart-wrapper &#123;\n        background: #fff;\n        padding: 16px 16px 0;\n        margin-bottom: 32px;\n    &#125;\n    &#125;\n\n    @media (max-width:1024px) &#123;\n        .chart-wrapper &#123;\n            padding: 8px;\n        &#125;\n    &#125;\n&lt;/style&gt;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"vue-es6接入Echarts\"><a href=\"#vue-es6接入Echarts\" class=\"headerlink\" title=\"vue+es6接入Echarts\"></a>vue+es6接入Echarts</h3><h4 id=\"1-安装\"><a href=\"#1-安装\" class=\"headerlink\" title=\"1.安装\"></a>1.安装</h4><pre><code class=\"shell\"># echars\nnpm install echarts --save</code></pre>\n<h4 id=\"2-实现图表下钻及还原demo\"><a href=\"#2-实现图表下钻及还原demo\" class=\"headerlink\" title=\"2.实现图表下钻及还原demo\"></a>2.实现图表下钻及还原demo</h4><pre><code class=\"textmate\">&lt;template&gt;\n    &lt;div style=&quot;display: inline-block&quot; v-show=&quot;optionShow&quot; &gt;\n        &lt;div id=&quot;option&quot; :style=&quot;&#123;width: &#39;800px&#39;, height: &#39;600px&#39;&#125;&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;div style=&quot;display: inline-block&quot; v-show=&quot;optionSecondShow&quot; &gt;\n        &lt;div id=&quot;secondOption&quot; :style=&quot;&#123;width: &#39;800px&#39;, height: &#39;600px&#39;&#125;&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n    import * as echarts from &#39;echarts&#39;;\n    export default &#123;\n        name: &#39;dashboard&#39;,\n        data() &#123;\n            return &#123;\n                optionShow: true,\n                // echarts报表\n                option: &#123;&#125;,\n                optionSecond: &#123;&#125;,\n            &#125;\n        &#125;,\n        created()&#123;\n        &#125;,\n        mounted()&#123;\n            //调用method中方法！！！\n            let that = this;\n\n            //渲染报表一\n            let myChart = echarts.init(document.getElementById(&#39;option&#39;))\n            that.initEcharts();\n            myChart.setOption(that.option);\n\n            //报表二\n            let myChartSecond = echarts.init(document.getElementById(&#39;secondOption&#39;))\n            //图表一下钻\n            myChart.on(&#39;click&#39;, function (params) &#123;\n                console.log(params.name,params.value,params.seriesName);\n\n                //重置值\n                that.secondShowFun()\n                myChartSecond.setOption(that.optionSecond)\n            &#125;);\n\n            //点击图表二还原数据\n            myChartSecond.getZr().on(&#39;click&#39;, function (event) &#123;\n                if (!event.target) &#123;\n                    that.initEcharts();\n                    myChart.setOption(that.option)\n                &#125;\n            &#125;);\n\n            //点击图表二下钻\n            myChartSecond.on(&#39;click&#39;, function (params) &#123;\n                console.log(params.name,params.value,params.seriesName);\n\n                //展示列表\n                that.showTabFun()\n            &#125;);\n\n        &#125;,\n        methods: &#123;\n            initEcharts()&#123;\n                this.optionShow = true;\n                this.optionSecondShow = false;\n                this.tableShow = false;\n                this.option = &#123;\n                    tooltip: &#123;\n                        trigger: &#39;axis&#39;,\n                        axisPointer: &#123;            // Use axis to trigger tooltip\n                            type: &#39;shadow&#39;        // &#39;shadow&#39; as default; can also be &#39;line&#39; or &#39;shadow&#39;\n                        &#125;\n                    &#125;,\n                    legend: &#123;\n                        data: [&#39;项目一&#39;, &#39;项目二&#39;, &#39;项目三&#39;]\n                    &#125;,\n                    grid: &#123;\n                        left: &#39;3%&#39;,\n                        right: &#39;4%&#39;,\n                        bottom: &#39;3%&#39;,\n                        containLabel: true\n                    &#125;,\n                    xAxis: &#123;\n                        type: &#39;value&#39;\n                    &#125;,\n                    yAxis: &#123;\n                        type: &#39;category&#39;,\n                        data: [&#39;user-center&#39;, &#39;user-auth&#39;, &#39;uaa-gateway&#39;, &#39;crm&#39;, &#39;ims&#39;, &#39;fms&#39;, &#39;cloud-gateway&#39;]\n                    &#125;,\n                    series: [\n                        &#123;\n                            name: &#39;项目一&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [320, 302, 301, 334, 390, 330, 320]\n                        &#125;,\n                        &#123;\n                            name: &#39;项目二&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [120, 132, 101, 134, 90, 230, 210]\n                        &#125;,\n                        &#123;\n                            name: &#39;项目三&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true,\n                                valueAnimation: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [220, 182, 191, 234, 290, 330, 310]\n                        &#125;\n                    ],\n                &#125;;\n            &#125;,\n            secondShowFun()&#123;\n                this.optionShow = false;\n                this.optionSecondShow = true;\n                this.optionSecond = &#123;\n                    tooltip: &#123;\n                        trigger: &#39;axis&#39;,\n                        axisPointer: &#123;            // Use axis to trigger tooltip\n                            type: &#39;shadow&#39;        // &#39;shadow&#39; as default; can also be &#39;line&#39; or &#39;shadow&#39;\n                        &#125;\n                    &#125;,\n                    legend: &#123;\n                        data: [&#39;分类一&#39;,&#39;分类二&#39;,&#39;分类三&#39;]\n                    &#125;,\n                    grid: &#123;\n                        left: &#39;3%&#39;,\n                        right: &#39;4%&#39;,\n                        bottom: &#39;3%&#39;,\n                        containLabel: true\n                    &#125;,\n                    xAxis: &#123;\n                        type: &#39;value&#39;\n                    &#125;,\n                    yAxis: &#123;\n                        type: &#39;category&#39;,\n                        data: [&#39;子项一&#39;, &#39;子项二&#39;, &#39;子项三&#39;]\n                    &#125;,\n                    series : [\n                        &#123;\n                            name: &#39;子项一&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [10,2,3]\n                        &#125;,\n                        &#123;\n                            name: &#39;子项二&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [1,3,4]\n                        &#125;,\n                        &#123;\n                            name: &#39;子项三&#39;,\n                            type: &#39;bar&#39;,\n                            stack: &#39;total&#39;,\n                            label: &#123;\n                                show: true\n                            &#125;,\n                            emphasis: &#123;\n                                focus: &#39;series&#39;\n                            &#125;,\n                            data: [2,5,6]\n                        &#125;,\n                    ],\n                &#125;;\n            &#125;,\n        &#125;\n    &#125;\n&lt;/script&gt;\n\n&lt;style lang=&quot;scss&quot; scoped&gt;\n    .dashboard-editor-container &#123;\n        padding: 32px;\n        background-color: rgb(240, 242, 245);\n        position: relative;\n\n    .chart-wrapper &#123;\n        background: #fff;\n        padding: 16px 16px 0;\n        margin-bottom: 32px;\n    &#125;\n    &#125;\n\n    @media (max-width:1024px) &#123;\n        .chart-wrapper &#123;\n            padding: 8px;\n        &#125;\n    &#125;\n&lt;/style&gt;</code></pre>\n"},{"title":"测试相关","date":"2021-04-13T03:56:00.300Z","_content":"\n- [JMH-性能优化测试(转)](https://blog.csdn.net/weixin_43767015/article/details/104758415)\n","source":"_posts/test/test.md","raw":"---\ntitle: 测试相关\ndate: 2021-04-13 12:00：00\ntags:\n- test \ncategories:\n- 测试\n---\n\n- [JMH-性能优化测试(转)](https://blog.csdn.net/weixin_43767015/article/details/104758415)\n","slug":"test/test","published":1,"updated":"2021-07-26T07:59:14.178Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bdo0014fms6bpg1b805","content":"<ul>\n<li><a href=\"https://blog.csdn.net/weixin_43767015/article/details/104758415\">JMH-性能优化测试(转)</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://blog.csdn.net/weixin_43767015/article/details/104758415\">JMH-性能优化测试(转)</a></li>\n</ul>\n"},{"title":"互联网常用语记录","description":"常用语记录","date":"2020-11-04T14:31:24.000Z","_content":" \n### 二字动词\n```textmate\n复盘、赋能、沉淀、倒逼、落地、串联、协同、反哺、兼容、\n包装、重组、履约、响应、量化、发力、布局、联动、开拓、\n细分、梳理、输出、加速、共建、支撑、融合、聚合、解耦、\n集成、对齐、对标、对焦、抓手、拆解、拉通、抽象、摸索、\n提炼、打通、打透、吃透、迁移、分发、分层、分装、穿梭、\n辐射、围绕、复用、渗透、扩展、\n```\n\n### 二字名词\n```textmate\n漏斗、中台、闭环、打法、拉通、纽带、矩阵、刺激、\n规模、场景、聚焦、维度、格局、形态、生态、话术、\n体系、认知、玩法、体感、感知、调性、心智、战役、\n合力、心力、赛道、因子、模型、载体、横向、通道、\n补位、链路、试点\n```\n\n### 三字名词\n```textmate\n颗粒度、感知度、方法论、组合拳、引爆点、点线面、\n精细化、差异化、平台化、结构化、影响力、耦合性、\n易用性、一致性、端到端、短平快\n```\n\n### 四字名词\n```textmate\n生命周期、价值转化、强化认知、资源倾斜、完善逻辑、\n抽离透传、复用打法、商业价值、商业模式、快速响应、\n定性定量、关键链路、去中心化、结果导向、垂直领域、\n如何收口、归因分析、体验度量、信息屏障\n```\n\n\n\n\n\n","source":"_posts/thinking/ali-words.md","raw":"---\ntitle: 互联网常用语记录\ndescription: 常用语记录\ndate: 2020-11-04 22:31:24\ntags: 常用语\ncategories:\n- 思考\n---\n \n### 二字动词\n```textmate\n复盘、赋能、沉淀、倒逼、落地、串联、协同、反哺、兼容、\n包装、重组、履约、响应、量化、发力、布局、联动、开拓、\n细分、梳理、输出、加速、共建、支撑、融合、聚合、解耦、\n集成、对齐、对标、对焦、抓手、拆解、拉通、抽象、摸索、\n提炼、打通、打透、吃透、迁移、分发、分层、分装、穿梭、\n辐射、围绕、复用、渗透、扩展、\n```\n\n### 二字名词\n```textmate\n漏斗、中台、闭环、打法、拉通、纽带、矩阵、刺激、\n规模、场景、聚焦、维度、格局、形态、生态、话术、\n体系、认知、玩法、体感、感知、调性、心智、战役、\n合力、心力、赛道、因子、模型、载体、横向、通道、\n补位、链路、试点\n```\n\n### 三字名词\n```textmate\n颗粒度、感知度、方法论、组合拳、引爆点、点线面、\n精细化、差异化、平台化、结构化、影响力、耦合性、\n易用性、一致性、端到端、短平快\n```\n\n### 四字名词\n```textmate\n生命周期、价值转化、强化认知、资源倾斜、完善逻辑、\n抽离透传、复用打法、商业价值、商业模式、快速响应、\n定性定量、关键链路、去中心化、结果导向、垂直领域、\n如何收口、归因分析、体验度量、信息屏障\n```\n\n\n\n\n\n","slug":"thinking/ali-words","published":1,"updated":"2021-07-26T07:59:14.126Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bdz0017fms6cwevh2r6","content":"<h3 id=\"二字动词\"><a href=\"#二字动词\" class=\"headerlink\" title=\"二字动词\"></a>二字动词</h3><pre><code class=\"textmate\">复盘、赋能、沉淀、倒逼、落地、串联、协同、反哺、兼容、\n包装、重组、履约、响应、量化、发力、布局、联动、开拓、\n细分、梳理、输出、加速、共建、支撑、融合、聚合、解耦、\n集成、对齐、对标、对焦、抓手、拆解、拉通、抽象、摸索、\n提炼、打通、打透、吃透、迁移、分发、分层、分装、穿梭、\n辐射、围绕、复用、渗透、扩展、</code></pre>\n<h3 id=\"二字名词\"><a href=\"#二字名词\" class=\"headerlink\" title=\"二字名词\"></a>二字名词</h3><pre><code class=\"textmate\">漏斗、中台、闭环、打法、拉通、纽带、矩阵、刺激、\n规模、场景、聚焦、维度、格局、形态、生态、话术、\n体系、认知、玩法、体感、感知、调性、心智、战役、\n合力、心力、赛道、因子、模型、载体、横向、通道、\n补位、链路、试点</code></pre>\n<h3 id=\"三字名词\"><a href=\"#三字名词\" class=\"headerlink\" title=\"三字名词\"></a>三字名词</h3><pre><code class=\"textmate\">颗粒度、感知度、方法论、组合拳、引爆点、点线面、\n精细化、差异化、平台化、结构化、影响力、耦合性、\n易用性、一致性、端到端、短平快</code></pre>\n<h3 id=\"四字名词\"><a href=\"#四字名词\" class=\"headerlink\" title=\"四字名词\"></a>四字名词</h3><pre><code class=\"textmate\">生命周期、价值转化、强化认知、资源倾斜、完善逻辑、\n抽离透传、复用打法、商业价值、商业模式、快速响应、\n定性定量、关键链路、去中心化、结果导向、垂直领域、\n如何收口、归因分析、体验度量、信息屏障</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"二字动词\"><a href=\"#二字动词\" class=\"headerlink\" title=\"二字动词\"></a>二字动词</h3><pre><code class=\"textmate\">复盘、赋能、沉淀、倒逼、落地、串联、协同、反哺、兼容、\n包装、重组、履约、响应、量化、发力、布局、联动、开拓、\n细分、梳理、输出、加速、共建、支撑、融合、聚合、解耦、\n集成、对齐、对标、对焦、抓手、拆解、拉通、抽象、摸索、\n提炼、打通、打透、吃透、迁移、分发、分层、分装、穿梭、\n辐射、围绕、复用、渗透、扩展、</code></pre>\n<h3 id=\"二字名词\"><a href=\"#二字名词\" class=\"headerlink\" title=\"二字名词\"></a>二字名词</h3><pre><code class=\"textmate\">漏斗、中台、闭环、打法、拉通、纽带、矩阵、刺激、\n规模、场景、聚焦、维度、格局、形态、生态、话术、\n体系、认知、玩法、体感、感知、调性、心智、战役、\n合力、心力、赛道、因子、模型、载体、横向、通道、\n补位、链路、试点</code></pre>\n<h3 id=\"三字名词\"><a href=\"#三字名词\" class=\"headerlink\" title=\"三字名词\"></a>三字名词</h3><pre><code class=\"textmate\">颗粒度、感知度、方法论、组合拳、引爆点、点线面、\n精细化、差异化、平台化、结构化、影响力、耦合性、\n易用性、一致性、端到端、短平快</code></pre>\n<h3 id=\"四字名词\"><a href=\"#四字名词\" class=\"headerlink\" title=\"四字名词\"></a>四字名词</h3><pre><code class=\"textmate\">生命周期、价值转化、强化认知、资源倾斜、完善逻辑、\n抽离透传、复用打法、商业价值、商业模式、快速响应、\n定性定量、关键链路、去中心化、结果导向、垂直领域、\n如何收口、归因分析、体验度量、信息屏障</code></pre>\n"},{"title":"阅读","description":"思考 阅读","date":"2020-10-02T06:44:10.000Z","_content":"\n### 技术书\n- 计算机基础\n\n|分类|书名|作者|\n|---|---|---|\n|操作系统|《现代操作系统》||\n| |《程序员的自我修养：链接、装载与库》||\n| |《操作系统真象还原》||\n| |《Linux 内核设计与实现》||\n| |《Windows 程序设计》第五版|\n|计算机网络|《计算机网络：自顶向下方法》||\n| |《TCP/IP 网络编程》||\n| |《网络是怎样连接的》||\n| |《图解HTTP》|上野宣|\n| |《HTTP权威指南》||\n|编译原理|《编译系统透视：图解编译原理》||\n|计算机组成|《计算机组成与设计：硬件软件接口》||\n\n- 综合\n  《Netty、Zookeeper、Redis高并发实战》\n\n- 语言\n\n|分类|书名|\n|---|---|\n|Java|《Java 核心技术》|\n| |《Effective Java》|\n| |《Java 编程思想》|\n| |《深入理解 Java 虚拟机》|\n| |《Java 并发编程实战》|\n\n### 思考方式\n- [结构化思维](https://www.toutiao.com/i6619057728725729800/)\n","source":"_posts/thinking/book.md","raw":"---\ntitle: 阅读\ndescription: 思考 阅读\ndate: 2020-10-02 14:44:10\ntags:\n- 思维\ncategories:\n- 思考\n---\n\n### 技术书\n- 计算机基础\n\n|分类|书名|作者|\n|---|---|---|\n|操作系统|《现代操作系统》||\n| |《程序员的自我修养：链接、装载与库》||\n| |《操作系统真象还原》||\n| |《Linux 内核设计与实现》||\n| |《Windows 程序设计》第五版|\n|计算机网络|《计算机网络：自顶向下方法》||\n| |《TCP/IP 网络编程》||\n| |《网络是怎样连接的》||\n| |《图解HTTP》|上野宣|\n| |《HTTP权威指南》||\n|编译原理|《编译系统透视：图解编译原理》||\n|计算机组成|《计算机组成与设计：硬件软件接口》||\n\n- 综合\n  《Netty、Zookeeper、Redis高并发实战》\n\n- 语言\n\n|分类|书名|\n|---|---|\n|Java|《Java 核心技术》|\n| |《Effective Java》|\n| |《Java 编程思想》|\n| |《深入理解 Java 虚拟机》|\n| |《Java 并发编程实战》|\n\n### 思考方式\n- [结构化思维](https://www.toutiao.com/i6619057728725729800/)\n","slug":"thinking/book","published":1,"updated":"2021-09-10T02:20:11.232Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3be0001bfms69ehy9w6i","content":"<h3 id=\"技术书\"><a href=\"#技术书\" class=\"headerlink\" title=\"技术书\"></a>技术书</h3><ul>\n<li>计算机基础</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>分类</th>\n<th>书名</th>\n<th>作者</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>操作系统</td>\n<td>《现代操作系统》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《程序员的自我修养：链接、装载与库》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《操作系统真象还原》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《Linux 内核设计与实现》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《Windows 程序设计》第五版</td>\n<td></td>\n</tr>\n<tr>\n<td>计算机网络</td>\n<td>《计算机网络：自顶向下方法》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《TCP/IP 网络编程》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《网络是怎样连接的》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《图解HTTP》</td>\n<td>上野宣</td>\n</tr>\n<tr>\n<td></td>\n<td>《HTTP权威指南》</td>\n<td></td>\n</tr>\n<tr>\n<td>编译原理</td>\n<td>《编译系统透视：图解编译原理》</td>\n<td></td>\n</tr>\n<tr>\n<td>计算机组成</td>\n<td>《计算机组成与设计：硬件软件接口》</td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li><p>综合<br>《Netty、Zookeeper、Redis高并发实战》</p>\n</li>\n<li><p>语言</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>分类</th>\n<th>书名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Java</td>\n<td>《Java 核心技术》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Effective Java》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Java 编程思想》</td>\n</tr>\n<tr>\n<td></td>\n<td>《深入理解 Java 虚拟机》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Java 并发编程实战》</td>\n</tr>\n</tbody></table>\n<h3 id=\"思考方式\"><a href=\"#思考方式\" class=\"headerlink\" title=\"思考方式\"></a>思考方式</h3><ul>\n<li><a href=\"https://www.toutiao.com/i6619057728725729800/\">结构化思维</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"技术书\"><a href=\"#技术书\" class=\"headerlink\" title=\"技术书\"></a>技术书</h3><ul>\n<li>计算机基础</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>分类</th>\n<th>书名</th>\n<th>作者</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>操作系统</td>\n<td>《现代操作系统》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《程序员的自我修养：链接、装载与库》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《操作系统真象还原》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《Linux 内核设计与实现》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《Windows 程序设计》第五版</td>\n<td></td>\n</tr>\n<tr>\n<td>计算机网络</td>\n<td>《计算机网络：自顶向下方法》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《TCP/IP 网络编程》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《网络是怎样连接的》</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>《图解HTTP》</td>\n<td>上野宣</td>\n</tr>\n<tr>\n<td></td>\n<td>《HTTP权威指南》</td>\n<td></td>\n</tr>\n<tr>\n<td>编译原理</td>\n<td>《编译系统透视：图解编译原理》</td>\n<td></td>\n</tr>\n<tr>\n<td>计算机组成</td>\n<td>《计算机组成与设计：硬件软件接口》</td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li><p>综合<br>《Netty、Zookeeper、Redis高并发实战》</p>\n</li>\n<li><p>语言</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>分类</th>\n<th>书名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Java</td>\n<td>《Java 核心技术》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Effective Java》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Java 编程思想》</td>\n</tr>\n<tr>\n<td></td>\n<td>《深入理解 Java 虚拟机》</td>\n</tr>\n<tr>\n<td></td>\n<td>《Java 并发编程实战》</td>\n</tr>\n</tbody></table>\n<h3 id=\"思考方式\"><a href=\"#思考方式\" class=\"headerlink\" title=\"思考方式\"></a>思考方式</h3><ul>\n<li><a href=\"https://www.toutiao.com/i6619057728725729800/\">结构化思维</a></li>\n</ul>\n"},{"title":"SpringBoot集成Kafka","date":"2021-02-03T08:06:00.000Z","_content":"\n### 简单案例\n#### 引用包\n```xml\n<!-- 设置了版本号，有可能会报错ClassNotFound -->\n<dependency>\n    <groupId>org.springframework.kafka</groupId>\n    <artifactId>spring-kafka</artifactId>\n</dependency>\n```\n\n#### 配置\n```yaml\nspring:\n  kafka:\n  topic: testTopic\n  bootstrap-servers: 127.0.0.1:9092\n  producer:\n    retries: 0\n    batch-size: 50\n    buffer-memory: 6554432\n    key-serializer: org.apache.kafka.common.serialization.StringSerializer\n    value-serializer: org.apache.kafka.common.serialization.StringSerializer\n    properties:\n      max:\n        request:\n          size: 5242880\n      linger.ms: 1\n```\n\n#### 发送消息\n```java\n@Slf4j\n@Component\npublic class MessageService{\n    \n    @Autowired\n    private KafkaTemplate kafkaTemplate;\n    @Value(\"${spring.kafka.topic}\")\n    private String topics;\n    \n    public void sendSyncMessage(String resourceName){\n        try{\n            kafkaTemplate.send(topics,resourceName);\n        } catch (Exception e) {\n            log.error(\"message send failed, error={}\", e);\n        }\n    }\n}\n```\n\n#### 监听消息\n```java\n@Slf4j\n@Component\npublic class MessageListener {\n\n    @KafkaListener(topics = {\"testTopic\"}, groupId = \"testGroupId\")\n    public void annul1(ConsumerRecord<String, String> record) {\n        log.info(\"groupId = myContainer2, message = \" + record.toString());\n    }\n}\n```\n\n### 双kafka案例\n- [SpringBoot多kafka配置](https://www.byteblogs.com/article/434)\n#### 配置文件\n```yaml\nspring:\n  kafka:\n    kafka1:\n      bootstrap-servers: 127.0.0.1:9092\n      producer:\n        retries: 0\n        batch-size: 50\n        buffer-memory: 6554432\n        key-serializer: org.apache.kafka.common.serialization.StringSerializer\n        value-serializer: org.apache.kafka.common.serialization.StringSerializer\n        properties:\n          max:\n            request:\n              size: 5242880\n          linger.ms: 1\n    kafka2:\n      bootstrap-servers: 127.0.0.1:9092\n      producer:\n        retries: 0\n        batch-size: 50\n        buffer-memory: 6554432\n        key-serializer: org.apache.kafka.common.serialization.StringSerializer\n        value-serializer: org.apache.kafka.common.serialization.StringSerializer\n        properties:\n          max:\n            request:\n              size: 5242880\n          linger.ms: 1\n```\n\n#### 代码配置\n- 实例1配置\n```java\n@Configuration\n@EnableKafka\npublic class Kafka1Config {\n\n    @Bean(\"kafka1ExtListenerKafkaProperties\")\n    @Primary\n    @ConfigurationProperties(prefix = \"spring.kafka.kafka1\")\n    public KafkaProperties kafka1ExtListenerKafkaProperties() {\n        return new KafkaProperties();\n    }\n\n    @Bean(\"kafka1ListenerContainerFactory\")\n    @Primary\n    KafkaListenerContainerFactory<ConcurrentMessageListenerContainer<Integer, String>> kafkaListenerContainerFactory() {\n        ConcurrentKafkaListenerContainerFactory<Integer, String> factory = new ConcurrentKafkaListenerContainerFactory<>();\n        factory.setConsumerFactory(consumerFactory());\n        factory.setConcurrency(3);\n        factory.getContainerProperties().setPollTimeout(3000);\n        return factory;\n    }\n\n    private ConsumerFactory<Integer, String> consumerFactory() {\n        return new DefaultKafkaConsumerFactory<>(consumerConfigs());\n    }\n\n    private Map<String, Object> consumerConfigs() {\n        return kafka1ExtListenerKafkaProperties().buildConsumerProperties();\n    }\n\n    @Bean(\"kafkaTemplate\")\n    @Primary\n    public KafkaTemplate<String, String> kafkaTemplate() {\n        return new KafkaTemplate<>(producerFactory());\n    }\n\n    private ProducerFactory<String, String> producerFactory() {\n        DefaultKafkaProducerFactory<String, String> producerFactory = new DefaultKafkaProducerFactory<>(producerConfigs());\n        return producerFactory;\n    }\n\n    private Map<String, Object> producerConfigs() {\n        return kafka1ExtListenerKafkaProperties().buildProducerProperties();\n    }\n}\n```\n\n- 实例2配置\n```java\n@Configuration\n@EnableKafka\npublic class Kafka2Config {\n\n    @Bean(\"kafka2ListenerKafkaProperties\")\n    @ConfigurationProperties(prefix = \"spring.kafka.kafka2\")\n    public KafkaProperties kafka2ListenerKafkaProperties() {\n        return new KafkaProperties();\n    }\n\n    @Bean(\"kafka2ListenerContainerFactory\")\n    public KafkaListenerContainerFactory<ConcurrentMessageListenerContainer<Integer, String>> kafka2ListenerContainerFactory() {\n        ConcurrentKafkaListenerContainerFactory<Integer, String> factory = new ConcurrentKafkaListenerContainerFactory<>();\n        factory.setConsumerFactory(consumerFactory());\n        factory.setConcurrency(3);\n        factory.getContainerProperties().setPollTimeout(3000);\n        return factory;\n    }\n\n    /**\n     * 消费者工厂的bean\n     *\n     * @return\n     */\n    private ConsumerFactory<Integer, String> consumerFactory() {\n        return new DefaultKafkaConsumerFactory<>(consumerConfigs());\n    }\n\n    private Map<String, Object> consumerConfigs() {\n        return kafka2ListenerKafkaProperties().buildConsumerProperties();\n    }\n\n    @Bean(\"kafka2Template\")\n    public KafkaTemplate<String, String> kafka2Template() {\n        return new KafkaTemplate<>(producerFactory());\n    }\n\n    private ProducerFactory<String, String> producerFactory() {\n        DefaultKafkaProducerFactory<String, String> producerFactory = new DefaultKafkaProducerFactory<>(producerConfigs());\n        return producerFactory;\n    }\n\n    private Map<String, Object> producerConfigs() {\n        return kafka2ListenerKafkaProperties().buildProducerProperties();\n    }\n}\n```\n\n#### 使用\n```java\n@Slf4j\n@Service\npublic class MessageSendService{\n    @Resource(name = \"kafkaTemplate\")\n    private KafkaTemplate<String, Object> kafkaTemplate;\n\n    @Resource(name = \"kafkaTemplateForMonitor\")\n    private KafkaTemplate<String, Object> kafkaTemplateForMonitor;\n\n    public boolean kafka1Send(String topic, String message) {\n        try {\n            if (kafkaMq) {\n                kafkaTemplate.send(topic, message);\n            }\n        } catch (Exception e) {\n            log.warn(\"kafka1 发送kafka消息失败 topic={},error={}\",topic,e);\n        }\n        return true;\n    }\n    \n    public boolean kafka2Send(String topic, String message){\n        try {\n            kafkaTemplateForMonitor.send(topic, message);\n        } catch (Exception e) {\n            log.warn(\"kafka2 发送kafka消息失败 topic={},error={}\",topic,e);\n        }\n        return true;\n    }\n}\n```\n","source":"_posts/backend/mq/kafka.md","raw":"---\ntitle: SpringBoot集成Kafka\ndate: 2021-02-03 16:06:00\ntags:\n- message\n- kafka\n\ncategories:\n- 后端\n- 消息队列\n---\n\n### 简单案例\n#### 引用包\n```xml\n<!-- 设置了版本号，有可能会报错ClassNotFound -->\n<dependency>\n    <groupId>org.springframework.kafka</groupId>\n    <artifactId>spring-kafka</artifactId>\n</dependency>\n```\n\n#### 配置\n```yaml\nspring:\n  kafka:\n  topic: testTopic\n  bootstrap-servers: 127.0.0.1:9092\n  producer:\n    retries: 0\n    batch-size: 50\n    buffer-memory: 6554432\n    key-serializer: org.apache.kafka.common.serialization.StringSerializer\n    value-serializer: org.apache.kafka.common.serialization.StringSerializer\n    properties:\n      max:\n        request:\n          size: 5242880\n      linger.ms: 1\n```\n\n#### 发送消息\n```java\n@Slf4j\n@Component\npublic class MessageService{\n    \n    @Autowired\n    private KafkaTemplate kafkaTemplate;\n    @Value(\"${spring.kafka.topic}\")\n    private String topics;\n    \n    public void sendSyncMessage(String resourceName){\n        try{\n            kafkaTemplate.send(topics,resourceName);\n        } catch (Exception e) {\n            log.error(\"message send failed, error={}\", e);\n        }\n    }\n}\n```\n\n#### 监听消息\n```java\n@Slf4j\n@Component\npublic class MessageListener {\n\n    @KafkaListener(topics = {\"testTopic\"}, groupId = \"testGroupId\")\n    public void annul1(ConsumerRecord<String, String> record) {\n        log.info(\"groupId = myContainer2, message = \" + record.toString());\n    }\n}\n```\n\n### 双kafka案例\n- [SpringBoot多kafka配置](https://www.byteblogs.com/article/434)\n#### 配置文件\n```yaml\nspring:\n  kafka:\n    kafka1:\n      bootstrap-servers: 127.0.0.1:9092\n      producer:\n        retries: 0\n        batch-size: 50\n        buffer-memory: 6554432\n        key-serializer: org.apache.kafka.common.serialization.StringSerializer\n        value-serializer: org.apache.kafka.common.serialization.StringSerializer\n        properties:\n          max:\n            request:\n              size: 5242880\n          linger.ms: 1\n    kafka2:\n      bootstrap-servers: 127.0.0.1:9092\n      producer:\n        retries: 0\n        batch-size: 50\n        buffer-memory: 6554432\n        key-serializer: org.apache.kafka.common.serialization.StringSerializer\n        value-serializer: org.apache.kafka.common.serialization.StringSerializer\n        properties:\n          max:\n            request:\n              size: 5242880\n          linger.ms: 1\n```\n\n#### 代码配置\n- 实例1配置\n```java\n@Configuration\n@EnableKafka\npublic class Kafka1Config {\n\n    @Bean(\"kafka1ExtListenerKafkaProperties\")\n    @Primary\n    @ConfigurationProperties(prefix = \"spring.kafka.kafka1\")\n    public KafkaProperties kafka1ExtListenerKafkaProperties() {\n        return new KafkaProperties();\n    }\n\n    @Bean(\"kafka1ListenerContainerFactory\")\n    @Primary\n    KafkaListenerContainerFactory<ConcurrentMessageListenerContainer<Integer, String>> kafkaListenerContainerFactory() {\n        ConcurrentKafkaListenerContainerFactory<Integer, String> factory = new ConcurrentKafkaListenerContainerFactory<>();\n        factory.setConsumerFactory(consumerFactory());\n        factory.setConcurrency(3);\n        factory.getContainerProperties().setPollTimeout(3000);\n        return factory;\n    }\n\n    private ConsumerFactory<Integer, String> consumerFactory() {\n        return new DefaultKafkaConsumerFactory<>(consumerConfigs());\n    }\n\n    private Map<String, Object> consumerConfigs() {\n        return kafka1ExtListenerKafkaProperties().buildConsumerProperties();\n    }\n\n    @Bean(\"kafkaTemplate\")\n    @Primary\n    public KafkaTemplate<String, String> kafkaTemplate() {\n        return new KafkaTemplate<>(producerFactory());\n    }\n\n    private ProducerFactory<String, String> producerFactory() {\n        DefaultKafkaProducerFactory<String, String> producerFactory = new DefaultKafkaProducerFactory<>(producerConfigs());\n        return producerFactory;\n    }\n\n    private Map<String, Object> producerConfigs() {\n        return kafka1ExtListenerKafkaProperties().buildProducerProperties();\n    }\n}\n```\n\n- 实例2配置\n```java\n@Configuration\n@EnableKafka\npublic class Kafka2Config {\n\n    @Bean(\"kafka2ListenerKafkaProperties\")\n    @ConfigurationProperties(prefix = \"spring.kafka.kafka2\")\n    public KafkaProperties kafka2ListenerKafkaProperties() {\n        return new KafkaProperties();\n    }\n\n    @Bean(\"kafka2ListenerContainerFactory\")\n    public KafkaListenerContainerFactory<ConcurrentMessageListenerContainer<Integer, String>> kafka2ListenerContainerFactory() {\n        ConcurrentKafkaListenerContainerFactory<Integer, String> factory = new ConcurrentKafkaListenerContainerFactory<>();\n        factory.setConsumerFactory(consumerFactory());\n        factory.setConcurrency(3);\n        factory.getContainerProperties().setPollTimeout(3000);\n        return factory;\n    }\n\n    /**\n     * 消费者工厂的bean\n     *\n     * @return\n     */\n    private ConsumerFactory<Integer, String> consumerFactory() {\n        return new DefaultKafkaConsumerFactory<>(consumerConfigs());\n    }\n\n    private Map<String, Object> consumerConfigs() {\n        return kafka2ListenerKafkaProperties().buildConsumerProperties();\n    }\n\n    @Bean(\"kafka2Template\")\n    public KafkaTemplate<String, String> kafka2Template() {\n        return new KafkaTemplate<>(producerFactory());\n    }\n\n    private ProducerFactory<String, String> producerFactory() {\n        DefaultKafkaProducerFactory<String, String> producerFactory = new DefaultKafkaProducerFactory<>(producerConfigs());\n        return producerFactory;\n    }\n\n    private Map<String, Object> producerConfigs() {\n        return kafka2ListenerKafkaProperties().buildProducerProperties();\n    }\n}\n```\n\n#### 使用\n```java\n@Slf4j\n@Service\npublic class MessageSendService{\n    @Resource(name = \"kafkaTemplate\")\n    private KafkaTemplate<String, Object> kafkaTemplate;\n\n    @Resource(name = \"kafkaTemplateForMonitor\")\n    private KafkaTemplate<String, Object> kafkaTemplateForMonitor;\n\n    public boolean kafka1Send(String topic, String message) {\n        try {\n            if (kafkaMq) {\n                kafkaTemplate.send(topic, message);\n            }\n        } catch (Exception e) {\n            log.warn(\"kafka1 发送kafka消息失败 topic={},error={}\",topic,e);\n        }\n        return true;\n    }\n    \n    public boolean kafka2Send(String topic, String message){\n        try {\n            kafkaTemplateForMonitor.send(topic, message);\n        } catch (Exception e) {\n            log.warn(\"kafka2 发送kafka消息失败 topic={},error={}\",topic,e);\n        }\n        return true;\n    }\n}\n```\n","slug":"backend/mq/kafka","published":1,"updated":"2021-08-19T01:37:57.007Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3be2001dfms61wgq2efr","content":"<h3 id=\"简单案例\"><a href=\"#简单案例\" class=\"headerlink\" title=\"简单案例\"></a>简单案例</h3><h4 id=\"引用包\"><a href=\"#引用包\" class=\"headerlink\" title=\"引用包\"></a>引用包</h4><pre><code class=\"xml\">&lt;!-- 设置了版本号，有可能会报错ClassNotFound --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;\n&lt;/dependency&gt;</code></pre>\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><pre><code class=\"yaml\">spring:\n  kafka:\n  topic: testTopic\n  bootstrap-servers: 127.0.0.1:9092\n  producer:\n    retries: 0\n    batch-size: 50\n    buffer-memory: 6554432\n    key-serializer: org.apache.kafka.common.serialization.StringSerializer\n    value-serializer: org.apache.kafka.common.serialization.StringSerializer\n    properties:\n      max:\n        request:\n          size: 5242880\n      linger.ms: 1</code></pre>\n<h4 id=\"发送消息\"><a href=\"#发送消息\" class=\"headerlink\" title=\"发送消息\"></a>发送消息</h4><pre><code class=\"java\">@Slf4j\n@Component\npublic class MessageService&#123;\n\n    @Autowired\n    private KafkaTemplate kafkaTemplate;\n    @Value(&quot;$&#123;spring.kafka.topic&#125;&quot;)\n    private String topics;\n\n    public void sendSyncMessage(String resourceName)&#123;\n        try&#123;\n            kafkaTemplate.send(topics,resourceName);\n        &#125; catch (Exception e) &#123;\n            log.error(&quot;message send failed, error=&#123;&#125;&quot;, e);\n        &#125;\n    &#125;\n&#125;</code></pre>\n<h4 id=\"监听消息\"><a href=\"#监听消息\" class=\"headerlink\" title=\"监听消息\"></a>监听消息</h4><pre><code class=\"java\">@Slf4j\n@Component\npublic class MessageListener &#123;\n\n    @KafkaListener(topics = &#123;&quot;testTopic&quot;&#125;, groupId = &quot;testGroupId&quot;)\n    public void annul1(ConsumerRecord&lt;String, String&gt; record) &#123;\n        log.info(&quot;groupId = myContainer2, message = &quot; + record.toString());\n    &#125;\n&#125;</code></pre>\n<h3 id=\"双kafka案例\"><a href=\"#双kafka案例\" class=\"headerlink\" title=\"双kafka案例\"></a>双kafka案例</h3><ul>\n<li><a href=\"https://www.byteblogs.com/article/434\">SpringBoot多kafka配置</a><h4 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h4><pre><code class=\"yaml\">spring:\nkafka:\n  kafka1:\n    bootstrap-servers: 127.0.0.1:9092\n    producer:\n      retries: 0\n      batch-size: 50\n      buffer-memory: 6554432\n      key-serializer: org.apache.kafka.common.serialization.StringSerializer\n      value-serializer: org.apache.kafka.common.serialization.StringSerializer\n      properties:\n        max:\n          request:\n            size: 5242880\n        linger.ms: 1\n  kafka2:\n    bootstrap-servers: 127.0.0.1:9092\n    producer:\n      retries: 0\n      batch-size: 50\n      buffer-memory: 6554432\n      key-serializer: org.apache.kafka.common.serialization.StringSerializer\n      value-serializer: org.apache.kafka.common.serialization.StringSerializer\n      properties:\n        max:\n          request:\n            size: 5242880\n        linger.ms: 1</code></pre>\n</li>\n</ul>\n<h4 id=\"代码配置\"><a href=\"#代码配置\" class=\"headerlink\" title=\"代码配置\"></a>代码配置</h4><ul>\n<li><p>实例1配置</p>\n<pre><code class=\"java\">@Configuration\n@EnableKafka\npublic class Kafka1Config &#123;\n\n  @Bean(&quot;kafka1ExtListenerKafkaProperties&quot;)\n  @Primary\n  @ConfigurationProperties(prefix = &quot;spring.kafka.kafka1&quot;)\n  public KafkaProperties kafka1ExtListenerKafkaProperties() &#123;\n      return new KafkaProperties();\n  &#125;\n\n  @Bean(&quot;kafka1ListenerContainerFactory&quot;)\n  @Primary\n  KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;Integer, String&gt;&gt; kafkaListenerContainerFactory() &#123;\n      ConcurrentKafkaListenerContainerFactory&lt;Integer, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;();\n      factory.setConsumerFactory(consumerFactory());\n      factory.setConcurrency(3);\n      factory.getContainerProperties().setPollTimeout(3000);\n      return factory;\n  &#125;\n\n  private ConsumerFactory&lt;Integer, String&gt; consumerFactory() &#123;\n      return new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs());\n  &#125;\n\n  private Map&lt;String, Object&gt; consumerConfigs() &#123;\n      return kafka1ExtListenerKafkaProperties().buildConsumerProperties();\n  &#125;\n\n  @Bean(&quot;kafkaTemplate&quot;)\n  @Primary\n  public KafkaTemplate&lt;String, String&gt; kafkaTemplate() &#123;\n      return new KafkaTemplate&lt;&gt;(producerFactory());\n  &#125;\n\n  private ProducerFactory&lt;String, String&gt; producerFactory() &#123;\n      DefaultKafkaProducerFactory&lt;String, String&gt; producerFactory = new DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());\n      return producerFactory;\n  &#125;\n\n  private Map&lt;String, Object&gt; producerConfigs() &#123;\n      return kafka1ExtListenerKafkaProperties().buildProducerProperties();\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>实例2配置</p>\n<pre><code class=\"java\">@Configuration\n@EnableKafka\npublic class Kafka2Config &#123;\n\n  @Bean(&quot;kafka2ListenerKafkaProperties&quot;)\n  @ConfigurationProperties(prefix = &quot;spring.kafka.kafka2&quot;)\n  public KafkaProperties kafka2ListenerKafkaProperties() &#123;\n      return new KafkaProperties();\n  &#125;\n\n  @Bean(&quot;kafka2ListenerContainerFactory&quot;)\n  public KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;Integer, String&gt;&gt; kafka2ListenerContainerFactory() &#123;\n      ConcurrentKafkaListenerContainerFactory&lt;Integer, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;();\n      factory.setConsumerFactory(consumerFactory());\n      factory.setConcurrency(3);\n      factory.getContainerProperties().setPollTimeout(3000);\n      return factory;\n  &#125;\n\n  /**\n   * 消费者工厂的bean\n   *\n   * @return\n   */\n  private ConsumerFactory&lt;Integer, String&gt; consumerFactory() &#123;\n      return new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs());\n  &#125;\n\n  private Map&lt;String, Object&gt; consumerConfigs() &#123;\n      return kafka2ListenerKafkaProperties().buildConsumerProperties();\n  &#125;\n\n  @Bean(&quot;kafka2Template&quot;)\n  public KafkaTemplate&lt;String, String&gt; kafka2Template() &#123;\n      return new KafkaTemplate&lt;&gt;(producerFactory());\n  &#125;\n\n  private ProducerFactory&lt;String, String&gt; producerFactory() &#123;\n      DefaultKafkaProducerFactory&lt;String, String&gt; producerFactory = new DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());\n      return producerFactory;\n  &#125;\n\n  private Map&lt;String, Object&gt; producerConfigs() &#123;\n      return kafka2ListenerKafkaProperties().buildProducerProperties();\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h4><pre><code class=\"java\">@Slf4j\n@Service\npublic class MessageSendService&#123;\n    @Resource(name = &quot;kafkaTemplate&quot;)\n    private KafkaTemplate&lt;String, Object&gt; kafkaTemplate;\n\n    @Resource(name = &quot;kafkaTemplateForMonitor&quot;)\n    private KafkaTemplate&lt;String, Object&gt; kafkaTemplateForMonitor;\n\n    public boolean kafka1Send(String topic, String message) &#123;\n        try &#123;\n            if (kafkaMq) &#123;\n                kafkaTemplate.send(topic, message);\n            &#125;\n        &#125; catch (Exception e) &#123;\n            log.warn(&quot;kafka1 发送kafka消息失败 topic=&#123;&#125;,error=&#123;&#125;&quot;,topic,e);\n        &#125;\n        return true;\n    &#125;\n\n    public boolean kafka2Send(String topic, String message)&#123;\n        try &#123;\n            kafkaTemplateForMonitor.send(topic, message);\n        &#125; catch (Exception e) &#123;\n            log.warn(&quot;kafka2 发送kafka消息失败 topic=&#123;&#125;,error=&#123;&#125;&quot;,topic,e);\n        &#125;\n        return true;\n    &#125;\n&#125;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"简单案例\"><a href=\"#简单案例\" class=\"headerlink\" title=\"简单案例\"></a>简单案例</h3><h4 id=\"引用包\"><a href=\"#引用包\" class=\"headerlink\" title=\"引用包\"></a>引用包</h4><pre><code class=\"xml\">&lt;!-- 设置了版本号，有可能会报错ClassNotFound --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;\n&lt;/dependency&gt;</code></pre>\n<h4 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h4><pre><code class=\"yaml\">spring:\n  kafka:\n  topic: testTopic\n  bootstrap-servers: 127.0.0.1:9092\n  producer:\n    retries: 0\n    batch-size: 50\n    buffer-memory: 6554432\n    key-serializer: org.apache.kafka.common.serialization.StringSerializer\n    value-serializer: org.apache.kafka.common.serialization.StringSerializer\n    properties:\n      max:\n        request:\n          size: 5242880\n      linger.ms: 1</code></pre>\n<h4 id=\"发送消息\"><a href=\"#发送消息\" class=\"headerlink\" title=\"发送消息\"></a>发送消息</h4><pre><code class=\"java\">@Slf4j\n@Component\npublic class MessageService&#123;\n\n    @Autowired\n    private KafkaTemplate kafkaTemplate;\n    @Value(&quot;$&#123;spring.kafka.topic&#125;&quot;)\n    private String topics;\n\n    public void sendSyncMessage(String resourceName)&#123;\n        try&#123;\n            kafkaTemplate.send(topics,resourceName);\n        &#125; catch (Exception e) &#123;\n            log.error(&quot;message send failed, error=&#123;&#125;&quot;, e);\n        &#125;\n    &#125;\n&#125;</code></pre>\n<h4 id=\"监听消息\"><a href=\"#监听消息\" class=\"headerlink\" title=\"监听消息\"></a>监听消息</h4><pre><code class=\"java\">@Slf4j\n@Component\npublic class MessageListener &#123;\n\n    @KafkaListener(topics = &#123;&quot;testTopic&quot;&#125;, groupId = &quot;testGroupId&quot;)\n    public void annul1(ConsumerRecord&lt;String, String&gt; record) &#123;\n        log.info(&quot;groupId = myContainer2, message = &quot; + record.toString());\n    &#125;\n&#125;</code></pre>\n<h3 id=\"双kafka案例\"><a href=\"#双kafka案例\" class=\"headerlink\" title=\"双kafka案例\"></a>双kafka案例</h3><ul>\n<li><a href=\"https://www.byteblogs.com/article/434\">SpringBoot多kafka配置</a><h4 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h4><pre><code class=\"yaml\">spring:\nkafka:\n  kafka1:\n    bootstrap-servers: 127.0.0.1:9092\n    producer:\n      retries: 0\n      batch-size: 50\n      buffer-memory: 6554432\n      key-serializer: org.apache.kafka.common.serialization.StringSerializer\n      value-serializer: org.apache.kafka.common.serialization.StringSerializer\n      properties:\n        max:\n          request:\n            size: 5242880\n        linger.ms: 1\n  kafka2:\n    bootstrap-servers: 127.0.0.1:9092\n    producer:\n      retries: 0\n      batch-size: 50\n      buffer-memory: 6554432\n      key-serializer: org.apache.kafka.common.serialization.StringSerializer\n      value-serializer: org.apache.kafka.common.serialization.StringSerializer\n      properties:\n        max:\n          request:\n            size: 5242880\n        linger.ms: 1</code></pre>\n</li>\n</ul>\n<h4 id=\"代码配置\"><a href=\"#代码配置\" class=\"headerlink\" title=\"代码配置\"></a>代码配置</h4><ul>\n<li><p>实例1配置</p>\n<pre><code class=\"java\">@Configuration\n@EnableKafka\npublic class Kafka1Config &#123;\n\n  @Bean(&quot;kafka1ExtListenerKafkaProperties&quot;)\n  @Primary\n  @ConfigurationProperties(prefix = &quot;spring.kafka.kafka1&quot;)\n  public KafkaProperties kafka1ExtListenerKafkaProperties() &#123;\n      return new KafkaProperties();\n  &#125;\n\n  @Bean(&quot;kafka1ListenerContainerFactory&quot;)\n  @Primary\n  KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;Integer, String&gt;&gt; kafkaListenerContainerFactory() &#123;\n      ConcurrentKafkaListenerContainerFactory&lt;Integer, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;();\n      factory.setConsumerFactory(consumerFactory());\n      factory.setConcurrency(3);\n      factory.getContainerProperties().setPollTimeout(3000);\n      return factory;\n  &#125;\n\n  private ConsumerFactory&lt;Integer, String&gt; consumerFactory() &#123;\n      return new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs());\n  &#125;\n\n  private Map&lt;String, Object&gt; consumerConfigs() &#123;\n      return kafka1ExtListenerKafkaProperties().buildConsumerProperties();\n  &#125;\n\n  @Bean(&quot;kafkaTemplate&quot;)\n  @Primary\n  public KafkaTemplate&lt;String, String&gt; kafkaTemplate() &#123;\n      return new KafkaTemplate&lt;&gt;(producerFactory());\n  &#125;\n\n  private ProducerFactory&lt;String, String&gt; producerFactory() &#123;\n      DefaultKafkaProducerFactory&lt;String, String&gt; producerFactory = new DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());\n      return producerFactory;\n  &#125;\n\n  private Map&lt;String, Object&gt; producerConfigs() &#123;\n      return kafka1ExtListenerKafkaProperties().buildProducerProperties();\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>实例2配置</p>\n<pre><code class=\"java\">@Configuration\n@EnableKafka\npublic class Kafka2Config &#123;\n\n  @Bean(&quot;kafka2ListenerKafkaProperties&quot;)\n  @ConfigurationProperties(prefix = &quot;spring.kafka.kafka2&quot;)\n  public KafkaProperties kafka2ListenerKafkaProperties() &#123;\n      return new KafkaProperties();\n  &#125;\n\n  @Bean(&quot;kafka2ListenerContainerFactory&quot;)\n  public KafkaListenerContainerFactory&lt;ConcurrentMessageListenerContainer&lt;Integer, String&gt;&gt; kafka2ListenerContainerFactory() &#123;\n      ConcurrentKafkaListenerContainerFactory&lt;Integer, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;();\n      factory.setConsumerFactory(consumerFactory());\n      factory.setConcurrency(3);\n      factory.getContainerProperties().setPollTimeout(3000);\n      return factory;\n  &#125;\n\n  /**\n   * 消费者工厂的bean\n   *\n   * @return\n   */\n  private ConsumerFactory&lt;Integer, String&gt; consumerFactory() &#123;\n      return new DefaultKafkaConsumerFactory&lt;&gt;(consumerConfigs());\n  &#125;\n\n  private Map&lt;String, Object&gt; consumerConfigs() &#123;\n      return kafka2ListenerKafkaProperties().buildConsumerProperties();\n  &#125;\n\n  @Bean(&quot;kafka2Template&quot;)\n  public KafkaTemplate&lt;String, String&gt; kafka2Template() &#123;\n      return new KafkaTemplate&lt;&gt;(producerFactory());\n  &#125;\n\n  private ProducerFactory&lt;String, String&gt; producerFactory() &#123;\n      DefaultKafkaProducerFactory&lt;String, String&gt; producerFactory = new DefaultKafkaProducerFactory&lt;&gt;(producerConfigs());\n      return producerFactory;\n  &#125;\n\n  private Map&lt;String, Object&gt; producerConfigs() &#123;\n      return kafka2ListenerKafkaProperties().buildProducerProperties();\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h4><pre><code class=\"java\">@Slf4j\n@Service\npublic class MessageSendService&#123;\n    @Resource(name = &quot;kafkaTemplate&quot;)\n    private KafkaTemplate&lt;String, Object&gt; kafkaTemplate;\n\n    @Resource(name = &quot;kafkaTemplateForMonitor&quot;)\n    private KafkaTemplate&lt;String, Object&gt; kafkaTemplateForMonitor;\n\n    public boolean kafka1Send(String topic, String message) &#123;\n        try &#123;\n            if (kafkaMq) &#123;\n                kafkaTemplate.send(topic, message);\n            &#125;\n        &#125; catch (Exception e) &#123;\n            log.warn(&quot;kafka1 发送kafka消息失败 topic=&#123;&#125;,error=&#123;&#125;&quot;,topic,e);\n        &#125;\n        return true;\n    &#125;\n\n    public boolean kafka2Send(String topic, String message)&#123;\n        try &#123;\n            kafkaTemplateForMonitor.send(topic, message);\n        &#125; catch (Exception e) &#123;\n            log.warn(&quot;kafka2 发送kafka消息失败 topic=&#123;&#125;,error=&#123;&#125;&quot;,topic,e);\n        &#125;\n        return true;\n    &#125;\n&#125;</code></pre>\n"},{"title":"集成Jimu报表","description":"jimu","date":"2021-08-04T10:28:22.000Z","_content":"\n- [官网](http://www.jimureport.com/)\n- [官方文档](http://report.jeecg.com/2078875)\n\n### 集成步骤\n> 见官网文档\n\n### 集成时遇到的问题\n- 集成后启动报错，Unable to load cache item\n> [导致问题产生的原因](https://docs.spring.io/spring-boot/docs/1.5.16.RELEASE/reference/html/using-boot-devtools.html)\n```textmate\n解决方法: 去掉devtools即可\n```\n","source":"_posts/backend/other/jimu-report.md","raw":"---\ntitle: 集成Jimu报表\ndescription: jimu\ndate: 2021-08-04 18:28:22\ntags:\n- 三方集成\ncategories:\n- 后端\n- 三方集成\n---\n\n- [官网](http://www.jimureport.com/)\n- [官方文档](http://report.jeecg.com/2078875)\n\n### 集成步骤\n> 见官网文档\n\n### 集成时遇到的问题\n- 集成后启动报错，Unable to load cache item\n> [导致问题产生的原因](https://docs.spring.io/spring-boot/docs/1.5.16.RELEASE/reference/html/using-boot-devtools.html)\n```textmate\n解决方法: 去掉devtools即可\n```\n","slug":"backend/other/jimu-report","published":1,"updated":"2021-08-04T10:42:03.736Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3be4001hfms6fayq074o","content":"<ul>\n<li><a href=\"http://www.jimureport.com/\">官网</a></li>\n<li><a href=\"http://report.jeecg.com/2078875\">官方文档</a></li>\n</ul>\n<h3 id=\"集成步骤\"><a href=\"#集成步骤\" class=\"headerlink\" title=\"集成步骤\"></a>集成步骤</h3><blockquote>\n<p>见官网文档</p>\n</blockquote>\n<h3 id=\"集成时遇到的问题\"><a href=\"#集成时遇到的问题\" class=\"headerlink\" title=\"集成时遇到的问题\"></a>集成时遇到的问题</h3><ul>\n<li>集成后启动报错，Unable to load cache item<blockquote>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/1.5.16.RELEASE/reference/html/using-boot-devtools.html\">导致问题产生的原因</a></p>\n</blockquote>\n<pre><code class=\"textmate\">解决方法: 去掉devtools即可</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"http://www.jimureport.com/\">官网</a></li>\n<li><a href=\"http://report.jeecg.com/2078875\">官方文档</a></li>\n</ul>\n<h3 id=\"集成步骤\"><a href=\"#集成步骤\" class=\"headerlink\" title=\"集成步骤\"></a>集成步骤</h3><blockquote>\n<p>见官网文档</p>\n</blockquote>\n<h3 id=\"集成时遇到的问题\"><a href=\"#集成时遇到的问题\" class=\"headerlink\" title=\"集成时遇到的问题\"></a>集成时遇到的问题</h3><ul>\n<li>集成后启动报错，Unable to load cache item<blockquote>\n<p><a href=\"https://docs.spring.io/spring-boot/docs/1.5.16.RELEASE/reference/html/using-boot-devtools.html\">导致问题产生的原因</a></p>\n</blockquote>\n<pre><code class=\"textmate\">解决方法: 去掉devtools即可</code></pre>\n</li>\n</ul>\n"},{"title":"nacos","description":"nacos","date":"2021-04-13T02:56:52.000Z","_content":"\n- [官方文档](https://nacos.io/zh-cn/docs/what-is-nacos.html)\n- [小白也能懂的 Nacos 服务模型介绍(转)](https://mp.weixin.qq.com/s/S8HI7DG5v9C2IfjXtkVjuQ) \n- [动态刷新原理(转)](https://blog.csdn.net/wangwei19871103/article/details/105775039/)\n- [相关-Raft算法(转)](https://www.baidu.com/s?ie=UTF-8&wd=Raft%E7%AE%97%E6%B3%95)\n","source":"_posts/backend/service/nacos.md","raw":"---\ntitle: nacos\ndescription: nacos\n#top: 1\ndate: 2021-04-13 10:56:52\ntags:\n- nacos\n- 动态配置\n- 注册中心\ncategories:\n- 后端\n- 服务治理\n---\n\n- [官方文档](https://nacos.io/zh-cn/docs/what-is-nacos.html)\n- [小白也能懂的 Nacos 服务模型介绍(转)](https://mp.weixin.qq.com/s/S8HI7DG5v9C2IfjXtkVjuQ) \n- [动态刷新原理(转)](https://blog.csdn.net/wangwei19871103/article/details/105775039/)\n- [相关-Raft算法(转)](https://www.baidu.com/s?ie=UTF-8&wd=Raft%E7%AE%97%E6%B3%95)\n","slug":"backend/service/nacos","published":1,"updated":"2021-08-19T01:38:43.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3be7001kfms686sdg412","content":"<ul>\n<li><a href=\"https://nacos.io/zh-cn/docs/what-is-nacos.html\">官方文档</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/S8HI7DG5v9C2IfjXtkVjuQ\">小白也能懂的 Nacos 服务模型介绍(转)</a> </li>\n<li><a href=\"https://blog.csdn.net/wangwei19871103/article/details/105775039/\">动态刷新原理(转)</a></li>\n<li><a href=\"https://www.baidu.com/s?ie=UTF-8&wd=Raft%E7%AE%97%E6%B3%95\">相关-Raft算法(转)</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://nacos.io/zh-cn/docs/what-is-nacos.html\">官方文档</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/S8HI7DG5v9C2IfjXtkVjuQ\">小白也能懂的 Nacos 服务模型介绍(转)</a> </li>\n<li><a href=\"https://blog.csdn.net/wangwei19871103/article/details/105775039/\">动态刷新原理(转)</a></li>\n<li><a href=\"https://www.baidu.com/s?ie=UTF-8&wd=Raft%E7%AE%97%E6%B3%95\">相关-Raft算法(转)</a></li>\n</ul>\n"},{"title":"Zookeeper搭建","date":"2020-10-29T07:40:46.000Z","_content":"\n\n### 相关链接\n> [官网](https://zookeeper.apache.org/releases.html)\n\n### 注意事项\n```textmate\n1.下载 xxx-bin.tar.gz包(这种是编译好的)，否则启动时会提示找不到Class\n2.启动时注意端口号是否已经被占用\n```\n\n### 单机部署步骤\n```textmate\n1.解压文件\n    tar -zxvf xxx-bin.tar.gz zookeeper\n\n2.修改配置\n    cd zookeeper/conf\n    cp zoo_sample.cfg zoo.cfg\n    vim zoo.cfg\n    修改以下配置项\n        dataDir= xxx/dataDir\n        dataLogDir= xxx/logs/zookeeper\n3.新增配置\n    cd xxx/dataDir\n    echo 1001>myid\n4.启动\n    cd zookeeper/bin\n    ./zkServer.sh start / restart / stop / status\n```\n\n### zookeeper数据查看工具\n> [下载地址](https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip)\n- 使用\n\n```textmate\n1.解压后进入build文件夹\n2.运行jar\n    nohup java -jar zookeeper-dev-ZooInspector.jar &\n3.左上角连接按钮，输入zk地址并连接\n```\n\n### 常见问题\n- 启动报ClassNotFound\n```textmate\n重新下载zookeeper包，注意是xxxx-bin.tar.gz这种的\n```\n\n- 启动失败\n\n```textmate\n1.检查配置的文件夹路径和权限是否正常\n2.检查zookeeper是否已经被启动\n    ps -ef | grep zookeeper\n    kill进程\n3.删除 dataDir 和 dataLogDir 路径下 version-2 文件夹后重启\n```\n","source":"_posts/backend/service/zookeeper.md","raw":"---\ntitle: Zookeeper搭建\ndate: 2020-10-29 15:40:46\ntags: \n- zookeeper\n- 注册中心\n- 分布式锁\ncategories: \n- 后端\n- 服务治理\n---\n\n\n### 相关链接\n> [官网](https://zookeeper.apache.org/releases.html)\n\n### 注意事项\n```textmate\n1.下载 xxx-bin.tar.gz包(这种是编译好的)，否则启动时会提示找不到Class\n2.启动时注意端口号是否已经被占用\n```\n\n### 单机部署步骤\n```textmate\n1.解压文件\n    tar -zxvf xxx-bin.tar.gz zookeeper\n\n2.修改配置\n    cd zookeeper/conf\n    cp zoo_sample.cfg zoo.cfg\n    vim zoo.cfg\n    修改以下配置项\n        dataDir= xxx/dataDir\n        dataLogDir= xxx/logs/zookeeper\n3.新增配置\n    cd xxx/dataDir\n    echo 1001>myid\n4.启动\n    cd zookeeper/bin\n    ./zkServer.sh start / restart / stop / status\n```\n\n### zookeeper数据查看工具\n> [下载地址](https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip)\n- 使用\n\n```textmate\n1.解压后进入build文件夹\n2.运行jar\n    nohup java -jar zookeeper-dev-ZooInspector.jar &\n3.左上角连接按钮，输入zk地址并连接\n```\n\n### 常见问题\n- 启动报ClassNotFound\n```textmate\n重新下载zookeeper包，注意是xxxx-bin.tar.gz这种的\n```\n\n- 启动失败\n\n```textmate\n1.检查配置的文件夹路径和权限是否正常\n2.检查zookeeper是否已经被启动\n    ps -ef | grep zookeeper\n    kill进程\n3.删除 dataDir 和 dataLogDir 路径下 version-2 文件夹后重启\n```\n","slug":"backend/service/zookeeper","published":1,"updated":"2021-08-19T01:38:43.084Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3be9001nfms68ynk6mua","content":"<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><blockquote>\n<p><a href=\"https://zookeeper.apache.org/releases.html\">官网</a></p>\n</blockquote>\n<h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><pre><code class=\"textmate\">1.下载 xxx-bin.tar.gz包(这种是编译好的)，否则启动时会提示找不到Class\n2.启动时注意端口号是否已经被占用</code></pre>\n<h3 id=\"单机部署步骤\"><a href=\"#单机部署步骤\" class=\"headerlink\" title=\"单机部署步骤\"></a>单机部署步骤</h3><pre><code class=\"textmate\">1.解压文件\n    tar -zxvf xxx-bin.tar.gz zookeeper\n\n2.修改配置\n    cd zookeeper/conf\n    cp zoo_sample.cfg zoo.cfg\n    vim zoo.cfg\n    修改以下配置项\n        dataDir= xxx/dataDir\n        dataLogDir= xxx/logs/zookeeper\n3.新增配置\n    cd xxx/dataDir\n    echo 1001&gt;myid\n4.启动\n    cd zookeeper/bin\n    ./zkServer.sh start / restart / stop / status</code></pre>\n<h3 id=\"zookeeper数据查看工具\"><a href=\"#zookeeper数据查看工具\" class=\"headerlink\" title=\"zookeeper数据查看工具\"></a>zookeeper数据查看工具</h3><blockquote>\n<p><a href=\"https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip\">下载地址</a></p>\n</blockquote>\n<ul>\n<li>使用</li>\n</ul>\n<pre><code class=\"textmate\">1.解压后进入build文件夹\n2.运行jar\n    nohup java -jar zookeeper-dev-ZooInspector.jar &amp;\n3.左上角连接按钮，输入zk地址并连接</code></pre>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li><p>启动报ClassNotFound</p>\n<pre><code class=\"textmate\">重新下载zookeeper包，注意是xxxx-bin.tar.gz这种的</code></pre>\n</li>\n<li><p>启动失败</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.检查配置的文件夹路径和权限是否正常\n2.检查zookeeper是否已经被启动\n    ps -ef | grep zookeeper\n    kill进程\n3.删除 dataDir 和 dataLogDir 路径下 version-2 文件夹后重启</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h3><blockquote>\n<p><a href=\"https://zookeeper.apache.org/releases.html\">官网</a></p>\n</blockquote>\n<h3 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h3><pre><code class=\"textmate\">1.下载 xxx-bin.tar.gz包(这种是编译好的)，否则启动时会提示找不到Class\n2.启动时注意端口号是否已经被占用</code></pre>\n<h3 id=\"单机部署步骤\"><a href=\"#单机部署步骤\" class=\"headerlink\" title=\"单机部署步骤\"></a>单机部署步骤</h3><pre><code class=\"textmate\">1.解压文件\n    tar -zxvf xxx-bin.tar.gz zookeeper\n\n2.修改配置\n    cd zookeeper/conf\n    cp zoo_sample.cfg zoo.cfg\n    vim zoo.cfg\n    修改以下配置项\n        dataDir= xxx/dataDir\n        dataLogDir= xxx/logs/zookeeper\n3.新增配置\n    cd xxx/dataDir\n    echo 1001&gt;myid\n4.启动\n    cd zookeeper/bin\n    ./zkServer.sh start / restart / stop / status</code></pre>\n<h3 id=\"zookeeper数据查看工具\"><a href=\"#zookeeper数据查看工具\" class=\"headerlink\" title=\"zookeeper数据查看工具\"></a>zookeeper数据查看工具</h3><blockquote>\n<p><a href=\"https://issues.apache.org/jira/secure/attachment/12436620/ZooInspector.zip\">下载地址</a></p>\n</blockquote>\n<ul>\n<li>使用</li>\n</ul>\n<pre><code class=\"textmate\">1.解压后进入build文件夹\n2.运行jar\n    nohup java -jar zookeeper-dev-ZooInspector.jar &amp;\n3.左上角连接按钮，输入zk地址并连接</code></pre>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li><p>启动报ClassNotFound</p>\n<pre><code class=\"textmate\">重新下载zookeeper包，注意是xxxx-bin.tar.gz这种的</code></pre>\n</li>\n<li><p>启动失败</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.检查配置的文件夹路径和权限是否正常\n2.检查zookeeper是否已经被启动\n    ps -ef | grep zookeeper\n    kill进程\n3.删除 dataDir 和 dataLogDir 路径下 version-2 文件夹后重启</code></pre>\n"},{"title":"SpringBoot多数据源","date":"2021-08-17T08:58:00.000Z","_content":"\n- [SpringBoot多数据源(转)](https://www.jianshu.com/p/b2f818b742a2)\n\n### 核心类\n- DynamicDataSource\n","source":"_posts/backend/spring/mybatis.md","raw":"---\ntitle: SpringBoot多数据源\ndate: 2021-08-17 16:58:00\ntags:\n- 多数据源\ncategories:\n- 后端\n- 框架\n---\n\n- [SpringBoot多数据源(转)](https://www.jianshu.com/p/b2f818b742a2)\n\n### 核心类\n- DynamicDataSource\n","slug":"backend/spring/mybatis","published":1,"updated":"2021-08-19T01:36:56.118Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3beb001pfms6fxvz4vqn","content":"<ul>\n<li><a href=\"https://www.jianshu.com/p/b2f818b742a2\">SpringBoot多数据源(转)</a></li>\n</ul>\n<h3 id=\"核心类\"><a href=\"#核心类\" class=\"headerlink\" title=\"核心类\"></a>核心类</h3><ul>\n<li>DynamicDataSource</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://www.jianshu.com/p/b2f818b742a2\">SpringBoot多数据源(转)</a></li>\n</ul>\n<h3 id=\"核心类\"><a href=\"#核心类\" class=\"headerlink\" title=\"核心类\"></a>核心类</h3><ul>\n<li>DynamicDataSource</li>\n</ul>\n"},{"title":"SpringBoot","date":"2021-03-22T01:44:01.000Z","_content":"\n### 文章收集\n- [SpringBoot启动过程(转)](https://www.jianshu.com/p/603d125f21b3)\n- [流程图(转)](https://www.processon.com/view/link/59812124e4b0de2518b32b6e)\n- [@RefreshScope原理](https://blog.csdn.net/youanyyou/article/details/103562907)\n- [SpringBoot内置Tomcat启动源码分析](https://www.cnblogs.com/sword-successful/p/11383723.html)\n\n### 集成PageHelper\n- 配置\n```pom\n<!--基础框架包-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-dependencies</artifactId>\n    <version>2.3.4.RELEASE</version>\n    <type>pom</type>\n    <scope>import</scope>\n</dependency>\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-dependencies</artifactId>\n    <version>Hoxton.SR8</version>\n    <type>pom</type>\n    <scope>import</scope>\n</dependency>\n<!--page helper依赖-->\n<!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper-spring-boot-starter -->\n<dependency>\n    <groupId>com.github.pagehelper</groupId>\n    <artifactId>pagehelper-spring-boot-starter</artifactId>\n    <version>1.3.0</version>\n</dependency>\n```\n\n- 使用\n```java\nclass XXService{\n    public Result list(QueryParam param){\n        PageMethod.startPage(param.getPageNumber(),param.getPageSize());\n        List result = mapper.list(param);\n        PageInfo pageInfo = new PageInfo(result);\n        return PageDTO.result(pageInfo.getTotal(),result);\n    }\n}\n```\n\n- 注意事项\n\n```textmate\n1.注意pom版本号\n2.使用pagehelper-spring-boot-starter pom后，不需要在yml中配置pagehelper相关参数，否则分页会有问题(亲测)\n  例如: 永远只在第一页\n```\n\n### 自动装配原理\n```textmate\n@EnableAutoConfiguration\n条件注解 @ConditionalOnBean等\n@EnableAutoConfiguration注解(找META-INF/spring.factories配置文件中的所有自动配置类)\n```\n","source":"_posts/backend/spring/spring-boot.md","raw":"---\ntitle: SpringBoot\ndate: 2021-03-22 09:44:01\ntags:\n- springboot\ncategories:\n- 后端\n- 框架\n---\n\n### 文章收集\n- [SpringBoot启动过程(转)](https://www.jianshu.com/p/603d125f21b3)\n- [流程图(转)](https://www.processon.com/view/link/59812124e4b0de2518b32b6e)\n- [@RefreshScope原理](https://blog.csdn.net/youanyyou/article/details/103562907)\n- [SpringBoot内置Tomcat启动源码分析](https://www.cnblogs.com/sword-successful/p/11383723.html)\n\n### 集成PageHelper\n- 配置\n```pom\n<!--基础框架包-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-dependencies</artifactId>\n    <version>2.3.4.RELEASE</version>\n    <type>pom</type>\n    <scope>import</scope>\n</dependency>\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-dependencies</artifactId>\n    <version>Hoxton.SR8</version>\n    <type>pom</type>\n    <scope>import</scope>\n</dependency>\n<!--page helper依赖-->\n<!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper-spring-boot-starter -->\n<dependency>\n    <groupId>com.github.pagehelper</groupId>\n    <artifactId>pagehelper-spring-boot-starter</artifactId>\n    <version>1.3.0</version>\n</dependency>\n```\n\n- 使用\n```java\nclass XXService{\n    public Result list(QueryParam param){\n        PageMethod.startPage(param.getPageNumber(),param.getPageSize());\n        List result = mapper.list(param);\n        PageInfo pageInfo = new PageInfo(result);\n        return PageDTO.result(pageInfo.getTotal(),result);\n    }\n}\n```\n\n- 注意事项\n\n```textmate\n1.注意pom版本号\n2.使用pagehelper-spring-boot-starter pom后，不需要在yml中配置pagehelper相关参数，否则分页会有问题(亲测)\n  例如: 永远只在第一页\n```\n\n### 自动装配原理\n```textmate\n@EnableAutoConfiguration\n条件注解 @ConditionalOnBean等\n@EnableAutoConfiguration注解(找META-INF/spring.factories配置文件中的所有自动配置类)\n```\n","slug":"backend/spring/spring-boot","published":1,"updated":"2021-08-19T01:36:56.124Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bee001sfms6f8nq1l9b","content":"<h3 id=\"文章收集\"><a href=\"#文章收集\" class=\"headerlink\" title=\"文章收集\"></a>文章收集</h3><ul>\n<li><a href=\"https://www.jianshu.com/p/603d125f21b3\">SpringBoot启动过程(转)</a></li>\n<li><a href=\"https://www.processon.com/view/link/59812124e4b0de2518b32b6e\">流程图(转)</a></li>\n<li><a href=\"https://blog.csdn.net/youanyyou/article/details/103562907\">@RefreshScope原理</a></li>\n<li><a href=\"https://www.cnblogs.com/sword-successful/p/11383723.html\">SpringBoot内置Tomcat启动源码分析</a></li>\n</ul>\n<h3 id=\"集成PageHelper\"><a href=\"#集成PageHelper\" class=\"headerlink\" title=\"集成PageHelper\"></a>集成PageHelper</h3><ul>\n<li><p>配置</p>\n<pre><code class=\"pom\">&lt;!--基础框架包--&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\n  &lt;version&gt;2.3.4.RELEASE&lt;/version&gt;\n  &lt;type&gt;pom&lt;/type&gt;\n  &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n  &lt;version&gt;Hoxton.SR8&lt;/version&gt;\n  &lt;type&gt;pom&lt;/type&gt;\n  &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;!--page helper依赖--&gt;\n&lt;!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper-spring-boot-starter --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;\n  &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt;\n  &lt;version&gt;1.3.0&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n</li>\n<li><p>使用</p>\n<pre><code class=\"java\">class XXService&#123;\n  public Result list(QueryParam param)&#123;\n      PageMethod.startPage(param.getPageNumber(),param.getPageSize());\n      List result = mapper.list(param);\n      PageInfo pageInfo = new PageInfo(result);\n      return PageDTO.result(pageInfo.getTotal(),result);\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>注意事项</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.注意pom版本号\n2.使用pagehelper-spring-boot-starter pom后，不需要在yml中配置pagehelper相关参数，否则分页会有问题(亲测)\n  例如: 永远只在第一页</code></pre>\n<h3 id=\"自动装配原理\"><a href=\"#自动装配原理\" class=\"headerlink\" title=\"自动装配原理\"></a>自动装配原理</h3><pre><code class=\"textmate\">@EnableAutoConfiguration\n条件注解 @ConditionalOnBean等\n@EnableAutoConfiguration注解(找META-INF/spring.factories配置文件中的所有自动配置类)</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"文章收集\"><a href=\"#文章收集\" class=\"headerlink\" title=\"文章收集\"></a>文章收集</h3><ul>\n<li><a href=\"https://www.jianshu.com/p/603d125f21b3\">SpringBoot启动过程(转)</a></li>\n<li><a href=\"https://www.processon.com/view/link/59812124e4b0de2518b32b6e\">流程图(转)</a></li>\n<li><a href=\"https://blog.csdn.net/youanyyou/article/details/103562907\">@RefreshScope原理</a></li>\n<li><a href=\"https://www.cnblogs.com/sword-successful/p/11383723.html\">SpringBoot内置Tomcat启动源码分析</a></li>\n</ul>\n<h3 id=\"集成PageHelper\"><a href=\"#集成PageHelper\" class=\"headerlink\" title=\"集成PageHelper\"></a>集成PageHelper</h3><ul>\n<li><p>配置</p>\n<pre><code class=\"pom\">&lt;!--基础框架包--&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\n  &lt;version&gt;2.3.4.RELEASE&lt;/version&gt;\n  &lt;type&gt;pom&lt;/type&gt;\n  &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n  &lt;version&gt;Hoxton.SR8&lt;/version&gt;\n  &lt;type&gt;pom&lt;/type&gt;\n  &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;!--page helper依赖--&gt;\n&lt;!-- https://mvnrepository.com/artifact/com.github.pagehelper/pagehelper-spring-boot-starter --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;\n  &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt;\n  &lt;version&gt;1.3.0&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n</li>\n<li><p>使用</p>\n<pre><code class=\"java\">class XXService&#123;\n  public Result list(QueryParam param)&#123;\n      PageMethod.startPage(param.getPageNumber(),param.getPageSize());\n      List result = mapper.list(param);\n      PageInfo pageInfo = new PageInfo(result);\n      return PageDTO.result(pageInfo.getTotal(),result);\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>注意事项</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.注意pom版本号\n2.使用pagehelper-spring-boot-starter pom后，不需要在yml中配置pagehelper相关参数，否则分页会有问题(亲测)\n  例如: 永远只在第一页</code></pre>\n<h3 id=\"自动装配原理\"><a href=\"#自动装配原理\" class=\"headerlink\" title=\"自动装配原理\"></a>自动装配原理</h3><pre><code class=\"textmate\">@EnableAutoConfiguration\n条件注解 @ConditionalOnBean等\n@EnableAutoConfiguration注解(找META-INF/spring.factories配置文件中的所有自动配置类)</code></pre>\n"},{"title":"SpringClougGateway","date":"2021-06-15T06:16:00.000Z","_content":"\n### 文章收集\n- [SpringCloudGateway-2.1.0.RC3](https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RC3/multi/multi_spring-cloud-gateway.html)\n- [SpringCloudGateway官网](https://spring.io/projects/spring-cloud-gateway)\n- [SpringCloudGateway(读取、修改RequestBody)(转)](https://www.haoyizebo.com/posts/876ed1e8/)\n\n### 配置\n```yaml\nspring:\n  application:\n    name: cloud-gateway\n  cloud:\n    httpclient:\n      connect-timeout: 20000\n      pool:\n        max-idle-time: 20000\n    #开启从注册中心动态创建路由的功能，利用微服务名进行路由\n#    discovery:\n#      locator:\n#        lower-case-service-id: true\n#        enabled: true\n\n    # 相关文档 https://www.cnblogs.com/crazymakercircle/p/11704077.html\n    # uri相同时，只有最后一个会生效\n    #一个请求满足多个路由的断言条件时，请求只会被首个成功匹配的路由转发；\n    #predicates断言，可根据datetime、Cookie、Header、Host、Method、Path、Queryparam、RemoteAddr匹配\n    #filter: 支持PrefixPath、RewritePath、SetPath、RedirectTo、RemoveRequestHeader、\n    #RemoveResponseHeader、SetStatus、StripPrefix、RequestSize、Default-filters\n    gateway:\n      routes:\n      #根据url拦截\n      - id: service1_v1\n        uri: https://www.so.com/?quanso.com.cn\n        predicates:\n          - Path=/360\n#      - id: service1_v2\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/v2\n\n      #拦截v1请求，并带上/api，转发到8080端口上\n#      - id: service1_v3\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/v1\n#        filters:\n#          - PrefixPath=/api\n\n      #predicates断言，可根据datetime/Cookie/Header/Host/Method/Path/Queryparam/RemoteAddr匹配\n      - id: queryParam-baidu-route\n        uri: https://www.baidu.com\n        predicates:\n          - Query=baidu\n      - id: queryParam-bing-route\n        uri: https://bing.com/\n        predicates:\n          - Query=bing, tr. #参数中包含bing,且值为tr开头的三位参数 才能匹配到\n\n#      - id: queryParam-release2-route\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/api\n#          - Weight=service2, 90\n\n#      - id: queryParam-head-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Header=Jump, 1001 #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n#      - id: queryParam-host-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Host=*.apix #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n      #测试StripPrefix\n#      - id: full-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Query=full\n#        filters:\n#          - PrefixPath=/full\n#          - StripPrefix=0\n\n      # 熔断降级\n#      - id: queryParam-fallback-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/test\n#        filters:\n#          - name: Hystrix\n#            args:\n#              name: default\n#              fallbackUri: forward:/fallback\n#      - id: fallback-route\n#        uri: http://localhost:8080/fallback\n#        predicates:\n#          - Path=/fallback\n\n        # 金丝雀发布\n      - id: release1-route\n        uri: http://localhost:8080\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n      - id: release2-route\n        uri: http://localhost:8081\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n\n\n#hystrix.command.fallbackA.execution.isolation.thread.timeoutInMilliseconds: 5000\n# hystrix 信号量隔离，1.5秒后自动超时\nhystrix:\n  command:\n    default:\n      execution:\n        isolation:\n          strategy: SEMAPHORE\n          thread:\n            timeoutInMilliseconds: 1500\n\n```\n\n### 获取及改写RequestBody示例\n```java\nclass DemoFilter implements GlobalFilter, Ordered{\n    @Resource\n    private ServerCodecConfigurer configurer;\n\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        ServerRequest serverRequest = ServerRequest.create(exchange, configurer.getReaders());\n\n        // read & modify body\n        Mono<String> modifiedBody = serverRequest.bodyToMono(String.class)\n                .flatMap(body -> {\n                    //例子：验签\n                    boolean checkFlag = paramSignCheck(jsonParam);\n                    if(!checkFlag){\n                        return Mono.error(new Exception(\"验签失败\"));\n                    }\n                    return Mono.just(body);\n                });\n\n        BodyInserter bodyInserter = BodyInserters.fromPublisher(modifiedBody,String.class);\n        HttpHeaders headers = new HttpHeaders();\n        headers.putAll(exchange.getRequest().getHeaders());\n        //重要 不处理会导致请求失败\n        headers.remove(HttpHeaders.CONTENT_LENGTH);\n        CachedBodyOutputMessage outputMessage = new CachedBodyOutputMessage(exchange, headers);\n\n        return bodyInserter.insert(outputMessage, new BodyInserterContext())\n                .then(Mono.defer(() -> {\n                    ServerHttpRequestDecorator decorator = new ServerHttpRequestDecorator(\n                            exchange.getRequest()) {\n                        @Override\n                        public HttpHeaders getHeaders() {\n                            long contentLength = headers.getContentLength();\n                            HttpHeaders httpHeaders = new HttpHeaders();\n                            httpHeaders.putAll(super.getHeaders());\n                            if (contentLength > 0) {\n                                httpHeaders.setContentLength(contentLength);\n                            }\n                            return httpHeaders;\n                        }\n\n                        @Override\n                        public Flux<DataBuffer> getBody() {\n                            return outputMessage.getBody();\n                        }\n                    };\n                    ServerHttpResponse decoratedResponse = decorate(exchange, trace);\n                    return chain.filter(exchange.mutate().request(decorator).response(decoratedResponse).build());\n                }));\n    }\n}\n```\n\n### 新增headers\n```java\n@Configuration\npublic class AuthGatewayFilter implements GlobalFilter, Ordered {\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        Consumer<HttpHeaders> httpHeaders = httpHeader -> {\n            // 存在相同的key,直接添加会报错\n            if(StringUtils.isBlank(httpHeader.getFirst(\"xxx\"))){\n                httpHeader.add(\"xxx\", \"xxx\");\n            }\n        };\n        ServerHttpRequest serverHttpRequest = exchange.getRequest().mutate().headers(httpHeaders).build();\n        exchange = exchange.mutate().request(serverHttpRequest).build();\n\n        return chain.filter(exchange);\n    }\n    @Override\n    public int getOrder() {\n        return Ordered.HIGHEST_PRECEDENCE - 1;\n    }\n}\n```\n\n### 请求非json格式转jsondemo\n```java\nclass Demo{\n\n    /** application/x-www-form-urlencoded 转json **/\n    private Map<String, Object> decodeBody(String body) {\n        return Arrays.stream(body.split(\"&\"))\n                .map(s -> s.split(\"=\"))\n                .collect(Collectors.toMap(arr -> arr[0], arr -> arr[1]));\n    }\n\n    /** fomrData(非文件)转 json 数据 **/\n    private String parseFormData2Json(String requestParam){\n        if(StringUtils.isBlank(requestParam) \n                && !requestParam.contains(\"filename\")){\n            return requestParam;\n        }\n        try{\n            requestParam = requestParam.replace(\"-\",\"\").split(\"-\")[0];\n            String code = requestParam.split(\"\\n\")[0];\n            requestParam = requestParam.replaceAll(code,\"\")\n                    .replaceAll(\"ContentDisposition: formdata;\",\"\")\n                    .replaceAll(\"\\n\",\"\")\n                    .replaceAll(\"name=\",\",\")\n                    .replaceAll(\"\\\"\\r\\r\",\"\\\":\\\"\")\n                    .replaceFirst(\",\",\"\")\n                    .replaceAll(\"\\r\",\"\\\"\")\n            ;\n            requestParam = \"{\" + requestParam + \"\\\"}\";\n        } catch (Exception e){\n            e.printStackTrace();\n        }\n        return requestParam;\n    }\n}\n\n```\n","source":"_posts/backend/spring/springcloud-gateway.md","raw":"---\ntitle: SpringClougGateway\ndate: 2021-06-15 14:16:00\ntags:\n- gateway\ncategories:\n- 后端\n- 框架\n---\n\n### 文章收集\n- [SpringCloudGateway-2.1.0.RC3](https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RC3/multi/multi_spring-cloud-gateway.html)\n- [SpringCloudGateway官网](https://spring.io/projects/spring-cloud-gateway)\n- [SpringCloudGateway(读取、修改RequestBody)(转)](https://www.haoyizebo.com/posts/876ed1e8/)\n\n### 配置\n```yaml\nspring:\n  application:\n    name: cloud-gateway\n  cloud:\n    httpclient:\n      connect-timeout: 20000\n      pool:\n        max-idle-time: 20000\n    #开启从注册中心动态创建路由的功能，利用微服务名进行路由\n#    discovery:\n#      locator:\n#        lower-case-service-id: true\n#        enabled: true\n\n    # 相关文档 https://www.cnblogs.com/crazymakercircle/p/11704077.html\n    # uri相同时，只有最后一个会生效\n    #一个请求满足多个路由的断言条件时，请求只会被首个成功匹配的路由转发；\n    #predicates断言，可根据datetime、Cookie、Header、Host、Method、Path、Queryparam、RemoteAddr匹配\n    #filter: 支持PrefixPath、RewritePath、SetPath、RedirectTo、RemoveRequestHeader、\n    #RemoveResponseHeader、SetStatus、StripPrefix、RequestSize、Default-filters\n    gateway:\n      routes:\n      #根据url拦截\n      - id: service1_v1\n        uri: https://www.so.com/?quanso.com.cn\n        predicates:\n          - Path=/360\n#      - id: service1_v2\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/v2\n\n      #拦截v1请求，并带上/api，转发到8080端口上\n#      - id: service1_v3\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/v1\n#        filters:\n#          - PrefixPath=/api\n\n      #predicates断言，可根据datetime/Cookie/Header/Host/Method/Path/Queryparam/RemoteAddr匹配\n      - id: queryParam-baidu-route\n        uri: https://www.baidu.com\n        predicates:\n          - Query=baidu\n      - id: queryParam-bing-route\n        uri: https://bing.com/\n        predicates:\n          - Query=bing, tr. #参数中包含bing,且值为tr开头的三位参数 才能匹配到\n\n#      - id: queryParam-release2-route\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/api\n#          - Weight=service2, 90\n\n#      - id: queryParam-head-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Header=Jump, 1001 #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n#      - id: queryParam-host-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Host=*.apix #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n      #测试StripPrefix\n#      - id: full-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Query=full\n#        filters:\n#          - PrefixPath=/full\n#          - StripPrefix=0\n\n      # 熔断降级\n#      - id: queryParam-fallback-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/test\n#        filters:\n#          - name: Hystrix\n#            args:\n#              name: default\n#              fallbackUri: forward:/fallback\n#      - id: fallback-route\n#        uri: http://localhost:8080/fallback\n#        predicates:\n#          - Path=/fallback\n\n        # 金丝雀发布\n      - id: release1-route\n        uri: http://localhost:8080\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n      - id: release2-route\n        uri: http://localhost:8081\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n\n\n#hystrix.command.fallbackA.execution.isolation.thread.timeoutInMilliseconds: 5000\n# hystrix 信号量隔离，1.5秒后自动超时\nhystrix:\n  command:\n    default:\n      execution:\n        isolation:\n          strategy: SEMAPHORE\n          thread:\n            timeoutInMilliseconds: 1500\n\n```\n\n### 获取及改写RequestBody示例\n```java\nclass DemoFilter implements GlobalFilter, Ordered{\n    @Resource\n    private ServerCodecConfigurer configurer;\n\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        ServerRequest serverRequest = ServerRequest.create(exchange, configurer.getReaders());\n\n        // read & modify body\n        Mono<String> modifiedBody = serverRequest.bodyToMono(String.class)\n                .flatMap(body -> {\n                    //例子：验签\n                    boolean checkFlag = paramSignCheck(jsonParam);\n                    if(!checkFlag){\n                        return Mono.error(new Exception(\"验签失败\"));\n                    }\n                    return Mono.just(body);\n                });\n\n        BodyInserter bodyInserter = BodyInserters.fromPublisher(modifiedBody,String.class);\n        HttpHeaders headers = new HttpHeaders();\n        headers.putAll(exchange.getRequest().getHeaders());\n        //重要 不处理会导致请求失败\n        headers.remove(HttpHeaders.CONTENT_LENGTH);\n        CachedBodyOutputMessage outputMessage = new CachedBodyOutputMessage(exchange, headers);\n\n        return bodyInserter.insert(outputMessage, new BodyInserterContext())\n                .then(Mono.defer(() -> {\n                    ServerHttpRequestDecorator decorator = new ServerHttpRequestDecorator(\n                            exchange.getRequest()) {\n                        @Override\n                        public HttpHeaders getHeaders() {\n                            long contentLength = headers.getContentLength();\n                            HttpHeaders httpHeaders = new HttpHeaders();\n                            httpHeaders.putAll(super.getHeaders());\n                            if (contentLength > 0) {\n                                httpHeaders.setContentLength(contentLength);\n                            }\n                            return httpHeaders;\n                        }\n\n                        @Override\n                        public Flux<DataBuffer> getBody() {\n                            return outputMessage.getBody();\n                        }\n                    };\n                    ServerHttpResponse decoratedResponse = decorate(exchange, trace);\n                    return chain.filter(exchange.mutate().request(decorator).response(decoratedResponse).build());\n                }));\n    }\n}\n```\n\n### 新增headers\n```java\n@Configuration\npublic class AuthGatewayFilter implements GlobalFilter, Ordered {\n    @Override\n    public Mono<Void> filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        Consumer<HttpHeaders> httpHeaders = httpHeader -> {\n            // 存在相同的key,直接添加会报错\n            if(StringUtils.isBlank(httpHeader.getFirst(\"xxx\"))){\n                httpHeader.add(\"xxx\", \"xxx\");\n            }\n        };\n        ServerHttpRequest serverHttpRequest = exchange.getRequest().mutate().headers(httpHeaders).build();\n        exchange = exchange.mutate().request(serverHttpRequest).build();\n\n        return chain.filter(exchange);\n    }\n    @Override\n    public int getOrder() {\n        return Ordered.HIGHEST_PRECEDENCE - 1;\n    }\n}\n```\n\n### 请求非json格式转jsondemo\n```java\nclass Demo{\n\n    /** application/x-www-form-urlencoded 转json **/\n    private Map<String, Object> decodeBody(String body) {\n        return Arrays.stream(body.split(\"&\"))\n                .map(s -> s.split(\"=\"))\n                .collect(Collectors.toMap(arr -> arr[0], arr -> arr[1]));\n    }\n\n    /** fomrData(非文件)转 json 数据 **/\n    private String parseFormData2Json(String requestParam){\n        if(StringUtils.isBlank(requestParam) \n                && !requestParam.contains(\"filename\")){\n            return requestParam;\n        }\n        try{\n            requestParam = requestParam.replace(\"-\",\"\").split(\"-\")[0];\n            String code = requestParam.split(\"\\n\")[0];\n            requestParam = requestParam.replaceAll(code,\"\")\n                    .replaceAll(\"ContentDisposition: formdata;\",\"\")\n                    .replaceAll(\"\\n\",\"\")\n                    .replaceAll(\"name=\",\",\")\n                    .replaceAll(\"\\\"\\r\\r\",\"\\\":\\\"\")\n                    .replaceFirst(\",\",\"\")\n                    .replaceAll(\"\\r\",\"\\\"\")\n            ;\n            requestParam = \"{\" + requestParam + \"\\\"}\";\n        } catch (Exception e){\n            e.printStackTrace();\n        }\n        return requestParam;\n    }\n}\n\n```\n","slug":"backend/spring/springcloud-gateway","published":1,"updated":"2021-08-19T01:36:56.137Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3beg001vfms676r15vm2","content":"<h3 id=\"文章收集\"><a href=\"#文章收集\" class=\"headerlink\" title=\"文章收集\"></a>文章收集</h3><ul>\n<li><a href=\"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RC3/multi/multi_spring-cloud-gateway.html\">SpringCloudGateway-2.1.0.RC3</a></li>\n<li><a href=\"https://spring.io/projects/spring-cloud-gateway\">SpringCloudGateway官网</a></li>\n<li><a href=\"https://www.haoyizebo.com/posts/876ed1e8/\">SpringCloudGateway(读取、修改RequestBody)(转)</a></li>\n</ul>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><pre><code class=\"yaml\">spring:\n  application:\n    name: cloud-gateway\n  cloud:\n    httpclient:\n      connect-timeout: 20000\n      pool:\n        max-idle-time: 20000\n    #开启从注册中心动态创建路由的功能，利用微服务名进行路由\n#    discovery:\n#      locator:\n#        lower-case-service-id: true\n#        enabled: true\n\n    # 相关文档 https://www.cnblogs.com/crazymakercircle/p/11704077.html\n    # uri相同时，只有最后一个会生效\n    #一个请求满足多个路由的断言条件时，请求只会被首个成功匹配的路由转发；\n    #predicates断言，可根据datetime、Cookie、Header、Host、Method、Path、Queryparam、RemoteAddr匹配\n    #filter: 支持PrefixPath、RewritePath、SetPath、RedirectTo、RemoveRequestHeader、\n    #RemoveResponseHeader、SetStatus、StripPrefix、RequestSize、Default-filters\n    gateway:\n      routes:\n      #根据url拦截\n      - id: service1_v1\n        uri: https://www.so.com/?quanso.com.cn\n        predicates:\n          - Path=/360\n#      - id: service1_v2\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/v2\n\n      #拦截v1请求，并带上/api，转发到8080端口上\n#      - id: service1_v3\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/v1\n#        filters:\n#          - PrefixPath=/api\n\n      #predicates断言，可根据datetime/Cookie/Header/Host/Method/Path/Queryparam/RemoteAddr匹配\n      - id: queryParam-baidu-route\n        uri: https://www.baidu.com\n        predicates:\n          - Query=baidu\n      - id: queryParam-bing-route\n        uri: https://bing.com/\n        predicates:\n          - Query=bing, tr. #参数中包含bing,且值为tr开头的三位参数 才能匹配到\n\n#      - id: queryParam-release2-route\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/api\n#          - Weight=service2, 90\n\n#      - id: queryParam-head-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Header=Jump, 1001 #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n#      - id: queryParam-host-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Host=*.apix #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n      #测试StripPrefix\n#      - id: full-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Query=full\n#        filters:\n#          - PrefixPath=/full\n#          - StripPrefix=0\n\n      # 熔断降级\n#      - id: queryParam-fallback-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/test\n#        filters:\n#          - name: Hystrix\n#            args:\n#              name: default\n#              fallbackUri: forward:/fallback\n#      - id: fallback-route\n#        uri: http://localhost:8080/fallback\n#        predicates:\n#          - Path=/fallback\n\n        # 金丝雀发布\n      - id: release1-route\n        uri: http://localhost:8080\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n      - id: release2-route\n        uri: http://localhost:8081\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n\n\n#hystrix.command.fallbackA.execution.isolation.thread.timeoutInMilliseconds: 5000\n# hystrix 信号量隔离，1.5秒后自动超时\nhystrix:\n  command:\n    default:\n      execution:\n        isolation:\n          strategy: SEMAPHORE\n          thread:\n            timeoutInMilliseconds: 1500\n</code></pre>\n<h3 id=\"获取及改写RequestBody示例\"><a href=\"#获取及改写RequestBody示例\" class=\"headerlink\" title=\"获取及改写RequestBody示例\"></a>获取及改写RequestBody示例</h3><pre><code class=\"java\">class DemoFilter implements GlobalFilter, Ordered&#123;\n    @Resource\n    private ServerCodecConfigurer configurer;\n\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) &#123;\n        ServerRequest serverRequest = ServerRequest.create(exchange, configurer.getReaders());\n\n        // read &amp; modify body\n        Mono&lt;String&gt; modifiedBody = serverRequest.bodyToMono(String.class)\n                .flatMap(body -&gt; &#123;\n                    //例子：验签\n                    boolean checkFlag = paramSignCheck(jsonParam);\n                    if(!checkFlag)&#123;\n                        return Mono.error(new Exception(&quot;验签失败&quot;));\n                    &#125;\n                    return Mono.just(body);\n                &#125;);\n\n        BodyInserter bodyInserter = BodyInserters.fromPublisher(modifiedBody,String.class);\n        HttpHeaders headers = new HttpHeaders();\n        headers.putAll(exchange.getRequest().getHeaders());\n        //重要 不处理会导致请求失败\n        headers.remove(HttpHeaders.CONTENT_LENGTH);\n        CachedBodyOutputMessage outputMessage = new CachedBodyOutputMessage(exchange, headers);\n\n        return bodyInserter.insert(outputMessage, new BodyInserterContext())\n                .then(Mono.defer(() -&gt; &#123;\n                    ServerHttpRequestDecorator decorator = new ServerHttpRequestDecorator(\n                            exchange.getRequest()) &#123;\n                        @Override\n                        public HttpHeaders getHeaders() &#123;\n                            long contentLength = headers.getContentLength();\n                            HttpHeaders httpHeaders = new HttpHeaders();\n                            httpHeaders.putAll(super.getHeaders());\n                            if (contentLength &gt; 0) &#123;\n                                httpHeaders.setContentLength(contentLength);\n                            &#125;\n                            return httpHeaders;\n                        &#125;\n\n                        @Override\n                        public Flux&lt;DataBuffer&gt; getBody() &#123;\n                            return outputMessage.getBody();\n                        &#125;\n                    &#125;;\n                    ServerHttpResponse decoratedResponse = decorate(exchange, trace);\n                    return chain.filter(exchange.mutate().request(decorator).response(decoratedResponse).build());\n                &#125;));\n    &#125;\n&#125;</code></pre>\n<h3 id=\"新增headers\"><a href=\"#新增headers\" class=\"headerlink\" title=\"新增headers\"></a>新增headers</h3><pre><code class=\"java\">@Configuration\npublic class AuthGatewayFilter implements GlobalFilter, Ordered &#123;\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) &#123;\n        Consumer&lt;HttpHeaders&gt; httpHeaders = httpHeader -&gt; &#123;\n            // 存在相同的key,直接添加会报错\n            if(StringUtils.isBlank(httpHeader.getFirst(&quot;xxx&quot;)))&#123;\n                httpHeader.add(&quot;xxx&quot;, &quot;xxx&quot;);\n            &#125;\n        &#125;;\n        ServerHttpRequest serverHttpRequest = exchange.getRequest().mutate().headers(httpHeaders).build();\n        exchange = exchange.mutate().request(serverHttpRequest).build();\n\n        return chain.filter(exchange);\n    &#125;\n    @Override\n    public int getOrder() &#123;\n        return Ordered.HIGHEST_PRECEDENCE - 1;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"请求非json格式转jsondemo\"><a href=\"#请求非json格式转jsondemo\" class=\"headerlink\" title=\"请求非json格式转jsondemo\"></a>请求非json格式转jsondemo</h3><pre><code class=\"java\">class Demo&#123;\n\n    /** application/x-www-form-urlencoded 转json **/\n    private Map&lt;String, Object&gt; decodeBody(String body) &#123;\n        return Arrays.stream(body.split(&quot;&amp;&quot;))\n                .map(s -&gt; s.split(&quot;=&quot;))\n                .collect(Collectors.toMap(arr -&gt; arr[0], arr -&gt; arr[1]));\n    &#125;\n\n    /** fomrData(非文件)转 json 数据 **/\n    private String parseFormData2Json(String requestParam)&#123;\n        if(StringUtils.isBlank(requestParam) \n                &amp;&amp; !requestParam.contains(&quot;filename&quot;))&#123;\n            return requestParam;\n        &#125;\n        try&#123;\n            requestParam = requestParam.replace(&quot;-&quot;,&quot;&quot;).split(&quot;-&quot;)[0];\n            String code = requestParam.split(&quot;\\n&quot;)[0];\n            requestParam = requestParam.replaceAll(code,&quot;&quot;)\n                    .replaceAll(&quot;ContentDisposition: formdata;&quot;,&quot;&quot;)\n                    .replaceAll(&quot;\\n&quot;,&quot;&quot;)\n                    .replaceAll(&quot;name=&quot;,&quot;,&quot;)\n                    .replaceAll(&quot;\\&quot;\\r\\r&quot;,&quot;\\&quot;:\\&quot;&quot;)\n                    .replaceFirst(&quot;,&quot;,&quot;&quot;)\n                    .replaceAll(&quot;\\r&quot;,&quot;\\&quot;&quot;)\n            ;\n            requestParam = &quot;&#123;&quot; + requestParam + &quot;\\&quot;&#125;&quot;;\n        &#125; catch (Exception e)&#123;\n            e.printStackTrace();\n        &#125;\n        return requestParam;\n    &#125;\n&#125;\n</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"文章收集\"><a href=\"#文章收集\" class=\"headerlink\" title=\"文章收集\"></a>文章收集</h3><ul>\n<li><a href=\"https://cloud.spring.io/spring-cloud-static/spring-cloud-gateway/2.1.0.RC3/multi/multi_spring-cloud-gateway.html\">SpringCloudGateway-2.1.0.RC3</a></li>\n<li><a href=\"https://spring.io/projects/spring-cloud-gateway\">SpringCloudGateway官网</a></li>\n<li><a href=\"https://www.haoyizebo.com/posts/876ed1e8/\">SpringCloudGateway(读取、修改RequestBody)(转)</a></li>\n</ul>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><pre><code class=\"yaml\">spring:\n  application:\n    name: cloud-gateway\n  cloud:\n    httpclient:\n      connect-timeout: 20000\n      pool:\n        max-idle-time: 20000\n    #开启从注册中心动态创建路由的功能，利用微服务名进行路由\n#    discovery:\n#      locator:\n#        lower-case-service-id: true\n#        enabled: true\n\n    # 相关文档 https://www.cnblogs.com/crazymakercircle/p/11704077.html\n    # uri相同时，只有最后一个会生效\n    #一个请求满足多个路由的断言条件时，请求只会被首个成功匹配的路由转发；\n    #predicates断言，可根据datetime、Cookie、Header、Host、Method、Path、Queryparam、RemoteAddr匹配\n    #filter: 支持PrefixPath、RewritePath、SetPath、RedirectTo、RemoveRequestHeader、\n    #RemoveResponseHeader、SetStatus、StripPrefix、RequestSize、Default-filters\n    gateway:\n      routes:\n      #根据url拦截\n      - id: service1_v1\n        uri: https://www.so.com/?quanso.com.cn\n        predicates:\n          - Path=/360\n#      - id: service1_v2\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/v2\n\n      #拦截v1请求，并带上/api，转发到8080端口上\n#      - id: service1_v3\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/v1\n#        filters:\n#          - PrefixPath=/api\n\n      #predicates断言，可根据datetime/Cookie/Header/Host/Method/Path/Queryparam/RemoteAddr匹配\n      - id: queryParam-baidu-route\n        uri: https://www.baidu.com\n        predicates:\n          - Query=baidu\n      - id: queryParam-bing-route\n        uri: https://bing.com/\n        predicates:\n          - Query=bing, tr. #参数中包含bing,且值为tr开头的三位参数 才能匹配到\n\n#      - id: queryParam-release2-route\n#        uri: http://localhost:8080/api/v2\n#        predicates:\n#          - Path=/api\n#          - Weight=service2, 90\n\n#      - id: queryParam-head-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Header=Jump, 1001 #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n#      - id: queryParam-host-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Host=*.apix #请求头中包含信息才校验通过\n#        filters:\n#          - PrefixPath=/api\n\n      #测试StripPrefix\n#      - id: full-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Query=full\n#        filters:\n#          - PrefixPath=/full\n#          - StripPrefix=0\n\n      # 熔断降级\n#      - id: queryParam-fallback-route\n#        uri: http://localhost:8080\n#        predicates:\n#          - Path=/test\n#        filters:\n#          - name: Hystrix\n#            args:\n#              name: default\n#              fallbackUri: forward:/fallback\n#      - id: fallback-route\n#        uri: http://localhost:8080/fallback\n#        predicates:\n#          - Path=/fallback\n\n        # 金丝雀发布\n      - id: release1-route\n        uri: http://localhost:8080\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n      - id: release2-route\n        uri: http://localhost:8081\n        predicates:\n          - Path=/v1\n          - Weight=service1, 50\n        filters:\n          - PrefixPath=/api\n\n\n#hystrix.command.fallbackA.execution.isolation.thread.timeoutInMilliseconds: 5000\n# hystrix 信号量隔离，1.5秒后自动超时\nhystrix:\n  command:\n    default:\n      execution:\n        isolation:\n          strategy: SEMAPHORE\n          thread:\n            timeoutInMilliseconds: 1500\n</code></pre>\n<h3 id=\"获取及改写RequestBody示例\"><a href=\"#获取及改写RequestBody示例\" class=\"headerlink\" title=\"获取及改写RequestBody示例\"></a>获取及改写RequestBody示例</h3><pre><code class=\"java\">class DemoFilter implements GlobalFilter, Ordered&#123;\n    @Resource\n    private ServerCodecConfigurer configurer;\n\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) &#123;\n        ServerRequest serverRequest = ServerRequest.create(exchange, configurer.getReaders());\n\n        // read &amp; modify body\n        Mono&lt;String&gt; modifiedBody = serverRequest.bodyToMono(String.class)\n                .flatMap(body -&gt; &#123;\n                    //例子：验签\n                    boolean checkFlag = paramSignCheck(jsonParam);\n                    if(!checkFlag)&#123;\n                        return Mono.error(new Exception(&quot;验签失败&quot;));\n                    &#125;\n                    return Mono.just(body);\n                &#125;);\n\n        BodyInserter bodyInserter = BodyInserters.fromPublisher(modifiedBody,String.class);\n        HttpHeaders headers = new HttpHeaders();\n        headers.putAll(exchange.getRequest().getHeaders());\n        //重要 不处理会导致请求失败\n        headers.remove(HttpHeaders.CONTENT_LENGTH);\n        CachedBodyOutputMessage outputMessage = new CachedBodyOutputMessage(exchange, headers);\n\n        return bodyInserter.insert(outputMessage, new BodyInserterContext())\n                .then(Mono.defer(() -&gt; &#123;\n                    ServerHttpRequestDecorator decorator = new ServerHttpRequestDecorator(\n                            exchange.getRequest()) &#123;\n                        @Override\n                        public HttpHeaders getHeaders() &#123;\n                            long contentLength = headers.getContentLength();\n                            HttpHeaders httpHeaders = new HttpHeaders();\n                            httpHeaders.putAll(super.getHeaders());\n                            if (contentLength &gt; 0) &#123;\n                                httpHeaders.setContentLength(contentLength);\n                            &#125;\n                            return httpHeaders;\n                        &#125;\n\n                        @Override\n                        public Flux&lt;DataBuffer&gt; getBody() &#123;\n                            return outputMessage.getBody();\n                        &#125;\n                    &#125;;\n                    ServerHttpResponse decoratedResponse = decorate(exchange, trace);\n                    return chain.filter(exchange.mutate().request(decorator).response(decoratedResponse).build());\n                &#125;));\n    &#125;\n&#125;</code></pre>\n<h3 id=\"新增headers\"><a href=\"#新增headers\" class=\"headerlink\" title=\"新增headers\"></a>新增headers</h3><pre><code class=\"java\">@Configuration\npublic class AuthGatewayFilter implements GlobalFilter, Ordered &#123;\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) &#123;\n        Consumer&lt;HttpHeaders&gt; httpHeaders = httpHeader -&gt; &#123;\n            // 存在相同的key,直接添加会报错\n            if(StringUtils.isBlank(httpHeader.getFirst(&quot;xxx&quot;)))&#123;\n                httpHeader.add(&quot;xxx&quot;, &quot;xxx&quot;);\n            &#125;\n        &#125;;\n        ServerHttpRequest serverHttpRequest = exchange.getRequest().mutate().headers(httpHeaders).build();\n        exchange = exchange.mutate().request(serverHttpRequest).build();\n\n        return chain.filter(exchange);\n    &#125;\n    @Override\n    public int getOrder() &#123;\n        return Ordered.HIGHEST_PRECEDENCE - 1;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"请求非json格式转jsondemo\"><a href=\"#请求非json格式转jsondemo\" class=\"headerlink\" title=\"请求非json格式转jsondemo\"></a>请求非json格式转jsondemo</h3><pre><code class=\"java\">class Demo&#123;\n\n    /** application/x-www-form-urlencoded 转json **/\n    private Map&lt;String, Object&gt; decodeBody(String body) &#123;\n        return Arrays.stream(body.split(&quot;&amp;&quot;))\n                .map(s -&gt; s.split(&quot;=&quot;))\n                .collect(Collectors.toMap(arr -&gt; arr[0], arr -&gt; arr[1]));\n    &#125;\n\n    /** fomrData(非文件)转 json 数据 **/\n    private String parseFormData2Json(String requestParam)&#123;\n        if(StringUtils.isBlank(requestParam) \n                &amp;&amp; !requestParam.contains(&quot;filename&quot;))&#123;\n            return requestParam;\n        &#125;\n        try&#123;\n            requestParam = requestParam.replace(&quot;-&quot;,&quot;&quot;).split(&quot;-&quot;)[0];\n            String code = requestParam.split(&quot;\\n&quot;)[0];\n            requestParam = requestParam.replaceAll(code,&quot;&quot;)\n                    .replaceAll(&quot;ContentDisposition: formdata;&quot;,&quot;&quot;)\n                    .replaceAll(&quot;\\n&quot;,&quot;&quot;)\n                    .replaceAll(&quot;name=&quot;,&quot;,&quot;)\n                    .replaceAll(&quot;\\&quot;\\r\\r&quot;,&quot;\\&quot;:\\&quot;&quot;)\n                    .replaceFirst(&quot;,&quot;,&quot;&quot;)\n                    .replaceAll(&quot;\\r&quot;,&quot;\\&quot;&quot;)\n            ;\n            requestParam = &quot;&#123;&quot; + requestParam + &quot;\\&quot;&#125;&quot;;\n        &#125; catch (Exception e)&#123;\n            e.printStackTrace();\n        &#125;\n        return requestParam;\n    &#125;\n&#125;\n</code></pre>\n"},{"title":"MySQL相关","date":"2020-10-02T07:51:46.000Z","_content":"\n### 存储引擎区别\n\n- 查看数据库支持的存储引擎\n```sql\nshow engines;\n```\n\n类型 | 磁盘文件 | 特性 | 适用场景\n---|--- | --- | --- |\nFEDERATED||用来访问远程表存储引擎|访问远程表\nMRG_MYISAM||把多个MyISAM表合并为一个逻辑单元；查询一个表时，相当与查询其所有成员表|可以用分区表替换merge表|\nMyISAM|.MDY数据)<br/> .MYI(索引)|主要的非实物处理存储引擎|\nBLACKHOLE||丢弃写操作，读操作返回空内容|\nCSV|.CSV(数据)<br/>.CSM(元数据)|存储数据时，会以逗号作为数据项之间的分割符号|不支持索引，数据存在为普通文本文件\nMEMORY||置于内存的表|\nARCHIVE||用于数据存档(行插入后不能再修改)|数据归档，大批量存储后不修改\nInnoDB|.ibd(数据&索引)|具备外键支持功能的事务处理引擎|\nPERFORMANCE_SCHEMA||用于监视MySQL服务器|\nNDB||集群存储引擎||\n|TokuDB||存储速度快，查询速度略慢与InnoDB,支持事务等，未来替代InnoDB|\n\n\n### 建表语句\n```sql\n1.表结构完全复制\ncreate table user_bak LIKE user;\n\n2.使用某些字段建表\ncreate table user_bak select now() as time ;\n\n3.建表时字段值强制转换\ncreate table user_bak select CAST('2019-8-01' as UNSIGNED) as time;\n\n4.临时表\n解释：只对当前会话有效，有同名表则原表隐藏不可见，会话结束自动清除\ncreate temporary table user_bak  like user;\ndrop temporary table user_bak;\n```\n\n### Cast类型强制转换\n```sql\n语法: \n    Cast(字段名 as 转换的类型 )\n\n支持的类型:\n    CHAR[(N)] 字符型 \n    DATE 日期型\n    DATETIME 日期和时间型\n    DECIMAL float型\n    SIGNED int\n    TIME 时间型\n\n场景:\n    1.解决utf8字符查询时传入表情符，导致报错；\n\n```\n\n### 新建分区表\n- 示例\n```sql\ncreate table user_bak (\n id int(11) UNSIGNED AUTO_INCREMENT ,\n `name` varchar(200) DEFAULT null COMMENT '名称',\n rand_num int(11) DEFAULT NULL COMMENT '随机数',\n birthday datetime default null comment '生日',\n PRIMARY KEY (`id`,rand_num)\n) ENGINE = INNODB partition by RANGE (rand_num)\n(\n\tPARTITION p0 VALUES less THAN (20),\n\tPARTITION p1 VALUES less THAN (40),\n\tPARTITION p2 VALUES less THAN (60),\n\tPARTITION p3 VALUES less THAN (80),\n\tPARTITION p4 VALUES less THAN MAXVALUE\n);\n```\n\n- 注意点\n\n```textmate\n1.PRIMARY必须包含分区的字段\n2.不能单独创建分区，建表时就要创建\n```\n\n- 常见异常\n\n```textmate\n1.ERROR 1064  不能单独创建分区\n解决：建表时就要把分区创建好\n\n2.ERROR 1503 主键必须包含分区函数中所有列\n解决：创建分区的字段必须放在主键索引中\n```\n\n### 子查询\n```sql\n-- 1.ALL - 查询返回单个结果,类似in操作\nselect * from user_bak where (id) \n>= ALL(select id from user_bak where id = 10)\n\n-- 2.ANY & SUM -效果一样,类似or操作\nselect * from user_bak where (name,id) \n= SOME(select name,id from user_bak where id = 1 or name = 'eee')\n```\n\n### FullText全文搜索\n- 全文搜索类型\n\n```textmate\n1.自然语言搜索-搜索包含匹配词的信息\n2.布尔模式搜索-\n3.查询扩展搜索\n```\n- 创建索引需要满足的条件\n\n```textmate\n1.表类型为MyISAM,version5.6以后引入了对InnoDB支持\n2.字段类型只能是char/varchar/text类型\n3.全文搜索会自动忽略掉常用词(在记录中出现几率为50%以上)-验证可以查出来\n4.停用词会被过滤掉(the/after/other等)\n5.少于4个字符会被忽略，查不出来(默认4-84个字符范围，可更改)\n```\n\n- 语法\n\n```sql\n-- 自然语言\nselect *,match(`name`) against('good boy') \nas 'percentage' from `user` where match(`name`) against('good boy');\n\n-- 布尔模式\nselect *,match(`name`) against('good boy' in boolean MODE) as 'percentage' from `user` where match(`name`) against('good boy' in boolean MODE);\n\n-- 内容顺序完全匹配\nselect *,match(`name`) against('\"good boy\"' in boolean MODE) as 'percentage' from `user` where match(`name`) against('\"good boy\"' in boolean MODE);\n\n-- 扩展查询\nselect *,match(`name`) against('good boy' with query expansion) as 'percentage' from `user` where match(`name`) against('good boy'  with query expansion);\n```\n\n- 修改查询字符长度\n\n```textmate\n1.my.cnf文件中ft_min_word_len\n2.重建FullText索引或者快速修复\nrepair table table_name quick;\n```\n\n## 字符集\n### 有字符集有关的系统设置\n```yaml\ncharacter_set_system 用于存储的字符集\ncharacter_set_server 服务器默认字符集\ncollation_server  系统排序规则\ncharacter_set_database 数据库字符集\ncollation_database  数据库排序规则\ncharacter_set_client 客户端向服务器发送SQL时使用的字符集\ncharacter_set_result 表示服务器返回结果时使用的字符集\ncharacter_set_connection 连接时使用的字符串\ncharacter_set_filesystem 文件系统字符集\n```\n\n### 空间值\n```textmate\nOpenGIS规范\npoint 类型值,只支持InnoDB/MyISAM/NDB/ARCHIVE引擎\npoint(xxxx,xxxx)\n```\n\n### 模糊匹配查询\n```textmate\n1.like\n    % 匹配任意数量的字符序列\n    _ 只能匹配单个字符\n    \\%  \\_  转义\n2.REGEXP-正则查询\n\n```\n\n### 新建用户后授权\n```sql\n-- %表示所有IP可连接\nCREATE USER `用户名`@`%` IDENTIFIED BY '密码';\ngrant all privileges on jwgateway.* to '用户名'@'%' identified by '密码';\nselect * from mysql.user;\n```\n","source":"_posts/backend/storage/mysql-other.md","raw":"---\ntitle: MySQL相关\ndate: 2020-10-02 15:51:46\ntags: \n- mysql\ncategories: \n- 存储\n---\n\n### 存储引擎区别\n\n- 查看数据库支持的存储引擎\n```sql\nshow engines;\n```\n\n类型 | 磁盘文件 | 特性 | 适用场景\n---|--- | --- | --- |\nFEDERATED||用来访问远程表存储引擎|访问远程表\nMRG_MYISAM||把多个MyISAM表合并为一个逻辑单元；查询一个表时，相当与查询其所有成员表|可以用分区表替换merge表|\nMyISAM|.MDY数据)<br/> .MYI(索引)|主要的非实物处理存储引擎|\nBLACKHOLE||丢弃写操作，读操作返回空内容|\nCSV|.CSV(数据)<br/>.CSM(元数据)|存储数据时，会以逗号作为数据项之间的分割符号|不支持索引，数据存在为普通文本文件\nMEMORY||置于内存的表|\nARCHIVE||用于数据存档(行插入后不能再修改)|数据归档，大批量存储后不修改\nInnoDB|.ibd(数据&索引)|具备外键支持功能的事务处理引擎|\nPERFORMANCE_SCHEMA||用于监视MySQL服务器|\nNDB||集群存储引擎||\n|TokuDB||存储速度快，查询速度略慢与InnoDB,支持事务等，未来替代InnoDB|\n\n\n### 建表语句\n```sql\n1.表结构完全复制\ncreate table user_bak LIKE user;\n\n2.使用某些字段建表\ncreate table user_bak select now() as time ;\n\n3.建表时字段值强制转换\ncreate table user_bak select CAST('2019-8-01' as UNSIGNED) as time;\n\n4.临时表\n解释：只对当前会话有效，有同名表则原表隐藏不可见，会话结束自动清除\ncreate temporary table user_bak  like user;\ndrop temporary table user_bak;\n```\n\n### Cast类型强制转换\n```sql\n语法: \n    Cast(字段名 as 转换的类型 )\n\n支持的类型:\n    CHAR[(N)] 字符型 \n    DATE 日期型\n    DATETIME 日期和时间型\n    DECIMAL float型\n    SIGNED int\n    TIME 时间型\n\n场景:\n    1.解决utf8字符查询时传入表情符，导致报错；\n\n```\n\n### 新建分区表\n- 示例\n```sql\ncreate table user_bak (\n id int(11) UNSIGNED AUTO_INCREMENT ,\n `name` varchar(200) DEFAULT null COMMENT '名称',\n rand_num int(11) DEFAULT NULL COMMENT '随机数',\n birthday datetime default null comment '生日',\n PRIMARY KEY (`id`,rand_num)\n) ENGINE = INNODB partition by RANGE (rand_num)\n(\n\tPARTITION p0 VALUES less THAN (20),\n\tPARTITION p1 VALUES less THAN (40),\n\tPARTITION p2 VALUES less THAN (60),\n\tPARTITION p3 VALUES less THAN (80),\n\tPARTITION p4 VALUES less THAN MAXVALUE\n);\n```\n\n- 注意点\n\n```textmate\n1.PRIMARY必须包含分区的字段\n2.不能单独创建分区，建表时就要创建\n```\n\n- 常见异常\n\n```textmate\n1.ERROR 1064  不能单独创建分区\n解决：建表时就要把分区创建好\n\n2.ERROR 1503 主键必须包含分区函数中所有列\n解决：创建分区的字段必须放在主键索引中\n```\n\n### 子查询\n```sql\n-- 1.ALL - 查询返回单个结果,类似in操作\nselect * from user_bak where (id) \n>= ALL(select id from user_bak where id = 10)\n\n-- 2.ANY & SUM -效果一样,类似or操作\nselect * from user_bak where (name,id) \n= SOME(select name,id from user_bak where id = 1 or name = 'eee')\n```\n\n### FullText全文搜索\n- 全文搜索类型\n\n```textmate\n1.自然语言搜索-搜索包含匹配词的信息\n2.布尔模式搜索-\n3.查询扩展搜索\n```\n- 创建索引需要满足的条件\n\n```textmate\n1.表类型为MyISAM,version5.6以后引入了对InnoDB支持\n2.字段类型只能是char/varchar/text类型\n3.全文搜索会自动忽略掉常用词(在记录中出现几率为50%以上)-验证可以查出来\n4.停用词会被过滤掉(the/after/other等)\n5.少于4个字符会被忽略，查不出来(默认4-84个字符范围，可更改)\n```\n\n- 语法\n\n```sql\n-- 自然语言\nselect *,match(`name`) against('good boy') \nas 'percentage' from `user` where match(`name`) against('good boy');\n\n-- 布尔模式\nselect *,match(`name`) against('good boy' in boolean MODE) as 'percentage' from `user` where match(`name`) against('good boy' in boolean MODE);\n\n-- 内容顺序完全匹配\nselect *,match(`name`) against('\"good boy\"' in boolean MODE) as 'percentage' from `user` where match(`name`) against('\"good boy\"' in boolean MODE);\n\n-- 扩展查询\nselect *,match(`name`) against('good boy' with query expansion) as 'percentage' from `user` where match(`name`) against('good boy'  with query expansion);\n```\n\n- 修改查询字符长度\n\n```textmate\n1.my.cnf文件中ft_min_word_len\n2.重建FullText索引或者快速修复\nrepair table table_name quick;\n```\n\n## 字符集\n### 有字符集有关的系统设置\n```yaml\ncharacter_set_system 用于存储的字符集\ncharacter_set_server 服务器默认字符集\ncollation_server  系统排序规则\ncharacter_set_database 数据库字符集\ncollation_database  数据库排序规则\ncharacter_set_client 客户端向服务器发送SQL时使用的字符集\ncharacter_set_result 表示服务器返回结果时使用的字符集\ncharacter_set_connection 连接时使用的字符串\ncharacter_set_filesystem 文件系统字符集\n```\n\n### 空间值\n```textmate\nOpenGIS规范\npoint 类型值,只支持InnoDB/MyISAM/NDB/ARCHIVE引擎\npoint(xxxx,xxxx)\n```\n\n### 模糊匹配查询\n```textmate\n1.like\n    % 匹配任意数量的字符序列\n    _ 只能匹配单个字符\n    \\%  \\_  转义\n2.REGEXP-正则查询\n\n```\n\n### 新建用户后授权\n```sql\n-- %表示所有IP可连接\nCREATE USER `用户名`@`%` IDENTIFIED BY '密码';\ngrant all privileges on jwgateway.* to '用户名'@'%' identified by '密码';\nselect * from mysql.user;\n```\n","slug":"backend/storage/mysql-other","published":1,"updated":"2021-07-26T07:38:28.785Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bek001xfms66g2q5ko4","content":"<h3 id=\"存储引擎区别\"><a href=\"#存储引擎区别\" class=\"headerlink\" title=\"存储引擎区别\"></a>存储引擎区别</h3><ul>\n<li>查看数据库支持的存储引擎<pre><code class=\"sql\">show engines;</code></pre>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>磁盘文件</th>\n<th>特性</th>\n<th>适用场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>FEDERATED</td>\n<td></td>\n<td>用来访问远程表存储引擎</td>\n<td>访问远程表</td>\n</tr>\n<tr>\n<td>MRG_MYISAM</td>\n<td></td>\n<td>把多个MyISAM表合并为一个逻辑单元；查询一个表时，相当与查询其所有成员表</td>\n<td>可以用分区表替换merge表</td>\n</tr>\n<tr>\n<td>MyISAM</td>\n<td>.MDY数据)<br/> .MYI(索引)</td>\n<td>主要的非实物处理存储引擎</td>\n<td></td>\n</tr>\n<tr>\n<td>BLACKHOLE</td>\n<td></td>\n<td>丢弃写操作，读操作返回空内容</td>\n<td></td>\n</tr>\n<tr>\n<td>CSV</td>\n<td>.CSV(数据)<br/>.CSM(元数据)</td>\n<td>存储数据时，会以逗号作为数据项之间的分割符号</td>\n<td>不支持索引，数据存在为普通文本文件</td>\n</tr>\n<tr>\n<td>MEMORY</td>\n<td></td>\n<td>置于内存的表</td>\n<td></td>\n</tr>\n<tr>\n<td>ARCHIVE</td>\n<td></td>\n<td>用于数据存档(行插入后不能再修改)</td>\n<td>数据归档，大批量存储后不修改</td>\n</tr>\n<tr>\n<td>InnoDB</td>\n<td>.ibd(数据&amp;索引)</td>\n<td>具备外键支持功能的事务处理引擎</td>\n<td></td>\n</tr>\n<tr>\n<td>PERFORMANCE_SCHEMA</td>\n<td></td>\n<td>用于监视MySQL服务器</td>\n<td></td>\n</tr>\n<tr>\n<td>NDB</td>\n<td></td>\n<td>集群存储引擎</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>TokuDB</td>\n<td></td>\n<td>存储速度快，查询速度略慢与InnoDB,支持事务等，未来替代InnoDB</td>\n</tr>\n</tbody></table>\n<h3 id=\"建表语句\"><a href=\"#建表语句\" class=\"headerlink\" title=\"建表语句\"></a>建表语句</h3><pre><code class=\"sql\">1.表结构完全复制\ncreate table user_bak LIKE user;\n\n2.使用某些字段建表\ncreate table user_bak select now() as time ;\n\n3.建表时字段值强制转换\ncreate table user_bak select CAST(&#39;2019-8-01&#39; as UNSIGNED) as time;\n\n4.临时表\n解释：只对当前会话有效，有同名表则原表隐藏不可见，会话结束自动清除\ncreate temporary table user_bak  like user;\ndrop temporary table user_bak;</code></pre>\n<h3 id=\"Cast类型强制转换\"><a href=\"#Cast类型强制转换\" class=\"headerlink\" title=\"Cast类型强制转换\"></a>Cast类型强制转换</h3><pre><code class=\"sql\">语法: \n    Cast(字段名 as 转换的类型 )\n\n支持的类型:\n    CHAR[(N)] 字符型 \n    DATE 日期型\n    DATETIME 日期和时间型\n    DECIMAL float型\n    SIGNED int\n    TIME 时间型\n\n场景:\n    1.解决utf8字符查询时传入表情符，导致报错；\n</code></pre>\n<h3 id=\"新建分区表\"><a href=\"#新建分区表\" class=\"headerlink\" title=\"新建分区表\"></a>新建分区表</h3><ul>\n<li><p>示例</p>\n<pre><code class=\"sql\">create table user_bak (\nid int(11) UNSIGNED AUTO_INCREMENT ,\n`name` varchar(200) DEFAULT null COMMENT &#39;名称&#39;,\nrand_num int(11) DEFAULT NULL COMMENT &#39;随机数&#39;,\nbirthday datetime default null comment &#39;生日&#39;,\nPRIMARY KEY (`id`,rand_num)\n) ENGINE = INNODB partition by RANGE (rand_num)\n(\n  PARTITION p0 VALUES less THAN (20),\n  PARTITION p1 VALUES less THAN (40),\n  PARTITION p2 VALUES less THAN (60),\n  PARTITION p3 VALUES less THAN (80),\n  PARTITION p4 VALUES less THAN MAXVALUE\n);</code></pre>\n</li>\n<li><p>注意点</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.PRIMARY必须包含分区的字段\n2.不能单独创建分区，建表时就要创建</code></pre>\n<ul>\n<li>常见异常</li>\n</ul>\n<pre><code class=\"textmate\">1.ERROR 1064  不能单独创建分区\n解决：建表时就要把分区创建好\n\n2.ERROR 1503 主键必须包含分区函数中所有列\n解决：创建分区的字段必须放在主键索引中</code></pre>\n<h3 id=\"子查询\"><a href=\"#子查询\" class=\"headerlink\" title=\"子查询\"></a>子查询</h3><pre><code class=\"sql\">-- 1.ALL - 查询返回单个结果,类似in操作\nselect * from user_bak where (id) \n&gt;= ALL(select id from user_bak where id = 10)\n\n-- 2.ANY &amp; SUM -效果一样,类似or操作\nselect * from user_bak where (name,id) \n= SOME(select name,id from user_bak where id = 1 or name = &#39;eee&#39;)</code></pre>\n<h3 id=\"FullText全文搜索\"><a href=\"#FullText全文搜索\" class=\"headerlink\" title=\"FullText全文搜索\"></a>FullText全文搜索</h3><ul>\n<li>全文搜索类型</li>\n</ul>\n<pre><code class=\"textmate\">1.自然语言搜索-搜索包含匹配词的信息\n2.布尔模式搜索-\n3.查询扩展搜索</code></pre>\n<ul>\n<li>创建索引需要满足的条件</li>\n</ul>\n<pre><code class=\"textmate\">1.表类型为MyISAM,version5.6以后引入了对InnoDB支持\n2.字段类型只能是char/varchar/text类型\n3.全文搜索会自动忽略掉常用词(在记录中出现几率为50%以上)-验证可以查出来\n4.停用词会被过滤掉(the/after/other等)\n5.少于4个字符会被忽略，查不出来(默认4-84个字符范围，可更改)</code></pre>\n<ul>\n<li>语法</li>\n</ul>\n<pre><code class=\"sql\">-- 自然语言\nselect *,match(`name`) against(&#39;good boy&#39;) \nas &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39;);\n\n-- 布尔模式\nselect *,match(`name`) against(&#39;good boy&#39; in boolean MODE) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39; in boolean MODE);\n\n-- 内容顺序完全匹配\nselect *,match(`name`) against(&#39;&quot;good boy&quot;&#39; in boolean MODE) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;&quot;good boy&quot;&#39; in boolean MODE);\n\n-- 扩展查询\nselect *,match(`name`) against(&#39;good boy&#39; with query expansion) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39;  with query expansion);</code></pre>\n<ul>\n<li>修改查询字符长度</li>\n</ul>\n<pre><code class=\"textmate\">1.my.cnf文件中ft_min_word_len\n2.重建FullText索引或者快速修复\nrepair table table_name quick;</code></pre>\n<h2 id=\"字符集\"><a href=\"#字符集\" class=\"headerlink\" title=\"字符集\"></a>字符集</h2><h3 id=\"有字符集有关的系统设置\"><a href=\"#有字符集有关的系统设置\" class=\"headerlink\" title=\"有字符集有关的系统设置\"></a>有字符集有关的系统设置</h3><pre><code class=\"yaml\">character_set_system 用于存储的字符集\ncharacter_set_server 服务器默认字符集\ncollation_server  系统排序规则\ncharacter_set_database 数据库字符集\ncollation_database  数据库排序规则\ncharacter_set_client 客户端向服务器发送SQL时使用的字符集\ncharacter_set_result 表示服务器返回结果时使用的字符集\ncharacter_set_connection 连接时使用的字符串\ncharacter_set_filesystem 文件系统字符集</code></pre>\n<h3 id=\"空间值\"><a href=\"#空间值\" class=\"headerlink\" title=\"空间值\"></a>空间值</h3><pre><code class=\"textmate\">OpenGIS规范\npoint 类型值,只支持InnoDB/MyISAM/NDB/ARCHIVE引擎\npoint(xxxx,xxxx)</code></pre>\n<h3 id=\"模糊匹配查询\"><a href=\"#模糊匹配查询\" class=\"headerlink\" title=\"模糊匹配查询\"></a>模糊匹配查询</h3><pre><code class=\"textmate\">1.like\n    % 匹配任意数量的字符序列\n    _ 只能匹配单个字符\n    \\%  \\_  转义\n2.REGEXP-正则查询\n</code></pre>\n<h3 id=\"新建用户后授权\"><a href=\"#新建用户后授权\" class=\"headerlink\" title=\"新建用户后授权\"></a>新建用户后授权</h3><pre><code class=\"sql\">-- %表示所有IP可连接\nCREATE USER `用户名`@`%` IDENTIFIED BY &#39;密码&#39;;\ngrant all privileges on jwgateway.* to &#39;用户名&#39;@&#39;%&#39; identified by &#39;密码&#39;;\nselect * from mysql.user;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"存储引擎区别\"><a href=\"#存储引擎区别\" class=\"headerlink\" title=\"存储引擎区别\"></a>存储引擎区别</h3><ul>\n<li>查看数据库支持的存储引擎<pre><code class=\"sql\">show engines;</code></pre>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>磁盘文件</th>\n<th>特性</th>\n<th>适用场景</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>FEDERATED</td>\n<td></td>\n<td>用来访问远程表存储引擎</td>\n<td>访问远程表</td>\n</tr>\n<tr>\n<td>MRG_MYISAM</td>\n<td></td>\n<td>把多个MyISAM表合并为一个逻辑单元；查询一个表时，相当与查询其所有成员表</td>\n<td>可以用分区表替换merge表</td>\n</tr>\n<tr>\n<td>MyISAM</td>\n<td>.MDY数据)<br/> .MYI(索引)</td>\n<td>主要的非实物处理存储引擎</td>\n<td></td>\n</tr>\n<tr>\n<td>BLACKHOLE</td>\n<td></td>\n<td>丢弃写操作，读操作返回空内容</td>\n<td></td>\n</tr>\n<tr>\n<td>CSV</td>\n<td>.CSV(数据)<br/>.CSM(元数据)</td>\n<td>存储数据时，会以逗号作为数据项之间的分割符号</td>\n<td>不支持索引，数据存在为普通文本文件</td>\n</tr>\n<tr>\n<td>MEMORY</td>\n<td></td>\n<td>置于内存的表</td>\n<td></td>\n</tr>\n<tr>\n<td>ARCHIVE</td>\n<td></td>\n<td>用于数据存档(行插入后不能再修改)</td>\n<td>数据归档，大批量存储后不修改</td>\n</tr>\n<tr>\n<td>InnoDB</td>\n<td>.ibd(数据&amp;索引)</td>\n<td>具备外键支持功能的事务处理引擎</td>\n<td></td>\n</tr>\n<tr>\n<td>PERFORMANCE_SCHEMA</td>\n<td></td>\n<td>用于监视MySQL服务器</td>\n<td></td>\n</tr>\n<tr>\n<td>NDB</td>\n<td></td>\n<td>集群存储引擎</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>TokuDB</td>\n<td></td>\n<td>存储速度快，查询速度略慢与InnoDB,支持事务等，未来替代InnoDB</td>\n</tr>\n</tbody></table>\n<h3 id=\"建表语句\"><a href=\"#建表语句\" class=\"headerlink\" title=\"建表语句\"></a>建表语句</h3><pre><code class=\"sql\">1.表结构完全复制\ncreate table user_bak LIKE user;\n\n2.使用某些字段建表\ncreate table user_bak select now() as time ;\n\n3.建表时字段值强制转换\ncreate table user_bak select CAST(&#39;2019-8-01&#39; as UNSIGNED) as time;\n\n4.临时表\n解释：只对当前会话有效，有同名表则原表隐藏不可见，会话结束自动清除\ncreate temporary table user_bak  like user;\ndrop temporary table user_bak;</code></pre>\n<h3 id=\"Cast类型强制转换\"><a href=\"#Cast类型强制转换\" class=\"headerlink\" title=\"Cast类型强制转换\"></a>Cast类型强制转换</h3><pre><code class=\"sql\">语法: \n    Cast(字段名 as 转换的类型 )\n\n支持的类型:\n    CHAR[(N)] 字符型 \n    DATE 日期型\n    DATETIME 日期和时间型\n    DECIMAL float型\n    SIGNED int\n    TIME 时间型\n\n场景:\n    1.解决utf8字符查询时传入表情符，导致报错；\n</code></pre>\n<h3 id=\"新建分区表\"><a href=\"#新建分区表\" class=\"headerlink\" title=\"新建分区表\"></a>新建分区表</h3><ul>\n<li><p>示例</p>\n<pre><code class=\"sql\">create table user_bak (\nid int(11) UNSIGNED AUTO_INCREMENT ,\n`name` varchar(200) DEFAULT null COMMENT &#39;名称&#39;,\nrand_num int(11) DEFAULT NULL COMMENT &#39;随机数&#39;,\nbirthday datetime default null comment &#39;生日&#39;,\nPRIMARY KEY (`id`,rand_num)\n) ENGINE = INNODB partition by RANGE (rand_num)\n(\n  PARTITION p0 VALUES less THAN (20),\n  PARTITION p1 VALUES less THAN (40),\n  PARTITION p2 VALUES less THAN (60),\n  PARTITION p3 VALUES less THAN (80),\n  PARTITION p4 VALUES less THAN MAXVALUE\n);</code></pre>\n</li>\n<li><p>注意点</p>\n</li>\n</ul>\n<pre><code class=\"textmate\">1.PRIMARY必须包含分区的字段\n2.不能单独创建分区，建表时就要创建</code></pre>\n<ul>\n<li>常见异常</li>\n</ul>\n<pre><code class=\"textmate\">1.ERROR 1064  不能单独创建分区\n解决：建表时就要把分区创建好\n\n2.ERROR 1503 主键必须包含分区函数中所有列\n解决：创建分区的字段必须放在主键索引中</code></pre>\n<h3 id=\"子查询\"><a href=\"#子查询\" class=\"headerlink\" title=\"子查询\"></a>子查询</h3><pre><code class=\"sql\">-- 1.ALL - 查询返回单个结果,类似in操作\nselect * from user_bak where (id) \n&gt;= ALL(select id from user_bak where id = 10)\n\n-- 2.ANY &amp; SUM -效果一样,类似or操作\nselect * from user_bak where (name,id) \n= SOME(select name,id from user_bak where id = 1 or name = &#39;eee&#39;)</code></pre>\n<h3 id=\"FullText全文搜索\"><a href=\"#FullText全文搜索\" class=\"headerlink\" title=\"FullText全文搜索\"></a>FullText全文搜索</h3><ul>\n<li>全文搜索类型</li>\n</ul>\n<pre><code class=\"textmate\">1.自然语言搜索-搜索包含匹配词的信息\n2.布尔模式搜索-\n3.查询扩展搜索</code></pre>\n<ul>\n<li>创建索引需要满足的条件</li>\n</ul>\n<pre><code class=\"textmate\">1.表类型为MyISAM,version5.6以后引入了对InnoDB支持\n2.字段类型只能是char/varchar/text类型\n3.全文搜索会自动忽略掉常用词(在记录中出现几率为50%以上)-验证可以查出来\n4.停用词会被过滤掉(the/after/other等)\n5.少于4个字符会被忽略，查不出来(默认4-84个字符范围，可更改)</code></pre>\n<ul>\n<li>语法</li>\n</ul>\n<pre><code class=\"sql\">-- 自然语言\nselect *,match(`name`) against(&#39;good boy&#39;) \nas &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39;);\n\n-- 布尔模式\nselect *,match(`name`) against(&#39;good boy&#39; in boolean MODE) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39; in boolean MODE);\n\n-- 内容顺序完全匹配\nselect *,match(`name`) against(&#39;&quot;good boy&quot;&#39; in boolean MODE) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;&quot;good boy&quot;&#39; in boolean MODE);\n\n-- 扩展查询\nselect *,match(`name`) against(&#39;good boy&#39; with query expansion) as &#39;percentage&#39; from `user` where match(`name`) against(&#39;good boy&#39;  with query expansion);</code></pre>\n<ul>\n<li>修改查询字符长度</li>\n</ul>\n<pre><code class=\"textmate\">1.my.cnf文件中ft_min_word_len\n2.重建FullText索引或者快速修复\nrepair table table_name quick;</code></pre>\n<h2 id=\"字符集\"><a href=\"#字符集\" class=\"headerlink\" title=\"字符集\"></a>字符集</h2><h3 id=\"有字符集有关的系统设置\"><a href=\"#有字符集有关的系统设置\" class=\"headerlink\" title=\"有字符集有关的系统设置\"></a>有字符集有关的系统设置</h3><pre><code class=\"yaml\">character_set_system 用于存储的字符集\ncharacter_set_server 服务器默认字符集\ncollation_server  系统排序规则\ncharacter_set_database 数据库字符集\ncollation_database  数据库排序规则\ncharacter_set_client 客户端向服务器发送SQL时使用的字符集\ncharacter_set_result 表示服务器返回结果时使用的字符集\ncharacter_set_connection 连接时使用的字符串\ncharacter_set_filesystem 文件系统字符集</code></pre>\n<h3 id=\"空间值\"><a href=\"#空间值\" class=\"headerlink\" title=\"空间值\"></a>空间值</h3><pre><code class=\"textmate\">OpenGIS规范\npoint 类型值,只支持InnoDB/MyISAM/NDB/ARCHIVE引擎\npoint(xxxx,xxxx)</code></pre>\n<h3 id=\"模糊匹配查询\"><a href=\"#模糊匹配查询\" class=\"headerlink\" title=\"模糊匹配查询\"></a>模糊匹配查询</h3><pre><code class=\"textmate\">1.like\n    % 匹配任意数量的字符序列\n    _ 只能匹配单个字符\n    \\%  \\_  转义\n2.REGEXP-正则查询\n</code></pre>\n<h3 id=\"新建用户后授权\"><a href=\"#新建用户后授权\" class=\"headerlink\" title=\"新建用户后授权\"></a>新建用户后授权</h3><pre><code class=\"sql\">-- %表示所有IP可连接\nCREATE USER `用户名`@`%` IDENTIFIED BY &#39;密码&#39;;\ngrant all privileges on jwgateway.* to &#39;用户名&#39;@&#39;%&#39; identified by &#39;密码&#39;;\nselect * from mysql.user;</code></pre>\n"},{"title":"Canal服务搭建","date":"2020-10-02T07:51:46.000Z","_content":"\n### 相关网址\n- [官网](https://github.com/alibaba/canal/wiki/Home)\n- [快速开始](https://github.com/alibaba/canal/wiki/QuickStart)\n- [Release下载](https://github.com/alibaba/canal/releases)\n- [Docker镜像地址](https://hub.docker.com/r/canal/canal-server/tags/)\n- [Canal Admin QuickStart](https://github.com/alibaba/canal/wiki/Canal-Admin-QuickStart)\n- [Canal Client Example](https://github.com/alibaba/canal/wiki/ClientExample)\n\n### 直接部署\n#### 准备\n```textmate\n1.下载安装包(点击上面Release)\n    这里用1.1.4版本,下载 canal.deployer-1.1.4.tar.gz(主要程序) 和 canal.admin-1.1.4.tar.gz(管理程序)\n\n2.解压&配置\n    mkdir canal-deployer\n    mkdir canal-admin\n    tar -zxvf canal.deployer-1.1.4.tar.gz -C canal-deployer\n    tar -zxvg canal.admin-1.1.4.tar.gz -C canal-admin\n    修改 canal-deployer/conf 中 canal.properties(参考 快速开始，或参考底部配置)\n\n3.修改Instance配置\n    cd cd canal-deployer/conf/example/instance.properties\n    参考官网或底部instance.peroperties配置\n\n4.多Instance - 可选\n    cd canal-deployer/conf\n    cp -R example example2\n    修改example2中配置\n\n5.配置canal-admin\n    初始化数据脚本，脚本所在位置 canal-admin/conf/canal_manager.sql\n    修改配置，配置所在位置 canal-admin/conf/application.yml\n    修改其中的数据库配置、端口号、用户名密码等-可选\n\n6.启动\n    6-1.canal-admin启动( 访问链接 localhost:80 )\n        sh ./canal-admin/bin/startup.sh\n    6-2.canal-server启动\n        sh ./canal-deployer/bin/startup.sh\n    6-3.日志所在文件夹\n        cd canal-deployer/logs\n```\n\n### Docker搭建步骤\n> docker方式部署,注意配置时mysql的IP地址\n#### 准备\n```textmate\n1.mysql\n  需要确认mysql已开启binlog设置\n2.拉取canal-server镜像\n  docker pull canal/canal-server:v1.1.4\n3.下载docker启动脚本\n   wget https://github.com/alibaba/canal/blob/master/docker/run.sh\n4.修改启动脚本中数据库配置\n5.下载canal-admin包,修改配置(或者复制run.sh并修改启动命令，启动canal-admin)-可选\n   wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.admin-1.1.4.tar.gz\n   mkdir canal-admin\n   tar -zxvf canal.admin-1.1.4.tar.gz -C canal-admin\n   修改conf/application.yml中数据库配置\n   初始化mysql脚本，conf/canal_manager.sql\n6.canal-client\n   参考 Canal Client Example\n```\n\n#### 启动命令\n```textmate\n1.canal-server\n   运行 sh run.sh 会出现提示，复制提示后运行\n2.canal-admin\n   sh bin/startup.sh\n3.启动程序(canal-client)\n    成功后会打印出empty count : xx\n```\n\n#### CanalAdmin配置\n\n- 1.集群配置\n```yaml\n#集群名-local\n#zk地址-127.0.0.1:2181 (可以不搭建zk)\n#以下为配置项\n# register ip\ncanal.register.ip =\n# canal admin config\ncanal.admin.manager = 127.0.0.1:8089\ncanal.admin.port = 11110\ncanal.admin.user = admin\ncanal.admin.passwd = 4ACFE3202A5FF5CF467898FC58AAB1D615029441\n```\n\n- 2.Server管理\n```textmate\nServerIP-127.0.0.1 (同一集群下server ip不能重复)\nadmin端口号-11110\n```\n\n- 3.Instance管理\n```textmate\n注意：Instance名称要与cancal-server容器中文件夹一致，默认有example\nInstance配置项参考官网或底部配置\n```\n\n#### 一个Canal服务读取多个MySQL实例(docker中操作)\n```textmate\n1.进入canal容器内部关闭服务(不关闭复制会导致写入db2失败)\n    docker exec -it canal-server bash\n    ./stop.sh\n2.复制一份Instatnce配置(注意确认example2中文件权限与example中是否一样)\n    cd canal-server/conf\n    cp -R example example2\n3.Canal Admin中添加新配置\n    Instance名称-example2\n4.集成zookeeper\n    修改canal-server/conf/下配置canal.properties\n    canal.register.ip = zk服务器IP\n    canal.zkServers = zk服务器IP:2181\n```\n\n### 参考配置(基础版，其他配置参考官网)\n\n- canal.properties\n```yaml\n# 用以下配置项是需要修改的，其他默认配置项保留原来设置\n# canal地址\ncanal.register.ip = zk所在地址\n# zk配置，如果有用到则配置，没用到则保留默认设置\ncanal.admin.register.auto = true\ncanal.admin.register.cluster = 192.168.154.231:2181\ncanal.zkServers = 192.168.154.231:2181\n```\n\n- instance.properties\n```yaml\n# 用以下配置项是需要修改的，其他默认配置项保留原来设置(example2配置同下)\n# 数据库配置\ncanal.instance.master.address= 数据库IP:端口号\ncanal.instance.dbUsername = 用户名 \ncanal.instance.dbPassword = 密码\ncanal.instance.defaultDatabaseName = 要监控的库名，不设置则监听当前实例下所有库\ncanal.instance.connectionCharset = UTF-8\ncanal.instance.tsdb.enable=false\n```\n\n#### 常见问题\n- 服务都启动成功，客户端拉不到变更日志\n```textmate\n注意客户端中 canalConnector.subscribe() 中设置项，设置了值则服务中配置的过滤条件不生效\n参考配置 canalConnector.subscribe(\"sap_system\\\\..*,user_center\\\\..*\")\n```\n\n- 一个Canal-Service,多个client，运行时报错\n```textmate\n改为一个canal一个client，原因是多个client同时提交ack时，可能会存在重复提交的问题\n```\n","source":"_posts/backend/storage/canal.md","raw":"---\ntitle: Canal服务搭建\ndate: 2020-10-02 15:51:46\ntags: \n- canal\ncategories: \n- 存储\n---\n\n### 相关网址\n- [官网](https://github.com/alibaba/canal/wiki/Home)\n- [快速开始](https://github.com/alibaba/canal/wiki/QuickStart)\n- [Release下载](https://github.com/alibaba/canal/releases)\n- [Docker镜像地址](https://hub.docker.com/r/canal/canal-server/tags/)\n- [Canal Admin QuickStart](https://github.com/alibaba/canal/wiki/Canal-Admin-QuickStart)\n- [Canal Client Example](https://github.com/alibaba/canal/wiki/ClientExample)\n\n### 直接部署\n#### 准备\n```textmate\n1.下载安装包(点击上面Release)\n    这里用1.1.4版本,下载 canal.deployer-1.1.4.tar.gz(主要程序) 和 canal.admin-1.1.4.tar.gz(管理程序)\n\n2.解压&配置\n    mkdir canal-deployer\n    mkdir canal-admin\n    tar -zxvf canal.deployer-1.1.4.tar.gz -C canal-deployer\n    tar -zxvg canal.admin-1.1.4.tar.gz -C canal-admin\n    修改 canal-deployer/conf 中 canal.properties(参考 快速开始，或参考底部配置)\n\n3.修改Instance配置\n    cd cd canal-deployer/conf/example/instance.properties\n    参考官网或底部instance.peroperties配置\n\n4.多Instance - 可选\n    cd canal-deployer/conf\n    cp -R example example2\n    修改example2中配置\n\n5.配置canal-admin\n    初始化数据脚本，脚本所在位置 canal-admin/conf/canal_manager.sql\n    修改配置，配置所在位置 canal-admin/conf/application.yml\n    修改其中的数据库配置、端口号、用户名密码等-可选\n\n6.启动\n    6-1.canal-admin启动( 访问链接 localhost:80 )\n        sh ./canal-admin/bin/startup.sh\n    6-2.canal-server启动\n        sh ./canal-deployer/bin/startup.sh\n    6-3.日志所在文件夹\n        cd canal-deployer/logs\n```\n\n### Docker搭建步骤\n> docker方式部署,注意配置时mysql的IP地址\n#### 准备\n```textmate\n1.mysql\n  需要确认mysql已开启binlog设置\n2.拉取canal-server镜像\n  docker pull canal/canal-server:v1.1.4\n3.下载docker启动脚本\n   wget https://github.com/alibaba/canal/blob/master/docker/run.sh\n4.修改启动脚本中数据库配置\n5.下载canal-admin包,修改配置(或者复制run.sh并修改启动命令，启动canal-admin)-可选\n   wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.admin-1.1.4.tar.gz\n   mkdir canal-admin\n   tar -zxvf canal.admin-1.1.4.tar.gz -C canal-admin\n   修改conf/application.yml中数据库配置\n   初始化mysql脚本，conf/canal_manager.sql\n6.canal-client\n   参考 Canal Client Example\n```\n\n#### 启动命令\n```textmate\n1.canal-server\n   运行 sh run.sh 会出现提示，复制提示后运行\n2.canal-admin\n   sh bin/startup.sh\n3.启动程序(canal-client)\n    成功后会打印出empty count : xx\n```\n\n#### CanalAdmin配置\n\n- 1.集群配置\n```yaml\n#集群名-local\n#zk地址-127.0.0.1:2181 (可以不搭建zk)\n#以下为配置项\n# register ip\ncanal.register.ip =\n# canal admin config\ncanal.admin.manager = 127.0.0.1:8089\ncanal.admin.port = 11110\ncanal.admin.user = admin\ncanal.admin.passwd = 4ACFE3202A5FF5CF467898FC58AAB1D615029441\n```\n\n- 2.Server管理\n```textmate\nServerIP-127.0.0.1 (同一集群下server ip不能重复)\nadmin端口号-11110\n```\n\n- 3.Instance管理\n```textmate\n注意：Instance名称要与cancal-server容器中文件夹一致，默认有example\nInstance配置项参考官网或底部配置\n```\n\n#### 一个Canal服务读取多个MySQL实例(docker中操作)\n```textmate\n1.进入canal容器内部关闭服务(不关闭复制会导致写入db2失败)\n    docker exec -it canal-server bash\n    ./stop.sh\n2.复制一份Instatnce配置(注意确认example2中文件权限与example中是否一样)\n    cd canal-server/conf\n    cp -R example example2\n3.Canal Admin中添加新配置\n    Instance名称-example2\n4.集成zookeeper\n    修改canal-server/conf/下配置canal.properties\n    canal.register.ip = zk服务器IP\n    canal.zkServers = zk服务器IP:2181\n```\n\n### 参考配置(基础版，其他配置参考官网)\n\n- canal.properties\n```yaml\n# 用以下配置项是需要修改的，其他默认配置项保留原来设置\n# canal地址\ncanal.register.ip = zk所在地址\n# zk配置，如果有用到则配置，没用到则保留默认设置\ncanal.admin.register.auto = true\ncanal.admin.register.cluster = 192.168.154.231:2181\ncanal.zkServers = 192.168.154.231:2181\n```\n\n- instance.properties\n```yaml\n# 用以下配置项是需要修改的，其他默认配置项保留原来设置(example2配置同下)\n# 数据库配置\ncanal.instance.master.address= 数据库IP:端口号\ncanal.instance.dbUsername = 用户名 \ncanal.instance.dbPassword = 密码\ncanal.instance.defaultDatabaseName = 要监控的库名，不设置则监听当前实例下所有库\ncanal.instance.connectionCharset = UTF-8\ncanal.instance.tsdb.enable=false\n```\n\n#### 常见问题\n- 服务都启动成功，客户端拉不到变更日志\n```textmate\n注意客户端中 canalConnector.subscribe() 中设置项，设置了值则服务中配置的过滤条件不生效\n参考配置 canalConnector.subscribe(\"sap_system\\\\..*,user_center\\\\..*\")\n```\n\n- 一个Canal-Service,多个client，运行时报错\n```textmate\n改为一个canal一个client，原因是多个client同时提交ack时，可能会存在重复提交的问题\n```\n","slug":"backend/storage/canal","published":1,"updated":"2021-07-26T07:57:19.950Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3ben0021fms613b14dbl","content":"<h3 id=\"相关网址\"><a href=\"#相关网址\" class=\"headerlink\" title=\"相关网址\"></a>相关网址</h3><ul>\n<li><a href=\"https://github.com/alibaba/canal/wiki/Home\">官网</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/QuickStart\">快速开始</a></li>\n<li><a href=\"https://github.com/alibaba/canal/releases\">Release下载</a></li>\n<li><a href=\"https://hub.docker.com/r/canal/canal-server/tags/\">Docker镜像地址</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/Canal-Admin-QuickStart\">Canal Admin QuickStart</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/ClientExample\">Canal Client Example</a></li>\n</ul>\n<h3 id=\"直接部署\"><a href=\"#直接部署\" class=\"headerlink\" title=\"直接部署\"></a>直接部署</h3><h4 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h4><pre><code class=\"textmate\">1.下载安装包(点击上面Release)\n    这里用1.1.4版本,下载 canal.deployer-1.1.4.tar.gz(主要程序) 和 canal.admin-1.1.4.tar.gz(管理程序)\n\n2.解压&amp;配置\n    mkdir canal-deployer\n    mkdir canal-admin\n    tar -zxvf canal.deployer-1.1.4.tar.gz -C canal-deployer\n    tar -zxvg canal.admin-1.1.4.tar.gz -C canal-admin\n    修改 canal-deployer/conf 中 canal.properties(参考 快速开始，或参考底部配置)\n\n3.修改Instance配置\n    cd cd canal-deployer/conf/example/instance.properties\n    参考官网或底部instance.peroperties配置\n\n4.多Instance - 可选\n    cd canal-deployer/conf\n    cp -R example example2\n    修改example2中配置\n\n5.配置canal-admin\n    初始化数据脚本，脚本所在位置 canal-admin/conf/canal_manager.sql\n    修改配置，配置所在位置 canal-admin/conf/application.yml\n    修改其中的数据库配置、端口号、用户名密码等-可选\n\n6.启动\n    6-1.canal-admin启动( 访问链接 localhost:80 )\n        sh ./canal-admin/bin/startup.sh\n    6-2.canal-server启动\n        sh ./canal-deployer/bin/startup.sh\n    6-3.日志所在文件夹\n        cd canal-deployer/logs</code></pre>\n<h3 id=\"Docker搭建步骤\"><a href=\"#Docker搭建步骤\" class=\"headerlink\" title=\"Docker搭建步骤\"></a>Docker搭建步骤</h3><blockquote>\n<p>docker方式部署,注意配置时mysql的IP地址</p>\n</blockquote>\n<h4 id=\"准备-1\"><a href=\"#准备-1\" class=\"headerlink\" title=\"准备\"></a>准备</h4><pre><code class=\"textmate\">1.mysql\n  需要确认mysql已开启binlog设置\n2.拉取canal-server镜像\n  docker pull canal/canal-server:v1.1.4\n3.下载docker启动脚本\n   wget https://github.com/alibaba/canal/blob/master/docker/run.sh\n4.修改启动脚本中数据库配置\n5.下载canal-admin包,修改配置(或者复制run.sh并修改启动命令，启动canal-admin)-可选\n   wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.admin-1.1.4.tar.gz\n   mkdir canal-admin\n   tar -zxvf canal.admin-1.1.4.tar.gz -C canal-admin\n   修改conf/application.yml中数据库配置\n   初始化mysql脚本，conf/canal_manager.sql\n6.canal-client\n   参考 Canal Client Example</code></pre>\n<h4 id=\"启动命令\"><a href=\"#启动命令\" class=\"headerlink\" title=\"启动命令\"></a>启动命令</h4><pre><code class=\"textmate\">1.canal-server\n   运行 sh run.sh 会出现提示，复制提示后运行\n2.canal-admin\n   sh bin/startup.sh\n3.启动程序(canal-client)\n    成功后会打印出empty count : xx</code></pre>\n<h4 id=\"CanalAdmin配置\"><a href=\"#CanalAdmin配置\" class=\"headerlink\" title=\"CanalAdmin配置\"></a>CanalAdmin配置</h4><ul>\n<li><p>1.集群配置</p>\n<pre><code class=\"yaml\">#集群名-local\n#zk地址-127.0.0.1:2181 (可以不搭建zk)\n#以下为配置项\n# register ip\ncanal.register.ip =\n# canal admin config\ncanal.admin.manager = 127.0.0.1:8089\ncanal.admin.port = 11110\ncanal.admin.user = admin\ncanal.admin.passwd = 4ACFE3202A5FF5CF467898FC58AAB1D615029441</code></pre>\n</li>\n<li><p>2.Server管理</p>\n<pre><code class=\"textmate\">ServerIP-127.0.0.1 (同一集群下server ip不能重复)\nadmin端口号-11110</code></pre>\n</li>\n<li><p>3.Instance管理</p>\n<pre><code class=\"textmate\">注意：Instance名称要与cancal-server容器中文件夹一致，默认有example\nInstance配置项参考官网或底部配置</code></pre>\n</li>\n</ul>\n<h4 id=\"一个Canal服务读取多个MySQL实例-docker中操作\"><a href=\"#一个Canal服务读取多个MySQL实例-docker中操作\" class=\"headerlink\" title=\"一个Canal服务读取多个MySQL实例(docker中操作)\"></a>一个Canal服务读取多个MySQL实例(docker中操作)</h4><pre><code class=\"textmate\">1.进入canal容器内部关闭服务(不关闭复制会导致写入db2失败)\n    docker exec -it canal-server bash\n    ./stop.sh\n2.复制一份Instatnce配置(注意确认example2中文件权限与example中是否一样)\n    cd canal-server/conf\n    cp -R example example2\n3.Canal Admin中添加新配置\n    Instance名称-example2\n4.集成zookeeper\n    修改canal-server/conf/下配置canal.properties\n    canal.register.ip = zk服务器IP\n    canal.zkServers = zk服务器IP:2181</code></pre>\n<h3 id=\"参考配置-基础版，其他配置参考官网\"><a href=\"#参考配置-基础版，其他配置参考官网\" class=\"headerlink\" title=\"参考配置(基础版，其他配置参考官网)\"></a>参考配置(基础版，其他配置参考官网)</h3><ul>\n<li><p>canal.properties</p>\n<pre><code class=\"yaml\"># 用以下配置项是需要修改的，其他默认配置项保留原来设置\n# canal地址\ncanal.register.ip = zk所在地址\n# zk配置，如果有用到则配置，没用到则保留默认设置\ncanal.admin.register.auto = true\ncanal.admin.register.cluster = 192.168.154.231:2181\ncanal.zkServers = 192.168.154.231:2181</code></pre>\n</li>\n<li><p>instance.properties</p>\n<pre><code class=\"yaml\"># 用以下配置项是需要修改的，其他默认配置项保留原来设置(example2配置同下)\n# 数据库配置\ncanal.instance.master.address= 数据库IP:端口号\ncanal.instance.dbUsername = 用户名 \ncanal.instance.dbPassword = 密码\ncanal.instance.defaultDatabaseName = 要监控的库名，不设置则监听当前实例下所有库\ncanal.instance.connectionCharset = UTF-8\ncanal.instance.tsdb.enable=false</code></pre>\n</li>\n</ul>\n<h4 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h4><ul>\n<li><p>服务都启动成功，客户端拉不到变更日志</p>\n<pre><code class=\"textmate\">注意客户端中 canalConnector.subscribe() 中设置项，设置了值则服务中配置的过滤条件不生效\n参考配置 canalConnector.subscribe(&quot;sap_system\\\\..*,user_center\\\\..*&quot;)</code></pre>\n</li>\n<li><p>一个Canal-Service,多个client，运行时报错</p>\n<pre><code class=\"textmate\">改为一个canal一个client，原因是多个client同时提交ack时，可能会存在重复提交的问题</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"相关网址\"><a href=\"#相关网址\" class=\"headerlink\" title=\"相关网址\"></a>相关网址</h3><ul>\n<li><a href=\"https://github.com/alibaba/canal/wiki/Home\">官网</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/QuickStart\">快速开始</a></li>\n<li><a href=\"https://github.com/alibaba/canal/releases\">Release下载</a></li>\n<li><a href=\"https://hub.docker.com/r/canal/canal-server/tags/\">Docker镜像地址</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/Canal-Admin-QuickStart\">Canal Admin QuickStart</a></li>\n<li><a href=\"https://github.com/alibaba/canal/wiki/ClientExample\">Canal Client Example</a></li>\n</ul>\n<h3 id=\"直接部署\"><a href=\"#直接部署\" class=\"headerlink\" title=\"直接部署\"></a>直接部署</h3><h4 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h4><pre><code class=\"textmate\">1.下载安装包(点击上面Release)\n    这里用1.1.4版本,下载 canal.deployer-1.1.4.tar.gz(主要程序) 和 canal.admin-1.1.4.tar.gz(管理程序)\n\n2.解压&amp;配置\n    mkdir canal-deployer\n    mkdir canal-admin\n    tar -zxvf canal.deployer-1.1.4.tar.gz -C canal-deployer\n    tar -zxvg canal.admin-1.1.4.tar.gz -C canal-admin\n    修改 canal-deployer/conf 中 canal.properties(参考 快速开始，或参考底部配置)\n\n3.修改Instance配置\n    cd cd canal-deployer/conf/example/instance.properties\n    参考官网或底部instance.peroperties配置\n\n4.多Instance - 可选\n    cd canal-deployer/conf\n    cp -R example example2\n    修改example2中配置\n\n5.配置canal-admin\n    初始化数据脚本，脚本所在位置 canal-admin/conf/canal_manager.sql\n    修改配置，配置所在位置 canal-admin/conf/application.yml\n    修改其中的数据库配置、端口号、用户名密码等-可选\n\n6.启动\n    6-1.canal-admin启动( 访问链接 localhost:80 )\n        sh ./canal-admin/bin/startup.sh\n    6-2.canal-server启动\n        sh ./canal-deployer/bin/startup.sh\n    6-3.日志所在文件夹\n        cd canal-deployer/logs</code></pre>\n<h3 id=\"Docker搭建步骤\"><a href=\"#Docker搭建步骤\" class=\"headerlink\" title=\"Docker搭建步骤\"></a>Docker搭建步骤</h3><blockquote>\n<p>docker方式部署,注意配置时mysql的IP地址</p>\n</blockquote>\n<h4 id=\"准备-1\"><a href=\"#准备-1\" class=\"headerlink\" title=\"准备\"></a>准备</h4><pre><code class=\"textmate\">1.mysql\n  需要确认mysql已开启binlog设置\n2.拉取canal-server镜像\n  docker pull canal/canal-server:v1.1.4\n3.下载docker启动脚本\n   wget https://github.com/alibaba/canal/blob/master/docker/run.sh\n4.修改启动脚本中数据库配置\n5.下载canal-admin包,修改配置(或者复制run.sh并修改启动命令，启动canal-admin)-可选\n   wget https://github.com/alibaba/canal/releases/download/canal-1.1.4/canal.admin-1.1.4.tar.gz\n   mkdir canal-admin\n   tar -zxvf canal.admin-1.1.4.tar.gz -C canal-admin\n   修改conf/application.yml中数据库配置\n   初始化mysql脚本，conf/canal_manager.sql\n6.canal-client\n   参考 Canal Client Example</code></pre>\n<h4 id=\"启动命令\"><a href=\"#启动命令\" class=\"headerlink\" title=\"启动命令\"></a>启动命令</h4><pre><code class=\"textmate\">1.canal-server\n   运行 sh run.sh 会出现提示，复制提示后运行\n2.canal-admin\n   sh bin/startup.sh\n3.启动程序(canal-client)\n    成功后会打印出empty count : xx</code></pre>\n<h4 id=\"CanalAdmin配置\"><a href=\"#CanalAdmin配置\" class=\"headerlink\" title=\"CanalAdmin配置\"></a>CanalAdmin配置</h4><ul>\n<li><p>1.集群配置</p>\n<pre><code class=\"yaml\">#集群名-local\n#zk地址-127.0.0.1:2181 (可以不搭建zk)\n#以下为配置项\n# register ip\ncanal.register.ip =\n# canal admin config\ncanal.admin.manager = 127.0.0.1:8089\ncanal.admin.port = 11110\ncanal.admin.user = admin\ncanal.admin.passwd = 4ACFE3202A5FF5CF467898FC58AAB1D615029441</code></pre>\n</li>\n<li><p>2.Server管理</p>\n<pre><code class=\"textmate\">ServerIP-127.0.0.1 (同一集群下server ip不能重复)\nadmin端口号-11110</code></pre>\n</li>\n<li><p>3.Instance管理</p>\n<pre><code class=\"textmate\">注意：Instance名称要与cancal-server容器中文件夹一致，默认有example\nInstance配置项参考官网或底部配置</code></pre>\n</li>\n</ul>\n<h4 id=\"一个Canal服务读取多个MySQL实例-docker中操作\"><a href=\"#一个Canal服务读取多个MySQL实例-docker中操作\" class=\"headerlink\" title=\"一个Canal服务读取多个MySQL实例(docker中操作)\"></a>一个Canal服务读取多个MySQL实例(docker中操作)</h4><pre><code class=\"textmate\">1.进入canal容器内部关闭服务(不关闭复制会导致写入db2失败)\n    docker exec -it canal-server bash\n    ./stop.sh\n2.复制一份Instatnce配置(注意确认example2中文件权限与example中是否一样)\n    cd canal-server/conf\n    cp -R example example2\n3.Canal Admin中添加新配置\n    Instance名称-example2\n4.集成zookeeper\n    修改canal-server/conf/下配置canal.properties\n    canal.register.ip = zk服务器IP\n    canal.zkServers = zk服务器IP:2181</code></pre>\n<h3 id=\"参考配置-基础版，其他配置参考官网\"><a href=\"#参考配置-基础版，其他配置参考官网\" class=\"headerlink\" title=\"参考配置(基础版，其他配置参考官网)\"></a>参考配置(基础版，其他配置参考官网)</h3><ul>\n<li><p>canal.properties</p>\n<pre><code class=\"yaml\"># 用以下配置项是需要修改的，其他默认配置项保留原来设置\n# canal地址\ncanal.register.ip = zk所在地址\n# zk配置，如果有用到则配置，没用到则保留默认设置\ncanal.admin.register.auto = true\ncanal.admin.register.cluster = 192.168.154.231:2181\ncanal.zkServers = 192.168.154.231:2181</code></pre>\n</li>\n<li><p>instance.properties</p>\n<pre><code class=\"yaml\"># 用以下配置项是需要修改的，其他默认配置项保留原来设置(example2配置同下)\n# 数据库配置\ncanal.instance.master.address= 数据库IP:端口号\ncanal.instance.dbUsername = 用户名 \ncanal.instance.dbPassword = 密码\ncanal.instance.defaultDatabaseName = 要监控的库名，不设置则监听当前实例下所有库\ncanal.instance.connectionCharset = UTF-8\ncanal.instance.tsdb.enable=false</code></pre>\n</li>\n</ul>\n<h4 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h4><ul>\n<li><p>服务都启动成功，客户端拉不到变更日志</p>\n<pre><code class=\"textmate\">注意客户端中 canalConnector.subscribe() 中设置项，设置了值则服务中配置的过滤条件不生效\n参考配置 canalConnector.subscribe(&quot;sap_system\\\\..*,user_center\\\\..*&quot;)</code></pre>\n</li>\n<li><p>一个Canal-Service,多个client，运行时报错</p>\n<pre><code class=\"textmate\">改为一个canal一个client，原因是多个client同时提交ack时，可能会存在重复提交的问题</code></pre>\n</li>\n</ul>\n"},{"title":"MySQL相关知识","date":"2021-07-20T01:45:00.000Z","_content":"\n### Innodb引擎的4大特性\n> [参考文档](https://www.cnblogs.com/zhs0/p/10528520.html)\n- 插入缓冲\n- 二次写\n- 自适应哈希\n- 预读\n\n#### 插入缓冲\n```textmate\n用于提升插入性能，分为Insert Buffer、Change Buffer\nchange buffering是insert buffer的加强，insert buffer只针对insert有效，change buffering对insert、delete、update(delete+insert)、purge都有效\n\n使用插入缓冲的条件：\n* 非聚集索引\n* 非唯一索引\n```\n\n#### 事务\n- 事务的特性ACID\n```textmate\n原子性(atomicity)：一个事务被事务不可分割的最小工作单元，要么全部提交，要么全部失败回滚。\n一致性(consistency)：数据库总是从一致性状态到另一个一致性状态，它只包含成功事务提交的结果\n隔离型(isolation)：事务所做的修改在最终提交一起，对其他事务是不可见的\n持久性(durability)：一旦事务提交，则其所做的修改就会永久保存到数据库中。\n```\n\n- 事务隔离级别 \n\n| |脏读|不可重复读|幻读|解决原理|\n|---|---|---|---|---|\n|读未提交|x|x|x||\n|读已提交|√|x|x||\n|可重复读|√|√|x|gap锁 (mysql默认级别)|\n|串行化|√|√|√|读锁|\n\n#### 重要文件\n- undolog\n- redolog\n- binlog\n\n#### 存储引擎\n- MyISAM\n- Heap\n- Merge\n- INNODB\n- ISAM\n","source":"_posts/backend/storage/mysql.md","raw":"---\ntitle: MySQL相关知识\ndate: 2021-07-20 09:45:00\ntags:\n- mysql\n\ncategories:\n- 存储\n---\n\n### Innodb引擎的4大特性\n> [参考文档](https://www.cnblogs.com/zhs0/p/10528520.html)\n- 插入缓冲\n- 二次写\n- 自适应哈希\n- 预读\n\n#### 插入缓冲\n```textmate\n用于提升插入性能，分为Insert Buffer、Change Buffer\nchange buffering是insert buffer的加强，insert buffer只针对insert有效，change buffering对insert、delete、update(delete+insert)、purge都有效\n\n使用插入缓冲的条件：\n* 非聚集索引\n* 非唯一索引\n```\n\n#### 事务\n- 事务的特性ACID\n```textmate\n原子性(atomicity)：一个事务被事务不可分割的最小工作单元，要么全部提交，要么全部失败回滚。\n一致性(consistency)：数据库总是从一致性状态到另一个一致性状态，它只包含成功事务提交的结果\n隔离型(isolation)：事务所做的修改在最终提交一起，对其他事务是不可见的\n持久性(durability)：一旦事务提交，则其所做的修改就会永久保存到数据库中。\n```\n\n- 事务隔离级别 \n\n| |脏读|不可重复读|幻读|解决原理|\n|---|---|---|---|---|\n|读未提交|x|x|x||\n|读已提交|√|x|x||\n|可重复读|√|√|x|gap锁 (mysql默认级别)|\n|串行化|√|√|√|读锁|\n\n#### 重要文件\n- undolog\n- redolog\n- binlog\n\n#### 存储引擎\n- MyISAM\n- Heap\n- Merge\n- INNODB\n- ISAM\n","slug":"backend/storage/mysql","published":1,"updated":"2021-08-10T01:55:59.458Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bep0023fms673740w90","content":"<h3 id=\"Innodb引擎的4大特性\"><a href=\"#Innodb引擎的4大特性\" class=\"headerlink\" title=\"Innodb引擎的4大特性\"></a>Innodb引擎的4大特性</h3><blockquote>\n<p><a href=\"https://www.cnblogs.com/zhs0/p/10528520.html\">参考文档</a></p>\n</blockquote>\n<ul>\n<li>插入缓冲</li>\n<li>二次写</li>\n<li>自适应哈希</li>\n<li>预读</li>\n</ul>\n<h4 id=\"插入缓冲\"><a href=\"#插入缓冲\" class=\"headerlink\" title=\"插入缓冲\"></a>插入缓冲</h4><pre><code class=\"textmate\">用于提升插入性能，分为Insert Buffer、Change Buffer\nchange buffering是insert buffer的加强，insert buffer只针对insert有效，change buffering对insert、delete、update(delete+insert)、purge都有效\n\n使用插入缓冲的条件：\n* 非聚集索引\n* 非唯一索引</code></pre>\n<h4 id=\"事务\"><a href=\"#事务\" class=\"headerlink\" title=\"事务\"></a>事务</h4><ul>\n<li><p>事务的特性ACID</p>\n<pre><code class=\"textmate\">原子性(atomicity)：一个事务被事务不可分割的最小工作单元，要么全部提交，要么全部失败回滚。\n一致性(consistency)：数据库总是从一致性状态到另一个一致性状态，它只包含成功事务提交的结果\n隔离型(isolation)：事务所做的修改在最终提交一起，对其他事务是不可见的\n持久性(durability)：一旦事务提交，则其所做的修改就会永久保存到数据库中。</code></pre>\n</li>\n<li><p>事务隔离级别 </p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>脏读</th>\n<th>不可重复读</th>\n<th>幻读</th>\n<th>解决原理</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>读未提交</td>\n<td>x</td>\n<td>x</td>\n<td>x</td>\n<td></td>\n</tr>\n<tr>\n<td>读已提交</td>\n<td>√</td>\n<td>x</td>\n<td>x</td>\n<td></td>\n</tr>\n<tr>\n<td>可重复读</td>\n<td>√</td>\n<td>√</td>\n<td>x</td>\n<td>gap锁 (mysql默认级别)</td>\n</tr>\n<tr>\n<td>串行化</td>\n<td>√</td>\n<td>√</td>\n<td>√</td>\n<td>读锁</td>\n</tr>\n</tbody></table>\n<h4 id=\"重要文件\"><a href=\"#重要文件\" class=\"headerlink\" title=\"重要文件\"></a>重要文件</h4><ul>\n<li>undolog</li>\n<li>redolog</li>\n<li>binlog</li>\n</ul>\n<h4 id=\"存储引擎\"><a href=\"#存储引擎\" class=\"headerlink\" title=\"存储引擎\"></a>存储引擎</h4><ul>\n<li>MyISAM</li>\n<li>Heap</li>\n<li>Merge</li>\n<li>INNODB</li>\n<li>ISAM</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Innodb引擎的4大特性\"><a href=\"#Innodb引擎的4大特性\" class=\"headerlink\" title=\"Innodb引擎的4大特性\"></a>Innodb引擎的4大特性</h3><blockquote>\n<p><a href=\"https://www.cnblogs.com/zhs0/p/10528520.html\">参考文档</a></p>\n</blockquote>\n<ul>\n<li>插入缓冲</li>\n<li>二次写</li>\n<li>自适应哈希</li>\n<li>预读</li>\n</ul>\n<h4 id=\"插入缓冲\"><a href=\"#插入缓冲\" class=\"headerlink\" title=\"插入缓冲\"></a>插入缓冲</h4><pre><code class=\"textmate\">用于提升插入性能，分为Insert Buffer、Change Buffer\nchange buffering是insert buffer的加强，insert buffer只针对insert有效，change buffering对insert、delete、update(delete+insert)、purge都有效\n\n使用插入缓冲的条件：\n* 非聚集索引\n* 非唯一索引</code></pre>\n<h4 id=\"事务\"><a href=\"#事务\" class=\"headerlink\" title=\"事务\"></a>事务</h4><ul>\n<li><p>事务的特性ACID</p>\n<pre><code class=\"textmate\">原子性(atomicity)：一个事务被事务不可分割的最小工作单元，要么全部提交，要么全部失败回滚。\n一致性(consistency)：数据库总是从一致性状态到另一个一致性状态，它只包含成功事务提交的结果\n隔离型(isolation)：事务所做的修改在最终提交一起，对其他事务是不可见的\n持久性(durability)：一旦事务提交，则其所做的修改就会永久保存到数据库中。</code></pre>\n</li>\n<li><p>事务隔离级别 </p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>脏读</th>\n<th>不可重复读</th>\n<th>幻读</th>\n<th>解决原理</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>读未提交</td>\n<td>x</td>\n<td>x</td>\n<td>x</td>\n<td></td>\n</tr>\n<tr>\n<td>读已提交</td>\n<td>√</td>\n<td>x</td>\n<td>x</td>\n<td></td>\n</tr>\n<tr>\n<td>可重复读</td>\n<td>√</td>\n<td>√</td>\n<td>x</td>\n<td>gap锁 (mysql默认级别)</td>\n</tr>\n<tr>\n<td>串行化</td>\n<td>√</td>\n<td>√</td>\n<td>√</td>\n<td>读锁</td>\n</tr>\n</tbody></table>\n<h4 id=\"重要文件\"><a href=\"#重要文件\" class=\"headerlink\" title=\"重要文件\"></a>重要文件</h4><ul>\n<li>undolog</li>\n<li>redolog</li>\n<li>binlog</li>\n</ul>\n<h4 id=\"存储引擎\"><a href=\"#存储引擎\" class=\"headerlink\" title=\"存储引擎\"></a>存储引擎</h4><ul>\n<li>MyISAM</li>\n<li>Heap</li>\n<li>Merge</li>\n<li>INNODB</li>\n<li>ISAM</li>\n</ul>\n"},{"title":"Redis学习笔记","description":"redis","date":"2021-02-02T11:59:00.000Z","_content":"\n### Redis相关\n\n#### RedisTemplate配置\n```java\n@Configuration\n@EnableCaching\npublic class RedisConfig extends CachingConfigurerSupport {\n    @Bean\n    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory connectionFactory){\n        RedisTemplate<Object, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(connectionFactory);\n\n        //key的序列化方式\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n        // string的key序列化方式\n        template.setKeySerializer(stringRedisSerializer);\n        // hash的key也采用String的序列化方式\n        template.setHashKeySerializer(stringRedisSerializer);\n\n        //value的序列化方式\n        FastJson2JsonRedisSerializer serializer = new FastJson2JsonRedisSerializer(Object.class);\n        ObjectMapper om = new ObjectMapper();\n        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        om.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\n        om.registerModule(new JavaTimeModule());\n        serializer.setObjectMapper(om);\n\n        //string的value序列化方式\n        template.setValueSerializer(serializer);\n        // hash的value序列化方式\n        template.setHashValueSerializer(stringRedisSerializer);\n        \n        template.afterPropertiesSet();\n        return template;\n    }\n}\n```\n### RedisTemplate k-v序列化差异\n<img src=\"https://im-fan.gitee.io/img/cache/redisTemplate-serialize.png\"/>\n\n### RedisTemplate 操作hash\n```java\n//redis中的hash相当于java中的HashMap\n\nString key = \"key\";\nMap<String,String> hashMap = new HashMap<>();\nhashMap.put(\"a\",JSON.toJSONString(new Object()));\nhashMap.put(\"b\",JSON.toJSONString(new Object()));\n\n//所有值\nredisTemplate.opsForHash().putAll(key,hashMap);\n\n//获取单个值\nList<String> hashKey = new ArrayList<>();\nhashKey.add(\"a\"); // 获取hash中的某个key下的值\nredisTemplate.opsForHash().multiGet(key,hashKey);\n\n//设置单个值\nString hk = \"hash 的key\";\nString hv = \"hash 的value\";\nredisTemplate.opsForHash().put(key,hk,hv);\n\n//删除key\nString[] hkeys = {hk};\nredisTemplate.opsForHash().delete(key, hkeys);\n\n```\n\n### Redis原子操作的两种方式\n#### Lua脚本\n```shell\n-- lua语法 https://www.runoob.com/lua/lua-tutorial.html\n-- 实现一个原子锁,存在key则返回失败,否则返回存储并返回成功\n-- 关键字必须大写 参数1:value 参数2:有效时长\n\n-- call 与 pcall区别  call执行错误就直接返回,pcall错误则返回一个带 err 域的 Lua 表(table),用于表示错误\n\n-- 存在则直接返回失败\nlocal val = redis.call(\"get\",KEYS[1])\n\n-- 不存在,则获取锁\nif val then\n    return 0\nelse\n    redis.call(\"set\",KEYS[1],ARGV[1])\n    redis.call('expire',KEYS[1],ARGV[2])\n    return 1\nend\n```\n```java\n@Service\npublic class LuaService {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * lua文件所在路径\n     * @parm key 键\n     * @param ttl 过期时间，秒\n     **/\n    public boolean getAtomLock(String key,long ttl){\n        String lockKey = \"my:lock:\" + key;\n        // lua脚本所在resource目录下的相对路径\n        String luaName = \"lua/atom_lock.lua\";\n        // 执行 lua 脚本\n        DefaultRedisScript<Long> redisScript = new DefaultRedisScript<>();\n        // 指定 lua 脚本\n        redisScript.setScriptSource(new ResourceScriptSource(new ClassPathResource(luaName)));\n        // 指定返回类型\n        redisScript.setResultType(Long.class);\n        // 参数一：redisScript，参数二：key列表，参数三：arg（可多个）\n        Long result = (Long) redisTemplate.execute(redisScript, Collections.singletonList(lockKey),1,ttl);\n        return result != null && result == 1L;\n    }\n}\n\n```\n#### 事务操作\n- execute方式\n```java\n@Service\npublic class RedisService {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * 不存则在获取锁\n     * @param key\n     * @param value 值\n     * @param expire 过期时间，秒\n     * **/\n    public boolean setAndExpireIfAbsent(final String key, final String value, final long expire) {\n        boolean isSuccess = (boolean) redisTemplate.execute((RedisCallback) connection -> {\n            Object object = connection.execute(\"set\",\n                    key.getBytes(),\n                    value.getBytes(),\n                    SafeEncoder.encode(\"NX\"),\n                    SafeEncoder.encode(\"EX\"),\n                    Protocol.toByteArray(expire));\n            return null != object;\n        });\n        return isSuccess;\n    }\n}\n```\n\n","source":"_posts/backend/storage/redis.md","raw":"---\ntitle: Redis学习笔记\ndescription: redis\ndate: 2021-02-02 19:59:00\ntags:\n- cache\ncategories:\n- 存储\n---\n\n### Redis相关\n\n#### RedisTemplate配置\n```java\n@Configuration\n@EnableCaching\npublic class RedisConfig extends CachingConfigurerSupport {\n    @Bean\n    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory connectionFactory){\n        RedisTemplate<Object, Object> template = new RedisTemplate<>();\n        template.setConnectionFactory(connectionFactory);\n\n        //key的序列化方式\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n        // string的key序列化方式\n        template.setKeySerializer(stringRedisSerializer);\n        // hash的key也采用String的序列化方式\n        template.setHashKeySerializer(stringRedisSerializer);\n\n        //value的序列化方式\n        FastJson2JsonRedisSerializer serializer = new FastJson2JsonRedisSerializer(Object.class);\n        ObjectMapper om = new ObjectMapper();\n        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        om.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\n        om.registerModule(new JavaTimeModule());\n        serializer.setObjectMapper(om);\n\n        //string的value序列化方式\n        template.setValueSerializer(serializer);\n        // hash的value序列化方式\n        template.setHashValueSerializer(stringRedisSerializer);\n        \n        template.afterPropertiesSet();\n        return template;\n    }\n}\n```\n### RedisTemplate k-v序列化差异\n<img src=\"https://im-fan.gitee.io/img/cache/redisTemplate-serialize.png\"/>\n\n### RedisTemplate 操作hash\n```java\n//redis中的hash相当于java中的HashMap\n\nString key = \"key\";\nMap<String,String> hashMap = new HashMap<>();\nhashMap.put(\"a\",JSON.toJSONString(new Object()));\nhashMap.put(\"b\",JSON.toJSONString(new Object()));\n\n//所有值\nredisTemplate.opsForHash().putAll(key,hashMap);\n\n//获取单个值\nList<String> hashKey = new ArrayList<>();\nhashKey.add(\"a\"); // 获取hash中的某个key下的值\nredisTemplate.opsForHash().multiGet(key,hashKey);\n\n//设置单个值\nString hk = \"hash 的key\";\nString hv = \"hash 的value\";\nredisTemplate.opsForHash().put(key,hk,hv);\n\n//删除key\nString[] hkeys = {hk};\nredisTemplate.opsForHash().delete(key, hkeys);\n\n```\n\n### Redis原子操作的两种方式\n#### Lua脚本\n```shell\n-- lua语法 https://www.runoob.com/lua/lua-tutorial.html\n-- 实现一个原子锁,存在key则返回失败,否则返回存储并返回成功\n-- 关键字必须大写 参数1:value 参数2:有效时长\n\n-- call 与 pcall区别  call执行错误就直接返回,pcall错误则返回一个带 err 域的 Lua 表(table),用于表示错误\n\n-- 存在则直接返回失败\nlocal val = redis.call(\"get\",KEYS[1])\n\n-- 不存在,则获取锁\nif val then\n    return 0\nelse\n    redis.call(\"set\",KEYS[1],ARGV[1])\n    redis.call('expire',KEYS[1],ARGV[2])\n    return 1\nend\n```\n```java\n@Service\npublic class LuaService {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * lua文件所在路径\n     * @parm key 键\n     * @param ttl 过期时间，秒\n     **/\n    public boolean getAtomLock(String key,long ttl){\n        String lockKey = \"my:lock:\" + key;\n        // lua脚本所在resource目录下的相对路径\n        String luaName = \"lua/atom_lock.lua\";\n        // 执行 lua 脚本\n        DefaultRedisScript<Long> redisScript = new DefaultRedisScript<>();\n        // 指定 lua 脚本\n        redisScript.setScriptSource(new ResourceScriptSource(new ClassPathResource(luaName)));\n        // 指定返回类型\n        redisScript.setResultType(Long.class);\n        // 参数一：redisScript，参数二：key列表，参数三：arg（可多个）\n        Long result = (Long) redisTemplate.execute(redisScript, Collections.singletonList(lockKey),1,ttl);\n        return result != null && result == 1L;\n    }\n}\n\n```\n#### 事务操作\n- execute方式\n```java\n@Service\npublic class RedisService {\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * 不存则在获取锁\n     * @param key\n     * @param value 值\n     * @param expire 过期时间，秒\n     * **/\n    public boolean setAndExpireIfAbsent(final String key, final String value, final long expire) {\n        boolean isSuccess = (boolean) redisTemplate.execute((RedisCallback) connection -> {\n            Object object = connection.execute(\"set\",\n                    key.getBytes(),\n                    value.getBytes(),\n                    SafeEncoder.encode(\"NX\"),\n                    SafeEncoder.encode(\"EX\"),\n                    Protocol.toByteArray(expire));\n            return null != object;\n        });\n        return isSuccess;\n    }\n}\n```\n\n","slug":"backend/storage/redis","published":1,"updated":"2021-07-26T07:38:28.767Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bew0027fms6bncugtgv","content":"<h3 id=\"Redis相关\"><a href=\"#Redis相关\" class=\"headerlink\" title=\"Redis相关\"></a>Redis相关</h3><h4 id=\"RedisTemplate配置\"><a href=\"#RedisTemplate配置\" class=\"headerlink\" title=\"RedisTemplate配置\"></a>RedisTemplate配置</h4><pre><code class=\"java\">@Configuration\n@EnableCaching\npublic class RedisConfig extends CachingConfigurerSupport &#123;\n    @Bean\n    public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory connectionFactory)&#123;\n        RedisTemplate&lt;Object, Object&gt; template = new RedisTemplate&lt;&gt;();\n        template.setConnectionFactory(connectionFactory);\n\n        //key的序列化方式\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n        // string的key序列化方式\n        template.setKeySerializer(stringRedisSerializer);\n        // hash的key也采用String的序列化方式\n        template.setHashKeySerializer(stringRedisSerializer);\n\n        //value的序列化方式\n        FastJson2JsonRedisSerializer serializer = new FastJson2JsonRedisSerializer(Object.class);\n        ObjectMapper om = new ObjectMapper();\n        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        om.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\n        om.registerModule(new JavaTimeModule());\n        serializer.setObjectMapper(om);\n\n        //string的value序列化方式\n        template.setValueSerializer(serializer);\n        // hash的value序列化方式\n        template.setHashValueSerializer(stringRedisSerializer);\n\n        template.afterPropertiesSet();\n        return template;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"RedisTemplate-k-v序列化差异\"><a href=\"#RedisTemplate-k-v序列化差异\" class=\"headerlink\" title=\"RedisTemplate k-v序列化差异\"></a>RedisTemplate k-v序列化差异</h3><img src=\"https://im-fan.gitee.io/img/cache/redisTemplate-serialize.png\"/>\n\n<h3 id=\"RedisTemplate-操作hash\"><a href=\"#RedisTemplate-操作hash\" class=\"headerlink\" title=\"RedisTemplate 操作hash\"></a>RedisTemplate 操作hash</h3><pre><code class=\"java\">//redis中的hash相当于java中的HashMap\n\nString key = &quot;key&quot;;\nMap&lt;String,String&gt; hashMap = new HashMap&lt;&gt;();\nhashMap.put(&quot;a&quot;,JSON.toJSONString(new Object()));\nhashMap.put(&quot;b&quot;,JSON.toJSONString(new Object()));\n\n//所有值\nredisTemplate.opsForHash().putAll(key,hashMap);\n\n//获取单个值\nList&lt;String&gt; hashKey = new ArrayList&lt;&gt;();\nhashKey.add(&quot;a&quot;); // 获取hash中的某个key下的值\nredisTemplate.opsForHash().multiGet(key,hashKey);\n\n//设置单个值\nString hk = &quot;hash 的key&quot;;\nString hv = &quot;hash 的value&quot;;\nredisTemplate.opsForHash().put(key,hk,hv);\n\n//删除key\nString[] hkeys = &#123;hk&#125;;\nredisTemplate.opsForHash().delete(key, hkeys);\n</code></pre>\n<h3 id=\"Redis原子操作的两种方式\"><a href=\"#Redis原子操作的两种方式\" class=\"headerlink\" title=\"Redis原子操作的两种方式\"></a>Redis原子操作的两种方式</h3><h4 id=\"Lua脚本\"><a href=\"#Lua脚本\" class=\"headerlink\" title=\"Lua脚本\"></a>Lua脚本</h4><pre><code class=\"shell\">-- lua语法 https://www.runoob.com/lua/lua-tutorial.html\n-- 实现一个原子锁,存在key则返回失败,否则返回存储并返回成功\n-- 关键字必须大写 参数1:value 参数2:有效时长\n\n-- call 与 pcall区别  call执行错误就直接返回,pcall错误则返回一个带 err 域的 Lua 表(table),用于表示错误\n\n-- 存在则直接返回失败\nlocal val = redis.call(&quot;get&quot;,KEYS[1])\n\n-- 不存在,则获取锁\nif val then\n    return 0\nelse\n    redis.call(&quot;set&quot;,KEYS[1],ARGV[1])\n    redis.call(&#39;expire&#39;,KEYS[1],ARGV[2])\n    return 1\nend</code></pre>\n<pre><code class=\"java\">@Service\npublic class LuaService &#123;\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * lua文件所在路径\n     * @parm key 键\n     * @param ttl 过期时间，秒\n     **/\n    public boolean getAtomLock(String key,long ttl)&#123;\n        String lockKey = &quot;my:lock:&quot; + key;\n        // lua脚本所在resource目录下的相对路径\n        String luaName = &quot;lua/atom_lock.lua&quot;;\n        // 执行 lua 脚本\n        DefaultRedisScript&lt;Long&gt; redisScript = new DefaultRedisScript&lt;&gt;();\n        // 指定 lua 脚本\n        redisScript.setScriptSource(new ResourceScriptSource(new ClassPathResource(luaName)));\n        // 指定返回类型\n        redisScript.setResultType(Long.class);\n        // 参数一：redisScript，参数二：key列表，参数三：arg（可多个）\n        Long result = (Long) redisTemplate.execute(redisScript, Collections.singletonList(lockKey),1,ttl);\n        return result != null &amp;&amp; result == 1L;\n    &#125;\n&#125;\n</code></pre>\n<h4 id=\"事务操作\"><a href=\"#事务操作\" class=\"headerlink\" title=\"事务操作\"></a>事务操作</h4><ul>\n<li><p>execute方式</p>\n<pre><code class=\"java\">@Service\npublic class RedisService &#123;\n\n  @Autowired\n  private RedisTemplate redisTemplate;\n\n  /**\n   * 不存则在获取锁\n   * @param key\n   * @param value 值\n   * @param expire 过期时间，秒\n   * **/\n  public boolean setAndExpireIfAbsent(final String key, final String value, final long expire) &#123;\n      boolean isSuccess = (boolean) redisTemplate.execute((RedisCallback) connection -&gt; &#123;\n          Object object = connection.execute(&quot;set&quot;,\n                  key.getBytes(),\n                  value.getBytes(),\n                  SafeEncoder.encode(&quot;NX&quot;),\n                  SafeEncoder.encode(&quot;EX&quot;),\n                  Protocol.toByteArray(expire));\n          return null != object;\n      &#125;);\n      return isSuccess;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Redis相关\"><a href=\"#Redis相关\" class=\"headerlink\" title=\"Redis相关\"></a>Redis相关</h3><h4 id=\"RedisTemplate配置\"><a href=\"#RedisTemplate配置\" class=\"headerlink\" title=\"RedisTemplate配置\"></a>RedisTemplate配置</h4><pre><code class=\"java\">@Configuration\n@EnableCaching\npublic class RedisConfig extends CachingConfigurerSupport &#123;\n    @Bean\n    public RedisTemplate&lt;String, Object&gt; redisTemplate(RedisConnectionFactory connectionFactory)&#123;\n        RedisTemplate&lt;Object, Object&gt; template = new RedisTemplate&lt;&gt;();\n        template.setConnectionFactory(connectionFactory);\n\n        //key的序列化方式\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n        // string的key序列化方式\n        template.setKeySerializer(stringRedisSerializer);\n        // hash的key也采用String的序列化方式\n        template.setHashKeySerializer(stringRedisSerializer);\n\n        //value的序列化方式\n        FastJson2JsonRedisSerializer serializer = new FastJson2JsonRedisSerializer(Object.class);\n        ObjectMapper om = new ObjectMapper();\n        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);\n        om.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);\n        om.registerModule(new JavaTimeModule());\n        serializer.setObjectMapper(om);\n\n        //string的value序列化方式\n        template.setValueSerializer(serializer);\n        // hash的value序列化方式\n        template.setHashValueSerializer(stringRedisSerializer);\n\n        template.afterPropertiesSet();\n        return template;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"RedisTemplate-k-v序列化差异\"><a href=\"#RedisTemplate-k-v序列化差异\" class=\"headerlink\" title=\"RedisTemplate k-v序列化差异\"></a>RedisTemplate k-v序列化差异</h3><img src=\"https://im-fan.gitee.io/img/cache/redisTemplate-serialize.png\"/>\n\n<h3 id=\"RedisTemplate-操作hash\"><a href=\"#RedisTemplate-操作hash\" class=\"headerlink\" title=\"RedisTemplate 操作hash\"></a>RedisTemplate 操作hash</h3><pre><code class=\"java\">//redis中的hash相当于java中的HashMap\n\nString key = &quot;key&quot;;\nMap&lt;String,String&gt; hashMap = new HashMap&lt;&gt;();\nhashMap.put(&quot;a&quot;,JSON.toJSONString(new Object()));\nhashMap.put(&quot;b&quot;,JSON.toJSONString(new Object()));\n\n//所有值\nredisTemplate.opsForHash().putAll(key,hashMap);\n\n//获取单个值\nList&lt;String&gt; hashKey = new ArrayList&lt;&gt;();\nhashKey.add(&quot;a&quot;); // 获取hash中的某个key下的值\nredisTemplate.opsForHash().multiGet(key,hashKey);\n\n//设置单个值\nString hk = &quot;hash 的key&quot;;\nString hv = &quot;hash 的value&quot;;\nredisTemplate.opsForHash().put(key,hk,hv);\n\n//删除key\nString[] hkeys = &#123;hk&#125;;\nredisTemplate.opsForHash().delete(key, hkeys);\n</code></pre>\n<h3 id=\"Redis原子操作的两种方式\"><a href=\"#Redis原子操作的两种方式\" class=\"headerlink\" title=\"Redis原子操作的两种方式\"></a>Redis原子操作的两种方式</h3><h4 id=\"Lua脚本\"><a href=\"#Lua脚本\" class=\"headerlink\" title=\"Lua脚本\"></a>Lua脚本</h4><pre><code class=\"shell\">-- lua语法 https://www.runoob.com/lua/lua-tutorial.html\n-- 实现一个原子锁,存在key则返回失败,否则返回存储并返回成功\n-- 关键字必须大写 参数1:value 参数2:有效时长\n\n-- call 与 pcall区别  call执行错误就直接返回,pcall错误则返回一个带 err 域的 Lua 表(table),用于表示错误\n\n-- 存在则直接返回失败\nlocal val = redis.call(&quot;get&quot;,KEYS[1])\n\n-- 不存在,则获取锁\nif val then\n    return 0\nelse\n    redis.call(&quot;set&quot;,KEYS[1],ARGV[1])\n    redis.call(&#39;expire&#39;,KEYS[1],ARGV[2])\n    return 1\nend</code></pre>\n<pre><code class=\"java\">@Service\npublic class LuaService &#123;\n\n    @Autowired\n    private RedisTemplate redisTemplate;\n\n    /**\n     * lua文件所在路径\n     * @parm key 键\n     * @param ttl 过期时间，秒\n     **/\n    public boolean getAtomLock(String key,long ttl)&#123;\n        String lockKey = &quot;my:lock:&quot; + key;\n        // lua脚本所在resource目录下的相对路径\n        String luaName = &quot;lua/atom_lock.lua&quot;;\n        // 执行 lua 脚本\n        DefaultRedisScript&lt;Long&gt; redisScript = new DefaultRedisScript&lt;&gt;();\n        // 指定 lua 脚本\n        redisScript.setScriptSource(new ResourceScriptSource(new ClassPathResource(luaName)));\n        // 指定返回类型\n        redisScript.setResultType(Long.class);\n        // 参数一：redisScript，参数二：key列表，参数三：arg（可多个）\n        Long result = (Long) redisTemplate.execute(redisScript, Collections.singletonList(lockKey),1,ttl);\n        return result != null &amp;&amp; result == 1L;\n    &#125;\n&#125;\n</code></pre>\n<h4 id=\"事务操作\"><a href=\"#事务操作\" class=\"headerlink\" title=\"事务操作\"></a>事务操作</h4><ul>\n<li><p>execute方式</p>\n<pre><code class=\"java\">@Service\npublic class RedisService &#123;\n\n  @Autowired\n  private RedisTemplate redisTemplate;\n\n  /**\n   * 不存则在获取锁\n   * @param key\n   * @param value 值\n   * @param expire 过期时间，秒\n   * **/\n  public boolean setAndExpireIfAbsent(final String key, final String value, final long expire) &#123;\n      boolean isSuccess = (boolean) redisTemplate.execute((RedisCallback) connection -&gt; &#123;\n          Object object = connection.execute(&quot;set&quot;,\n                  key.getBytes(),\n                  value.getBytes(),\n                  SafeEncoder.encode(&quot;NX&quot;),\n                  SafeEncoder.encode(&quot;EX&quot;),\n                  Protocol.toByteArray(expire));\n          return null != object;\n      &#125;);\n      return isSuccess;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n"},{"title":"UML类图","description":"UML类图","date":"2020-12-25T10:57:00.000Z","_content":"### 常用元素\n```textmate\n1.类\n  用三层矩形框表示，第一层类名及解释(斜体表示抽象类)、第二层字段和属性、第三层方法\n  前面的符号，‘+’表示public，‘-’表示private，‘#’表示protected。\n2.接口\n  用两层矩形框表示，第一层接口名及解释、第二层方法\n```\n\n### 常见的几种关系\n```textmate\n1.泛化(Generalization)\n    表示继承。是is-a的关系。 用 空心三角箭头+实线 表示，箭头指向继承的类\n2.依赖(Dependency)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现. 空心三角箭头+虚线 箭头指向接口\n3.关联(Association)\n    描述类与类之间的连接，是has­-a的关系。它使一个类知道另一个类的属性和方法; 实心三角箭头+实线，两边关联则有两个箭头\n4.聚合(Aggregation)\n    是整体与部分的关系，且部分可以离开整体而单独存在。空心菱形+实线，菱形指向整体\n5.组合(Composition)\n    是整体与部分的关系，但部分不能离开整体而单独存在。实心菱形+实线，菱形指向整体\n6. 实现(Realization)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现。空心三角箭头+虚线，箭头指向接口\n\n基数: 线两端的数字表明这一端的类可以有几个实例，比如：一个鸟应该有两只翅膀。如果一个类可能有无数个实例，则就用‘n’来表示。关联、聚合、组合是有基数的。\n```\n<img src=\"https://im-fan.gitee.io/img/uml/uml-line.png\" width=\"500\" height=\"300\"/>\n\n### 示例-标识了所有关系\n<img src=\"https://im-fan.gitee.io/img/uml/uml.png\"/>\n","source":"_posts/framework/design/uml.md","raw":"---\ntitle: UML类图\ndescription: UML类图\n#top: 1\ndate: 2020-12-25 18:57\ntags:\n- uml\n- 类图\ncategories:\n- 架构\n---\n### 常用元素\n```textmate\n1.类\n  用三层矩形框表示，第一层类名及解释(斜体表示抽象类)、第二层字段和属性、第三层方法\n  前面的符号，‘+’表示public，‘-’表示private，‘#’表示protected。\n2.接口\n  用两层矩形框表示，第一层接口名及解释、第二层方法\n```\n\n### 常见的几种关系\n```textmate\n1.泛化(Generalization)\n    表示继承。是is-a的关系。 用 空心三角箭头+实线 表示，箭头指向继承的类\n2.依赖(Dependency)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现. 空心三角箭头+虚线 箭头指向接口\n3.关联(Association)\n    描述类与类之间的连接，是has­-a的关系。它使一个类知道另一个类的属性和方法; 实心三角箭头+实线，两边关联则有两个箭头\n4.聚合(Aggregation)\n    是整体与部分的关系，且部分可以离开整体而单独存在。空心菱形+实线，菱形指向整体\n5.组合(Composition)\n    是整体与部分的关系，但部分不能离开整体而单独存在。实心菱形+实线，菱形指向整体\n6. 实现(Realization)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现。空心三角箭头+虚线，箭头指向接口\n\n基数: 线两端的数字表明这一端的类可以有几个实例，比如：一个鸟应该有两只翅膀。如果一个类可能有无数个实例，则就用‘n’来表示。关联、聚合、组合是有基数的。\n```\n<img src=\"https://im-fan.gitee.io/img/uml/uml-line.png\" width=\"500\" height=\"300\"/>\n\n### 示例-标识了所有关系\n<img src=\"https://im-fan.gitee.io/img/uml/uml.png\"/>\n","slug":"framework/design/uml","published":1,"updated":"2021-07-26T07:59:14.145Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bey0029fms611vdbkma","content":"<h3 id=\"常用元素\"><a href=\"#常用元素\" class=\"headerlink\" title=\"常用元素\"></a>常用元素</h3><pre><code class=\"textmate\">1.类\n  用三层矩形框表示，第一层类名及解释(斜体表示抽象类)、第二层字段和属性、第三层方法\n  前面的符号，‘+’表示public，‘-’表示private，‘#’表示protected。\n2.接口\n  用两层矩形框表示，第一层接口名及解释、第二层方法</code></pre>\n<h3 id=\"常见的几种关系\"><a href=\"#常见的几种关系\" class=\"headerlink\" title=\"常见的几种关系\"></a>常见的几种关系</h3><pre><code class=\"textmate\">1.泛化(Generalization)\n    表示继承。是is-a的关系。 用 空心三角箭头+实线 表示，箭头指向继承的类\n2.依赖(Dependency)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现. 空心三角箭头+虚线 箭头指向接口\n3.关联(Association)\n    描述类与类之间的连接，是has­-a的关系。它使一个类知道另一个类的属性和方法; 实心三角箭头+实线，两边关联则有两个箭头\n4.聚合(Aggregation)\n    是整体与部分的关系，且部分可以离开整体而单独存在。空心菱形+实线，菱形指向整体\n5.组合(Composition)\n    是整体与部分的关系，但部分不能离开整体而单独存在。实心菱形+实线，菱形指向整体\n6. 实现(Realization)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现。空心三角箭头+虚线，箭头指向接口\n\n基数: 线两端的数字表明这一端的类可以有几个实例，比如：一个鸟应该有两只翅膀。如果一个类可能有无数个实例，则就用‘n’来表示。关联、聚合、组合是有基数的。</code></pre>\n<img src=\"https://im-fan.gitee.io/img/uml/uml-line.png\" width=\"500\" height=\"300\"/>\n\n<h3 id=\"示例-标识了所有关系\"><a href=\"#示例-标识了所有关系\" class=\"headerlink\" title=\"示例-标识了所有关系\"></a>示例-标识了所有关系</h3><img src=\"https://im-fan.gitee.io/img/uml/uml.png\"/>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"常用元素\"><a href=\"#常用元素\" class=\"headerlink\" title=\"常用元素\"></a>常用元素</h3><pre><code class=\"textmate\">1.类\n  用三层矩形框表示，第一层类名及解释(斜体表示抽象类)、第二层字段和属性、第三层方法\n  前面的符号，‘+’表示public，‘-’表示private，‘#’表示protected。\n2.接口\n  用两层矩形框表示，第一层接口名及解释、第二层方法</code></pre>\n<h3 id=\"常见的几种关系\"><a href=\"#常见的几种关系\" class=\"headerlink\" title=\"常见的几种关系\"></a>常见的几种关系</h3><pre><code class=\"textmate\">1.泛化(Generalization)\n    表示继承。是is-a的关系。 用 空心三角箭头+实线 表示，箭头指向继承的类\n2.依赖(Dependency)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现. 空心三角箭头+虚线 箭头指向接口\n3.关联(Association)\n    描述类与类之间的连接，是has­-a的关系。它使一个类知道另一个类的属性和方法; 实心三角箭头+实线，两边关联则有两个箭头\n4.聚合(Aggregation)\n    是整体与部分的关系，且部分可以离开整体而单独存在。空心菱形+实线，菱形指向整体\n5.组合(Composition)\n    是整体与部分的关系，但部分不能离开整体而单独存在。实心菱形+实线，菱形指向整体\n6. 实现(Realization)\n    是一种类与接口的关系，表示类是接口所有特征和行为的实现。空心三角箭头+虚线，箭头指向接口\n\n基数: 线两端的数字表明这一端的类可以有几个实例，比如：一个鸟应该有两只翅膀。如果一个类可能有无数个实例，则就用‘n’来表示。关联、聚合、组合是有基数的。</code></pre>\n<img src=\"https://im-fan.gitee.io/img/uml/uml-line.png\" width=\"500\" height=\"300\"/>\n\n<h3 id=\"示例-标识了所有关系\"><a href=\"#示例-标识了所有关系\" class=\"headerlink\" title=\"示例-标识了所有关系\"></a>示例-标识了所有关系</h3><img src=\"https://im-fan.gitee.io/img/uml/uml.png\"/>\n"},{"title":"Gradle学习笔记","description":"gradle","date":"2021-01-21T05:24:22.000Z","_content":"\n- [Gradle理解：configuration、dependency](https://blog.csdn.net/gdeer/article/details/104815986)\n\n### 关键字解释\n\n|关键字|关键字解释|值|值解释|\n|-|:-:|-|:-:|\n|plugins||id||\n|group|定义模块|||\n|version|模块版本号|||\n|sourceCompatibility||||\n|configurations|不同的 configuration 用来引用不同领域</br>（或不同用途）的 dependencies|||\n|buildscript|用于声明gradle自身依赖的插件，优先执行|ext||\n|||repositories||\n|||dependencies||\n|allprojects|对所有project的配置,包括root project|repositories||\n|subprojects|对所有Child Project的配置|||\n|repositories|查找jar包顺序|||\n|dependencies|定义依赖|||\n|test|定义测试依赖信息|||\n\n\n### dependencies依赖关键字\n\n|3+|2.+|描述|\n|-|-|:-:|\n|implementation||所依赖的库仅可在当前module使用，编译速度快|\n|api|compile|所依赖的库可在整工程使用，编译速度较implementation慢|\n|provided|compileOnly|仅在编译时有效，不参与打包，一般在发布no jar的库时候会用到，很少用|\n|apk|runtimeOnly|仅在生成apk的时候参与打包，编译时不参与|\n|testImplementation|testCompile|仅在单元测试代码的编译以及最终打包测试apk时有效|\n|debugImplementation|debugCompile|仅在debug模式的编译和最终的debug apk打包时有效|\n|releaseImplementation|releaseCompile|仅在Release模式的编译和最终的Release apk打包时有效|\n\n\n","source":"_posts/backend/java/build/gradle.md","raw":"---\ntitle: Gradle学习笔记\ndescription: gradle\ndate: 2021-01-21 13:24:22\ntags:\n- 项目编译\ncategories:\n- 后端\n- 项目编译\n---\n\n- [Gradle理解：configuration、dependency](https://blog.csdn.net/gdeer/article/details/104815986)\n\n### 关键字解释\n\n|关键字|关键字解释|值|值解释|\n|-|:-:|-|:-:|\n|plugins||id||\n|group|定义模块|||\n|version|模块版本号|||\n|sourceCompatibility||||\n|configurations|不同的 configuration 用来引用不同领域</br>（或不同用途）的 dependencies|||\n|buildscript|用于声明gradle自身依赖的插件，优先执行|ext||\n|||repositories||\n|||dependencies||\n|allprojects|对所有project的配置,包括root project|repositories||\n|subprojects|对所有Child Project的配置|||\n|repositories|查找jar包顺序|||\n|dependencies|定义依赖|||\n|test|定义测试依赖信息|||\n\n\n### dependencies依赖关键字\n\n|3+|2.+|描述|\n|-|-|:-:|\n|implementation||所依赖的库仅可在当前module使用，编译速度快|\n|api|compile|所依赖的库可在整工程使用，编译速度较implementation慢|\n|provided|compileOnly|仅在编译时有效，不参与打包，一般在发布no jar的库时候会用到，很少用|\n|apk|runtimeOnly|仅在生成apk的时候参与打包，编译时不参与|\n|testImplementation|testCompile|仅在单元测试代码的编译以及最终打包测试apk时有效|\n|debugImplementation|debugCompile|仅在debug模式的编译和最终的debug apk打包时有效|\n|releaseImplementation|releaseCompile|仅在Release模式的编译和最终的Release apk打包时有效|\n\n\n","slug":"backend/java/build/gradle","published":1,"updated":"2021-01-21T05:44:07.480Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bf0002dfms6fumi9x4y","content":"<ul>\n<li><a href=\"https://blog.csdn.net/gdeer/article/details/104815986\">Gradle理解：configuration、dependency</a></li>\n</ul>\n<h3 id=\"关键字解释\"><a href=\"#关键字解释\" class=\"headerlink\" title=\"关键字解释\"></a>关键字解释</h3><table>\n<thead>\n<tr>\n<th>关键字</th>\n<th align=\"center\">关键字解释</th>\n<th>值</th>\n<th align=\"center\">值解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>plugins</td>\n<td align=\"center\"></td>\n<td>id</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>group</td>\n<td align=\"center\">定义模块</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>version</td>\n<td align=\"center\">模块版本号</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>sourceCompatibility</td>\n<td align=\"center\"></td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>configurations</td>\n<td align=\"center\">不同的 configuration 用来引用不同领域</br>（或不同用途）的 dependencies</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>buildscript</td>\n<td align=\"center\">用于声明gradle自身依赖的插件，优先执行</td>\n<td>ext</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td></td>\n<td align=\"center\"></td>\n<td>repositories</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td></td>\n<td align=\"center\"></td>\n<td>dependencies</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>allprojects</td>\n<td align=\"center\">对所有project的配置,包括root project</td>\n<td>repositories</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>subprojects</td>\n<td align=\"center\">对所有Child Project的配置</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>repositories</td>\n<td align=\"center\">查找jar包顺序</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>dependencies</td>\n<td align=\"center\">定义依赖</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>test</td>\n<td align=\"center\">定义测试依赖信息</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"dependencies依赖关键字\"><a href=\"#dependencies依赖关键字\" class=\"headerlink\" title=\"dependencies依赖关键字\"></a>dependencies依赖关键字</h3><table>\n<thead>\n<tr>\n<th>3+</th>\n<th>2.+</th>\n<th align=\"center\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>implementation</td>\n<td></td>\n<td align=\"center\">所依赖的库仅可在当前module使用，编译速度快</td>\n</tr>\n<tr>\n<td>api</td>\n<td>compile</td>\n<td align=\"center\">所依赖的库可在整工程使用，编译速度较implementation慢</td>\n</tr>\n<tr>\n<td>provided</td>\n<td>compileOnly</td>\n<td align=\"center\">仅在编译时有效，不参与打包，一般在发布no jar的库时候会用到，很少用</td>\n</tr>\n<tr>\n<td>apk</td>\n<td>runtimeOnly</td>\n<td align=\"center\">仅在生成apk的时候参与打包，编译时不参与</td>\n</tr>\n<tr>\n<td>testImplementation</td>\n<td>testCompile</td>\n<td align=\"center\">仅在单元测试代码的编译以及最终打包测试apk时有效</td>\n</tr>\n<tr>\n<td>debugImplementation</td>\n<td>debugCompile</td>\n<td align=\"center\">仅在debug模式的编译和最终的debug apk打包时有效</td>\n</tr>\n<tr>\n<td>releaseImplementation</td>\n<td>releaseCompile</td>\n<td align=\"center\">仅在Release模式的编译和最终的Release apk打包时有效</td>\n</tr>\n</tbody></table>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://blog.csdn.net/gdeer/article/details/104815986\">Gradle理解：configuration、dependency</a></li>\n</ul>\n<h3 id=\"关键字解释\"><a href=\"#关键字解释\" class=\"headerlink\" title=\"关键字解释\"></a>关键字解释</h3><table>\n<thead>\n<tr>\n<th>关键字</th>\n<th align=\"center\">关键字解释</th>\n<th>值</th>\n<th align=\"center\">值解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>plugins</td>\n<td align=\"center\"></td>\n<td>id</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>group</td>\n<td align=\"center\">定义模块</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>version</td>\n<td align=\"center\">模块版本号</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>sourceCompatibility</td>\n<td align=\"center\"></td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>configurations</td>\n<td align=\"center\">不同的 configuration 用来引用不同领域</br>（或不同用途）的 dependencies</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>buildscript</td>\n<td align=\"center\">用于声明gradle自身依赖的插件，优先执行</td>\n<td>ext</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td></td>\n<td align=\"center\"></td>\n<td>repositories</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td></td>\n<td align=\"center\"></td>\n<td>dependencies</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>allprojects</td>\n<td align=\"center\">对所有project的配置,包括root project</td>\n<td>repositories</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>subprojects</td>\n<td align=\"center\">对所有Child Project的配置</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>repositories</td>\n<td align=\"center\">查找jar包顺序</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>dependencies</td>\n<td align=\"center\">定义依赖</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td>test</td>\n<td align=\"center\">定义测试依赖信息</td>\n<td></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"dependencies依赖关键字\"><a href=\"#dependencies依赖关键字\" class=\"headerlink\" title=\"dependencies依赖关键字\"></a>dependencies依赖关键字</h3><table>\n<thead>\n<tr>\n<th>3+</th>\n<th>2.+</th>\n<th align=\"center\">描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>implementation</td>\n<td></td>\n<td align=\"center\">所依赖的库仅可在当前module使用，编译速度快</td>\n</tr>\n<tr>\n<td>api</td>\n<td>compile</td>\n<td align=\"center\">所依赖的库可在整工程使用，编译速度较implementation慢</td>\n</tr>\n<tr>\n<td>provided</td>\n<td>compileOnly</td>\n<td align=\"center\">仅在编译时有效，不参与打包，一般在发布no jar的库时候会用到，很少用</td>\n</tr>\n<tr>\n<td>apk</td>\n<td>runtimeOnly</td>\n<td align=\"center\">仅在生成apk的时候参与打包，编译时不参与</td>\n</tr>\n<tr>\n<td>testImplementation</td>\n<td>testCompile</td>\n<td align=\"center\">仅在单元测试代码的编译以及最终打包测试apk时有效</td>\n</tr>\n<tr>\n<td>debugImplementation</td>\n<td>debugCompile</td>\n<td align=\"center\">仅在debug模式的编译和最终的debug apk打包时有效</td>\n</tr>\n<tr>\n<td>releaseImplementation</td>\n<td>releaseCompile</td>\n<td align=\"center\">仅在Release模式的编译和最终的Release apk打包时有效</td>\n</tr>\n</tbody></table>\n"},{"title":"IO","description":"io","date":"2021-08-11T01:31:00.000Z","_content":"\n### IO模型\n|类型|解释|\n|---|---|\n|阻塞IO|返回数据就绪状态后，用户线程才能做其他动作|\n|非阻塞IO|用户线程不断询问数据是否就绪|\n|多路复用IO|即NIO(NewIO)  有一个线程不断去轮询多个 socket 的状态，只有当 socket 真正有读写事件时，才真正调用实际的 IO 读写操作，这个操作在内核中，比用户线程效率高<br/>缺点：一旦事件响应体很大，那么就会导致后续的事件迟迟得不到处理，并且会影响新的事件轮询。|\n|信号驱动IO|当用户线程发起一个 IO 请求操作，会给对应的 socket 注册一个信号函数，然后用户线程会继续执行，当内核数据就绪时会发送一个信号给用户线程，用户线程接收到之后，在信号函数中调用 IO 读写操作来进行实际的 IO 请求操作|\n|异步IO|最理想的IO模型  <br/>1.用户线程发起read操作，内核立即返回响应。<br/>2.内核接收到请求后，准备数据->copy至用户线程->给用户线程发信号<br/>比较：   信号驱动IO是需要client端调用函数操作IO，异步IO是内核异步处理，client端无需处理|\n\n- 多路复用IO\n\n```textmate\nIO多路复用模型的IO涉及两种系统调用，一种是IO操作的系\n统调用，另一种是select/epoll就绪查询系统调用。IO多路复用模型建立在操作系统的基础 设施之上，即操作系统的内核必须能够提供多路分离的系统调用select/epoll。\n优点:一个选择器查询线程，可以同时处理成千上万的网络连接， 所以，用户程序不必创建大量的线程，也不必维护这些线程，从而大大减小了系统的开 销。这是一个线程维护一个连接的阻塞IO模式相比，使用多路IO复用模型的最大优势。\n缺点:本质上，select/epoll系统调用是阻塞式的，属于同步IO。需要在读写事件就绪后，由系统调用本身负责进行读写，也就是说这个读写过程是阻塞 的\n```\n\n### IO包\n|包名|类型/包|类名|\n|---|---|---|\n|java.io|字节流|InputStream|\n|  |  |OutputStream|\n|  |字符流|Reader|\n|  | |Writer|\n|java.nio|channels包||\n|java.nio|charset包||\n|java.nio|Buffer包||\n|java.nio|ByteOrder||\n|java.nio|MappedByteBuffer||\n\n\n### 需改linux服务器配置支持百万级并发\n- Linux的系统默认值为1024，需要解除文件句柄数的限制\n- 调整步骤\n\n```textmate\n1.查看一个进程最大文件句柄数量\n  ulimit -n\n\n2.调整最大句柄数(当期会话有效)\n  ulimit -n 1000000\n\n3.永久调整最大句柄数(root权限)\n    vim /etc/rc.local\n    添加  ulimit -SHn 1000000\n    解释: 选项-S表示软性极限值，-H表示硬性极限值。硬 性极限是实际的限制，就是最大可以是100万，不能再多了。软性极限值则是系统发出警告 (Warning)的极限值，超过这个极限值，内核会发出警告。\n\n4.终极解除Linux系统的最大文件打开数量的限制\n    vim /etc/security/limits.conf\n    添加 \n        soft nofile 1000000\n        hard nofile 1000000\n    解释: soft nofile表示软性极限，hard nofile表示硬性极限。\n```\n","source":"_posts/backend/java/netty/io.md","raw":"---\ntitle: IO\ndescription: io\ndate: 2021-08-11 09:31:00\ntags:\n- io\ncategories:\n- 后端\n- io\n---\n\n### IO模型\n|类型|解释|\n|---|---|\n|阻塞IO|返回数据就绪状态后，用户线程才能做其他动作|\n|非阻塞IO|用户线程不断询问数据是否就绪|\n|多路复用IO|即NIO(NewIO)  有一个线程不断去轮询多个 socket 的状态，只有当 socket 真正有读写事件时，才真正调用实际的 IO 读写操作，这个操作在内核中，比用户线程效率高<br/>缺点：一旦事件响应体很大，那么就会导致后续的事件迟迟得不到处理，并且会影响新的事件轮询。|\n|信号驱动IO|当用户线程发起一个 IO 请求操作，会给对应的 socket 注册一个信号函数，然后用户线程会继续执行，当内核数据就绪时会发送一个信号给用户线程，用户线程接收到之后，在信号函数中调用 IO 读写操作来进行实际的 IO 请求操作|\n|异步IO|最理想的IO模型  <br/>1.用户线程发起read操作，内核立即返回响应。<br/>2.内核接收到请求后，准备数据->copy至用户线程->给用户线程发信号<br/>比较：   信号驱动IO是需要client端调用函数操作IO，异步IO是内核异步处理，client端无需处理|\n\n- 多路复用IO\n\n```textmate\nIO多路复用模型的IO涉及两种系统调用，一种是IO操作的系\n统调用，另一种是select/epoll就绪查询系统调用。IO多路复用模型建立在操作系统的基础 设施之上，即操作系统的内核必须能够提供多路分离的系统调用select/epoll。\n优点:一个选择器查询线程，可以同时处理成千上万的网络连接， 所以，用户程序不必创建大量的线程，也不必维护这些线程，从而大大减小了系统的开 销。这是一个线程维护一个连接的阻塞IO模式相比，使用多路IO复用模型的最大优势。\n缺点:本质上，select/epoll系统调用是阻塞式的，属于同步IO。需要在读写事件就绪后，由系统调用本身负责进行读写，也就是说这个读写过程是阻塞 的\n```\n\n### IO包\n|包名|类型/包|类名|\n|---|---|---|\n|java.io|字节流|InputStream|\n|  |  |OutputStream|\n|  |字符流|Reader|\n|  | |Writer|\n|java.nio|channels包||\n|java.nio|charset包||\n|java.nio|Buffer包||\n|java.nio|ByteOrder||\n|java.nio|MappedByteBuffer||\n\n\n### 需改linux服务器配置支持百万级并发\n- Linux的系统默认值为1024，需要解除文件句柄数的限制\n- 调整步骤\n\n```textmate\n1.查看一个进程最大文件句柄数量\n  ulimit -n\n\n2.调整最大句柄数(当期会话有效)\n  ulimit -n 1000000\n\n3.永久调整最大句柄数(root权限)\n    vim /etc/rc.local\n    添加  ulimit -SHn 1000000\n    解释: 选项-S表示软性极限值，-H表示硬性极限值。硬 性极限是实际的限制，就是最大可以是100万，不能再多了。软性极限值则是系统发出警告 (Warning)的极限值，超过这个极限值，内核会发出警告。\n\n4.终极解除Linux系统的最大文件打开数量的限制\n    vim /etc/security/limits.conf\n    添加 \n        soft nofile 1000000\n        hard nofile 1000000\n    解释: soft nofile表示软性极限，hard nofile表示硬性极限。\n```\n","slug":"backend/java/netty/io","published":1,"updated":"2021-08-11T03:46:34.044Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bf3002ffms61zpeai6n","content":"<h3 id=\"IO模型\"><a href=\"#IO模型\" class=\"headerlink\" title=\"IO模型\"></a>IO模型</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>阻塞IO</td>\n<td>返回数据就绪状态后，用户线程才能做其他动作</td>\n</tr>\n<tr>\n<td>非阻塞IO</td>\n<td>用户线程不断询问数据是否就绪</td>\n</tr>\n<tr>\n<td>多路复用IO</td>\n<td>即NIO(NewIO)  有一个线程不断去轮询多个 socket 的状态，只有当 socket 真正有读写事件时，才真正调用实际的 IO 读写操作，这个操作在内核中，比用户线程效率高<br/>缺点：一旦事件响应体很大，那么就会导致后续的事件迟迟得不到处理，并且会影响新的事件轮询。</td>\n</tr>\n<tr>\n<td>信号驱动IO</td>\n<td>当用户线程发起一个 IO 请求操作，会给对应的 socket 注册一个信号函数，然后用户线程会继续执行，当内核数据就绪时会发送一个信号给用户线程，用户线程接收到之后，在信号函数中调用 IO 读写操作来进行实际的 IO 请求操作</td>\n</tr>\n<tr>\n<td>异步IO</td>\n<td>最理想的IO模型  <br/>1.用户线程发起read操作，内核立即返回响应。<br/>2.内核接收到请求后，准备数据-&gt;copy至用户线程-&gt;给用户线程发信号<br/>比较：   信号驱动IO是需要client端调用函数操作IO，异步IO是内核异步处理，client端无需处理</td>\n</tr>\n</tbody></table>\n<ul>\n<li>多路复用IO</li>\n</ul>\n<pre><code class=\"textmate\">IO多路复用模型的IO涉及两种系统调用，一种是IO操作的系\n统调用，另一种是select/epoll就绪查询系统调用。IO多路复用模型建立在操作系统的基础 设施之上，即操作系统的内核必须能够提供多路分离的系统调用select/epoll。\n优点:一个选择器查询线程，可以同时处理成千上万的网络连接， 所以，用户程序不必创建大量的线程，也不必维护这些线程，从而大大减小了系统的开 销。这是一个线程维护一个连接的阻塞IO模式相比，使用多路IO复用模型的最大优势。\n缺点:本质上，select/epoll系统调用是阻塞式的，属于同步IO。需要在读写事件就绪后，由系统调用本身负责进行读写，也就是说这个读写过程是阻塞 的</code></pre>\n<h3 id=\"IO包\"><a href=\"#IO包\" class=\"headerlink\" title=\"IO包\"></a>IO包</h3><table>\n<thead>\n<tr>\n<th>包名</th>\n<th>类型/包</th>\n<th>类名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>java.io</td>\n<td>字节流</td>\n<td>InputStream</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>OutputStream</td>\n</tr>\n<tr>\n<td></td>\n<td>字符流</td>\n<td>Reader</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Writer</td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>channels包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>charset包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>Buffer包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>ByteOrder</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>MappedByteBuffer</td>\n<td></td>\n</tr>\n</tbody></table>\n<h3 id=\"需改linux服务器配置支持百万级并发\"><a href=\"#需改linux服务器配置支持百万级并发\" class=\"headerlink\" title=\"需改linux服务器配置支持百万级并发\"></a>需改linux服务器配置支持百万级并发</h3><ul>\n<li>Linux的系统默认值为1024，需要解除文件句柄数的限制</li>\n<li>调整步骤</li>\n</ul>\n<pre><code class=\"textmate\">1.查看一个进程最大文件句柄数量\n  ulimit -n\n\n2.调整最大句柄数(当期会话有效)\n  ulimit -n 1000000\n\n3.永久调整最大句柄数(root权限)\n    vim /etc/rc.local\n    添加  ulimit -SHn 1000000\n    解释: 选项-S表示软性极限值，-H表示硬性极限值。硬 性极限是实际的限制，就是最大可以是100万，不能再多了。软性极限值则是系统发出警告 (Warning)的极限值，超过这个极限值，内核会发出警告。\n\n4.终极解除Linux系统的最大文件打开数量的限制\n    vim /etc/security/limits.conf\n    添加 \n        soft nofile 1000000\n        hard nofile 1000000\n    解释: soft nofile表示软性极限，hard nofile表示硬性极限。</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"IO模型\"><a href=\"#IO模型\" class=\"headerlink\" title=\"IO模型\"></a>IO模型</h3><table>\n<thead>\n<tr>\n<th>类型</th>\n<th>解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>阻塞IO</td>\n<td>返回数据就绪状态后，用户线程才能做其他动作</td>\n</tr>\n<tr>\n<td>非阻塞IO</td>\n<td>用户线程不断询问数据是否就绪</td>\n</tr>\n<tr>\n<td>多路复用IO</td>\n<td>即NIO(NewIO)  有一个线程不断去轮询多个 socket 的状态，只有当 socket 真正有读写事件时，才真正调用实际的 IO 读写操作，这个操作在内核中，比用户线程效率高<br/>缺点：一旦事件响应体很大，那么就会导致后续的事件迟迟得不到处理，并且会影响新的事件轮询。</td>\n</tr>\n<tr>\n<td>信号驱动IO</td>\n<td>当用户线程发起一个 IO 请求操作，会给对应的 socket 注册一个信号函数，然后用户线程会继续执行，当内核数据就绪时会发送一个信号给用户线程，用户线程接收到之后，在信号函数中调用 IO 读写操作来进行实际的 IO 请求操作</td>\n</tr>\n<tr>\n<td>异步IO</td>\n<td>最理想的IO模型  <br/>1.用户线程发起read操作，内核立即返回响应。<br/>2.内核接收到请求后，准备数据-&gt;copy至用户线程-&gt;给用户线程发信号<br/>比较：   信号驱动IO是需要client端调用函数操作IO，异步IO是内核异步处理，client端无需处理</td>\n</tr>\n</tbody></table>\n<ul>\n<li>多路复用IO</li>\n</ul>\n<pre><code class=\"textmate\">IO多路复用模型的IO涉及两种系统调用，一种是IO操作的系\n统调用，另一种是select/epoll就绪查询系统调用。IO多路复用模型建立在操作系统的基础 设施之上，即操作系统的内核必须能够提供多路分离的系统调用select/epoll。\n优点:一个选择器查询线程，可以同时处理成千上万的网络连接， 所以，用户程序不必创建大量的线程，也不必维护这些线程，从而大大减小了系统的开 销。这是一个线程维护一个连接的阻塞IO模式相比，使用多路IO复用模型的最大优势。\n缺点:本质上，select/epoll系统调用是阻塞式的，属于同步IO。需要在读写事件就绪后，由系统调用本身负责进行读写，也就是说这个读写过程是阻塞 的</code></pre>\n<h3 id=\"IO包\"><a href=\"#IO包\" class=\"headerlink\" title=\"IO包\"></a>IO包</h3><table>\n<thead>\n<tr>\n<th>包名</th>\n<th>类型/包</th>\n<th>类名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>java.io</td>\n<td>字节流</td>\n<td>InputStream</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>OutputStream</td>\n</tr>\n<tr>\n<td></td>\n<td>字符流</td>\n<td>Reader</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>Writer</td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>channels包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>charset包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>Buffer包</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>ByteOrder</td>\n<td></td>\n</tr>\n<tr>\n<td>java.nio</td>\n<td>MappedByteBuffer</td>\n<td></td>\n</tr>\n</tbody></table>\n<h3 id=\"需改linux服务器配置支持百万级并发\"><a href=\"#需改linux服务器配置支持百万级并发\" class=\"headerlink\" title=\"需改linux服务器配置支持百万级并发\"></a>需改linux服务器配置支持百万级并发</h3><ul>\n<li>Linux的系统默认值为1024，需要解除文件句柄数的限制</li>\n<li>调整步骤</li>\n</ul>\n<pre><code class=\"textmate\">1.查看一个进程最大文件句柄数量\n  ulimit -n\n\n2.调整最大句柄数(当期会话有效)\n  ulimit -n 1000000\n\n3.永久调整最大句柄数(root权限)\n    vim /etc/rc.local\n    添加  ulimit -SHn 1000000\n    解释: 选项-S表示软性极限值，-H表示硬性极限值。硬 性极限是实际的限制，就是最大可以是100万，不能再多了。软性极限值则是系统发出警告 (Warning)的极限值，超过这个极限值，内核会发出警告。\n\n4.终极解除Linux系统的最大文件打开数量的限制\n    vim /etc/security/limits.conf\n    添加 \n        soft nofile 1000000\n        hard nofile 1000000\n    解释: soft nofile表示软性极限，hard nofile表示硬性极限。</code></pre>\n"},{"title":"ThreadPool详解","description":"线程池","date":"2021-02-09T06:12:45.000Z","_content":"\n#### 构造方法签名\n```textmate\nThreadPoolExecutor(int corePoolSize,\n        int maximumPoolSize,\n        long keepAliveTime,\n        TimeUnit unit,\n        BlockingQueue<Runnable> workQueue,\n        ThreadFactory threadFactory,\n        RejectedExecutionHandler handler)\n        \ncorePoolSize - 池中所保存的线程数，包括空闲线程。\nmaximumPoolSize - 池中允许的最大线程数。\nkeepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。\nunit - keepAliveTime参数的时间单位。\nworkQueue - 执行前用于保持任务的队列。此队列仅保持由 execute方法提交的 Runnable任务。\nthreadFactory - 执行程序创建新线程时使用的工厂。\nhandler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。\n```\n\n#### 官方封装好的线程池\n```textmate\nThreadPoolExecutor是Executors类的底层实现。\n\n1. newSingleThreadExecutor（单个后台线程）\n    创建一个单线程的线程池。这个线程池只有一个线程在工作，也就是相当于单线程串行执行所有任务。如果这个唯一的线程因为异常结束，那么会有一个新的线程来替代它。\n    此线程池保证所有任务的执行顺序按照任务的提交顺序执行。\n\n2.newFixedThreadPool（固定大小线程池）\n    创建固定大小的线程池。每次提交一个任务就创建一个线程，直到线程达到线程池的最大大小。线程池的大小一旦达到最大值就会保持不变，\n    如果某个线程因为执行异常而结束，那么线程池会补充一个新线程。\n\n3. newCachedThreadPool（无界线程池，可以进行自动线程回收）\n    创建一个可缓存的线程池。如果线程池的大小超过了处理任务所需要的线程，\n    那么就会回收部分空闲（60秒不执行任务）的线程，当任务数增加时，此线程池又可以智能的添加新线程来处理任务。\n    此线程池不会对线程池大小做限制，线程池大小完全依赖于操作系统（或者说JVM）能够创建的最大线程大小。\n\n4.newScheduledThreadPool\n    创建一个大小无限的线程池。此线程池支持定时以及周期性执行任务的需求。\n```\n\n#### 排队策略\n```textmate\n排队有三种通用策略：\n\n1.直接提交\n    工作队列的默认选项是 SynchronousQueue，它将任务直接提交给线程而不保持它们。在此，如果不存在可用于立即运行任务的线程，\n    则试图把任务加入队列将失败，因此会构造一个新的线程。此策略可以避免在处理可能具有内部依赖性的请求集时出现锁。\n    直接提交通常要求无界 maximumPoolSizes 以避免拒绝新提交的任务。当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n    \n2.无界队列。\n    使用无界队列（例如，不具有预定义容量的 LinkedBlockingQueue）将导致在所有 corePoolSize 线程都忙时新任务在队列中等待。\n    这样，创建的线程就不会超过 corePoolSize。（因此，maximumPoolSize的值也就无效了。）当每个任务完全独立于其他任务，即任务执行互不影响时，\n    适合于使用无界队列；例如，在 Web页服务器中。这种排队可用于处理瞬态突发请求，当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n3.有界队列。\n    当使用有限的 maximumPoolSizes时，有界队列（如 ArrayBlockingQueue）有助于防止资源耗尽，但是可能较难调整和控制。\n    队列大小和最大池大小可能需要相互折衷：使用大型队列和小型池可以最大限度地降低 CPU 使用率、操作系统资源和上下文切换开销，但是可能导致人工降低吞吐量。\n    如果任务频繁阻塞（例如，如果它们是 I/O边界），则系统可能为超过您许可的更多线程安排时间。使用小型队列通常要求较大的池大小，CPU使用率较高，\n    但是可能遇到不可接受的调度开销，这样也会降低吞吐量。\n```\n\n#### BlockingQueue的选择\n```textmate\n例子一：使用直接提交策略，也即SynchronousQueue。\n    首先SynchronousQueue是无界的，也就是说他存数任务的能力是没有限制的，但是由于该Queue本身的特性，在某次添加元素后必须等待其他线程取走后才能继续添加。\n\n例子二：使用无界队列策略，即LinkedBlockingQueue\n    corePoolSize大小的线程数会一直运行，忙完当前的，就从队列中拿任务开始运行。要防止任务疯长，比如任务运行的实行比较长\n\n例子三：有界队列，使用ArrayBlockingQueue。\n    这个是最为复杂的使用，所以JDK不推荐使用。与上面的相比，最大的特点便是可以防止资源耗尽的情况发生。假设，所有的任务都永远无法执行完。\n    对于首先来的A,B来说直接运行，接下来，如果来了C,D，他们会被放到queue中，如果接下来再来E,F，则增加线程运行E，F。但是如果再来任务，队列无法再接受了，\n    线程数也到达最大的限制了，所以就会使用拒绝策略来处理。\n```\n\n#### 拒绝策略\n```textmate\n在ThreadPoolExecutor中已经默认包含了4中拒绝策略\n1.CallerRunsPolicy\n    线程调用运行该任务的 execute 本身。此策略提供简单的反馈控制机制，能够减缓新任务的提交速度。\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n        if (!e.isShutdown()) {\n             r.run();\n         }\n    }\n这个策略显然不想放弃执行任务。但是由于池中已经没有任何资源了，那么就直接使用调用该execute的线程本身来执行。\n\n2.AbortPolicy\n    处理程序遭到拒绝将抛出运行时RejectedExecutionException\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n       throw new RejectedExecutionException();\n    }\n    这种策略直接抛出异常，丢弃任务。\n\n3.DiscardPolicy\n    不能执行的任务将被删除\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {}\n    这种策略和AbortPolicy几乎一样，也是丢弃任务，只不过他不抛出异常。\n\n4.DiscardOldestPolicy\n    如果执行程序尚未关闭，则位于工作队列头部的任务将被删除，然后重试执行程序（如果再次失败，则重复此过程）\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n        if (!e.isShutdown()) {\n            e.getQueue().poll();\n            e.execute(r);\n        }\n    }\n    该策略就稍微复杂一些，在pool没有关闭的前提下首先丢掉缓存在队列中的最早的任务，然后重新尝试运行该任务。这个策略需要适当小心。\n    设想:如果其他线程都还在运行，那么新来任务踢掉旧任务，缓存在queue中，再来一个任务又会踢掉queue中最老任务。\n```\n\n#### 总结\n```textmate\n总结：\nkeepAliveTime和maximumPoolSize及BlockingQueue的类型均有关系。如果BlockingQueue是无界的，那么永远不会触发maximumPoolSize，自然keepAliveTime也就没有了意义。\n反之，如果核心数较小，有界BlockingQueue数值又较小，同时keepAliveTime又设的很小，如果任务频繁，那么系统就会频繁的申请回收线程\n```\n\n#### 配置计算公式\n```textmate\n为了使CPU达到期望使用率，线程池的最优大小为\n线程个数 = cpu个数 * cpu利用率 * （1+ IO处理时间 / CPU处理时间)\n```\n","source":"_posts/backend/java/thread/threadPool.md","raw":"---\ntitle: ThreadPool详解\ndescription: 线程池\ndate: 2021-02-09 14:12:45\ntags:\n- 线程池\ncategories:\n- 后端\n- 线程池\n---\n\n#### 构造方法签名\n```textmate\nThreadPoolExecutor(int corePoolSize,\n        int maximumPoolSize,\n        long keepAliveTime,\n        TimeUnit unit,\n        BlockingQueue<Runnable> workQueue,\n        ThreadFactory threadFactory,\n        RejectedExecutionHandler handler)\n        \ncorePoolSize - 池中所保存的线程数，包括空闲线程。\nmaximumPoolSize - 池中允许的最大线程数。\nkeepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。\nunit - keepAliveTime参数的时间单位。\nworkQueue - 执行前用于保持任务的队列。此队列仅保持由 execute方法提交的 Runnable任务。\nthreadFactory - 执行程序创建新线程时使用的工厂。\nhandler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。\n```\n\n#### 官方封装好的线程池\n```textmate\nThreadPoolExecutor是Executors类的底层实现。\n\n1. newSingleThreadExecutor（单个后台线程）\n    创建一个单线程的线程池。这个线程池只有一个线程在工作，也就是相当于单线程串行执行所有任务。如果这个唯一的线程因为异常结束，那么会有一个新的线程来替代它。\n    此线程池保证所有任务的执行顺序按照任务的提交顺序执行。\n\n2.newFixedThreadPool（固定大小线程池）\n    创建固定大小的线程池。每次提交一个任务就创建一个线程，直到线程达到线程池的最大大小。线程池的大小一旦达到最大值就会保持不变，\n    如果某个线程因为执行异常而结束，那么线程池会补充一个新线程。\n\n3. newCachedThreadPool（无界线程池，可以进行自动线程回收）\n    创建一个可缓存的线程池。如果线程池的大小超过了处理任务所需要的线程，\n    那么就会回收部分空闲（60秒不执行任务）的线程，当任务数增加时，此线程池又可以智能的添加新线程来处理任务。\n    此线程池不会对线程池大小做限制，线程池大小完全依赖于操作系统（或者说JVM）能够创建的最大线程大小。\n\n4.newScheduledThreadPool\n    创建一个大小无限的线程池。此线程池支持定时以及周期性执行任务的需求。\n```\n\n#### 排队策略\n```textmate\n排队有三种通用策略：\n\n1.直接提交\n    工作队列的默认选项是 SynchronousQueue，它将任务直接提交给线程而不保持它们。在此，如果不存在可用于立即运行任务的线程，\n    则试图把任务加入队列将失败，因此会构造一个新的线程。此策略可以避免在处理可能具有内部依赖性的请求集时出现锁。\n    直接提交通常要求无界 maximumPoolSizes 以避免拒绝新提交的任务。当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n    \n2.无界队列。\n    使用无界队列（例如，不具有预定义容量的 LinkedBlockingQueue）将导致在所有 corePoolSize 线程都忙时新任务在队列中等待。\n    这样，创建的线程就不会超过 corePoolSize。（因此，maximumPoolSize的值也就无效了。）当每个任务完全独立于其他任务，即任务执行互不影响时，\n    适合于使用无界队列；例如，在 Web页服务器中。这种排队可用于处理瞬态突发请求，当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n3.有界队列。\n    当使用有限的 maximumPoolSizes时，有界队列（如 ArrayBlockingQueue）有助于防止资源耗尽，但是可能较难调整和控制。\n    队列大小和最大池大小可能需要相互折衷：使用大型队列和小型池可以最大限度地降低 CPU 使用率、操作系统资源和上下文切换开销，但是可能导致人工降低吞吐量。\n    如果任务频繁阻塞（例如，如果它们是 I/O边界），则系统可能为超过您许可的更多线程安排时间。使用小型队列通常要求较大的池大小，CPU使用率较高，\n    但是可能遇到不可接受的调度开销，这样也会降低吞吐量。\n```\n\n#### BlockingQueue的选择\n```textmate\n例子一：使用直接提交策略，也即SynchronousQueue。\n    首先SynchronousQueue是无界的，也就是说他存数任务的能力是没有限制的，但是由于该Queue本身的特性，在某次添加元素后必须等待其他线程取走后才能继续添加。\n\n例子二：使用无界队列策略，即LinkedBlockingQueue\n    corePoolSize大小的线程数会一直运行，忙完当前的，就从队列中拿任务开始运行。要防止任务疯长，比如任务运行的实行比较长\n\n例子三：有界队列，使用ArrayBlockingQueue。\n    这个是最为复杂的使用，所以JDK不推荐使用。与上面的相比，最大的特点便是可以防止资源耗尽的情况发生。假设，所有的任务都永远无法执行完。\n    对于首先来的A,B来说直接运行，接下来，如果来了C,D，他们会被放到queue中，如果接下来再来E,F，则增加线程运行E，F。但是如果再来任务，队列无法再接受了，\n    线程数也到达最大的限制了，所以就会使用拒绝策略来处理。\n```\n\n#### 拒绝策略\n```textmate\n在ThreadPoolExecutor中已经默认包含了4中拒绝策略\n1.CallerRunsPolicy\n    线程调用运行该任务的 execute 本身。此策略提供简单的反馈控制机制，能够减缓新任务的提交速度。\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n        if (!e.isShutdown()) {\n             r.run();\n         }\n    }\n这个策略显然不想放弃执行任务。但是由于池中已经没有任何资源了，那么就直接使用调用该execute的线程本身来执行。\n\n2.AbortPolicy\n    处理程序遭到拒绝将抛出运行时RejectedExecutionException\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n       throw new RejectedExecutionException();\n    }\n    这种策略直接抛出异常，丢弃任务。\n\n3.DiscardPolicy\n    不能执行的任务将被删除\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {}\n    这种策略和AbortPolicy几乎一样，也是丢弃任务，只不过他不抛出异常。\n\n4.DiscardOldestPolicy\n    如果执行程序尚未关闭，则位于工作队列头部的任务将被删除，然后重试执行程序（如果再次失败，则重复此过程）\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\n        if (!e.isShutdown()) {\n            e.getQueue().poll();\n            e.execute(r);\n        }\n    }\n    该策略就稍微复杂一些，在pool没有关闭的前提下首先丢掉缓存在队列中的最早的任务，然后重新尝试运行该任务。这个策略需要适当小心。\n    设想:如果其他线程都还在运行，那么新来任务踢掉旧任务，缓存在queue中，再来一个任务又会踢掉queue中最老任务。\n```\n\n#### 总结\n```textmate\n总结：\nkeepAliveTime和maximumPoolSize及BlockingQueue的类型均有关系。如果BlockingQueue是无界的，那么永远不会触发maximumPoolSize，自然keepAliveTime也就没有了意义。\n反之，如果核心数较小，有界BlockingQueue数值又较小，同时keepAliveTime又设的很小，如果任务频繁，那么系统就会频繁的申请回收线程\n```\n\n#### 配置计算公式\n```textmate\n为了使CPU达到期望使用率，线程池的最优大小为\n线程个数 = cpu个数 * cpu利用率 * （1+ IO处理时间 / CPU处理时间)\n```\n","slug":"backend/java/thread/threadPool","published":1,"updated":"2021-02-09T06:27:29.796Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bf6002jfms67y1agutf","content":"<h4 id=\"构造方法签名\"><a href=\"#构造方法签名\" class=\"headerlink\" title=\"构造方法签名\"></a>构造方法签名</h4><pre><code class=\"textmate\">ThreadPoolExecutor(int corePoolSize,\n        int maximumPoolSize,\n        long keepAliveTime,\n        TimeUnit unit,\n        BlockingQueue&lt;Runnable&gt; workQueue,\n        ThreadFactory threadFactory,\n        RejectedExecutionHandler handler)\n\ncorePoolSize - 池中所保存的线程数，包括空闲线程。\nmaximumPoolSize - 池中允许的最大线程数。\nkeepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。\nunit - keepAliveTime参数的时间单位。\nworkQueue - 执行前用于保持任务的队列。此队列仅保持由 execute方法提交的 Runnable任务。\nthreadFactory - 执行程序创建新线程时使用的工厂。\nhandler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。</code></pre>\n<h4 id=\"官方封装好的线程池\"><a href=\"#官方封装好的线程池\" class=\"headerlink\" title=\"官方封装好的线程池\"></a>官方封装好的线程池</h4><pre><code class=\"textmate\">ThreadPoolExecutor是Executors类的底层实现。\n\n1. newSingleThreadExecutor（单个后台线程）\n    创建一个单线程的线程池。这个线程池只有一个线程在工作，也就是相当于单线程串行执行所有任务。如果这个唯一的线程因为异常结束，那么会有一个新的线程来替代它。\n    此线程池保证所有任务的执行顺序按照任务的提交顺序执行。\n\n2.newFixedThreadPool（固定大小线程池）\n    创建固定大小的线程池。每次提交一个任务就创建一个线程，直到线程达到线程池的最大大小。线程池的大小一旦达到最大值就会保持不变，\n    如果某个线程因为执行异常而结束，那么线程池会补充一个新线程。\n\n3. newCachedThreadPool（无界线程池，可以进行自动线程回收）\n    创建一个可缓存的线程池。如果线程池的大小超过了处理任务所需要的线程，\n    那么就会回收部分空闲（60秒不执行任务）的线程，当任务数增加时，此线程池又可以智能的添加新线程来处理任务。\n    此线程池不会对线程池大小做限制，线程池大小完全依赖于操作系统（或者说JVM）能够创建的最大线程大小。\n\n4.newScheduledThreadPool\n    创建一个大小无限的线程池。此线程池支持定时以及周期性执行任务的需求。</code></pre>\n<h4 id=\"排队策略\"><a href=\"#排队策略\" class=\"headerlink\" title=\"排队策略\"></a>排队策略</h4><pre><code class=\"textmate\">排队有三种通用策略：\n\n1.直接提交\n    工作队列的默认选项是 SynchronousQueue，它将任务直接提交给线程而不保持它们。在此，如果不存在可用于立即运行任务的线程，\n    则试图把任务加入队列将失败，因此会构造一个新的线程。此策略可以避免在处理可能具有内部依赖性的请求集时出现锁。\n    直接提交通常要求无界 maximumPoolSizes 以避免拒绝新提交的任务。当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n2.无界队列。\n    使用无界队列（例如，不具有预定义容量的 LinkedBlockingQueue）将导致在所有 corePoolSize 线程都忙时新任务在队列中等待。\n    这样，创建的线程就不会超过 corePoolSize。（因此，maximumPoolSize的值也就无效了。）当每个任务完全独立于其他任务，即任务执行互不影响时，\n    适合于使用无界队列；例如，在 Web页服务器中。这种排队可用于处理瞬态突发请求，当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n3.有界队列。\n    当使用有限的 maximumPoolSizes时，有界队列（如 ArrayBlockingQueue）有助于防止资源耗尽，但是可能较难调整和控制。\n    队列大小和最大池大小可能需要相互折衷：使用大型队列和小型池可以最大限度地降低 CPU 使用率、操作系统资源和上下文切换开销，但是可能导致人工降低吞吐量。\n    如果任务频繁阻塞（例如，如果它们是 I/O边界），则系统可能为超过您许可的更多线程安排时间。使用小型队列通常要求较大的池大小，CPU使用率较高，\n    但是可能遇到不可接受的调度开销，这样也会降低吞吐量。</code></pre>\n<h4 id=\"BlockingQueue的选择\"><a href=\"#BlockingQueue的选择\" class=\"headerlink\" title=\"BlockingQueue的选择\"></a>BlockingQueue的选择</h4><pre><code class=\"textmate\">例子一：使用直接提交策略，也即SynchronousQueue。\n    首先SynchronousQueue是无界的，也就是说他存数任务的能力是没有限制的，但是由于该Queue本身的特性，在某次添加元素后必须等待其他线程取走后才能继续添加。\n\n例子二：使用无界队列策略，即LinkedBlockingQueue\n    corePoolSize大小的线程数会一直运行，忙完当前的，就从队列中拿任务开始运行。要防止任务疯长，比如任务运行的实行比较长\n\n例子三：有界队列，使用ArrayBlockingQueue。\n    这个是最为复杂的使用，所以JDK不推荐使用。与上面的相比，最大的特点便是可以防止资源耗尽的情况发生。假设，所有的任务都永远无法执行完。\n    对于首先来的A,B来说直接运行，接下来，如果来了C,D，他们会被放到queue中，如果接下来再来E,F，则增加线程运行E，F。但是如果再来任务，队列无法再接受了，\n    线程数也到达最大的限制了，所以就会使用拒绝策略来处理。</code></pre>\n<h4 id=\"拒绝策略\"><a href=\"#拒绝策略\" class=\"headerlink\" title=\"拒绝策略\"></a>拒绝策略</h4><pre><code class=\"textmate\">在ThreadPoolExecutor中已经默认包含了4中拒绝策略\n1.CallerRunsPolicy\n    线程调用运行该任务的 execute 本身。此策略提供简单的反馈控制机制，能够减缓新任务的提交速度。\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n        if (!e.isShutdown()) &#123;\n             r.run();\n         &#125;\n    &#125;\n这个策略显然不想放弃执行任务。但是由于池中已经没有任何资源了，那么就直接使用调用该execute的线程本身来执行。\n\n2.AbortPolicy\n    处理程序遭到拒绝将抛出运行时RejectedExecutionException\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n       throw new RejectedExecutionException();\n    &#125;\n    这种策略直接抛出异常，丢弃任务。\n\n3.DiscardPolicy\n    不能执行的任务将被删除\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;&#125;\n    这种策略和AbortPolicy几乎一样，也是丢弃任务，只不过他不抛出异常。\n\n4.DiscardOldestPolicy\n    如果执行程序尚未关闭，则位于工作队列头部的任务将被删除，然后重试执行程序（如果再次失败，则重复此过程）\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n        if (!e.isShutdown()) &#123;\n            e.getQueue().poll();\n            e.execute(r);\n        &#125;\n    &#125;\n    该策略就稍微复杂一些，在pool没有关闭的前提下首先丢掉缓存在队列中的最早的任务，然后重新尝试运行该任务。这个策略需要适当小心。\n    设想:如果其他线程都还在运行，那么新来任务踢掉旧任务，缓存在queue中，再来一个任务又会踢掉queue中最老任务。</code></pre>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><pre><code class=\"textmate\">总结：\nkeepAliveTime和maximumPoolSize及BlockingQueue的类型均有关系。如果BlockingQueue是无界的，那么永远不会触发maximumPoolSize，自然keepAliveTime也就没有了意义。\n反之，如果核心数较小，有界BlockingQueue数值又较小，同时keepAliveTime又设的很小，如果任务频繁，那么系统就会频繁的申请回收线程</code></pre>\n<h4 id=\"配置计算公式\"><a href=\"#配置计算公式\" class=\"headerlink\" title=\"配置计算公式\"></a>配置计算公式</h4><pre><code class=\"textmate\">为了使CPU达到期望使用率，线程池的最优大小为\n线程个数 = cpu个数 * cpu利用率 * （1+ IO处理时间 / CPU处理时间)</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"构造方法签名\"><a href=\"#构造方法签名\" class=\"headerlink\" title=\"构造方法签名\"></a>构造方法签名</h4><pre><code class=\"textmate\">ThreadPoolExecutor(int corePoolSize,\n        int maximumPoolSize,\n        long keepAliveTime,\n        TimeUnit unit,\n        BlockingQueue&lt;Runnable&gt; workQueue,\n        ThreadFactory threadFactory,\n        RejectedExecutionHandler handler)\n\ncorePoolSize - 池中所保存的线程数，包括空闲线程。\nmaximumPoolSize - 池中允许的最大线程数。\nkeepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。\nunit - keepAliveTime参数的时间单位。\nworkQueue - 执行前用于保持任务的队列。此队列仅保持由 execute方法提交的 Runnable任务。\nthreadFactory - 执行程序创建新线程时使用的工厂。\nhandler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。</code></pre>\n<h4 id=\"官方封装好的线程池\"><a href=\"#官方封装好的线程池\" class=\"headerlink\" title=\"官方封装好的线程池\"></a>官方封装好的线程池</h4><pre><code class=\"textmate\">ThreadPoolExecutor是Executors类的底层实现。\n\n1. newSingleThreadExecutor（单个后台线程）\n    创建一个单线程的线程池。这个线程池只有一个线程在工作，也就是相当于单线程串行执行所有任务。如果这个唯一的线程因为异常结束，那么会有一个新的线程来替代它。\n    此线程池保证所有任务的执行顺序按照任务的提交顺序执行。\n\n2.newFixedThreadPool（固定大小线程池）\n    创建固定大小的线程池。每次提交一个任务就创建一个线程，直到线程达到线程池的最大大小。线程池的大小一旦达到最大值就会保持不变，\n    如果某个线程因为执行异常而结束，那么线程池会补充一个新线程。\n\n3. newCachedThreadPool（无界线程池，可以进行自动线程回收）\n    创建一个可缓存的线程池。如果线程池的大小超过了处理任务所需要的线程，\n    那么就会回收部分空闲（60秒不执行任务）的线程，当任务数增加时，此线程池又可以智能的添加新线程来处理任务。\n    此线程池不会对线程池大小做限制，线程池大小完全依赖于操作系统（或者说JVM）能够创建的最大线程大小。\n\n4.newScheduledThreadPool\n    创建一个大小无限的线程池。此线程池支持定时以及周期性执行任务的需求。</code></pre>\n<h4 id=\"排队策略\"><a href=\"#排队策略\" class=\"headerlink\" title=\"排队策略\"></a>排队策略</h4><pre><code class=\"textmate\">排队有三种通用策略：\n\n1.直接提交\n    工作队列的默认选项是 SynchronousQueue，它将任务直接提交给线程而不保持它们。在此，如果不存在可用于立即运行任务的线程，\n    则试图把任务加入队列将失败，因此会构造一个新的线程。此策略可以避免在处理可能具有内部依赖性的请求集时出现锁。\n    直接提交通常要求无界 maximumPoolSizes 以避免拒绝新提交的任务。当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n2.无界队列。\n    使用无界队列（例如，不具有预定义容量的 LinkedBlockingQueue）将导致在所有 corePoolSize 线程都忙时新任务在队列中等待。\n    这样，创建的线程就不会超过 corePoolSize。（因此，maximumPoolSize的值也就无效了。）当每个任务完全独立于其他任务，即任务执行互不影响时，\n    适合于使用无界队列；例如，在 Web页服务器中。这种排队可用于处理瞬态突发请求，当命令以超过队列所能处理的平均数连续到达时，此策略允许无界线程具有增长的可能性。\n\n3.有界队列。\n    当使用有限的 maximumPoolSizes时，有界队列（如 ArrayBlockingQueue）有助于防止资源耗尽，但是可能较难调整和控制。\n    队列大小和最大池大小可能需要相互折衷：使用大型队列和小型池可以最大限度地降低 CPU 使用率、操作系统资源和上下文切换开销，但是可能导致人工降低吞吐量。\n    如果任务频繁阻塞（例如，如果它们是 I/O边界），则系统可能为超过您许可的更多线程安排时间。使用小型队列通常要求较大的池大小，CPU使用率较高，\n    但是可能遇到不可接受的调度开销，这样也会降低吞吐量。</code></pre>\n<h4 id=\"BlockingQueue的选择\"><a href=\"#BlockingQueue的选择\" class=\"headerlink\" title=\"BlockingQueue的选择\"></a>BlockingQueue的选择</h4><pre><code class=\"textmate\">例子一：使用直接提交策略，也即SynchronousQueue。\n    首先SynchronousQueue是无界的，也就是说他存数任务的能力是没有限制的，但是由于该Queue本身的特性，在某次添加元素后必须等待其他线程取走后才能继续添加。\n\n例子二：使用无界队列策略，即LinkedBlockingQueue\n    corePoolSize大小的线程数会一直运行，忙完当前的，就从队列中拿任务开始运行。要防止任务疯长，比如任务运行的实行比较长\n\n例子三：有界队列，使用ArrayBlockingQueue。\n    这个是最为复杂的使用，所以JDK不推荐使用。与上面的相比，最大的特点便是可以防止资源耗尽的情况发生。假设，所有的任务都永远无法执行完。\n    对于首先来的A,B来说直接运行，接下来，如果来了C,D，他们会被放到queue中，如果接下来再来E,F，则增加线程运行E，F。但是如果再来任务，队列无法再接受了，\n    线程数也到达最大的限制了，所以就会使用拒绝策略来处理。</code></pre>\n<h4 id=\"拒绝策略\"><a href=\"#拒绝策略\" class=\"headerlink\" title=\"拒绝策略\"></a>拒绝策略</h4><pre><code class=\"textmate\">在ThreadPoolExecutor中已经默认包含了4中拒绝策略\n1.CallerRunsPolicy\n    线程调用运行该任务的 execute 本身。此策略提供简单的反馈控制机制，能够减缓新任务的提交速度。\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n        if (!e.isShutdown()) &#123;\n             r.run();\n         &#125;\n    &#125;\n这个策略显然不想放弃执行任务。但是由于池中已经没有任何资源了，那么就直接使用调用该execute的线程本身来执行。\n\n2.AbortPolicy\n    处理程序遭到拒绝将抛出运行时RejectedExecutionException\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n       throw new RejectedExecutionException();\n    &#125;\n    这种策略直接抛出异常，丢弃任务。\n\n3.DiscardPolicy\n    不能执行的任务将被删除\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;&#125;\n    这种策略和AbortPolicy几乎一样，也是丢弃任务，只不过他不抛出异常。\n\n4.DiscardOldestPolicy\n    如果执行程序尚未关闭，则位于工作队列头部的任务将被删除，然后重试执行程序（如果再次失败，则重复此过程）\n    public void rejectedExecution(Runnable r, ThreadPoolExecutor e) &#123;\n        if (!e.isShutdown()) &#123;\n            e.getQueue().poll();\n            e.execute(r);\n        &#125;\n    &#125;\n    该策略就稍微复杂一些，在pool没有关闭的前提下首先丢掉缓存在队列中的最早的任务，然后重新尝试运行该任务。这个策略需要适当小心。\n    设想:如果其他线程都还在运行，那么新来任务踢掉旧任务，缓存在queue中，再来一个任务又会踢掉queue中最老任务。</code></pre>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><pre><code class=\"textmate\">总结：\nkeepAliveTime和maximumPoolSize及BlockingQueue的类型均有关系。如果BlockingQueue是无界的，那么永远不会触发maximumPoolSize，自然keepAliveTime也就没有了意义。\n反之，如果核心数较小，有界BlockingQueue数值又较小，同时keepAliveTime又设的很小，如果任务频繁，那么系统就会频繁的申请回收线程</code></pre>\n<h4 id=\"配置计算公式\"><a href=\"#配置计算公式\" class=\"headerlink\" title=\"配置计算公式\"></a>配置计算公式</h4><pre><code class=\"textmate\">为了使CPU达到期望使用率，线程池的最优大小为\n线程个数 = cpu个数 * cpu利用率 * （1+ IO处理时间 / CPU处理时间)</code></pre>\n"},{"title":"EasyExcel使用遇到的问题","description":"excel","date":"2020-10-20T09:22:53.000Z","_content":"\n### 导出设置标题格式\n- TitleHandler\n```java\npublic class TitleHandler implements CellWriteHandler{\n\n    //操作列\n    private List<Integer> columnIndexs;\n    //颜色\n    private Short colorIndex;\n\n    public TitleHandler(List<Integer> columnIndexs, Short colorIndex) {\n        this.columnIndexs = columnIndexs;\n        this.colorIndex = colorIndex;\n    }\n\n    @Override\n    public void beforeCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellDataConverted(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellDispose(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List<CellData> cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n        if(isHead){\n            // 设置列宽\n            Sheet sheet = writeSheetHolder.getSheet();\n            sheet.setColumnWidth(cell.getColumnIndex(), 20 * 256);\n            writeSheetHolder.getSheet().getRow(0).setHeight((short)(3*256));\n            Workbook workbook = writeSheetHolder.getSheet().getWorkbook();\n\n            // 设置标题字体样式\n            WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n            WriteFont headWriteFont = new WriteFont();\n            headWriteFont.setFontName(\"宋体\");\n            headWriteFont.setFontHeightInPoints((short)14);\n            headWriteFont.setBold(true);\n            if (CollectionUtils.isNotEmpty(columnIndexs) &&\n                    colorIndex != null &&\n                    columnIndexs.contains(cell.getColumnIndex())) {\n                // 设置字体颜色\n                headWriteFont.setColor(colorIndex);\n            }\n            headWriteCellStyle.setWriteFont(headWriteFont);\n            headWriteCellStyle.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());\n            CellStyle cellStyle = StyleUtil.buildHeadCellStyle(workbook, headWriteCellStyle);\n            cell.setCellStyle(cellStyle);\n        }\n    }\n}\n```\n\n- ExcelUtils\n```java\npublic class ExcelUtils {\n    /** 导出Excel **/\n    public static void exportExcel(String fileName, String sheetName,Class clazz,\n                                   List data, HttpServletResponse response,\n                                   CellWriteHandler... cellWriteHandlers) throws IOException {\n        response.setContentType(\"application/vnd.ms-excel\");\n        response.setCharacterEncoding(\"utf-8\");\n        fileName = URLEncoder.encode(fileName, \"UTF-8\").replaceAll(\"\\\\+\", \"%20\");\n        response.setHeader(\"Content-disposition\", \"attachment;filename*=utf-8''\" + fileName + \".xlsx\");\n\n        // 列标题的策略\n        WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n        // 单元格策略\n        WriteCellStyle contentWriteCellStyle = new WriteCellStyle();\n        // 初始化表格样式\n        HorizontalCellStyleStrategy horizontalCellStyleStrategy = new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);\n\n        ExcelWriterSheetBuilder excelWriterSheetBuilder = EasyExcel.write(response.getOutputStream(), clazz)\n                .sheet(sheetName)\n                .registerWriteHandler(horizontalCellStyleStrategy);\n\n        if (null != cellWriteHandlers && cellWriteHandlers.length > 0) {\n            for (int i = 0; i < cellWriteHandlers.length; i++) {\n                excelWriterSheetBuilder.registerWriteHandler(cellWriteHandlers[i]);\n            }\n        }\n        // 开始导出\n        excelWriterSheetBuilder.doWrite(data);\n    }\n}\n```\n- 使用\n```java\n/** 导出excel模板**/\npublic void exportTemplate(List<Integer> ids,HttpServletResponse response){\n    try {\n        List<XXX> result = getByIds(ids);\n\n        // 指定标红色的列\n        List<Integer> columns = Arrays.asList(0,1,2,3);\n\n        TitleHandler titleHandler = new TitleHandler(columns, IndexedColors.RED.index);\n        ExcelUtils.exportExcel(\"文件名\",\"sheet名称\",\n                XXX.class,result,response,titleHandler);\n    } catch (IOException e) {\n        log.warn(\"导出失败,error={}\",e);\n    }\n}\n```\n\n### 设置中文文件名\n\n```java\n// 代码中添加\nresponse.setContentType(\"application/vnd.ms-excel;charset=UTF-8\");\nresponse.setCharacterEncoding(\"utf-8\");\nresponse.setHeader(\"Content-disposition\", \"attachment;filename*=utf-8''\" + fileName + \".xlsx\");\n```\n\n### 导出失败返回错误信息\n```java\n// 重写响应信息数据类型\nresponse.reset();\nresponse.setContentType(\"application/json\");\nresponse.setCharacterEncoding(\"utf-8\");\ntry {\n    response.getWriter().println(result);\n} catch (IOException ioException) {\n    log.warn(\"业务异常  msg={}\",ioException);\n}\n```\n\n### 常见错误\n#### 导出成功但是后台日志报类型转换异常\n```textmate\n错误日志\n    No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type 'application/vnd.ms-excel;charset=utf-8'\n    org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type 'application/vnd.ms-excel;charset=utf-8'\n原因\n    导出方法不能有返回值，导出文件时会设置相应头为文件格式；如果有返回值，则就会出现数据转换异常的错误\n解决方法\n    修改Controller中方法，改为 void 即可\n```\n","source":"_posts/backend/java/utils/excel.md","raw":"---\ntitle: EasyExcel使用遇到的问题\ndescription: excel\ndate: 2020-10-20 17:22:53\ntags:\n- utils\ncategories:\n- 后端\n- 工具\n---\n\n### 导出设置标题格式\n- TitleHandler\n```java\npublic class TitleHandler implements CellWriteHandler{\n\n    //操作列\n    private List<Integer> columnIndexs;\n    //颜色\n    private Short colorIndex;\n\n    public TitleHandler(List<Integer> columnIndexs, Short colorIndex) {\n        this.columnIndexs = columnIndexs;\n        this.colorIndex = colorIndex;\n    }\n\n    @Override\n    public void beforeCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellDataConverted(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n\n    }\n\n    @Override\n    public void afterCellDispose(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List<CellData> cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) {\n        if(isHead){\n            // 设置列宽\n            Sheet sheet = writeSheetHolder.getSheet();\n            sheet.setColumnWidth(cell.getColumnIndex(), 20 * 256);\n            writeSheetHolder.getSheet().getRow(0).setHeight((short)(3*256));\n            Workbook workbook = writeSheetHolder.getSheet().getWorkbook();\n\n            // 设置标题字体样式\n            WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n            WriteFont headWriteFont = new WriteFont();\n            headWriteFont.setFontName(\"宋体\");\n            headWriteFont.setFontHeightInPoints((short)14);\n            headWriteFont.setBold(true);\n            if (CollectionUtils.isNotEmpty(columnIndexs) &&\n                    colorIndex != null &&\n                    columnIndexs.contains(cell.getColumnIndex())) {\n                // 设置字体颜色\n                headWriteFont.setColor(colorIndex);\n            }\n            headWriteCellStyle.setWriteFont(headWriteFont);\n            headWriteCellStyle.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());\n            CellStyle cellStyle = StyleUtil.buildHeadCellStyle(workbook, headWriteCellStyle);\n            cell.setCellStyle(cellStyle);\n        }\n    }\n}\n```\n\n- ExcelUtils\n```java\npublic class ExcelUtils {\n    /** 导出Excel **/\n    public static void exportExcel(String fileName, String sheetName,Class clazz,\n                                   List data, HttpServletResponse response,\n                                   CellWriteHandler... cellWriteHandlers) throws IOException {\n        response.setContentType(\"application/vnd.ms-excel\");\n        response.setCharacterEncoding(\"utf-8\");\n        fileName = URLEncoder.encode(fileName, \"UTF-8\").replaceAll(\"\\\\+\", \"%20\");\n        response.setHeader(\"Content-disposition\", \"attachment;filename*=utf-8''\" + fileName + \".xlsx\");\n\n        // 列标题的策略\n        WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n        // 单元格策略\n        WriteCellStyle contentWriteCellStyle = new WriteCellStyle();\n        // 初始化表格样式\n        HorizontalCellStyleStrategy horizontalCellStyleStrategy = new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);\n\n        ExcelWriterSheetBuilder excelWriterSheetBuilder = EasyExcel.write(response.getOutputStream(), clazz)\n                .sheet(sheetName)\n                .registerWriteHandler(horizontalCellStyleStrategy);\n\n        if (null != cellWriteHandlers && cellWriteHandlers.length > 0) {\n            for (int i = 0; i < cellWriteHandlers.length; i++) {\n                excelWriterSheetBuilder.registerWriteHandler(cellWriteHandlers[i]);\n            }\n        }\n        // 开始导出\n        excelWriterSheetBuilder.doWrite(data);\n    }\n}\n```\n- 使用\n```java\n/** 导出excel模板**/\npublic void exportTemplate(List<Integer> ids,HttpServletResponse response){\n    try {\n        List<XXX> result = getByIds(ids);\n\n        // 指定标红色的列\n        List<Integer> columns = Arrays.asList(0,1,2,3);\n\n        TitleHandler titleHandler = new TitleHandler(columns, IndexedColors.RED.index);\n        ExcelUtils.exportExcel(\"文件名\",\"sheet名称\",\n                XXX.class,result,response,titleHandler);\n    } catch (IOException e) {\n        log.warn(\"导出失败,error={}\",e);\n    }\n}\n```\n\n### 设置中文文件名\n\n```java\n// 代码中添加\nresponse.setContentType(\"application/vnd.ms-excel;charset=UTF-8\");\nresponse.setCharacterEncoding(\"utf-8\");\nresponse.setHeader(\"Content-disposition\", \"attachment;filename*=utf-8''\" + fileName + \".xlsx\");\n```\n\n### 导出失败返回错误信息\n```java\n// 重写响应信息数据类型\nresponse.reset();\nresponse.setContentType(\"application/json\");\nresponse.setCharacterEncoding(\"utf-8\");\ntry {\n    response.getWriter().println(result);\n} catch (IOException ioException) {\n    log.warn(\"业务异常  msg={}\",ioException);\n}\n```\n\n### 常见错误\n#### 导出成功但是后台日志报类型转换异常\n```textmate\n错误日志\n    No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type 'application/vnd.ms-excel;charset=utf-8'\n    org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type 'application/vnd.ms-excel;charset=utf-8'\n原因\n    导出方法不能有返回值，导出文件时会设置相应头为文件格式；如果有返回值，则就会出现数据转换异常的错误\n解决方法\n    修改Controller中方法，改为 void 即可\n```\n","slug":"backend/java/utils/excel","published":1,"updated":"2020-12-26T08:35:35.306Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bf8002lfms6fhq03nvc","content":"<h3 id=\"导出设置标题格式\"><a href=\"#导出设置标题格式\" class=\"headerlink\" title=\"导出设置标题格式\"></a>导出设置标题格式</h3><ul>\n<li><p>TitleHandler</p>\n<pre><code class=\"java\">public class TitleHandler implements CellWriteHandler&#123;\n\n  //操作列\n  private List&lt;Integer&gt; columnIndexs;\n  //颜色\n  private Short colorIndex;\n\n  public TitleHandler(List&lt;Integer&gt; columnIndexs, Short colorIndex) &#123;\n      this.columnIndexs = columnIndexs;\n      this.colorIndex = colorIndex;\n  &#125;\n\n  @Override\n  public void beforeCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellDataConverted(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellDispose(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List&lt;CellData&gt; cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n      if(isHead)&#123;\n          // 设置列宽\n          Sheet sheet = writeSheetHolder.getSheet();\n          sheet.setColumnWidth(cell.getColumnIndex(), 20 * 256);\n          writeSheetHolder.getSheet().getRow(0).setHeight((short)(3*256));\n          Workbook workbook = writeSheetHolder.getSheet().getWorkbook();\n\n          // 设置标题字体样式\n          WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n          WriteFont headWriteFont = new WriteFont();\n          headWriteFont.setFontName(&quot;宋体&quot;);\n          headWriteFont.setFontHeightInPoints((short)14);\n          headWriteFont.setBold(true);\n          if (CollectionUtils.isNotEmpty(columnIndexs) &amp;&amp;\n                  colorIndex != null &amp;&amp;\n                  columnIndexs.contains(cell.getColumnIndex())) &#123;\n              // 设置字体颜色\n              headWriteFont.setColor(colorIndex);\n          &#125;\n          headWriteCellStyle.setWriteFont(headWriteFont);\n          headWriteCellStyle.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());\n          CellStyle cellStyle = StyleUtil.buildHeadCellStyle(workbook, headWriteCellStyle);\n          cell.setCellStyle(cellStyle);\n      &#125;\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>ExcelUtils</p>\n<pre><code class=\"java\">public class ExcelUtils &#123;\n  /** 导出Excel **/\n  public static void exportExcel(String fileName, String sheetName,Class clazz,\n                                 List data, HttpServletResponse response,\n                                 CellWriteHandler... cellWriteHandlers) throws IOException &#123;\n      response.setContentType(&quot;application/vnd.ms-excel&quot;);\n      response.setCharacterEncoding(&quot;utf-8&quot;);\n      fileName = URLEncoder.encode(fileName, &quot;UTF-8&quot;).replaceAll(&quot;\\\\+&quot;, &quot;%20&quot;);\n      response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#39;&#39;&quot; + fileName + &quot;.xlsx&quot;);\n\n      // 列标题的策略\n      WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n      // 单元格策略\n      WriteCellStyle contentWriteCellStyle = new WriteCellStyle();\n      // 初始化表格样式\n      HorizontalCellStyleStrategy horizontalCellStyleStrategy = new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);\n\n      ExcelWriterSheetBuilder excelWriterSheetBuilder = EasyExcel.write(response.getOutputStream(), clazz)\n              .sheet(sheetName)\n              .registerWriteHandler(horizontalCellStyleStrategy);\n\n      if (null != cellWriteHandlers &amp;&amp; cellWriteHandlers.length &gt; 0) &#123;\n          for (int i = 0; i &lt; cellWriteHandlers.length; i++) &#123;\n              excelWriterSheetBuilder.registerWriteHandler(cellWriteHandlers[i]);\n          &#125;\n      &#125;\n      // 开始导出\n      excelWriterSheetBuilder.doWrite(data);\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>使用</p>\n<pre><code class=\"java\">/** 导出excel模板**/\npublic void exportTemplate(List&lt;Integer&gt; ids,HttpServletResponse response)&#123;\n  try &#123;\n      List&lt;XXX&gt; result = getByIds(ids);\n\n      // 指定标红色的列\n      List&lt;Integer&gt; columns = Arrays.asList(0,1,2,3);\n\n      TitleHandler titleHandler = new TitleHandler(columns, IndexedColors.RED.index);\n      ExcelUtils.exportExcel(&quot;文件名&quot;,&quot;sheet名称&quot;,\n              XXX.class,result,response,titleHandler);\n  &#125; catch (IOException e) &#123;\n      log.warn(&quot;导出失败,error=&#123;&#125;&quot;,e);\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h3 id=\"设置中文文件名\"><a href=\"#设置中文文件名\" class=\"headerlink\" title=\"设置中文文件名\"></a>设置中文文件名</h3><pre><code class=\"java\">// 代码中添加\nresponse.setContentType(&quot;application/vnd.ms-excel;charset=UTF-8&quot;);\nresponse.setCharacterEncoding(&quot;utf-8&quot;);\nresponse.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#39;&#39;&quot; + fileName + &quot;.xlsx&quot;);</code></pre>\n<h3 id=\"导出失败返回错误信息\"><a href=\"#导出失败返回错误信息\" class=\"headerlink\" title=\"导出失败返回错误信息\"></a>导出失败返回错误信息</h3><pre><code class=\"java\">// 重写响应信息数据类型\nresponse.reset();\nresponse.setContentType(&quot;application/json&quot;);\nresponse.setCharacterEncoding(&quot;utf-8&quot;);\ntry &#123;\n    response.getWriter().println(result);\n&#125; catch (IOException ioException) &#123;\n    log.warn(&quot;业务异常  msg=&#123;&#125;&quot;,ioException);\n&#125;</code></pre>\n<h3 id=\"常见错误\"><a href=\"#常见错误\" class=\"headerlink\" title=\"常见错误\"></a>常见错误</h3><h4 id=\"导出成功但是后台日志报类型转换异常\"><a href=\"#导出成功但是后台日志报类型转换异常\" class=\"headerlink\" title=\"导出成功但是后台日志报类型转换异常\"></a>导出成功但是后台日志报类型转换异常</h4><pre><code class=\"textmate\">错误日志\n    No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type &#39;application/vnd.ms-excel;charset=utf-8&#39;\n    org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type &#39;application/vnd.ms-excel;charset=utf-8&#39;\n原因\n    导出方法不能有返回值，导出文件时会设置相应头为文件格式；如果有返回值，则就会出现数据转换异常的错误\n解决方法\n    修改Controller中方法，改为 void 即可</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"导出设置标题格式\"><a href=\"#导出设置标题格式\" class=\"headerlink\" title=\"导出设置标题格式\"></a>导出设置标题格式</h3><ul>\n<li><p>TitleHandler</p>\n<pre><code class=\"java\">public class TitleHandler implements CellWriteHandler&#123;\n\n  //操作列\n  private List&lt;Integer&gt; columnIndexs;\n  //颜色\n  private Short colorIndex;\n\n  public TitleHandler(List&lt;Integer&gt; columnIndexs, Short colorIndex) &#123;\n      this.columnIndexs = columnIndexs;\n      this.colorIndex = colorIndex;\n  &#125;\n\n  @Override\n  public void beforeCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Row row, Head head, Integer columnIndex, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellCreate(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellDataConverted(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, CellData cellData, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n\n  &#125;\n\n  @Override\n  public void afterCellDispose(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List&lt;CellData&gt; cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead) &#123;\n      if(isHead)&#123;\n          // 设置列宽\n          Sheet sheet = writeSheetHolder.getSheet();\n          sheet.setColumnWidth(cell.getColumnIndex(), 20 * 256);\n          writeSheetHolder.getSheet().getRow(0).setHeight((short)(3*256));\n          Workbook workbook = writeSheetHolder.getSheet().getWorkbook();\n\n          // 设置标题字体样式\n          WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n          WriteFont headWriteFont = new WriteFont();\n          headWriteFont.setFontName(&quot;宋体&quot;);\n          headWriteFont.setFontHeightInPoints((short)14);\n          headWriteFont.setBold(true);\n          if (CollectionUtils.isNotEmpty(columnIndexs) &amp;&amp;\n                  colorIndex != null &amp;&amp;\n                  columnIndexs.contains(cell.getColumnIndex())) &#123;\n              // 设置字体颜色\n              headWriteFont.setColor(colorIndex);\n          &#125;\n          headWriteCellStyle.setWriteFont(headWriteFont);\n          headWriteCellStyle.setFillForegroundColor(IndexedColors.GREY_25_PERCENT.getIndex());\n          CellStyle cellStyle = StyleUtil.buildHeadCellStyle(workbook, headWriteCellStyle);\n          cell.setCellStyle(cellStyle);\n      &#125;\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>ExcelUtils</p>\n<pre><code class=\"java\">public class ExcelUtils &#123;\n  /** 导出Excel **/\n  public static void exportExcel(String fileName, String sheetName,Class clazz,\n                                 List data, HttpServletResponse response,\n                                 CellWriteHandler... cellWriteHandlers) throws IOException &#123;\n      response.setContentType(&quot;application/vnd.ms-excel&quot;);\n      response.setCharacterEncoding(&quot;utf-8&quot;);\n      fileName = URLEncoder.encode(fileName, &quot;UTF-8&quot;).replaceAll(&quot;\\\\+&quot;, &quot;%20&quot;);\n      response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#39;&#39;&quot; + fileName + &quot;.xlsx&quot;);\n\n      // 列标题的策略\n      WriteCellStyle headWriteCellStyle = new WriteCellStyle();\n      // 单元格策略\n      WriteCellStyle contentWriteCellStyle = new WriteCellStyle();\n      // 初始化表格样式\n      HorizontalCellStyleStrategy horizontalCellStyleStrategy = new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);\n\n      ExcelWriterSheetBuilder excelWriterSheetBuilder = EasyExcel.write(response.getOutputStream(), clazz)\n              .sheet(sheetName)\n              .registerWriteHandler(horizontalCellStyleStrategy);\n\n      if (null != cellWriteHandlers &amp;&amp; cellWriteHandlers.length &gt; 0) &#123;\n          for (int i = 0; i &lt; cellWriteHandlers.length; i++) &#123;\n              excelWriterSheetBuilder.registerWriteHandler(cellWriteHandlers[i]);\n          &#125;\n      &#125;\n      // 开始导出\n      excelWriterSheetBuilder.doWrite(data);\n  &#125;\n&#125;</code></pre>\n</li>\n<li><p>使用</p>\n<pre><code class=\"java\">/** 导出excel模板**/\npublic void exportTemplate(List&lt;Integer&gt; ids,HttpServletResponse response)&#123;\n  try &#123;\n      List&lt;XXX&gt; result = getByIds(ids);\n\n      // 指定标红色的列\n      List&lt;Integer&gt; columns = Arrays.asList(0,1,2,3);\n\n      TitleHandler titleHandler = new TitleHandler(columns, IndexedColors.RED.index);\n      ExcelUtils.exportExcel(&quot;文件名&quot;,&quot;sheet名称&quot;,\n              XXX.class,result,response,titleHandler);\n  &#125; catch (IOException e) &#123;\n      log.warn(&quot;导出失败,error=&#123;&#125;&quot;,e);\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h3 id=\"设置中文文件名\"><a href=\"#设置中文文件名\" class=\"headerlink\" title=\"设置中文文件名\"></a>设置中文文件名</h3><pre><code class=\"java\">// 代码中添加\nresponse.setContentType(&quot;application/vnd.ms-excel;charset=UTF-8&quot;);\nresponse.setCharacterEncoding(&quot;utf-8&quot;);\nresponse.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#39;&#39;&quot; + fileName + &quot;.xlsx&quot;);</code></pre>\n<h3 id=\"导出失败返回错误信息\"><a href=\"#导出失败返回错误信息\" class=\"headerlink\" title=\"导出失败返回错误信息\"></a>导出失败返回错误信息</h3><pre><code class=\"java\">// 重写响应信息数据类型\nresponse.reset();\nresponse.setContentType(&quot;application/json&quot;);\nresponse.setCharacterEncoding(&quot;utf-8&quot;);\ntry &#123;\n    response.getWriter().println(result);\n&#125; catch (IOException ioException) &#123;\n    log.warn(&quot;业务异常  msg=&#123;&#125;&quot;,ioException);\n&#125;</code></pre>\n<h3 id=\"常见错误\"><a href=\"#常见错误\" class=\"headerlink\" title=\"常见错误\"></a>常见错误</h3><h4 id=\"导出成功但是后台日志报类型转换异常\"><a href=\"#导出成功但是后台日志报类型转换异常\" class=\"headerlink\" title=\"导出成功但是后台日志报类型转换异常\"></a>导出成功但是后台日志报类型转换异常</h4><pre><code class=\"textmate\">错误日志\n    No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type &#39;application/vnd.ms-excel;charset=utf-8&#39;\n    org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class com.hzrys.dashboard.common.result.R] with preset Content-Type &#39;application/vnd.ms-excel;charset=utf-8&#39;\n原因\n    导出方法不能有返回值，导出文件时会设置相应头为文件格式；如果有返回值，则就会出现数据转换异常的错误\n解决方法\n    修改Controller中方法，改为 void 即可</code></pre>\n"},{"title":"MybatisPlus使用笔记","description":"mybatis-plus","date":"2020-12-10T04:00:00.000Z","_content":"\n- [官网](https://mp.baomidou.com/)\n\n### 常用配置\n```yaml\n#mybatis\n# 配置是否打印日志 true-打印  false-不打印\n# paginationInterceptor-true 改为false则分页功能无效\nsql:\n  performanceInterceptor: true\nmybatis-plus:\n  mapper-locations: classpath*:/mapper/**/*.xml\n  #实体扫描，多个package用逗号或者分号分隔\n  typeAliasesPackage: com.ruoyi.**.domain\n  global-config:\n    #数据库相关配置\n    db-config:\n      #主键类型  AUTO:\"数据库ID自增\", INPUT:\"用户输入ID\", ID_WORKER:\"全局唯一ID (数字类型唯一ID)\", UUID:\"全局唯一ID UUID\";\n      id-type: AUTO\n      #字段策略 IGNORED:\"忽略判断\",NOT_NULL:\"非 NULL 判断\"),NOT_EMPTY:\"非空判断\"\n      field-strategy: NOT_NULL\n      #驼峰下划线转换\n      column-underline: true\n      logic-delete-value: -1\n      logic-not-delete-value: 0\n    banner: false\n  #原生配置\n  configuration:\n    #不加无法打印执行脚本及内容\n    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl\n    map-underscore-to-camel-case: true\n    cache-enabled: false\n    call-setters-on-nulls: true\n    jdbc-type-for-null: 'null'\n```\n### 常见问题\n\n- 1.selectOne() 查询出多条数据会报错\n```textmate\nselectOne不是存在多条数据时只返回一条！！！\n报错信息：\n   org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.TooManyResultsException:\n   Expected one result (or null) to be returned by selectOne(), but found: 2\n解决方法:\n    1.手动添加\n    wrapper最后加上(最好带上排序，每次返回固定的值) .last(\"limit 1\")\n    2.切面统一处理,如下\n```\n```java\n@Aspect\n@Component\npublic class MybatisPlusAspect {\n\n    // 配置织入点\n    @Pointcut(\"execution(public * com.baomidou.mybatisplus.core.mapper.BaseMapper.selectOne(..))\")\n    public void selectOneAspect() {\n    }\n\n    @Before(\"selectOneAspect()\")\n    public void beforeSelect(JoinPoint point) {\n        Object arg = point.getArgs()[0];\n        if (arg instanceof AbstractWrapper) {\n            arg = (AbstractWrapper) arg;\n            ((AbstractWrapper) arg).last(\"limit 1\");\n        }\n    }\n}\n```\n\n### Idea生成代码插件推荐\n- [EasyCode-MybatisCodeHelper](https://plugins.jetbrains.com/plugin/13847-easycode-mybatiscodehelper)\n","source":"_posts/backend/java/utils/mybatis-plus.md","raw":"---\ntitle: MybatisPlus使用笔记\ndescription: mybatis-plus\ndate: 2020-12-10 12:00:00\ntags:\n- utils\ncategories:\n- 后端\n- 工具\n---\n\n- [官网](https://mp.baomidou.com/)\n\n### 常用配置\n```yaml\n#mybatis\n# 配置是否打印日志 true-打印  false-不打印\n# paginationInterceptor-true 改为false则分页功能无效\nsql:\n  performanceInterceptor: true\nmybatis-plus:\n  mapper-locations: classpath*:/mapper/**/*.xml\n  #实体扫描，多个package用逗号或者分号分隔\n  typeAliasesPackage: com.ruoyi.**.domain\n  global-config:\n    #数据库相关配置\n    db-config:\n      #主键类型  AUTO:\"数据库ID自增\", INPUT:\"用户输入ID\", ID_WORKER:\"全局唯一ID (数字类型唯一ID)\", UUID:\"全局唯一ID UUID\";\n      id-type: AUTO\n      #字段策略 IGNORED:\"忽略判断\",NOT_NULL:\"非 NULL 判断\"),NOT_EMPTY:\"非空判断\"\n      field-strategy: NOT_NULL\n      #驼峰下划线转换\n      column-underline: true\n      logic-delete-value: -1\n      logic-not-delete-value: 0\n    banner: false\n  #原生配置\n  configuration:\n    #不加无法打印执行脚本及内容\n    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl\n    map-underscore-to-camel-case: true\n    cache-enabled: false\n    call-setters-on-nulls: true\n    jdbc-type-for-null: 'null'\n```\n### 常见问题\n\n- 1.selectOne() 查询出多条数据会报错\n```textmate\nselectOne不是存在多条数据时只返回一条！！！\n报错信息：\n   org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.TooManyResultsException:\n   Expected one result (or null) to be returned by selectOne(), but found: 2\n解决方法:\n    1.手动添加\n    wrapper最后加上(最好带上排序，每次返回固定的值) .last(\"limit 1\")\n    2.切面统一处理,如下\n```\n```java\n@Aspect\n@Component\npublic class MybatisPlusAspect {\n\n    // 配置织入点\n    @Pointcut(\"execution(public * com.baomidou.mybatisplus.core.mapper.BaseMapper.selectOne(..))\")\n    public void selectOneAspect() {\n    }\n\n    @Before(\"selectOneAspect()\")\n    public void beforeSelect(JoinPoint point) {\n        Object arg = point.getArgs()[0];\n        if (arg instanceof AbstractWrapper) {\n            arg = (AbstractWrapper) arg;\n            ((AbstractWrapper) arg).last(\"limit 1\");\n        }\n    }\n}\n```\n\n### Idea生成代码插件推荐\n- [EasyCode-MybatisCodeHelper](https://plugins.jetbrains.com/plugin/13847-easycode-mybatiscodehelper)\n","slug":"backend/java/utils/mybatis-plus","published":1,"updated":"2021-03-20T06:40:31.408Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bfb002qfms67zpd5bn4","content":"<ul>\n<li><a href=\"https://mp.baomidou.com/\">官网</a></li>\n</ul>\n<h3 id=\"常用配置\"><a href=\"#常用配置\" class=\"headerlink\" title=\"常用配置\"></a>常用配置</h3><pre><code class=\"yaml\">#mybatis\n# 配置是否打印日志 true-打印  false-不打印\n# paginationInterceptor-true 改为false则分页功能无效\nsql:\n  performanceInterceptor: true\nmybatis-plus:\n  mapper-locations: classpath*:/mapper/**/*.xml\n  #实体扫描，多个package用逗号或者分号分隔\n  typeAliasesPackage: com.ruoyi.**.domain\n  global-config:\n    #数据库相关配置\n    db-config:\n      #主键类型  AUTO:&quot;数据库ID自增&quot;, INPUT:&quot;用户输入ID&quot;, ID_WORKER:&quot;全局唯一ID (数字类型唯一ID)&quot;, UUID:&quot;全局唯一ID UUID&quot;;\n      id-type: AUTO\n      #字段策略 IGNORED:&quot;忽略判断&quot;,NOT_NULL:&quot;非 NULL 判断&quot;),NOT_EMPTY:&quot;非空判断&quot;\n      field-strategy: NOT_NULL\n      #驼峰下划线转换\n      column-underline: true\n      logic-delete-value: -1\n      logic-not-delete-value: 0\n    banner: false\n  #原生配置\n  configuration:\n    #不加无法打印执行脚本及内容\n    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl\n    map-underscore-to-camel-case: true\n    cache-enabled: false\n    call-setters-on-nulls: true\n    jdbc-type-for-null: &#39;null&#39;</code></pre>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li><p>1.selectOne() 查询出多条数据会报错</p>\n<pre><code class=\"textmate\">selectOne不是存在多条数据时只返回一条！！！\n报错信息：\n org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.TooManyResultsException:\n Expected one result (or null) to be returned by selectOne(), but found: 2\n解决方法:\n  1.手动添加\n  wrapper最后加上(最好带上排序，每次返回固定的值) .last(&quot;limit 1&quot;)\n  2.切面统一处理,如下</code></pre>\n<pre><code class=\"java\">@Aspect\n@Component\npublic class MybatisPlusAspect &#123;\n\n  // 配置织入点\n  @Pointcut(&quot;execution(public * com.baomidou.mybatisplus.core.mapper.BaseMapper.selectOne(..))&quot;)\n  public void selectOneAspect() &#123;\n  &#125;\n\n  @Before(&quot;selectOneAspect()&quot;)\n  public void beforeSelect(JoinPoint point) &#123;\n      Object arg = point.getArgs()[0];\n      if (arg instanceof AbstractWrapper) &#123;\n          arg = (AbstractWrapper) arg;\n          ((AbstractWrapper) arg).last(&quot;limit 1&quot;);\n      &#125;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h3 id=\"Idea生成代码插件推荐\"><a href=\"#Idea生成代码插件推荐\" class=\"headerlink\" title=\"Idea生成代码插件推荐\"></a>Idea生成代码插件推荐</h3><ul>\n<li><a href=\"https://plugins.jetbrains.com/plugin/13847-easycode-mybatiscodehelper\">EasyCode-MybatisCodeHelper</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><a href=\"https://mp.baomidou.com/\">官网</a></li>\n</ul>\n<h3 id=\"常用配置\"><a href=\"#常用配置\" class=\"headerlink\" title=\"常用配置\"></a>常用配置</h3><pre><code class=\"yaml\">#mybatis\n# 配置是否打印日志 true-打印  false-不打印\n# paginationInterceptor-true 改为false则分页功能无效\nsql:\n  performanceInterceptor: true\nmybatis-plus:\n  mapper-locations: classpath*:/mapper/**/*.xml\n  #实体扫描，多个package用逗号或者分号分隔\n  typeAliasesPackage: com.ruoyi.**.domain\n  global-config:\n    #数据库相关配置\n    db-config:\n      #主键类型  AUTO:&quot;数据库ID自增&quot;, INPUT:&quot;用户输入ID&quot;, ID_WORKER:&quot;全局唯一ID (数字类型唯一ID)&quot;, UUID:&quot;全局唯一ID UUID&quot;;\n      id-type: AUTO\n      #字段策略 IGNORED:&quot;忽略判断&quot;,NOT_NULL:&quot;非 NULL 判断&quot;),NOT_EMPTY:&quot;非空判断&quot;\n      field-strategy: NOT_NULL\n      #驼峰下划线转换\n      column-underline: true\n      logic-delete-value: -1\n      logic-not-delete-value: 0\n    banner: false\n  #原生配置\n  configuration:\n    #不加无法打印执行脚本及内容\n    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl\n    map-underscore-to-camel-case: true\n    cache-enabled: false\n    call-setters-on-nulls: true\n    jdbc-type-for-null: &#39;null&#39;</code></pre>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ul>\n<li><p>1.selectOne() 查询出多条数据会报错</p>\n<pre><code class=\"textmate\">selectOne不是存在多条数据时只返回一条！！！\n报错信息：\n org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.TooManyResultsException:\n Expected one result (or null) to be returned by selectOne(), but found: 2\n解决方法:\n  1.手动添加\n  wrapper最后加上(最好带上排序，每次返回固定的值) .last(&quot;limit 1&quot;)\n  2.切面统一处理,如下</code></pre>\n<pre><code class=\"java\">@Aspect\n@Component\npublic class MybatisPlusAspect &#123;\n\n  // 配置织入点\n  @Pointcut(&quot;execution(public * com.baomidou.mybatisplus.core.mapper.BaseMapper.selectOne(..))&quot;)\n  public void selectOneAspect() &#123;\n  &#125;\n\n  @Before(&quot;selectOneAspect()&quot;)\n  public void beforeSelect(JoinPoint point) &#123;\n      Object arg = point.getArgs()[0];\n      if (arg instanceof AbstractWrapper) &#123;\n          arg = (AbstractWrapper) arg;\n          ((AbstractWrapper) arg).last(&quot;limit 1&quot;);\n      &#125;\n  &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h3 id=\"Idea生成代码插件推荐\"><a href=\"#Idea生成代码插件推荐\" class=\"headerlink\" title=\"Idea生成代码插件推荐\"></a>Idea生成代码插件推荐</h3><ul>\n<li><a href=\"https://plugins.jetbrains.com/plugin/13847-easycode-mybatiscodehelper\">EasyCode-MybatisCodeHelper</a></li>\n</ul>\n"},{"title":"Java解析Swagger文档接口及参数","description":"解析swagger-ui","date":"2020-11-11T11:30:00.000Z","_content":"\n### 相关依赖包\n```xml\n<!--swagger依赖-->\n<dependency>\n    <groupId>io.springfox</groupId>\n    <artifactId>springfox-swagger2</artifactId>\n    <version>2.9.2</version>\n</dependency>\n<dependency>\n    <groupId>io.springfox</groupId>\n    <artifactId>springfox-swagger-ui</artifactId>\n    <version>2.9.2</version>\n</dependency>\n<dependency>\n    <groupId>com.github.xiaoymin</groupId>\n    <artifactId>swagger-bootstrap-ui</artifactId>\n    <version>1.9.6</version>\n</dependency>\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.73</version>\n</dependency>\n\n```\n\n### Swagger文档相关接口\n```textmate\n1.接口文档地址\n    https://localhost:8080/swagger-ui.html\n    https://localhost:8080/doc.html\n2.JSON格式接口数据(group参数由项目中swagger配置决定)\n    http://localhost:8080/v2/api-docs?group=V1版本\n```\n\n### 主要代码\n```java\n/**\n * 加载swagger文档中的接口信息\n * @Date 2020/11/6 11:31\n * @Author fan\n**/\npublic boolean loadSwaggerAPI(Integer lesseeId,String url){\n    try {\n        log.info(\"开始加载Swagger文档,url={}\",url);\n        String result = OkhttpClientUtil.get(url);\n        JSONObject jsonObject = JSON.parseObject(result);\n        if(jsonObject == null){\n            return false;\n        }\n        //移除对象描述信息\n        String platform = (String) JSON.parseObject(JSON.toJSONString(jsonObject.get(\"info\"))).get(\"title\");\n        JSONObject paths = (JSONObject) jsonObject.get(\"paths\");\n        JSONObject definitions = (JSONObject) jsonObject.get(\"definitions\");\n        Map<String,JSONObject> paramMap = JSONObject.toJavaObject(definitions,Map.class);\n\n        List<PublicResourceInfo> resourceInfos = new ArrayList<>();\n        for(Map.Entry<String,Object> entry :  paths.entrySet()){\n            String apiUrl = entry.getKey();\n            String perms = resourceInfoService.buildPermByApiPath(null,apiUrl);\n            JSONObject methodInfo = (JSONObject) entry.getValue();\n\n            for(Map.Entry<String,Object> methodEntry : methodInfo.entrySet()){\n                String requestType = methodEntry.getKey().toUpperCase();\n\n                JSONObject requestTypeInfo = (JSONObject) methodEntry.getValue();\n                String apiName = String.valueOf(requestTypeInfo.get(\"summary\"));\n                String moduleName = StringUtils.join((List<String>)requestTypeInfo.get(\"tags\"),\",\");\n\n                PublicResourceInfo resourceInfo = new PublicResourceInfo();\n                resourceInfo.setPlatformNameCn(platform);\n                resourceInfo.setApiPath(apiUrl);\n                resourceInfo.setPerms(perms);\n                resourceInfo.setApiName(apiName);\n                resourceInfo.setRequestType(requestType);\n                resourceInfo.setModuleNameCn(moduleName);\n\n                //解析swagger-ui中的出参入参\n                JSONArray parameterJson = (JSONArray) requestTypeInfo.get(\"parameters\");\n                Object requestParam = null;\n                Map<String,Object> requestParamMap = new HashMap<>();\n                if(parameterJson != null){\n                    for(Object object : parameterJson){\n                        JSONObject schema = (JSONObject) ((JSONObject) object).get(\"schema\");\n                        if (schema != null){\n                            String ref = (String) schema.get(\"$ref\");\n                            requestParam = parseRequestToJson(null,paramMap,ref);\n                        } else {\n                            String mapKey = (String) ((JSONObject) object).get(\"name\");\n                            String type = ((JSONObject) object).getString(\"type\");\n                            Object value = setValueByType(type,null);\n                            requestParamMap.put(mapKey,value);\n                        }\n                    }\n                }\n\n                if(requestParam != null){\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParam));\n                } else {\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParamMap));\n                }\n\n                //返回值类型都用标准类型，不解析其他格式\n                JSONObject response = (JSONObject) requestTypeInfo.get(\"responses\");\n                Object responseResult = null;\n                if(response != null){\n                    JSONObject schema = (JSONObject) ((JSONObject)response.get(\"200\")).get(\"schema\");\n                    if(schema != null){\n                        String ref = (String) schema.get(\"$ref\");\n                        responseResult = parseRequestToJson(null,paramMap,ref);\n                    }\n                }\n                if(responseResult != null){\n                    resourceInfo.setResponseParam(JSONObject.toJSONString(responseResult));\n                }\n\n                resourceInfos.add(resourceInfo);\n            }\n        }\n        log.info(\"解析完成=====>{}\",JSONObject.toJSONString(resourceInfos));\n    } catch (IOException e) {\n        log.error(\"加载Swagger文档中接口失败，url={}\",url);\n        return false;\n    }\n    return true;\n}\n\n/**\n * 解析swagger-ui中出参和入参为json\n * @param paramMap 入参和出参对象map,key-对象标识，value-对象属性及类型json\n * @param paramRef 入参和出参对应的对象信息， 格式: #/definitions/R«PageResultDTO«PublicResourceInfoDTO»»\n * @Date 2020/11/11 16:01\n * @Author fan\n**/\nprivate Object parseRequestToJson(Map<String,Integer> forEachCache,Map<String,JSONObject> paramMap, String paramRef){\n    if(StringUtils.isBlank(paramRef)){\n        return \"\";\n    }\n\n    //对象标识\n    String paramKey = paramRef.substring(paramRef.lastIndexOf(\"/\")+1);\n\n    //控制递归次数，同一个对象循环超过1次就返回空\n    if(forEachCache == null){\n        forEachCache = new HashMap<>();\n    }\n    Integer forEachCount = forEachCache.get(paramKey);\n    if(forEachCount != null && forEachCount >= 1){\n        return null;\n    } else {\n        forEachCache.put(paramKey,1);\n    }\n\n    //对象值\n    JSONObject paramJson = paramMap.get(paramKey);\n    JSONObject propertiesJson = JSONObject.parseObject(String.valueOf(paramJson.get(\"properties\")));\n\n    Map<String,Object> columnMap = new HashMap<>();\n    for(Map.Entry<String,Object> entry : propertiesJson.entrySet()){\n        String key = entry.getKey();\n        Object value = new JSONObject();\n        JSONObject valueJson = JSONObject.parseObject(String.valueOf(entry.getValue()));\n        String type = valueJson.getString(\"type\");\n        Object obj = valueJson.get(\"items\");\n\n        if(obj != null){\n            JSONObject property = JSONObject.parseObject(String.valueOf(obj));\n            String ref = (String) property.get(\"$ref\");\n            //有下一级，则递归\n            if(StringUtils.isNotBlank(ref)){\n                value = parseRequestToJson(forEachCache,paramMap,ref);\n            }\n        }\n        value = setValueByType(type,value);\n        columnMap.put(key,value);\n    }\n    return columnMap;\n}\n\n/**  根据参数类型设置value **/\nprivate Object setValueByType(String type,Object value){\n    if(\"array\".equals(type)){\n        JSONArray jsonArray = new JSONArray();\n        if(value == null){\n            value = new JSONObject();\n        }\n        jsonArray.add(value);\n        return JSONArray.toJSONString(jsonArray);\n    }\n    if(\"integer\".equals(type)){\n        return 0;\n    }\n    if(\"boolean\".equals(type)){\n        return true;\n    }\n    if(\"object\".equals(type)){\n        return value;\n    }\n    return \"\";\n}\n```\n","source":"_posts/backend/java/utils/swagger.md","raw":"---\ntitle: Java解析Swagger文档接口及参数\ndescription: 解析swagger-ui\ndate: 2020-11-11 19:30\ntags:\n- utils\ncategories:\n- 后端\n- 工具\n---\n\n### 相关依赖包\n```xml\n<!--swagger依赖-->\n<dependency>\n    <groupId>io.springfox</groupId>\n    <artifactId>springfox-swagger2</artifactId>\n    <version>2.9.2</version>\n</dependency>\n<dependency>\n    <groupId>io.springfox</groupId>\n    <artifactId>springfox-swagger-ui</artifactId>\n    <version>2.9.2</version>\n</dependency>\n<dependency>\n    <groupId>com.github.xiaoymin</groupId>\n    <artifactId>swagger-bootstrap-ui</artifactId>\n    <version>1.9.6</version>\n</dependency>\n\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.73</version>\n</dependency>\n\n```\n\n### Swagger文档相关接口\n```textmate\n1.接口文档地址\n    https://localhost:8080/swagger-ui.html\n    https://localhost:8080/doc.html\n2.JSON格式接口数据(group参数由项目中swagger配置决定)\n    http://localhost:8080/v2/api-docs?group=V1版本\n```\n\n### 主要代码\n```java\n/**\n * 加载swagger文档中的接口信息\n * @Date 2020/11/6 11:31\n * @Author fan\n**/\npublic boolean loadSwaggerAPI(Integer lesseeId,String url){\n    try {\n        log.info(\"开始加载Swagger文档,url={}\",url);\n        String result = OkhttpClientUtil.get(url);\n        JSONObject jsonObject = JSON.parseObject(result);\n        if(jsonObject == null){\n            return false;\n        }\n        //移除对象描述信息\n        String platform = (String) JSON.parseObject(JSON.toJSONString(jsonObject.get(\"info\"))).get(\"title\");\n        JSONObject paths = (JSONObject) jsonObject.get(\"paths\");\n        JSONObject definitions = (JSONObject) jsonObject.get(\"definitions\");\n        Map<String,JSONObject> paramMap = JSONObject.toJavaObject(definitions,Map.class);\n\n        List<PublicResourceInfo> resourceInfos = new ArrayList<>();\n        for(Map.Entry<String,Object> entry :  paths.entrySet()){\n            String apiUrl = entry.getKey();\n            String perms = resourceInfoService.buildPermByApiPath(null,apiUrl);\n            JSONObject methodInfo = (JSONObject) entry.getValue();\n\n            for(Map.Entry<String,Object> methodEntry : methodInfo.entrySet()){\n                String requestType = methodEntry.getKey().toUpperCase();\n\n                JSONObject requestTypeInfo = (JSONObject) methodEntry.getValue();\n                String apiName = String.valueOf(requestTypeInfo.get(\"summary\"));\n                String moduleName = StringUtils.join((List<String>)requestTypeInfo.get(\"tags\"),\",\");\n\n                PublicResourceInfo resourceInfo = new PublicResourceInfo();\n                resourceInfo.setPlatformNameCn(platform);\n                resourceInfo.setApiPath(apiUrl);\n                resourceInfo.setPerms(perms);\n                resourceInfo.setApiName(apiName);\n                resourceInfo.setRequestType(requestType);\n                resourceInfo.setModuleNameCn(moduleName);\n\n                //解析swagger-ui中的出参入参\n                JSONArray parameterJson = (JSONArray) requestTypeInfo.get(\"parameters\");\n                Object requestParam = null;\n                Map<String,Object> requestParamMap = new HashMap<>();\n                if(parameterJson != null){\n                    for(Object object : parameterJson){\n                        JSONObject schema = (JSONObject) ((JSONObject) object).get(\"schema\");\n                        if (schema != null){\n                            String ref = (String) schema.get(\"$ref\");\n                            requestParam = parseRequestToJson(null,paramMap,ref);\n                        } else {\n                            String mapKey = (String) ((JSONObject) object).get(\"name\");\n                            String type = ((JSONObject) object).getString(\"type\");\n                            Object value = setValueByType(type,null);\n                            requestParamMap.put(mapKey,value);\n                        }\n                    }\n                }\n\n                if(requestParam != null){\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParam));\n                } else {\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParamMap));\n                }\n\n                //返回值类型都用标准类型，不解析其他格式\n                JSONObject response = (JSONObject) requestTypeInfo.get(\"responses\");\n                Object responseResult = null;\n                if(response != null){\n                    JSONObject schema = (JSONObject) ((JSONObject)response.get(\"200\")).get(\"schema\");\n                    if(schema != null){\n                        String ref = (String) schema.get(\"$ref\");\n                        responseResult = parseRequestToJson(null,paramMap,ref);\n                    }\n                }\n                if(responseResult != null){\n                    resourceInfo.setResponseParam(JSONObject.toJSONString(responseResult));\n                }\n\n                resourceInfos.add(resourceInfo);\n            }\n        }\n        log.info(\"解析完成=====>{}\",JSONObject.toJSONString(resourceInfos));\n    } catch (IOException e) {\n        log.error(\"加载Swagger文档中接口失败，url={}\",url);\n        return false;\n    }\n    return true;\n}\n\n/**\n * 解析swagger-ui中出参和入参为json\n * @param paramMap 入参和出参对象map,key-对象标识，value-对象属性及类型json\n * @param paramRef 入参和出参对应的对象信息， 格式: #/definitions/R«PageResultDTO«PublicResourceInfoDTO»»\n * @Date 2020/11/11 16:01\n * @Author fan\n**/\nprivate Object parseRequestToJson(Map<String,Integer> forEachCache,Map<String,JSONObject> paramMap, String paramRef){\n    if(StringUtils.isBlank(paramRef)){\n        return \"\";\n    }\n\n    //对象标识\n    String paramKey = paramRef.substring(paramRef.lastIndexOf(\"/\")+1);\n\n    //控制递归次数，同一个对象循环超过1次就返回空\n    if(forEachCache == null){\n        forEachCache = new HashMap<>();\n    }\n    Integer forEachCount = forEachCache.get(paramKey);\n    if(forEachCount != null && forEachCount >= 1){\n        return null;\n    } else {\n        forEachCache.put(paramKey,1);\n    }\n\n    //对象值\n    JSONObject paramJson = paramMap.get(paramKey);\n    JSONObject propertiesJson = JSONObject.parseObject(String.valueOf(paramJson.get(\"properties\")));\n\n    Map<String,Object> columnMap = new HashMap<>();\n    for(Map.Entry<String,Object> entry : propertiesJson.entrySet()){\n        String key = entry.getKey();\n        Object value = new JSONObject();\n        JSONObject valueJson = JSONObject.parseObject(String.valueOf(entry.getValue()));\n        String type = valueJson.getString(\"type\");\n        Object obj = valueJson.get(\"items\");\n\n        if(obj != null){\n            JSONObject property = JSONObject.parseObject(String.valueOf(obj));\n            String ref = (String) property.get(\"$ref\");\n            //有下一级，则递归\n            if(StringUtils.isNotBlank(ref)){\n                value = parseRequestToJson(forEachCache,paramMap,ref);\n            }\n        }\n        value = setValueByType(type,value);\n        columnMap.put(key,value);\n    }\n    return columnMap;\n}\n\n/**  根据参数类型设置value **/\nprivate Object setValueByType(String type,Object value){\n    if(\"array\".equals(type)){\n        JSONArray jsonArray = new JSONArray();\n        if(value == null){\n            value = new JSONObject();\n        }\n        jsonArray.add(value);\n        return JSONArray.toJSONString(jsonArray);\n    }\n    if(\"integer\".equals(type)){\n        return 0;\n    }\n    if(\"boolean\".equals(type)){\n        return true;\n    }\n    if(\"object\".equals(type)){\n        return value;\n    }\n    return \"\";\n}\n```\n","slug":"backend/java/utils/swagger","published":1,"updated":"2020-12-26T08:25:31.533Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bfd002rfms6cpqp2jmo","content":"<h3 id=\"相关依赖包\"><a href=\"#相关依赖包\" class=\"headerlink\" title=\"相关依赖包\"></a>相关依赖包</h3><pre><code class=\"xml\">&lt;!--swagger依赖--&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;\n    &lt;artifactId&gt;swagger-bootstrap-ui&lt;/artifactId&gt;\n    &lt;version&gt;1.9.6&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;\n    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;\n    &lt;version&gt;1.2.73&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<h3 id=\"Swagger文档相关接口\"><a href=\"#Swagger文档相关接口\" class=\"headerlink\" title=\"Swagger文档相关接口\"></a>Swagger文档相关接口</h3><pre><code class=\"textmate\">1.接口文档地址\n    https://localhost:8080/swagger-ui.html\n    https://localhost:8080/doc.html\n2.JSON格式接口数据(group参数由项目中swagger配置决定)\n    http://localhost:8080/v2/api-docs?group=V1版本</code></pre>\n<h3 id=\"主要代码\"><a href=\"#主要代码\" class=\"headerlink\" title=\"主要代码\"></a>主要代码</h3><pre><code class=\"java\">/**\n * 加载swagger文档中的接口信息\n * @Date 2020/11/6 11:31\n * @Author fan\n**/\npublic boolean loadSwaggerAPI(Integer lesseeId,String url)&#123;\n    try &#123;\n        log.info(&quot;开始加载Swagger文档,url=&#123;&#125;&quot;,url);\n        String result = OkhttpClientUtil.get(url);\n        JSONObject jsonObject = JSON.parseObject(result);\n        if(jsonObject == null)&#123;\n            return false;\n        &#125;\n        //移除对象描述信息\n        String platform = (String) JSON.parseObject(JSON.toJSONString(jsonObject.get(&quot;info&quot;))).get(&quot;title&quot;);\n        JSONObject paths = (JSONObject) jsonObject.get(&quot;paths&quot;);\n        JSONObject definitions = (JSONObject) jsonObject.get(&quot;definitions&quot;);\n        Map&lt;String,JSONObject&gt; paramMap = JSONObject.toJavaObject(definitions,Map.class);\n\n        List&lt;PublicResourceInfo&gt; resourceInfos = new ArrayList&lt;&gt;();\n        for(Map.Entry&lt;String,Object&gt; entry :  paths.entrySet())&#123;\n            String apiUrl = entry.getKey();\n            String perms = resourceInfoService.buildPermByApiPath(null,apiUrl);\n            JSONObject methodInfo = (JSONObject) entry.getValue();\n\n            for(Map.Entry&lt;String,Object&gt; methodEntry : methodInfo.entrySet())&#123;\n                String requestType = methodEntry.getKey().toUpperCase();\n\n                JSONObject requestTypeInfo = (JSONObject) methodEntry.getValue();\n                String apiName = String.valueOf(requestTypeInfo.get(&quot;summary&quot;));\n                String moduleName = StringUtils.join((List&lt;String&gt;)requestTypeInfo.get(&quot;tags&quot;),&quot;,&quot;);\n\n                PublicResourceInfo resourceInfo = new PublicResourceInfo();\n                resourceInfo.setPlatformNameCn(platform);\n                resourceInfo.setApiPath(apiUrl);\n                resourceInfo.setPerms(perms);\n                resourceInfo.setApiName(apiName);\n                resourceInfo.setRequestType(requestType);\n                resourceInfo.setModuleNameCn(moduleName);\n\n                //解析swagger-ui中的出参入参\n                JSONArray parameterJson = (JSONArray) requestTypeInfo.get(&quot;parameters&quot;);\n                Object requestParam = null;\n                Map&lt;String,Object&gt; requestParamMap = new HashMap&lt;&gt;();\n                if(parameterJson != null)&#123;\n                    for(Object object : parameterJson)&#123;\n                        JSONObject schema = (JSONObject) ((JSONObject) object).get(&quot;schema&quot;);\n                        if (schema != null)&#123;\n                            String ref = (String) schema.get(&quot;$ref&quot;);\n                            requestParam = parseRequestToJson(null,paramMap,ref);\n                        &#125; else &#123;\n                            String mapKey = (String) ((JSONObject) object).get(&quot;name&quot;);\n                            String type = ((JSONObject) object).getString(&quot;type&quot;);\n                            Object value = setValueByType(type,null);\n                            requestParamMap.put(mapKey,value);\n                        &#125;\n                    &#125;\n                &#125;\n\n                if(requestParam != null)&#123;\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParam));\n                &#125; else &#123;\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParamMap));\n                &#125;\n\n                //返回值类型都用标准类型，不解析其他格式\n                JSONObject response = (JSONObject) requestTypeInfo.get(&quot;responses&quot;);\n                Object responseResult = null;\n                if(response != null)&#123;\n                    JSONObject schema = (JSONObject) ((JSONObject)response.get(&quot;200&quot;)).get(&quot;schema&quot;);\n                    if(schema != null)&#123;\n                        String ref = (String) schema.get(&quot;$ref&quot;);\n                        responseResult = parseRequestToJson(null,paramMap,ref);\n                    &#125;\n                &#125;\n                if(responseResult != null)&#123;\n                    resourceInfo.setResponseParam(JSONObject.toJSONString(responseResult));\n                &#125;\n\n                resourceInfos.add(resourceInfo);\n            &#125;\n        &#125;\n        log.info(&quot;解析完成=====&gt;&#123;&#125;&quot;,JSONObject.toJSONString(resourceInfos));\n    &#125; catch (IOException e) &#123;\n        log.error(&quot;加载Swagger文档中接口失败，url=&#123;&#125;&quot;,url);\n        return false;\n    &#125;\n    return true;\n&#125;\n\n/**\n * 解析swagger-ui中出参和入参为json\n * @param paramMap 入参和出参对象map,key-对象标识，value-对象属性及类型json\n * @param paramRef 入参和出参对应的对象信息， 格式: #/definitions/R«PageResultDTO«PublicResourceInfoDTO»»\n * @Date 2020/11/11 16:01\n * @Author fan\n**/\nprivate Object parseRequestToJson(Map&lt;String,Integer&gt; forEachCache,Map&lt;String,JSONObject&gt; paramMap, String paramRef)&#123;\n    if(StringUtils.isBlank(paramRef))&#123;\n        return &quot;&quot;;\n    &#125;\n\n    //对象标识\n    String paramKey = paramRef.substring(paramRef.lastIndexOf(&quot;/&quot;)+1);\n\n    //控制递归次数，同一个对象循环超过1次就返回空\n    if(forEachCache == null)&#123;\n        forEachCache = new HashMap&lt;&gt;();\n    &#125;\n    Integer forEachCount = forEachCache.get(paramKey);\n    if(forEachCount != null &amp;&amp; forEachCount &gt;= 1)&#123;\n        return null;\n    &#125; else &#123;\n        forEachCache.put(paramKey,1);\n    &#125;\n\n    //对象值\n    JSONObject paramJson = paramMap.get(paramKey);\n    JSONObject propertiesJson = JSONObject.parseObject(String.valueOf(paramJson.get(&quot;properties&quot;)));\n\n    Map&lt;String,Object&gt; columnMap = new HashMap&lt;&gt;();\n    for(Map.Entry&lt;String,Object&gt; entry : propertiesJson.entrySet())&#123;\n        String key = entry.getKey();\n        Object value = new JSONObject();\n        JSONObject valueJson = JSONObject.parseObject(String.valueOf(entry.getValue()));\n        String type = valueJson.getString(&quot;type&quot;);\n        Object obj = valueJson.get(&quot;items&quot;);\n\n        if(obj != null)&#123;\n            JSONObject property = JSONObject.parseObject(String.valueOf(obj));\n            String ref = (String) property.get(&quot;$ref&quot;);\n            //有下一级，则递归\n            if(StringUtils.isNotBlank(ref))&#123;\n                value = parseRequestToJson(forEachCache,paramMap,ref);\n            &#125;\n        &#125;\n        value = setValueByType(type,value);\n        columnMap.put(key,value);\n    &#125;\n    return columnMap;\n&#125;\n\n/**  根据参数类型设置value **/\nprivate Object setValueByType(String type,Object value)&#123;\n    if(&quot;array&quot;.equals(type))&#123;\n        JSONArray jsonArray = new JSONArray();\n        if(value == null)&#123;\n            value = new JSONObject();\n        &#125;\n        jsonArray.add(value);\n        return JSONArray.toJSONString(jsonArray);\n    &#125;\n    if(&quot;integer&quot;.equals(type))&#123;\n        return 0;\n    &#125;\n    if(&quot;boolean&quot;.equals(type))&#123;\n        return true;\n    &#125;\n    if(&quot;object&quot;.equals(type))&#123;\n        return value;\n    &#125;\n    return &quot;&quot;;\n&#125;</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"相关依赖包\"><a href=\"#相关依赖包\" class=\"headerlink\" title=\"相关依赖包\"></a>相关依赖包</h3><pre><code class=\"xml\">&lt;!--swagger依赖--&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt;\n    &lt;artifactId&gt;swagger-bootstrap-ui&lt;/artifactId&gt;\n    &lt;version&gt;1.9.6&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;\n    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;\n    &lt;version&gt;1.2.73&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<h3 id=\"Swagger文档相关接口\"><a href=\"#Swagger文档相关接口\" class=\"headerlink\" title=\"Swagger文档相关接口\"></a>Swagger文档相关接口</h3><pre><code class=\"textmate\">1.接口文档地址\n    https://localhost:8080/swagger-ui.html\n    https://localhost:8080/doc.html\n2.JSON格式接口数据(group参数由项目中swagger配置决定)\n    http://localhost:8080/v2/api-docs?group=V1版本</code></pre>\n<h3 id=\"主要代码\"><a href=\"#主要代码\" class=\"headerlink\" title=\"主要代码\"></a>主要代码</h3><pre><code class=\"java\">/**\n * 加载swagger文档中的接口信息\n * @Date 2020/11/6 11:31\n * @Author fan\n**/\npublic boolean loadSwaggerAPI(Integer lesseeId,String url)&#123;\n    try &#123;\n        log.info(&quot;开始加载Swagger文档,url=&#123;&#125;&quot;,url);\n        String result = OkhttpClientUtil.get(url);\n        JSONObject jsonObject = JSON.parseObject(result);\n        if(jsonObject == null)&#123;\n            return false;\n        &#125;\n        //移除对象描述信息\n        String platform = (String) JSON.parseObject(JSON.toJSONString(jsonObject.get(&quot;info&quot;))).get(&quot;title&quot;);\n        JSONObject paths = (JSONObject) jsonObject.get(&quot;paths&quot;);\n        JSONObject definitions = (JSONObject) jsonObject.get(&quot;definitions&quot;);\n        Map&lt;String,JSONObject&gt; paramMap = JSONObject.toJavaObject(definitions,Map.class);\n\n        List&lt;PublicResourceInfo&gt; resourceInfos = new ArrayList&lt;&gt;();\n        for(Map.Entry&lt;String,Object&gt; entry :  paths.entrySet())&#123;\n            String apiUrl = entry.getKey();\n            String perms = resourceInfoService.buildPermByApiPath(null,apiUrl);\n            JSONObject methodInfo = (JSONObject) entry.getValue();\n\n            for(Map.Entry&lt;String,Object&gt; methodEntry : methodInfo.entrySet())&#123;\n                String requestType = methodEntry.getKey().toUpperCase();\n\n                JSONObject requestTypeInfo = (JSONObject) methodEntry.getValue();\n                String apiName = String.valueOf(requestTypeInfo.get(&quot;summary&quot;));\n                String moduleName = StringUtils.join((List&lt;String&gt;)requestTypeInfo.get(&quot;tags&quot;),&quot;,&quot;);\n\n                PublicResourceInfo resourceInfo = new PublicResourceInfo();\n                resourceInfo.setPlatformNameCn(platform);\n                resourceInfo.setApiPath(apiUrl);\n                resourceInfo.setPerms(perms);\n                resourceInfo.setApiName(apiName);\n                resourceInfo.setRequestType(requestType);\n                resourceInfo.setModuleNameCn(moduleName);\n\n                //解析swagger-ui中的出参入参\n                JSONArray parameterJson = (JSONArray) requestTypeInfo.get(&quot;parameters&quot;);\n                Object requestParam = null;\n                Map&lt;String,Object&gt; requestParamMap = new HashMap&lt;&gt;();\n                if(parameterJson != null)&#123;\n                    for(Object object : parameterJson)&#123;\n                        JSONObject schema = (JSONObject) ((JSONObject) object).get(&quot;schema&quot;);\n                        if (schema != null)&#123;\n                            String ref = (String) schema.get(&quot;$ref&quot;);\n                            requestParam = parseRequestToJson(null,paramMap,ref);\n                        &#125; else &#123;\n                            String mapKey = (String) ((JSONObject) object).get(&quot;name&quot;);\n                            String type = ((JSONObject) object).getString(&quot;type&quot;);\n                            Object value = setValueByType(type,null);\n                            requestParamMap.put(mapKey,value);\n                        &#125;\n                    &#125;\n                &#125;\n\n                if(requestParam != null)&#123;\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParam));\n                &#125; else &#123;\n                    resourceInfo.setRequestParam(JSONObject.toJSONString(requestParamMap));\n                &#125;\n\n                //返回值类型都用标准类型，不解析其他格式\n                JSONObject response = (JSONObject) requestTypeInfo.get(&quot;responses&quot;);\n                Object responseResult = null;\n                if(response != null)&#123;\n                    JSONObject schema = (JSONObject) ((JSONObject)response.get(&quot;200&quot;)).get(&quot;schema&quot;);\n                    if(schema != null)&#123;\n                        String ref = (String) schema.get(&quot;$ref&quot;);\n                        responseResult = parseRequestToJson(null,paramMap,ref);\n                    &#125;\n                &#125;\n                if(responseResult != null)&#123;\n                    resourceInfo.setResponseParam(JSONObject.toJSONString(responseResult));\n                &#125;\n\n                resourceInfos.add(resourceInfo);\n            &#125;\n        &#125;\n        log.info(&quot;解析完成=====&gt;&#123;&#125;&quot;,JSONObject.toJSONString(resourceInfos));\n    &#125; catch (IOException e) &#123;\n        log.error(&quot;加载Swagger文档中接口失败，url=&#123;&#125;&quot;,url);\n        return false;\n    &#125;\n    return true;\n&#125;\n\n/**\n * 解析swagger-ui中出参和入参为json\n * @param paramMap 入参和出参对象map,key-对象标识，value-对象属性及类型json\n * @param paramRef 入参和出参对应的对象信息， 格式: #/definitions/R«PageResultDTO«PublicResourceInfoDTO»»\n * @Date 2020/11/11 16:01\n * @Author fan\n**/\nprivate Object parseRequestToJson(Map&lt;String,Integer&gt; forEachCache,Map&lt;String,JSONObject&gt; paramMap, String paramRef)&#123;\n    if(StringUtils.isBlank(paramRef))&#123;\n        return &quot;&quot;;\n    &#125;\n\n    //对象标识\n    String paramKey = paramRef.substring(paramRef.lastIndexOf(&quot;/&quot;)+1);\n\n    //控制递归次数，同一个对象循环超过1次就返回空\n    if(forEachCache == null)&#123;\n        forEachCache = new HashMap&lt;&gt;();\n    &#125;\n    Integer forEachCount = forEachCache.get(paramKey);\n    if(forEachCount != null &amp;&amp; forEachCount &gt;= 1)&#123;\n        return null;\n    &#125; else &#123;\n        forEachCache.put(paramKey,1);\n    &#125;\n\n    //对象值\n    JSONObject paramJson = paramMap.get(paramKey);\n    JSONObject propertiesJson = JSONObject.parseObject(String.valueOf(paramJson.get(&quot;properties&quot;)));\n\n    Map&lt;String,Object&gt; columnMap = new HashMap&lt;&gt;();\n    for(Map.Entry&lt;String,Object&gt; entry : propertiesJson.entrySet())&#123;\n        String key = entry.getKey();\n        Object value = new JSONObject();\n        JSONObject valueJson = JSONObject.parseObject(String.valueOf(entry.getValue()));\n        String type = valueJson.getString(&quot;type&quot;);\n        Object obj = valueJson.get(&quot;items&quot;);\n\n        if(obj != null)&#123;\n            JSONObject property = JSONObject.parseObject(String.valueOf(obj));\n            String ref = (String) property.get(&quot;$ref&quot;);\n            //有下一级，则递归\n            if(StringUtils.isNotBlank(ref))&#123;\n                value = parseRequestToJson(forEachCache,paramMap,ref);\n            &#125;\n        &#125;\n        value = setValueByType(type,value);\n        columnMap.put(key,value);\n    &#125;\n    return columnMap;\n&#125;\n\n/**  根据参数类型设置value **/\nprivate Object setValueByType(String type,Object value)&#123;\n    if(&quot;array&quot;.equals(type))&#123;\n        JSONArray jsonArray = new JSONArray();\n        if(value == null)&#123;\n            value = new JSONObject();\n        &#125;\n        jsonArray.add(value);\n        return JSONArray.toJSONString(jsonArray);\n    &#125;\n    if(&quot;integer&quot;.equals(type))&#123;\n        return 0;\n    &#125;\n    if(&quot;boolean&quot;.equals(type))&#123;\n        return true;\n    &#125;\n    if(&quot;object&quot;.equals(type))&#123;\n        return value;\n    &#125;\n    return &quot;&quot;;\n&#125;</code></pre>\n"},{"title":"SpringFramework源码编译","date":"2021-06-26T12:00:00.000Z","_content":"\n## SpringFramework5.2.x编译步骤(Mac下)\n### 使用工具\n- jdk1.8\n- Spring-Framework5.2.x 源码\n- Gradle 5.6.4\n- Idea2021\n\n### Gradle安装配置(编译工具)\n- [Gradle官网](https://gradle.org/)\n- [下载页面](https://gradle.org/releases/)\n\n#### 方式一、压缩包(推荐)\n> 建议下载源码中标识的gradle版本(源码gradle/wrapper/gradle-wrapper.properties中)\n```textmate\n1.下载压缩包，解压至~/software/文件夹下\n2.设置环境变量\n   echo $SHELL 先查看当前shell\n   /bin/bash 则修改 ~/.bash_profile 文件\n   /bin/zsh 则修改 ~/.zshrc 文件\n   添加以下配置:\n        export GRADLE_HOME=/Users/mac/software/gradle\n        export PATH=$PATH:$GRADLE_HOME/bin\n    source ~/.zshrc 或 source ~/.bash_profile 刷新\n3.验证安装\n  gradle -v\n```\n- 添加Gradle配置\n```groovy\nallprojects{\n   repositories {\n       def REPOSITORY_URL = 'http://maven.aliyun.com/nexus/content/groups/public/'\n       all { ArtifactRepository repo ->\n           if(repo instanceof MavenArtifactRepository){\n               def url = repo.url.toString()\n               if (url.startsWith('https://repo1.maven.org/maven2') || url.startsWith('https://jcenter.bintray.com/')) {\n                   project.logger.lifecycle \"Repository ${repo.url} replaced by $REPOSITORY_URL.\"\n                   remove repo\n               }\n           }\n       }\n       maven {\n           url REPOSITORY_URL\n       }\n   }\n}\n```\n\n#### 方式二、brew安装\n> 可能不是你想要的版本，注意！！！\n```shell\nbrew install gradle\n```\n\n#### 方式三、旧版本升级命令(没试过)\n```shell\n./gradlew wrapper --gradle-version=7.1 --distribution-type=bin\n```\n\n### Idea安装配置Gradle\n```textmate\n1.搜索并安装插件 \n    菜单: Preferences -> Plugins\n    插件名(2个): Gradle / Gradle Extension\n2.配置\n    菜单: Preferences -> Build -> Build Tools -> Gradle\n    配置项: 设置Gradle user home(仓库目录)\n```\n\n### Idea编译项目\n```textmate\n1.导入\n   File -> Open -> 打开 Spring-Framework5.2x源码中 build.gradle\n2.等待编译完成\n   正常情况下一次编译通过，不熟悉gradle的话建议先不要改 settings.gradle 和 build.gradle 内容，否则会编译失败；\n3.其他\n   出现其他异常先参考源码中 import-into-XXX.md 文档\n```\n\n### 新建项目测试\n- 1.新建模块my-demo，类型选Gradle\n- 2.将新建的模块加到项目中(idea自动新增)\n```textmate\nsettings.gradle 中新增 include 'my-demo'\n```\n- 3.引入模块\n```groovy\n// my-demo/build.gradle中引入模块\ndependencies 下新增 compile(project(\":spring-context\"))\n```\n- 4.新建配置类及测试代码\n```java\n//配置类\n//如果注解引入失败，则在\n@Component\npublic class TestConfig {\n}\n\n//测试类，打印成功则说明编译成功\npublic class StartDemo {\n    public static void main(String[] args) {\n        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(\"com.my.config\");\n        System.out.println(context.getBean(TestConfig.class));\n    }\n}\n```\n","source":"_posts/backend/spring/framework/springframework-1.md","raw":"---\ntitle: SpringFramework源码编译\ndate: 2021-06-26 20:00:00\ntags:\n- SpringFramework \ncategories:\n- 后端  \n- 框架\n---\n\n## SpringFramework5.2.x编译步骤(Mac下)\n### 使用工具\n- jdk1.8\n- Spring-Framework5.2.x 源码\n- Gradle 5.6.4\n- Idea2021\n\n### Gradle安装配置(编译工具)\n- [Gradle官网](https://gradle.org/)\n- [下载页面](https://gradle.org/releases/)\n\n#### 方式一、压缩包(推荐)\n> 建议下载源码中标识的gradle版本(源码gradle/wrapper/gradle-wrapper.properties中)\n```textmate\n1.下载压缩包，解压至~/software/文件夹下\n2.设置环境变量\n   echo $SHELL 先查看当前shell\n   /bin/bash 则修改 ~/.bash_profile 文件\n   /bin/zsh 则修改 ~/.zshrc 文件\n   添加以下配置:\n        export GRADLE_HOME=/Users/mac/software/gradle\n        export PATH=$PATH:$GRADLE_HOME/bin\n    source ~/.zshrc 或 source ~/.bash_profile 刷新\n3.验证安装\n  gradle -v\n```\n- 添加Gradle配置\n```groovy\nallprojects{\n   repositories {\n       def REPOSITORY_URL = 'http://maven.aliyun.com/nexus/content/groups/public/'\n       all { ArtifactRepository repo ->\n           if(repo instanceof MavenArtifactRepository){\n               def url = repo.url.toString()\n               if (url.startsWith('https://repo1.maven.org/maven2') || url.startsWith('https://jcenter.bintray.com/')) {\n                   project.logger.lifecycle \"Repository ${repo.url} replaced by $REPOSITORY_URL.\"\n                   remove repo\n               }\n           }\n       }\n       maven {\n           url REPOSITORY_URL\n       }\n   }\n}\n```\n\n#### 方式二、brew安装\n> 可能不是你想要的版本，注意！！！\n```shell\nbrew install gradle\n```\n\n#### 方式三、旧版本升级命令(没试过)\n```shell\n./gradlew wrapper --gradle-version=7.1 --distribution-type=bin\n```\n\n### Idea安装配置Gradle\n```textmate\n1.搜索并安装插件 \n    菜单: Preferences -> Plugins\n    插件名(2个): Gradle / Gradle Extension\n2.配置\n    菜单: Preferences -> Build -> Build Tools -> Gradle\n    配置项: 设置Gradle user home(仓库目录)\n```\n\n### Idea编译项目\n```textmate\n1.导入\n   File -> Open -> 打开 Spring-Framework5.2x源码中 build.gradle\n2.等待编译完成\n   正常情况下一次编译通过，不熟悉gradle的话建议先不要改 settings.gradle 和 build.gradle 内容，否则会编译失败；\n3.其他\n   出现其他异常先参考源码中 import-into-XXX.md 文档\n```\n\n### 新建项目测试\n- 1.新建模块my-demo，类型选Gradle\n- 2.将新建的模块加到项目中(idea自动新增)\n```textmate\nsettings.gradle 中新增 include 'my-demo'\n```\n- 3.引入模块\n```groovy\n// my-demo/build.gradle中引入模块\ndependencies 下新增 compile(project(\":spring-context\"))\n```\n- 4.新建配置类及测试代码\n```java\n//配置类\n//如果注解引入失败，则在\n@Component\npublic class TestConfig {\n}\n\n//测试类，打印成功则说明编译成功\npublic class StartDemo {\n    public static void main(String[] args) {\n        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(\"com.my.config\");\n        System.out.println(context.getBean(TestConfig.class));\n    }\n}\n```\n","slug":"backend/spring/framework/springframework-1","published":1,"updated":"2021-08-19T01:36:56.130Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bff002ufms6doui8fzl","content":"<h2 id=\"SpringFramework5-2-x编译步骤-Mac下\"><a href=\"#SpringFramework5-2-x编译步骤-Mac下\" class=\"headerlink\" title=\"SpringFramework5.2.x编译步骤(Mac下)\"></a>SpringFramework5.2.x编译步骤(Mac下)</h2><h3 id=\"使用工具\"><a href=\"#使用工具\" class=\"headerlink\" title=\"使用工具\"></a>使用工具</h3><ul>\n<li>jdk1.8</li>\n<li>Spring-Framework5.2.x 源码</li>\n<li>Gradle 5.6.4</li>\n<li>Idea2021</li>\n</ul>\n<h3 id=\"Gradle安装配置-编译工具\"><a href=\"#Gradle安装配置-编译工具\" class=\"headerlink\" title=\"Gradle安装配置(编译工具)\"></a>Gradle安装配置(编译工具)</h3><ul>\n<li><a href=\"https://gradle.org/\">Gradle官网</a></li>\n<li><a href=\"https://gradle.org/releases/\">下载页面</a></li>\n</ul>\n<h4 id=\"方式一、压缩包-推荐\"><a href=\"#方式一、压缩包-推荐\" class=\"headerlink\" title=\"方式一、压缩包(推荐)\"></a>方式一、压缩包(推荐)</h4><blockquote>\n<p>建议下载源码中标识的gradle版本(源码gradle/wrapper/gradle-wrapper.properties中)</p>\n</blockquote>\n<pre><code class=\"textmate\">1.下载压缩包，解压至~/software/文件夹下\n2.设置环境变量\n   echo $SHELL 先查看当前shell\n   /bin/bash 则修改 ~/.bash_profile 文件\n   /bin/zsh 则修改 ~/.zshrc 文件\n   添加以下配置:\n        export GRADLE_HOME=/Users/mac/software/gradle\n        export PATH=$PATH:$GRADLE_HOME/bin\n    source ~/.zshrc 或 source ~/.bash_profile 刷新\n3.验证安装\n  gradle -v</code></pre>\n<ul>\n<li>添加Gradle配置<pre><code class=\"groovy\">allprojects&#123;\n repositories &#123;\n     def REPOSITORY_URL = &#39;http://maven.aliyun.com/nexus/content/groups/public/&#39;\n     all &#123; ArtifactRepository repo -&gt;\n         if(repo instanceof MavenArtifactRepository)&#123;\n             def url = repo.url.toString()\n             if (url.startsWith(&#39;https://repo1.maven.org/maven2&#39;) || url.startsWith(&#39;https://jcenter.bintray.com/&#39;)) &#123;\n                 project.logger.lifecycle &quot;Repository $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;\n                 remove repo\n             &#125;\n         &#125;\n     &#125;\n     maven &#123;\n         url REPOSITORY_URL\n     &#125;\n &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"方式二、brew安装\"><a href=\"#方式二、brew安装\" class=\"headerlink\" title=\"方式二、brew安装\"></a>方式二、brew安装</h4><blockquote>\n<p>可能不是你想要的版本，注意！！！</p>\n</blockquote>\n<pre><code class=\"shell\">brew install gradle</code></pre>\n<h4 id=\"方式三、旧版本升级命令-没试过\"><a href=\"#方式三、旧版本升级命令-没试过\" class=\"headerlink\" title=\"方式三、旧版本升级命令(没试过)\"></a>方式三、旧版本升级命令(没试过)</h4><pre><code class=\"shell\">./gradlew wrapper --gradle-version=7.1 --distribution-type=bin</code></pre>\n<h3 id=\"Idea安装配置Gradle\"><a href=\"#Idea安装配置Gradle\" class=\"headerlink\" title=\"Idea安装配置Gradle\"></a>Idea安装配置Gradle</h3><pre><code class=\"textmate\">1.搜索并安装插件 \n    菜单: Preferences -&gt; Plugins\n    插件名(2个): Gradle / Gradle Extension\n2.配置\n    菜单: Preferences -&gt; Build -&gt; Build Tools -&gt; Gradle\n    配置项: 设置Gradle user home(仓库目录)</code></pre>\n<h3 id=\"Idea编译项目\"><a href=\"#Idea编译项目\" class=\"headerlink\" title=\"Idea编译项目\"></a>Idea编译项目</h3><pre><code class=\"textmate\">1.导入\n   File -&gt; Open -&gt; 打开 Spring-Framework5.2x源码中 build.gradle\n2.等待编译完成\n   正常情况下一次编译通过，不熟悉gradle的话建议先不要改 settings.gradle 和 build.gradle 内容，否则会编译失败；\n3.其他\n   出现其他异常先参考源码中 import-into-XXX.md 文档</code></pre>\n<h3 id=\"新建项目测试\"><a href=\"#新建项目测试\" class=\"headerlink\" title=\"新建项目测试\"></a>新建项目测试</h3><ul>\n<li>1.新建模块my-demo，类型选Gradle</li>\n<li>2.将新建的模块加到项目中(idea自动新增)<pre><code class=\"textmate\">settings.gradle 中新增 include &#39;my-demo&#39;</code></pre>\n</li>\n<li>3.引入模块<pre><code class=\"groovy\">// my-demo/build.gradle中引入模块\ndependencies 下新增 compile(project(&quot;:spring-context&quot;))</code></pre>\n</li>\n<li>4.新建配置类及测试代码<pre><code class=\"java\">//配置类\n//如果注解引入失败，则在\n@Component\npublic class TestConfig &#123;\n&#125;\n</code></pre>\n</li>\n</ul>\n<p>//测试类，打印成功则说明编译成功<br>public class StartDemo {<br>    public static void main(String[] args) {<br>        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(“com.my.config”);<br>        System.out.println(context.getBean(TestConfig.class));<br>    }<br>}</p>\n<pre><code></code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"SpringFramework5-2-x编译步骤-Mac下\"><a href=\"#SpringFramework5-2-x编译步骤-Mac下\" class=\"headerlink\" title=\"SpringFramework5.2.x编译步骤(Mac下)\"></a>SpringFramework5.2.x编译步骤(Mac下)</h2><h3 id=\"使用工具\"><a href=\"#使用工具\" class=\"headerlink\" title=\"使用工具\"></a>使用工具</h3><ul>\n<li>jdk1.8</li>\n<li>Spring-Framework5.2.x 源码</li>\n<li>Gradle 5.6.4</li>\n<li>Idea2021</li>\n</ul>\n<h3 id=\"Gradle安装配置-编译工具\"><a href=\"#Gradle安装配置-编译工具\" class=\"headerlink\" title=\"Gradle安装配置(编译工具)\"></a>Gradle安装配置(编译工具)</h3><ul>\n<li><a href=\"https://gradle.org/\">Gradle官网</a></li>\n<li><a href=\"https://gradle.org/releases/\">下载页面</a></li>\n</ul>\n<h4 id=\"方式一、压缩包-推荐\"><a href=\"#方式一、压缩包-推荐\" class=\"headerlink\" title=\"方式一、压缩包(推荐)\"></a>方式一、压缩包(推荐)</h4><blockquote>\n<p>建议下载源码中标识的gradle版本(源码gradle/wrapper/gradle-wrapper.properties中)</p>\n</blockquote>\n<pre><code class=\"textmate\">1.下载压缩包，解压至~/software/文件夹下\n2.设置环境变量\n   echo $SHELL 先查看当前shell\n   /bin/bash 则修改 ~/.bash_profile 文件\n   /bin/zsh 则修改 ~/.zshrc 文件\n   添加以下配置:\n        export GRADLE_HOME=/Users/mac/software/gradle\n        export PATH=$PATH:$GRADLE_HOME/bin\n    source ~/.zshrc 或 source ~/.bash_profile 刷新\n3.验证安装\n  gradle -v</code></pre>\n<ul>\n<li>添加Gradle配置<pre><code class=\"groovy\">allprojects&#123;\n repositories &#123;\n     def REPOSITORY_URL = &#39;http://maven.aliyun.com/nexus/content/groups/public/&#39;\n     all &#123; ArtifactRepository repo -&gt;\n         if(repo instanceof MavenArtifactRepository)&#123;\n             def url = repo.url.toString()\n             if (url.startsWith(&#39;https://repo1.maven.org/maven2&#39;) || url.startsWith(&#39;https://jcenter.bintray.com/&#39;)) &#123;\n                 project.logger.lifecycle &quot;Repository $&#123;repo.url&#125; replaced by $REPOSITORY_URL.&quot;\n                 remove repo\n             &#125;\n         &#125;\n     &#125;\n     maven &#123;\n         url REPOSITORY_URL\n     &#125;\n &#125;\n&#125;</code></pre>\n</li>\n</ul>\n<h4 id=\"方式二、brew安装\"><a href=\"#方式二、brew安装\" class=\"headerlink\" title=\"方式二、brew安装\"></a>方式二、brew安装</h4><blockquote>\n<p>可能不是你想要的版本，注意！！！</p>\n</blockquote>\n<pre><code class=\"shell\">brew install gradle</code></pre>\n<h4 id=\"方式三、旧版本升级命令-没试过\"><a href=\"#方式三、旧版本升级命令-没试过\" class=\"headerlink\" title=\"方式三、旧版本升级命令(没试过)\"></a>方式三、旧版本升级命令(没试过)</h4><pre><code class=\"shell\">./gradlew wrapper --gradle-version=7.1 --distribution-type=bin</code></pre>\n<h3 id=\"Idea安装配置Gradle\"><a href=\"#Idea安装配置Gradle\" class=\"headerlink\" title=\"Idea安装配置Gradle\"></a>Idea安装配置Gradle</h3><pre><code class=\"textmate\">1.搜索并安装插件 \n    菜单: Preferences -&gt; Plugins\n    插件名(2个): Gradle / Gradle Extension\n2.配置\n    菜单: Preferences -&gt; Build -&gt; Build Tools -&gt; Gradle\n    配置项: 设置Gradle user home(仓库目录)</code></pre>\n<h3 id=\"Idea编译项目\"><a href=\"#Idea编译项目\" class=\"headerlink\" title=\"Idea编译项目\"></a>Idea编译项目</h3><pre><code class=\"textmate\">1.导入\n   File -&gt; Open -&gt; 打开 Spring-Framework5.2x源码中 build.gradle\n2.等待编译完成\n   正常情况下一次编译通过，不熟悉gradle的话建议先不要改 settings.gradle 和 build.gradle 内容，否则会编译失败；\n3.其他\n   出现其他异常先参考源码中 import-into-XXX.md 文档</code></pre>\n<h3 id=\"新建项目测试\"><a href=\"#新建项目测试\" class=\"headerlink\" title=\"新建项目测试\"></a>新建项目测试</h3><ul>\n<li>1.新建模块my-demo，类型选Gradle</li>\n<li>2.将新建的模块加到项目中(idea自动新增)<pre><code class=\"textmate\">settings.gradle 中新增 include &#39;my-demo&#39;</code></pre>\n</li>\n<li>3.引入模块<pre><code class=\"groovy\">// my-demo/build.gradle中引入模块\ndependencies 下新增 compile(project(&quot;:spring-context&quot;))</code></pre>\n</li>\n<li>4.新建配置类及测试代码<pre><code class=\"java\">//配置类\n//如果注解引入失败，则在\n@Component\npublic class TestConfig &#123;\n&#125;\n</code></pre>\n</li>\n</ul>\n<p>//测试类，打印成功则说明编译成功<br>public class StartDemo {<br>    public static void main(String[] args) {<br>        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(“com.my.config”);<br>        System.out.println(context.getBean(TestConfig.class));<br>    }<br>}</p>\n<pre><code></code></pre>\n"},{"title":"SpringFramework源码学习","date":"2021-07-26T07:05:00.000Z","_content":"\n### StartDemo\n```java\npublic class StartDemo {\n   public static void main(String[] args) {\n      ApplicationContext context =\n            new AnnotationConfigApplicationContext(\"com.my.config\");\n      TestConfig testConfig = context.getBean(TestConfig.class);\n      System.out.println(\"==========>main\");\n      System.out.println(testConfig.getValue());\n   }\n}\n```\n### 关键类\n- AnnotationConfigApplicationContext\n```textmate\n根据包扫描对象\n```\n- RootBeanDefinition\n```textmate\n记录扫描到的类的具体信息(描述类)\n```\n- BeanFactoryPostProcessor\n```textmate\n接口，可自定义参与类初始化过程逻辑\n\t工厂钩子，允许自定义修改应用程序上下文的 bean 定义，调整上下文底层 bean 工厂的 bean 属性值。\n\tBeanFactoryPostProcessor是在spring容器加载了bean的定义文件之后，在bean实例化之前执行的。接口方法的入参是ConfigurrableListableBeanFactory，使用该参数，可以获取到相关bean的定义信息\n```\n- BeanPostProcessor\n```textmate\n后置处理器父类，有很多子类；不同子类提供了不同的实现方法，参与到bean初始化过程中\n\t例：AutowiredAnnotationBeanPostProcessor\n\t可以在spring容器实例化bean之后，在执行bean的初始化方法前后，添加一些自己的处理逻辑。\n\tBeanPostProcessor的执行顺序是在BeanFactoryPostProcessor之后。\n\t内置实现: \n\torg.springframework.context.annotation.CommonAnnotationBeanPostProcessor：支持@Resource注解的注入\n    org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor：支持@Required注解的注入\n    org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor：支持@Autowired注解的注入\n\n```\n### 简易流程\n```textmate\n生命周期 加载 -> 实例化 -> 初始化 -> 使用 -> 销毁\nscan -> beanPorcessor(描述bean信息) -> 放到 configMap 中 -> refresh -> 通过bean工厂实例化类 -> 放到单例池中\n```\n### AnnotationConfigApplicationContext详解\n- 类图\n  ![类图](https://gitee.com/im-fan/fan-pic/raw/master/images/springframework-bean-uml.png)\n- 流程图\n  ![执行流程](https://gitee.com/im-fan/fan-pic/raw/master/images/spring-start-process.png)\n\n\n### 解决循环依赖\n- [疯狂创客圈(转)](https://www.cnblogs.com/crazymakercircle/p/14465630.html)\n- 主要流程图\n  ![spring解决循环依赖流程(转)](https://gitee.com/im-fan/fan-pic/raw/master/images/spring-cycle-refrence.png)\n","source":"_posts/backend/spring/framework/springframework-2.md","raw":"---\ntitle: SpringFramework源码学习\ndate: 2021-07-26 15:05:00\ntags:\n- SpringFramework\ncategories:\n- 后端\n- 框架\n---\n\n### StartDemo\n```java\npublic class StartDemo {\n   public static void main(String[] args) {\n      ApplicationContext context =\n            new AnnotationConfigApplicationContext(\"com.my.config\");\n      TestConfig testConfig = context.getBean(TestConfig.class);\n      System.out.println(\"==========>main\");\n      System.out.println(testConfig.getValue());\n   }\n}\n```\n### 关键类\n- AnnotationConfigApplicationContext\n```textmate\n根据包扫描对象\n```\n- RootBeanDefinition\n```textmate\n记录扫描到的类的具体信息(描述类)\n```\n- BeanFactoryPostProcessor\n```textmate\n接口，可自定义参与类初始化过程逻辑\n\t工厂钩子，允许自定义修改应用程序上下文的 bean 定义，调整上下文底层 bean 工厂的 bean 属性值。\n\tBeanFactoryPostProcessor是在spring容器加载了bean的定义文件之后，在bean实例化之前执行的。接口方法的入参是ConfigurrableListableBeanFactory，使用该参数，可以获取到相关bean的定义信息\n```\n- BeanPostProcessor\n```textmate\n后置处理器父类，有很多子类；不同子类提供了不同的实现方法，参与到bean初始化过程中\n\t例：AutowiredAnnotationBeanPostProcessor\n\t可以在spring容器实例化bean之后，在执行bean的初始化方法前后，添加一些自己的处理逻辑。\n\tBeanPostProcessor的执行顺序是在BeanFactoryPostProcessor之后。\n\t内置实现: \n\torg.springframework.context.annotation.CommonAnnotationBeanPostProcessor：支持@Resource注解的注入\n    org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor：支持@Required注解的注入\n    org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor：支持@Autowired注解的注入\n\n```\n### 简易流程\n```textmate\n生命周期 加载 -> 实例化 -> 初始化 -> 使用 -> 销毁\nscan -> beanPorcessor(描述bean信息) -> 放到 configMap 中 -> refresh -> 通过bean工厂实例化类 -> 放到单例池中\n```\n### AnnotationConfigApplicationContext详解\n- 类图\n  ![类图](https://gitee.com/im-fan/fan-pic/raw/master/images/springframework-bean-uml.png)\n- 流程图\n  ![执行流程](https://gitee.com/im-fan/fan-pic/raw/master/images/spring-start-process.png)\n\n\n### 解决循环依赖\n- [疯狂创客圈(转)](https://www.cnblogs.com/crazymakercircle/p/14465630.html)\n- 主要流程图\n  ![spring解决循环依赖流程(转)](https://gitee.com/im-fan/fan-pic/raw/master/images/spring-cycle-refrence.png)\n","slug":"backend/spring/framework/springframework-2","published":1,"updated":"2021-08-19T01:41:45.039Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bfh002xfms617sz68x7","content":"<h3 id=\"StartDemo\"><a href=\"#StartDemo\" class=\"headerlink\" title=\"StartDemo\"></a>StartDemo</h3><pre><code class=\"java\">public class StartDemo &#123;\n   public static void main(String[] args) &#123;\n      ApplicationContext context =\n            new AnnotationConfigApplicationContext(&quot;com.my.config&quot;);\n      TestConfig testConfig = context.getBean(TestConfig.class);\n      System.out.println(&quot;==========&gt;main&quot;);\n      System.out.println(testConfig.getValue());\n   &#125;\n&#125;</code></pre>\n<h3 id=\"关键类\"><a href=\"#关键类\" class=\"headerlink\" title=\"关键类\"></a>关键类</h3><ul>\n<li>AnnotationConfigApplicationContext<pre><code class=\"textmate\">根据包扫描对象</code></pre>\n</li>\n<li>RootBeanDefinition<pre><code class=\"textmate\">记录扫描到的类的具体信息(描述类)</code></pre>\n</li>\n<li>BeanFactoryPostProcessor<pre><code class=\"textmate\">接口，可自定义参与类初始化过程逻辑\n  工厂钩子，允许自定义修改应用程序上下文的 bean 定义，调整上下文底层 bean 工厂的 bean 属性值。\n  BeanFactoryPostProcessor是在spring容器加载了bean的定义文件之后，在bean实例化之前执行的。接口方法的入参是ConfigurrableListableBeanFactory，使用该参数，可以获取到相关bean的定义信息</code></pre>\n</li>\n<li>BeanPostProcessor<pre><code class=\"textmate\">后置处理器父类，有很多子类；不同子类提供了不同的实现方法，参与到bean初始化过程中\n  例：AutowiredAnnotationBeanPostProcessor\n  可以在spring容器实例化bean之后，在执行bean的初始化方法前后，添加一些自己的处理逻辑。\n  BeanPostProcessor的执行顺序是在BeanFactoryPostProcessor之后。\n  内置实现: \n  org.springframework.context.annotation.CommonAnnotationBeanPostProcessor：支持@Resource注解的注入\n  org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor：支持@Required注解的注入\n  org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor：支持@Autowired注解的注入\n</code></pre>\n</li>\n</ul>\n<pre><code>### 简易流程\n```textmate\n生命周期 加载 -&gt; 实例化 -&gt; 初始化 -&gt; 使用 -&gt; 销毁\nscan -&gt; beanPorcessor(描述bean信息) -&gt; 放到 configMap 中 -&gt; refresh -&gt; 通过bean工厂实例化类 -&gt; 放到单例池中</code></pre>\n<h3 id=\"AnnotationConfigApplicationContext详解\"><a href=\"#AnnotationConfigApplicationContext详解\" class=\"headerlink\" title=\"AnnotationConfigApplicationContext详解\"></a>AnnotationConfigApplicationContext详解</h3><ul>\n<li>类图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/springframework-bean-uml.png\" alt=\"类图\"></li>\n<li>流程图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/spring-start-process.png\" alt=\"执行流程\"></li>\n</ul>\n<h3 id=\"解决循环依赖\"><a href=\"#解决循环依赖\" class=\"headerlink\" title=\"解决循环依赖\"></a>解决循环依赖</h3><ul>\n<li><a href=\"https://www.cnblogs.com/crazymakercircle/p/14465630.html\">疯狂创客圈(转)</a></li>\n<li>主要流程图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/spring-cycle-refrence.png\" alt=\"spring解决循环依赖流程(转)\"></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"StartDemo\"><a href=\"#StartDemo\" class=\"headerlink\" title=\"StartDemo\"></a>StartDemo</h3><pre><code class=\"java\">public class StartDemo &#123;\n   public static void main(String[] args) &#123;\n      ApplicationContext context =\n            new AnnotationConfigApplicationContext(&quot;com.my.config&quot;);\n      TestConfig testConfig = context.getBean(TestConfig.class);\n      System.out.println(&quot;==========&gt;main&quot;);\n      System.out.println(testConfig.getValue());\n   &#125;\n&#125;</code></pre>\n<h3 id=\"关键类\"><a href=\"#关键类\" class=\"headerlink\" title=\"关键类\"></a>关键类</h3><ul>\n<li>AnnotationConfigApplicationContext<pre><code class=\"textmate\">根据包扫描对象</code></pre>\n</li>\n<li>RootBeanDefinition<pre><code class=\"textmate\">记录扫描到的类的具体信息(描述类)</code></pre>\n</li>\n<li>BeanFactoryPostProcessor<pre><code class=\"textmate\">接口，可自定义参与类初始化过程逻辑\n  工厂钩子，允许自定义修改应用程序上下文的 bean 定义，调整上下文底层 bean 工厂的 bean 属性值。\n  BeanFactoryPostProcessor是在spring容器加载了bean的定义文件之后，在bean实例化之前执行的。接口方法的入参是ConfigurrableListableBeanFactory，使用该参数，可以获取到相关bean的定义信息</code></pre>\n</li>\n<li>BeanPostProcessor<pre><code class=\"textmate\">后置处理器父类，有很多子类；不同子类提供了不同的实现方法，参与到bean初始化过程中\n  例：AutowiredAnnotationBeanPostProcessor\n  可以在spring容器实例化bean之后，在执行bean的初始化方法前后，添加一些自己的处理逻辑。\n  BeanPostProcessor的执行顺序是在BeanFactoryPostProcessor之后。\n  内置实现: \n  org.springframework.context.annotation.CommonAnnotationBeanPostProcessor：支持@Resource注解的注入\n  org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor：支持@Required注解的注入\n  org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor：支持@Autowired注解的注入\n</code></pre>\n</li>\n</ul>\n<pre><code>### 简易流程\n```textmate\n生命周期 加载 -&gt; 实例化 -&gt; 初始化 -&gt; 使用 -&gt; 销毁\nscan -&gt; beanPorcessor(描述bean信息) -&gt; 放到 configMap 中 -&gt; refresh -&gt; 通过bean工厂实例化类 -&gt; 放到单例池中</code></pre>\n<h3 id=\"AnnotationConfigApplicationContext详解\"><a href=\"#AnnotationConfigApplicationContext详解\" class=\"headerlink\" title=\"AnnotationConfigApplicationContext详解\"></a>AnnotationConfigApplicationContext详解</h3><ul>\n<li>类图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/springframework-bean-uml.png\" alt=\"类图\"></li>\n<li>流程图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/spring-start-process.png\" alt=\"执行流程\"></li>\n</ul>\n<h3 id=\"解决循环依赖\"><a href=\"#解决循环依赖\" class=\"headerlink\" title=\"解决循环依赖\"></a>解决循环依赖</h3><ul>\n<li><a href=\"https://www.cnblogs.com/crazymakercircle/p/14465630.html\">疯狂创客圈(转)</a></li>\n<li>主要流程图<br><img src=\"https://gitee.com/im-fan/fan-pic/raw/master/images/spring-cycle-refrence.png\" alt=\"spring解决循环依赖流程(转)\"></li>\n</ul>\n"},{"title":"对象转换工具-MapStruct","description":"对象转换","date":"2020-10-02T07:51:46.000Z","_content":"\n\n## MapStruct\n[MapStruct](http://mapstruct.org/)是一个代码生成器，它基于约定优于配置方法极大地简化了Java bean类型之间映射的实现。\n生成的映射代码使用普通方法调用，因此快速，类型安全且易于理解。\n\n### 如何接入MapStruct\n\n- [官网文档](http://mapstruct.org/documentation/installation/)\n\nIDEA Support: https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions\n\n\n### Java Bean属性拷贝性能对比\n\nget/set >= [MapStruct](http://mapstruct.org/) > [JMapper](https://jmapper-framework.github.io/jmapper-core/)  >  [\"beanCopier(cglib)\"](https://github.com/cglib/cglib/blob/master/cglib/src/main/java/net/sf/cglib/beans/BeanCopier.java) > Orika > ModelMapper > Spring BeanUtils > Dozer > Apache BeanUtils\n  \n性能对比数据来源：\n - https://www.baeldung.com/java-performance-mapping-frameworks\n - https://java.libhunt.com/categories/337-bean-mapping\n \n说明：\n- get/set 需要手动编写大量转换代码，代码简洁性差、重复性高和工作量大。\n- beanCopier 性能较高，属性名和类型有较高的匹配要求。\n- MapStruct 性能较高，在编译阶段，生成Get/Set代码,支持不同属性之间自定义转换。\n- Orika 性能较高,支持自定义属性拷贝，性能略差与前两种，当比后面几种高很多。\n- Spring BeanUtils 性能一般，只能支持相关名称的拷贝。\n- Dozer 性能差，使用简单，编写xml不方便。\n- Apache BeanUtils 性能差。\n    \n### demo\n\n实例代码:\n```java\n/**\n* 定义对象之间转换Mapper\n * @Mapper 只有在接口加上这个注解， MapStruct 才会去实现该接口\n *     @Mapper\n *     componentModel ：主要是指定实现类的类型，\n *         - default：默认，可以通过 Mappers.getMapper(Class) 方式获取实例对象\n *         -  spring：在接口的实现类上自动添加注解 @Component，可通过 @Autowired 方式注入\n *     uses 使用用户自定义转换器\n *\n *     http://mapstruct.org/documentation/stable/reference/html/\n */\n//@Mapper(componentModel = \"spring\",uses = {DateHandWritten.class})\n@Mapper(\n        uses = {DateHandWritten.class, UserNameHandWritten.class},\n        imports = {LocalDateUtil.class}\n        )\npublic interface PersonMapper {\n\n    PersonMapper  INSTANCE  = Mappers.getMapper(PersonMapper.class);\n\n    @Mappings({\n            //@Mapping(source = \"name\",target = \"name\",ignore = true),\n            @Mapping(target = \"birthExpressionFormat\", expression = \"java(LocalDateUtil.getDateNow().toString())\"),\n            @Mapping(source = \"name\",target = \"address.name\"),\n            @Mapping(source = \"price\",target = \"price\",numberFormat = \"#.00\"),\n            @Mapping(source = \"birthDate\",target = \"birthDateFormat\",dateFormat = \"yyyy-MM-dd HH:mm:ss\")\n    })\n    /***\n     * @Mapping：属性映射，若源对象属性与目标对象名字一致，会自动映射对应属性\n     *     source：源属性\n     *     target：目标属性\n     *     dateFormat：String 到 Date 日期之间相互转换，通过 SimpleDateFormat，该值为 SimpleDateFormat              的日期格式\n     *     ignore: 忽略这个字段\n     * @Mappings：配置多个@Mapping\n     */\n    PersonDto toDto(Person person);\n\n    @InheritConfiguration(name = \"toDto\")\n    List<PersonDto> toDtos(List<Person> person);\n\n\n    /*@InheritInverseConfiguration()\n    PersonDto fromDto(Person person);*/\n\n    /**\n     * @InheritConfiguration 用于继承配置\n     * */\n  /*  @InheritConfiguration(name = \"toDto\")\n    void update(Person person, @MappingTarget PersonDto personDto);*/\n}\n\n/**定义自定义转换规则*/\npublic class DateHandWritten {\n\n    public String asString(Date date) {\n        return date != null ? new SimpleDateFormat( \"yyyy-MM-dd\" )\n            .format( date ) : null;\n    }\n\n    public Date asDate(String date) {\n        try {\n            return date != null ? new SimpleDateFormat( \"yyyy-MM-dd\" )\n                .parse( date ) : null;\n        }\n        catch ( ParseException e ) {\n            throw new RuntimeException( e );\n        }\n    }\n}\n\n/**定义自定义转换规则*/\npublic class UserNameHandWritten {\n\n    public String asUsername(String username) {\n        return  \"被修改后的name\";\n    } \n}\n\n/***使用实例*/\npublic class MapStructTest {\n\n    @Test\n    public void personTest(){\n        Person person = buildPerson();\n        PersonDto personDto = PersonMapper.INSTANCE.toDto(person);\n        System.out.println(JSON.toJSONString(personDto));\n        /**\n        * {\"address\":{\"name\":\"被修改后的name\"},\"addresses\":[{\"name\":\"被修改后的name\"}],\"age\":0,\"birthDate\":1555573411245,\"birthDateFormat\":\"2019-04-18\",\"birthExpressionFormat\":\"Thu Apr 18 15:43:31 CST 2019\",\"name\":\"被修改后的name\",\"price\":\"2.35\"}\n        * */\n    }\n\n    @Test\n    public void personListTest(){\n        Person person = buildPerson();\n        List<PersonDto> personDtos = PersonMapper.INSTANCE.toDtos(Lists.newArrayList(person));\n        System.out.println(JSON.toJSONString(personDtos));\n        /**\n        * [{\"address\":{\"name\":\"被修改后的name\"},\"addresses\":[{\"name\":\"被修改后的name\"}],\"age\":0,\"birthDate\":1555573439123,\"birthDateFormat\":\"2019-04-18\",\"birthExpressionFormat\":\"Thu Apr 18 15:43:59 CST 2019\",\"name\":\"被修改后的name\",\"price\":\"2.35\"}]\n        * */\n    }\n\n    private Person buildPerson(){\n        Address a = new Address();\n        a.setName(\"demo\");\n        return Person.builder().birthDate(new Date()).price(BigDecimal.valueOf(2.347)).name(\"中国人\").addresses(Lists.newArrayList(a)).build();\n    }\n}\n\n```\n### 实现原理\n在Maven 编译阶段将自动实现PersonMapper的对象属性转换接口,生成PersonMapperImpl文件。\n","source":"_posts/backend/java/utils/convert/map-struct.md","raw":"---\ntitle: 对象转换工具-MapStruct\ndescription: 对象转换\ndate: 2020-10-02 15:51:46\ntags:\n- utils\ncategories:\n- 后端\n- 工具\n---\n\n\n## MapStruct\n[MapStruct](http://mapstruct.org/)是一个代码生成器，它基于约定优于配置方法极大地简化了Java bean类型之间映射的实现。\n生成的映射代码使用普通方法调用，因此快速，类型安全且易于理解。\n\n### 如何接入MapStruct\n\n- [官网文档](http://mapstruct.org/documentation/installation/)\n\nIDEA Support: https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions\n\n\n### Java Bean属性拷贝性能对比\n\nget/set >= [MapStruct](http://mapstruct.org/) > [JMapper](https://jmapper-framework.github.io/jmapper-core/)  >  [\"beanCopier(cglib)\"](https://github.com/cglib/cglib/blob/master/cglib/src/main/java/net/sf/cglib/beans/BeanCopier.java) > Orika > ModelMapper > Spring BeanUtils > Dozer > Apache BeanUtils\n  \n性能对比数据来源：\n - https://www.baeldung.com/java-performance-mapping-frameworks\n - https://java.libhunt.com/categories/337-bean-mapping\n \n说明：\n- get/set 需要手动编写大量转换代码，代码简洁性差、重复性高和工作量大。\n- beanCopier 性能较高，属性名和类型有较高的匹配要求。\n- MapStruct 性能较高，在编译阶段，生成Get/Set代码,支持不同属性之间自定义转换。\n- Orika 性能较高,支持自定义属性拷贝，性能略差与前两种，当比后面几种高很多。\n- Spring BeanUtils 性能一般，只能支持相关名称的拷贝。\n- Dozer 性能差，使用简单，编写xml不方便。\n- Apache BeanUtils 性能差。\n    \n### demo\n\n实例代码:\n```java\n/**\n* 定义对象之间转换Mapper\n * @Mapper 只有在接口加上这个注解， MapStruct 才会去实现该接口\n *     @Mapper\n *     componentModel ：主要是指定实现类的类型，\n *         - default：默认，可以通过 Mappers.getMapper(Class) 方式获取实例对象\n *         -  spring：在接口的实现类上自动添加注解 @Component，可通过 @Autowired 方式注入\n *     uses 使用用户自定义转换器\n *\n *     http://mapstruct.org/documentation/stable/reference/html/\n */\n//@Mapper(componentModel = \"spring\",uses = {DateHandWritten.class})\n@Mapper(\n        uses = {DateHandWritten.class, UserNameHandWritten.class},\n        imports = {LocalDateUtil.class}\n        )\npublic interface PersonMapper {\n\n    PersonMapper  INSTANCE  = Mappers.getMapper(PersonMapper.class);\n\n    @Mappings({\n            //@Mapping(source = \"name\",target = \"name\",ignore = true),\n            @Mapping(target = \"birthExpressionFormat\", expression = \"java(LocalDateUtil.getDateNow().toString())\"),\n            @Mapping(source = \"name\",target = \"address.name\"),\n            @Mapping(source = \"price\",target = \"price\",numberFormat = \"#.00\"),\n            @Mapping(source = \"birthDate\",target = \"birthDateFormat\",dateFormat = \"yyyy-MM-dd HH:mm:ss\")\n    })\n    /***\n     * @Mapping：属性映射，若源对象属性与目标对象名字一致，会自动映射对应属性\n     *     source：源属性\n     *     target：目标属性\n     *     dateFormat：String 到 Date 日期之间相互转换，通过 SimpleDateFormat，该值为 SimpleDateFormat              的日期格式\n     *     ignore: 忽略这个字段\n     * @Mappings：配置多个@Mapping\n     */\n    PersonDto toDto(Person person);\n\n    @InheritConfiguration(name = \"toDto\")\n    List<PersonDto> toDtos(List<Person> person);\n\n\n    /*@InheritInverseConfiguration()\n    PersonDto fromDto(Person person);*/\n\n    /**\n     * @InheritConfiguration 用于继承配置\n     * */\n  /*  @InheritConfiguration(name = \"toDto\")\n    void update(Person person, @MappingTarget PersonDto personDto);*/\n}\n\n/**定义自定义转换规则*/\npublic class DateHandWritten {\n\n    public String asString(Date date) {\n        return date != null ? new SimpleDateFormat( \"yyyy-MM-dd\" )\n            .format( date ) : null;\n    }\n\n    public Date asDate(String date) {\n        try {\n            return date != null ? new SimpleDateFormat( \"yyyy-MM-dd\" )\n                .parse( date ) : null;\n        }\n        catch ( ParseException e ) {\n            throw new RuntimeException( e );\n        }\n    }\n}\n\n/**定义自定义转换规则*/\npublic class UserNameHandWritten {\n\n    public String asUsername(String username) {\n        return  \"被修改后的name\";\n    } \n}\n\n/***使用实例*/\npublic class MapStructTest {\n\n    @Test\n    public void personTest(){\n        Person person = buildPerson();\n        PersonDto personDto = PersonMapper.INSTANCE.toDto(person);\n        System.out.println(JSON.toJSONString(personDto));\n        /**\n        * {\"address\":{\"name\":\"被修改后的name\"},\"addresses\":[{\"name\":\"被修改后的name\"}],\"age\":0,\"birthDate\":1555573411245,\"birthDateFormat\":\"2019-04-18\",\"birthExpressionFormat\":\"Thu Apr 18 15:43:31 CST 2019\",\"name\":\"被修改后的name\",\"price\":\"2.35\"}\n        * */\n    }\n\n    @Test\n    public void personListTest(){\n        Person person = buildPerson();\n        List<PersonDto> personDtos = PersonMapper.INSTANCE.toDtos(Lists.newArrayList(person));\n        System.out.println(JSON.toJSONString(personDtos));\n        /**\n        * [{\"address\":{\"name\":\"被修改后的name\"},\"addresses\":[{\"name\":\"被修改后的name\"}],\"age\":0,\"birthDate\":1555573439123,\"birthDateFormat\":\"2019-04-18\",\"birthExpressionFormat\":\"Thu Apr 18 15:43:59 CST 2019\",\"name\":\"被修改后的name\",\"price\":\"2.35\"}]\n        * */\n    }\n\n    private Person buildPerson(){\n        Address a = new Address();\n        a.setName(\"demo\");\n        return Person.builder().birthDate(new Date()).price(BigDecimal.valueOf(2.347)).name(\"中国人\").addresses(Lists.newArrayList(a)).build();\n    }\n}\n\n```\n### 实现原理\n在Maven 编译阶段将自动实现PersonMapper的对象属性转换接口,生成PersonMapperImpl文件。\n","slug":"backend/java/utils/convert/map-struct","published":1,"updated":"2021-03-20T06:38:04.436Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bfi002zfms6heuhb9jc","content":"<h2 id=\"MapStruct\"><a href=\"#MapStruct\" class=\"headerlink\" title=\"MapStruct\"></a>MapStruct</h2><p><a href=\"http://mapstruct.org/\">MapStruct</a>是一个代码生成器，它基于约定优于配置方法极大地简化了Java bean类型之间映射的实现。<br>生成的映射代码使用普通方法调用，因此快速，类型安全且易于理解。</p>\n<h3 id=\"如何接入MapStruct\"><a href=\"#如何接入MapStruct\" class=\"headerlink\" title=\"如何接入MapStruct\"></a>如何接入MapStruct</h3><ul>\n<li><a href=\"http://mapstruct.org/documentation/installation/\">官网文档</a></li>\n</ul>\n<p>IDEA Support: <a href=\"https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions\">https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions</a></p>\n<h3 id=\"Java-Bean属性拷贝性能对比\"><a href=\"#Java-Bean属性拷贝性能对比\" class=\"headerlink\" title=\"Java Bean属性拷贝性能对比\"></a>Java Bean属性拷贝性能对比</h3><p>get/set &gt;= <a href=\"http://mapstruct.org/\">MapStruct</a> &gt; <a href=\"https://jmapper-framework.github.io/jmapper-core/\">JMapper</a>  &gt;  <a href=\"https://github.com/cglib/cglib/blob/master/cglib/src/main/java/net/sf/cglib/beans/BeanCopier.java\">“beanCopier(cglib)”</a> &gt; Orika &gt; ModelMapper &gt; Spring BeanUtils &gt; Dozer &gt; Apache BeanUtils</p>\n<p>性能对比数据来源：</p>\n<ul>\n<li><a href=\"https://www.baeldung.com/java-performance-mapping-frameworks\">https://www.baeldung.com/java-performance-mapping-frameworks</a></li>\n<li><a href=\"https://java.libhunt.com/categories/337-bean-mapping\">https://java.libhunt.com/categories/337-bean-mapping</a></li>\n</ul>\n<p>说明：</p>\n<ul>\n<li>get/set 需要手动编写大量转换代码，代码简洁性差、重复性高和工作量大。</li>\n<li>beanCopier 性能较高，属性名和类型有较高的匹配要求。</li>\n<li>MapStruct 性能较高，在编译阶段，生成Get/Set代码,支持不同属性之间自定义转换。</li>\n<li>Orika 性能较高,支持自定义属性拷贝，性能略差与前两种，当比后面几种高很多。</li>\n<li>Spring BeanUtils 性能一般，只能支持相关名称的拷贝。</li>\n<li>Dozer 性能差，使用简单，编写xml不方便。</li>\n<li>Apache BeanUtils 性能差。</li>\n</ul>\n<h3 id=\"demo\"><a href=\"#demo\" class=\"headerlink\" title=\"demo\"></a>demo</h3><p>实例代码:</p>\n<pre><code class=\"java\">/**\n* 定义对象之间转换Mapper\n * @Mapper 只有在接口加上这个注解， MapStruct 才会去实现该接口\n *     @Mapper\n *     componentModel ：主要是指定实现类的类型，\n *         - default：默认，可以通过 Mappers.getMapper(Class) 方式获取实例对象\n *         -  spring：在接口的实现类上自动添加注解 @Component，可通过 @Autowired 方式注入\n *     uses 使用用户自定义转换器\n *\n *     http://mapstruct.org/documentation/stable/reference/html/\n */\n//@Mapper(componentModel = &quot;spring&quot;,uses = &#123;DateHandWritten.class&#125;)\n@Mapper(\n        uses = &#123;DateHandWritten.class, UserNameHandWritten.class&#125;,\n        imports = &#123;LocalDateUtil.class&#125;\n        )\npublic interface PersonMapper &#123;\n\n    PersonMapper  INSTANCE  = Mappers.getMapper(PersonMapper.class);\n\n    @Mappings(&#123;\n            //@Mapping(source = &quot;name&quot;,target = &quot;name&quot;,ignore = true),\n            @Mapping(target = &quot;birthExpressionFormat&quot;, expression = &quot;java(LocalDateUtil.getDateNow().toString())&quot;),\n            @Mapping(source = &quot;name&quot;,target = &quot;address.name&quot;),\n            @Mapping(source = &quot;price&quot;,target = &quot;price&quot;,numberFormat = &quot;#.00&quot;),\n            @Mapping(source = &quot;birthDate&quot;,target = &quot;birthDateFormat&quot;,dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)\n    &#125;)\n    /***\n     * @Mapping：属性映射，若源对象属性与目标对象名字一致，会自动映射对应属性\n     *     source：源属性\n     *     target：目标属性\n     *     dateFormat：String 到 Date 日期之间相互转换，通过 SimpleDateFormat，该值为 SimpleDateFormat              的日期格式\n     *     ignore: 忽略这个字段\n     * @Mappings：配置多个@Mapping\n     */\n    PersonDto toDto(Person person);\n\n    @InheritConfiguration(name = &quot;toDto&quot;)\n    List&lt;PersonDto&gt; toDtos(List&lt;Person&gt; person);\n\n\n    /*@InheritInverseConfiguration()\n    PersonDto fromDto(Person person);*/\n\n    /**\n     * @InheritConfiguration 用于继承配置\n     * */\n  /*  @InheritConfiguration(name = &quot;toDto&quot;)\n    void update(Person person, @MappingTarget PersonDto personDto);*/\n&#125;\n\n/**定义自定义转换规则*/\npublic class DateHandWritten &#123;\n\n    public String asString(Date date) &#123;\n        return date != null ? new SimpleDateFormat( &quot;yyyy-MM-dd&quot; )\n            .format( date ) : null;\n    &#125;\n\n    public Date asDate(String date) &#123;\n        try &#123;\n            return date != null ? new SimpleDateFormat( &quot;yyyy-MM-dd&quot; )\n                .parse( date ) : null;\n        &#125;\n        catch ( ParseException e ) &#123;\n            throw new RuntimeException( e );\n        &#125;\n    &#125;\n&#125;\n\n/**定义自定义转换规则*/\npublic class UserNameHandWritten &#123;\n\n    public String asUsername(String username) &#123;\n        return  &quot;被修改后的name&quot;;\n    &#125; \n&#125;\n\n/***使用实例*/\npublic class MapStructTest &#123;\n\n    @Test\n    public void personTest()&#123;\n        Person person = buildPerson();\n        PersonDto personDto = PersonMapper.INSTANCE.toDto(person);\n        System.out.println(JSON.toJSONString(personDto));\n        /**\n        * &#123;&quot;address&quot;:&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;,&quot;addresses&quot;:[&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;],&quot;age&quot;:0,&quot;birthDate&quot;:1555573411245,&quot;birthDateFormat&quot;:&quot;2019-04-18&quot;,&quot;birthExpressionFormat&quot;:&quot;Thu Apr 18 15:43:31 CST 2019&quot;,&quot;name&quot;:&quot;被修改后的name&quot;,&quot;price&quot;:&quot;2.35&quot;&#125;\n        * */\n    &#125;\n\n    @Test\n    public void personListTest()&#123;\n        Person person = buildPerson();\n        List&lt;PersonDto&gt; personDtos = PersonMapper.INSTANCE.toDtos(Lists.newArrayList(person));\n        System.out.println(JSON.toJSONString(personDtos));\n        /**\n        * [&#123;&quot;address&quot;:&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;,&quot;addresses&quot;:[&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;],&quot;age&quot;:0,&quot;birthDate&quot;:1555573439123,&quot;birthDateFormat&quot;:&quot;2019-04-18&quot;,&quot;birthExpressionFormat&quot;:&quot;Thu Apr 18 15:43:59 CST 2019&quot;,&quot;name&quot;:&quot;被修改后的name&quot;,&quot;price&quot;:&quot;2.35&quot;&#125;]\n        * */\n    &#125;\n\n    private Person buildPerson()&#123;\n        Address a = new Address();\n        a.setName(&quot;demo&quot;);\n        return Person.builder().birthDate(new Date()).price(BigDecimal.valueOf(2.347)).name(&quot;中国人&quot;).addresses(Lists.newArrayList(a)).build();\n    &#125;\n&#125;\n</code></pre>\n<h3 id=\"实现原理\"><a href=\"#实现原理\" class=\"headerlink\" title=\"实现原理\"></a>实现原理</h3><p>在Maven 编译阶段将自动实现PersonMapper的对象属性转换接口,生成PersonMapperImpl文件。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"MapStruct\"><a href=\"#MapStruct\" class=\"headerlink\" title=\"MapStruct\"></a>MapStruct</h2><p><a href=\"http://mapstruct.org/\">MapStruct</a>是一个代码生成器，它基于约定优于配置方法极大地简化了Java bean类型之间映射的实现。<br>生成的映射代码使用普通方法调用，因此快速，类型安全且易于理解。</p>\n<h3 id=\"如何接入MapStruct\"><a href=\"#如何接入MapStruct\" class=\"headerlink\" title=\"如何接入MapStruct\"></a>如何接入MapStruct</h3><ul>\n<li><a href=\"http://mapstruct.org/documentation/installation/\">官网文档</a></li>\n</ul>\n<p>IDEA Support: <a href=\"https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions\">https://plugins.jetbrains.com/plugin/10036-mapstruct-support/versions</a></p>\n<h3 id=\"Java-Bean属性拷贝性能对比\"><a href=\"#Java-Bean属性拷贝性能对比\" class=\"headerlink\" title=\"Java Bean属性拷贝性能对比\"></a>Java Bean属性拷贝性能对比</h3><p>get/set &gt;= <a href=\"http://mapstruct.org/\">MapStruct</a> &gt; <a href=\"https://jmapper-framework.github.io/jmapper-core/\">JMapper</a>  &gt;  <a href=\"https://github.com/cglib/cglib/blob/master/cglib/src/main/java/net/sf/cglib/beans/BeanCopier.java\">“beanCopier(cglib)”</a> &gt; Orika &gt; ModelMapper &gt; Spring BeanUtils &gt; Dozer &gt; Apache BeanUtils</p>\n<p>性能对比数据来源：</p>\n<ul>\n<li><a href=\"https://www.baeldung.com/java-performance-mapping-frameworks\">https://www.baeldung.com/java-performance-mapping-frameworks</a></li>\n<li><a href=\"https://java.libhunt.com/categories/337-bean-mapping\">https://java.libhunt.com/categories/337-bean-mapping</a></li>\n</ul>\n<p>说明：</p>\n<ul>\n<li>get/set 需要手动编写大量转换代码，代码简洁性差、重复性高和工作量大。</li>\n<li>beanCopier 性能较高，属性名和类型有较高的匹配要求。</li>\n<li>MapStruct 性能较高，在编译阶段，生成Get/Set代码,支持不同属性之间自定义转换。</li>\n<li>Orika 性能较高,支持自定义属性拷贝，性能略差与前两种，当比后面几种高很多。</li>\n<li>Spring BeanUtils 性能一般，只能支持相关名称的拷贝。</li>\n<li>Dozer 性能差，使用简单，编写xml不方便。</li>\n<li>Apache BeanUtils 性能差。</li>\n</ul>\n<h3 id=\"demo\"><a href=\"#demo\" class=\"headerlink\" title=\"demo\"></a>demo</h3><p>实例代码:</p>\n<pre><code class=\"java\">/**\n* 定义对象之间转换Mapper\n * @Mapper 只有在接口加上这个注解， MapStruct 才会去实现该接口\n *     @Mapper\n *     componentModel ：主要是指定实现类的类型，\n *         - default：默认，可以通过 Mappers.getMapper(Class) 方式获取实例对象\n *         -  spring：在接口的实现类上自动添加注解 @Component，可通过 @Autowired 方式注入\n *     uses 使用用户自定义转换器\n *\n *     http://mapstruct.org/documentation/stable/reference/html/\n */\n//@Mapper(componentModel = &quot;spring&quot;,uses = &#123;DateHandWritten.class&#125;)\n@Mapper(\n        uses = &#123;DateHandWritten.class, UserNameHandWritten.class&#125;,\n        imports = &#123;LocalDateUtil.class&#125;\n        )\npublic interface PersonMapper &#123;\n\n    PersonMapper  INSTANCE  = Mappers.getMapper(PersonMapper.class);\n\n    @Mappings(&#123;\n            //@Mapping(source = &quot;name&quot;,target = &quot;name&quot;,ignore = true),\n            @Mapping(target = &quot;birthExpressionFormat&quot;, expression = &quot;java(LocalDateUtil.getDateNow().toString())&quot;),\n            @Mapping(source = &quot;name&quot;,target = &quot;address.name&quot;),\n            @Mapping(source = &quot;price&quot;,target = &quot;price&quot;,numberFormat = &quot;#.00&quot;),\n            @Mapping(source = &quot;birthDate&quot;,target = &quot;birthDateFormat&quot;,dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)\n    &#125;)\n    /***\n     * @Mapping：属性映射，若源对象属性与目标对象名字一致，会自动映射对应属性\n     *     source：源属性\n     *     target：目标属性\n     *     dateFormat：String 到 Date 日期之间相互转换，通过 SimpleDateFormat，该值为 SimpleDateFormat              的日期格式\n     *     ignore: 忽略这个字段\n     * @Mappings：配置多个@Mapping\n     */\n    PersonDto toDto(Person person);\n\n    @InheritConfiguration(name = &quot;toDto&quot;)\n    List&lt;PersonDto&gt; toDtos(List&lt;Person&gt; person);\n\n\n    /*@InheritInverseConfiguration()\n    PersonDto fromDto(Person person);*/\n\n    /**\n     * @InheritConfiguration 用于继承配置\n     * */\n  /*  @InheritConfiguration(name = &quot;toDto&quot;)\n    void update(Person person, @MappingTarget PersonDto personDto);*/\n&#125;\n\n/**定义自定义转换规则*/\npublic class DateHandWritten &#123;\n\n    public String asString(Date date) &#123;\n        return date != null ? new SimpleDateFormat( &quot;yyyy-MM-dd&quot; )\n            .format( date ) : null;\n    &#125;\n\n    public Date asDate(String date) &#123;\n        try &#123;\n            return date != null ? new SimpleDateFormat( &quot;yyyy-MM-dd&quot; )\n                .parse( date ) : null;\n        &#125;\n        catch ( ParseException e ) &#123;\n            throw new RuntimeException( e );\n        &#125;\n    &#125;\n&#125;\n\n/**定义自定义转换规则*/\npublic class UserNameHandWritten &#123;\n\n    public String asUsername(String username) &#123;\n        return  &quot;被修改后的name&quot;;\n    &#125; \n&#125;\n\n/***使用实例*/\npublic class MapStructTest &#123;\n\n    @Test\n    public void personTest()&#123;\n        Person person = buildPerson();\n        PersonDto personDto = PersonMapper.INSTANCE.toDto(person);\n        System.out.println(JSON.toJSONString(personDto));\n        /**\n        * &#123;&quot;address&quot;:&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;,&quot;addresses&quot;:[&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;],&quot;age&quot;:0,&quot;birthDate&quot;:1555573411245,&quot;birthDateFormat&quot;:&quot;2019-04-18&quot;,&quot;birthExpressionFormat&quot;:&quot;Thu Apr 18 15:43:31 CST 2019&quot;,&quot;name&quot;:&quot;被修改后的name&quot;,&quot;price&quot;:&quot;2.35&quot;&#125;\n        * */\n    &#125;\n\n    @Test\n    public void personListTest()&#123;\n        Person person = buildPerson();\n        List&lt;PersonDto&gt; personDtos = PersonMapper.INSTANCE.toDtos(Lists.newArrayList(person));\n        System.out.println(JSON.toJSONString(personDtos));\n        /**\n        * [&#123;&quot;address&quot;:&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;,&quot;addresses&quot;:[&#123;&quot;name&quot;:&quot;被修改后的name&quot;&#125;],&quot;age&quot;:0,&quot;birthDate&quot;:1555573439123,&quot;birthDateFormat&quot;:&quot;2019-04-18&quot;,&quot;birthExpressionFormat&quot;:&quot;Thu Apr 18 15:43:59 CST 2019&quot;,&quot;name&quot;:&quot;被修改后的name&quot;,&quot;price&quot;:&quot;2.35&quot;&#125;]\n        * */\n    &#125;\n\n    private Person buildPerson()&#123;\n        Address a = new Address();\n        a.setName(&quot;demo&quot;);\n        return Person.builder().birthDate(new Date()).price(BigDecimal.valueOf(2.347)).name(&quot;中国人&quot;).addresses(Lists.newArrayList(a)).build();\n    &#125;\n&#125;\n</code></pre>\n<h3 id=\"实现原理\"><a href=\"#实现原理\" class=\"headerlink\" title=\"实现原理\"></a>实现原理</h3><p>在Maven 编译阶段将自动实现PersonMapper的对象属性转换接口,生成PersonMapperImpl文件。</p>\n"},{"title":"对象转换工具-Orika","description":"对象转换","date":"2021-03-20T06:15:00.000Z","_content":"\n## Orika\n- [官方文档](http://orika-mapper.github.io/orika-docs/)\n\n### 提供的能力\n```textmate\nOrika为开发者提供了如下功能：\n1.映射复杂的、深层次结构性对象。\n2.通过将嵌套属性映射到顶级属性，“拉平”或“展开”对象。\n3.自动创建映射，并且在部分或所有映射上自定义。\n4.创建转换器，以完全控制对象图中的任何特定对象集合的映射——按类型，甚至是通过特定的属性名。\n5.处理代理或增强对象（如Hibernate或各种模拟框架）\n6.用一个配置应用双向映射。\n7.为一个目标抽象类或接口映射到具体的实现类。\n8.映射POJO属性到Lists, Arrays, and Maps。\n```\n\n### 配置\n#### pom引用\n```textmate\n<!-- 方式一(推荐) -->\n<dependency>\n    <groupId>net.rakugakibox.spring.boot</groupId>\n    <artifactId>orika-spring-boot-starter</artifactId>\n    <version>1.9.0</version>\n</dependency>\n\n<!-- 方式二，需要在项目中加入配置类 -->\n<dependency>\n    <groupId>ma.glasnost.orika</groupId>\n    <artifactId>orika-core</artifactId>\n    <version>1.5.4</version>\n    <scope>compile</scope>\n</dependency>\n```\n\n#### 方式二所需配置类(可选)\n```java\n/**\n * 可自定义转换规则\n * **/\n@Configuration\npublic class MapperFactoryAware {\n\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    @PostConstruct\n    public void init(){\n        mapperFactory.getConverterFactory().registerConverter(new BooleanConvert());\n    }\n\n    /** Boolean <=> Integer 互转 **/\n    private class BooleanConvert extends BidirectionalConverter<Boolean,Integer>{\n\n        @Override\n        public Integer convertTo(Boolean source, Type<Integer> destinationType, MappingContext mappingContext) {\n            return source ? 1 : 0;\n        }\n\n        @Override\n        public Boolean convertFrom(Integer source, Type<Boolean> destinationType, MappingContext mappingContext) {\n            return source == 1;\n        }\n    }\n}\n```\n\n### 案例\n#### 基础测试类\n```java\n// dto对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfoDTO {\n\n    private String userId;\n    private String userName;\n    private String createTime;\n    private List<String> ids;\n    private String dtoName;\n    private Integer sex;\n}\n\n// po对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfo {\n\n    private Integer userId;\n    private String userName;\n    private Date createTime;\n    private List<Integer> ids;\n    private String poName;\n    private Boolean sex;\n}\n```\n\n#### 简易demo(更多用法参考官方文档)\n```java\n@Slf4j\n@RunWith(SpringRunner.class)\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n        classes = DemoApplication.class)\npublic class ConvertTest{\n\n    @Autowired\n    private MapperFacade mapperFacade;\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    //简易案例，属性名相同，类型不同\n    @Test\n    public void testSimple(){\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(\"aaaa\")\n                .createTime(new Date())\n                .build();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(\"po 2 dto =====> {}\", JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(\"dto 2 po =====> {}\", JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List<UserInfo> pos = new ArrayList<>();\n        pos.add(userInfo);\n        List<UserInfoDTO> dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(pos));\n\n    }\n\n    //属性名不同，需要先在mapperFactory中设置，然后获取到mapperFacade再使用\n    @Test\n    public void testDiff(){\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(\"aaaa\")\n                .createTime(new Date())\n                .poName(\"this is po\")\n                .build();\n\n        //不同字段互转\n        mapperFactory.classMap(UserInfo.class, UserInfoDTO.class)\n                .field(\"poName\", \"dtoName\")\n                .byDefault()\n                .register();\n        MapperFacade mapperFacade = mapperFactory.getMapperFacade();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(\"po 2 dto =====> {}\", JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(\"dto 2 po =====> {}\", JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List<UserInfo> pos = new ArrayList<>();\n        pos.add(userInfo);\n        List<UserInfoDTO> dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(pos));\n    }\n}\n```\n\n#### 执行结果\n```textmate\ntestSimple 执行结果:\n-po 2 dto =====> {\"createTime\":\"Wed Jun 02 10:11:51 CST 2021\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}\n-dto 2 po =====> {\"createTime\":1622650311000,\"ids\":[1002,1003,1004,1005],\"userId\":10001,\"userName\":\"aaaa\"}\n-pos 2 dtos =====> [{\"createTime\":\"Wed Jun 02 10:11:51 CST 2021\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}]\n-pos 2 dtos =====> [{\"createTime\":1622650311000,\"ids\":[1002,1003,1004,1005],\"userId\":10001,\"userName\":\"aaaa\"}]\n\ntestDiff 执行结果:\npo 2 dto =====> {\"createTime\":\"Sat Mar 20 14:30:46 CST 2021\",\"dtoName\":\"this is po\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}\ndto 2 po =====> {\"createTime\":1616272246000,\"ids\":[1002,1003,1004,1005],\"poName\":\"this is po\",\"userId\":10001,\"userName\":\"aaaa\"}\npos 2 dtos =====> [{\"createTime\":\"Sat Mar 20 14:30:46 CST 2021\",\"dtoName\":\"this is po\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}]\npos 2 dtos =====> [{\"createTime\":1616272246000,\"ids\":[1002,1003,1004,1005],\"poName\":\"this is po\",\"userId\":10001,\"userName\":\"aaaa\"}]\n```\n","source":"_posts/backend/java/utils/convert/orika.md","raw":"---\ntitle: 对象转换工具-Orika\ndescription: 对象转换\ndate: 2021-03-20 14:15:00\ntags:\n- utils\ncategories:\n- 后端\n- 工具\n---\n\n## Orika\n- [官方文档](http://orika-mapper.github.io/orika-docs/)\n\n### 提供的能力\n```textmate\nOrika为开发者提供了如下功能：\n1.映射复杂的、深层次结构性对象。\n2.通过将嵌套属性映射到顶级属性，“拉平”或“展开”对象。\n3.自动创建映射，并且在部分或所有映射上自定义。\n4.创建转换器，以完全控制对象图中的任何特定对象集合的映射——按类型，甚至是通过特定的属性名。\n5.处理代理或增强对象（如Hibernate或各种模拟框架）\n6.用一个配置应用双向映射。\n7.为一个目标抽象类或接口映射到具体的实现类。\n8.映射POJO属性到Lists, Arrays, and Maps。\n```\n\n### 配置\n#### pom引用\n```textmate\n<!-- 方式一(推荐) -->\n<dependency>\n    <groupId>net.rakugakibox.spring.boot</groupId>\n    <artifactId>orika-spring-boot-starter</artifactId>\n    <version>1.9.0</version>\n</dependency>\n\n<!-- 方式二，需要在项目中加入配置类 -->\n<dependency>\n    <groupId>ma.glasnost.orika</groupId>\n    <artifactId>orika-core</artifactId>\n    <version>1.5.4</version>\n    <scope>compile</scope>\n</dependency>\n```\n\n#### 方式二所需配置类(可选)\n```java\n/**\n * 可自定义转换规则\n * **/\n@Configuration\npublic class MapperFactoryAware {\n\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    @PostConstruct\n    public void init(){\n        mapperFactory.getConverterFactory().registerConverter(new BooleanConvert());\n    }\n\n    /** Boolean <=> Integer 互转 **/\n    private class BooleanConvert extends BidirectionalConverter<Boolean,Integer>{\n\n        @Override\n        public Integer convertTo(Boolean source, Type<Integer> destinationType, MappingContext mappingContext) {\n            return source ? 1 : 0;\n        }\n\n        @Override\n        public Boolean convertFrom(Integer source, Type<Boolean> destinationType, MappingContext mappingContext) {\n            return source == 1;\n        }\n    }\n}\n```\n\n### 案例\n#### 基础测试类\n```java\n// dto对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfoDTO {\n\n    private String userId;\n    private String userName;\n    private String createTime;\n    private List<String> ids;\n    private String dtoName;\n    private Integer sex;\n}\n\n// po对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfo {\n\n    private Integer userId;\n    private String userName;\n    private Date createTime;\n    private List<Integer> ids;\n    private String poName;\n    private Boolean sex;\n}\n```\n\n#### 简易demo(更多用法参考官方文档)\n```java\n@Slf4j\n@RunWith(SpringRunner.class)\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n        classes = DemoApplication.class)\npublic class ConvertTest{\n\n    @Autowired\n    private MapperFacade mapperFacade;\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    //简易案例，属性名相同，类型不同\n    @Test\n    public void testSimple(){\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(\"aaaa\")\n                .createTime(new Date())\n                .build();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(\"po 2 dto =====> {}\", JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(\"dto 2 po =====> {}\", JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List<UserInfo> pos = new ArrayList<>();\n        pos.add(userInfo);\n        List<UserInfoDTO> dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(pos));\n\n    }\n\n    //属性名不同，需要先在mapperFactory中设置，然后获取到mapperFacade再使用\n    @Test\n    public void testDiff(){\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(\"aaaa\")\n                .createTime(new Date())\n                .poName(\"this is po\")\n                .build();\n\n        //不同字段互转\n        mapperFactory.classMap(UserInfo.class, UserInfoDTO.class)\n                .field(\"poName\", \"dtoName\")\n                .byDefault()\n                .register();\n        MapperFacade mapperFacade = mapperFactory.getMapperFacade();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(\"po 2 dto =====> {}\", JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(\"dto 2 po =====> {}\", JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List<UserInfo> pos = new ArrayList<>();\n        pos.add(userInfo);\n        List<UserInfoDTO> dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(\"pos 2 dtos =====> {}\", JSON.toJSONString(pos));\n    }\n}\n```\n\n#### 执行结果\n```textmate\ntestSimple 执行结果:\n-po 2 dto =====> {\"createTime\":\"Wed Jun 02 10:11:51 CST 2021\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}\n-dto 2 po =====> {\"createTime\":1622650311000,\"ids\":[1002,1003,1004,1005],\"userId\":10001,\"userName\":\"aaaa\"}\n-pos 2 dtos =====> [{\"createTime\":\"Wed Jun 02 10:11:51 CST 2021\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}]\n-pos 2 dtos =====> [{\"createTime\":1622650311000,\"ids\":[1002,1003,1004,1005],\"userId\":10001,\"userName\":\"aaaa\"}]\n\ntestDiff 执行结果:\npo 2 dto =====> {\"createTime\":\"Sat Mar 20 14:30:46 CST 2021\",\"dtoName\":\"this is po\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}\ndto 2 po =====> {\"createTime\":1616272246000,\"ids\":[1002,1003,1004,1005],\"poName\":\"this is po\",\"userId\":10001,\"userName\":\"aaaa\"}\npos 2 dtos =====> [{\"createTime\":\"Sat Mar 20 14:30:46 CST 2021\",\"dtoName\":\"this is po\",\"ids\":[\"1002\",\"1003\",\"1004\",\"1005\"],\"userId\":\"10001\",\"userName\":\"aaaa\"}]\npos 2 dtos =====> [{\"createTime\":1616272246000,\"ids\":[1002,1003,1004,1005],\"poName\":\"this is po\",\"userId\":10001,\"userName\":\"aaaa\"}]\n```\n","slug":"backend/java/utils/convert/orika","published":1,"updated":"2021-06-02T02:12:16.056Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bfk0033fms63klmdvjs","content":"<h2 id=\"Orika\"><a href=\"#Orika\" class=\"headerlink\" title=\"Orika\"></a>Orika</h2><ul>\n<li><a href=\"http://orika-mapper.github.io/orika-docs/\">官方文档</a></li>\n</ul>\n<h3 id=\"提供的能力\"><a href=\"#提供的能力\" class=\"headerlink\" title=\"提供的能力\"></a>提供的能力</h3><pre><code class=\"textmate\">Orika为开发者提供了如下功能：\n1.映射复杂的、深层次结构性对象。\n2.通过将嵌套属性映射到顶级属性，“拉平”或“展开”对象。\n3.自动创建映射，并且在部分或所有映射上自定义。\n4.创建转换器，以完全控制对象图中的任何特定对象集合的映射——按类型，甚至是通过特定的属性名。\n5.处理代理或增强对象（如Hibernate或各种模拟框架）\n6.用一个配置应用双向映射。\n7.为一个目标抽象类或接口映射到具体的实现类。\n8.映射POJO属性到Lists, Arrays, and Maps。</code></pre>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><h4 id=\"pom引用\"><a href=\"#pom引用\" class=\"headerlink\" title=\"pom引用\"></a>pom引用</h4><pre><code class=\"textmate\">&lt;!-- 方式一(推荐) --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;net.rakugakibox.spring.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;orika-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;1.9.0&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;!-- 方式二，需要在项目中加入配置类 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;ma.glasnost.orika&lt;/groupId&gt;\n    &lt;artifactId&gt;orika-core&lt;/artifactId&gt;\n    &lt;version&gt;1.5.4&lt;/version&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;</code></pre>\n<h4 id=\"方式二所需配置类-可选\"><a href=\"#方式二所需配置类-可选\" class=\"headerlink\" title=\"方式二所需配置类(可选)\"></a>方式二所需配置类(可选)</h4><pre><code class=\"java\">/**\n * 可自定义转换规则\n * **/\n@Configuration\npublic class MapperFactoryAware &#123;\n\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    @PostConstruct\n    public void init()&#123;\n        mapperFactory.getConverterFactory().registerConverter(new BooleanConvert());\n    &#125;\n\n    /** Boolean &lt;=&gt; Integer 互转 **/\n    private class BooleanConvert extends BidirectionalConverter&lt;Boolean,Integer&gt;&#123;\n\n        @Override\n        public Integer convertTo(Boolean source, Type&lt;Integer&gt; destinationType, MappingContext mappingContext) &#123;\n            return source ? 1 : 0;\n        &#125;\n\n        @Override\n        public Boolean convertFrom(Integer source, Type&lt;Boolean&gt; destinationType, MappingContext mappingContext) &#123;\n            return source == 1;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"案例\"><a href=\"#案例\" class=\"headerlink\" title=\"案例\"></a>案例</h3><h4 id=\"基础测试类\"><a href=\"#基础测试类\" class=\"headerlink\" title=\"基础测试类\"></a>基础测试类</h4><pre><code class=\"java\">// dto对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfoDTO &#123;\n\n    private String userId;\n    private String userName;\n    private String createTime;\n    private List&lt;String&gt; ids;\n    private String dtoName;\n    private Integer sex;\n&#125;\n\n// po对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfo &#123;\n\n    private Integer userId;\n    private String userName;\n    private Date createTime;\n    private List&lt;Integer&gt; ids;\n    private String poName;\n    private Boolean sex;\n&#125;</code></pre>\n<h4 id=\"简易demo-更多用法参考官方文档\"><a href=\"#简易demo-更多用法参考官方文档\" class=\"headerlink\" title=\"简易demo(更多用法参考官方文档)\"></a>简易demo(更多用法参考官方文档)</h4><pre><code class=\"java\">@Slf4j\n@RunWith(SpringRunner.class)\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n        classes = DemoApplication.class)\npublic class ConvertTest&#123;\n\n    @Autowired\n    private MapperFacade mapperFacade;\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    //简易案例，属性名相同，类型不同\n    @Test\n    public void testSimple()&#123;\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(&quot;aaaa&quot;)\n                .createTime(new Date())\n                .build();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(&quot;po 2 dto =====&gt; &#123;&#125;&quot;, JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(&quot;dto 2 po =====&gt; &#123;&#125;&quot;, JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List&lt;UserInfo&gt; pos = new ArrayList&lt;&gt;();\n        pos.add(userInfo);\n        List&lt;UserInfoDTO&gt; dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(pos));\n\n    &#125;\n\n    //属性名不同，需要先在mapperFactory中设置，然后获取到mapperFacade再使用\n    @Test\n    public void testDiff()&#123;\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(&quot;aaaa&quot;)\n                .createTime(new Date())\n                .poName(&quot;this is po&quot;)\n                .build();\n\n        //不同字段互转\n        mapperFactory.classMap(UserInfo.class, UserInfoDTO.class)\n                .field(&quot;poName&quot;, &quot;dtoName&quot;)\n                .byDefault()\n                .register();\n        MapperFacade mapperFacade = mapperFactory.getMapperFacade();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(&quot;po 2 dto =====&gt; &#123;&#125;&quot;, JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(&quot;dto 2 po =====&gt; &#123;&#125;&quot;, JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List&lt;UserInfo&gt; pos = new ArrayList&lt;&gt;();\n        pos.add(userInfo);\n        List&lt;UserInfoDTO&gt; dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(pos));\n    &#125;\n&#125;</code></pre>\n<h4 id=\"执行结果\"><a href=\"#执行结果\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><pre><code class=\"textmate\">testSimple 执行结果:\n-po 2 dto =====&gt; &#123;&quot;createTime&quot;:&quot;Wed Jun 02 10:11:51 CST 2021&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;\n-dto 2 po =====&gt; &#123;&quot;createTime&quot;:1622650311000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;\n-pos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:&quot;Wed Jun 02 10:11:51 CST 2021&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\n-pos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:1622650311000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\n\ntestDiff 执行结果:\npo 2 dto =====&gt; &#123;&quot;createTime&quot;:&quot;Sat Mar 20 14:30:46 CST 2021&quot;,&quot;dtoName&quot;:&quot;this is po&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;\ndto 2 po =====&gt; &#123;&quot;createTime&quot;:1616272246000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;poName&quot;:&quot;this is po&quot;,&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;\npos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:&quot;Sat Mar 20 14:30:46 CST 2021&quot;,&quot;dtoName&quot;:&quot;this is po&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\npos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:1616272246000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;poName&quot;:&quot;this is po&quot;,&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;]</code></pre>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Orika\"><a href=\"#Orika\" class=\"headerlink\" title=\"Orika\"></a>Orika</h2><ul>\n<li><a href=\"http://orika-mapper.github.io/orika-docs/\">官方文档</a></li>\n</ul>\n<h3 id=\"提供的能力\"><a href=\"#提供的能力\" class=\"headerlink\" title=\"提供的能力\"></a>提供的能力</h3><pre><code class=\"textmate\">Orika为开发者提供了如下功能：\n1.映射复杂的、深层次结构性对象。\n2.通过将嵌套属性映射到顶级属性，“拉平”或“展开”对象。\n3.自动创建映射，并且在部分或所有映射上自定义。\n4.创建转换器，以完全控制对象图中的任何特定对象集合的映射——按类型，甚至是通过特定的属性名。\n5.处理代理或增强对象（如Hibernate或各种模拟框架）\n6.用一个配置应用双向映射。\n7.为一个目标抽象类或接口映射到具体的实现类。\n8.映射POJO属性到Lists, Arrays, and Maps。</code></pre>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><h4 id=\"pom引用\"><a href=\"#pom引用\" class=\"headerlink\" title=\"pom引用\"></a>pom引用</h4><pre><code class=\"textmate\">&lt;!-- 方式一(推荐) --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;net.rakugakibox.spring.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;orika-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;1.9.0&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;!-- 方式二，需要在项目中加入配置类 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;ma.glasnost.orika&lt;/groupId&gt;\n    &lt;artifactId&gt;orika-core&lt;/artifactId&gt;\n    &lt;version&gt;1.5.4&lt;/version&gt;\n    &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;</code></pre>\n<h4 id=\"方式二所需配置类-可选\"><a href=\"#方式二所需配置类-可选\" class=\"headerlink\" title=\"方式二所需配置类(可选)\"></a>方式二所需配置类(可选)</h4><pre><code class=\"java\">/**\n * 可自定义转换规则\n * **/\n@Configuration\npublic class MapperFactoryAware &#123;\n\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    @PostConstruct\n    public void init()&#123;\n        mapperFactory.getConverterFactory().registerConverter(new BooleanConvert());\n    &#125;\n\n    /** Boolean &lt;=&gt; Integer 互转 **/\n    private class BooleanConvert extends BidirectionalConverter&lt;Boolean,Integer&gt;&#123;\n\n        @Override\n        public Integer convertTo(Boolean source, Type&lt;Integer&gt; destinationType, MappingContext mappingContext) &#123;\n            return source ? 1 : 0;\n        &#125;\n\n        @Override\n        public Boolean convertFrom(Integer source, Type&lt;Boolean&gt; destinationType, MappingContext mappingContext) &#123;\n            return source == 1;\n        &#125;\n    &#125;\n&#125;</code></pre>\n<h3 id=\"案例\"><a href=\"#案例\" class=\"headerlink\" title=\"案例\"></a>案例</h3><h4 id=\"基础测试类\"><a href=\"#基础测试类\" class=\"headerlink\" title=\"基础测试类\"></a>基础测试类</h4><pre><code class=\"java\">// dto对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfoDTO &#123;\n\n    private String userId;\n    private String userName;\n    private String createTime;\n    private List&lt;String&gt; ids;\n    private String dtoName;\n    private Integer sex;\n&#125;\n\n// po对象\n@Getter\n@Setter\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class UserInfo &#123;\n\n    private Integer userId;\n    private String userName;\n    private Date createTime;\n    private List&lt;Integer&gt; ids;\n    private String poName;\n    private Boolean sex;\n&#125;</code></pre>\n<h4 id=\"简易demo-更多用法参考官方文档\"><a href=\"#简易demo-更多用法参考官方文档\" class=\"headerlink\" title=\"简易demo(更多用法参考官方文档)\"></a>简易demo(更多用法参考官方文档)</h4><pre><code class=\"java\">@Slf4j\n@RunWith(SpringRunner.class)\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n        classes = DemoApplication.class)\npublic class ConvertTest&#123;\n\n    @Autowired\n    private MapperFacade mapperFacade;\n    @Autowired\n    private MapperFactory mapperFactory;\n\n    //简易案例，属性名相同，类型不同\n    @Test\n    public void testSimple()&#123;\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(&quot;aaaa&quot;)\n                .createTime(new Date())\n                .build();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(&quot;po 2 dto =====&gt; &#123;&#125;&quot;, JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(&quot;dto 2 po =====&gt; &#123;&#125;&quot;, JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List&lt;UserInfo&gt; pos = new ArrayList&lt;&gt;();\n        pos.add(userInfo);\n        List&lt;UserInfoDTO&gt; dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(pos));\n\n    &#125;\n\n    //属性名不同，需要先在mapperFactory中设置，然后获取到mapperFacade再使用\n    @Test\n    public void testDiff()&#123;\n        UserInfo userInfo = UserInfo.builder()\n                .userId(10001)\n                .ids(Arrays.asList(1002,1003,1004,1005))\n                .userName(&quot;aaaa&quot;)\n                .createTime(new Date())\n                .poName(&quot;this is po&quot;)\n                .build();\n\n        //不同字段互转\n        mapperFactory.classMap(UserInfo.class, UserInfoDTO.class)\n                .field(&quot;poName&quot;, &quot;dtoName&quot;)\n                .byDefault()\n                .register();\n        MapperFacade mapperFacade = mapperFactory.getMapperFacade();\n\n        //po 2 dto\n        UserInfoDTO result = mapperFacade.map(userInfo, UserInfoDTO.class);\n        log.info(&quot;po 2 dto =====&gt; &#123;&#125;&quot;, JSON.toJSONString(result));\n\n        //dto 2 po\n        UserInfo info = mapperFacade.map(result, UserInfo.class);\n        log.info(&quot;dto 2 po =====&gt; &#123;&#125;&quot;, JSON.toJSONString(info));\n\n        // pos 2 dtos\n        List&lt;UserInfo&gt; pos = new ArrayList&lt;&gt;();\n        pos.add(userInfo);\n        List&lt;UserInfoDTO&gt; dtos = mapperFacade.mapAsList(pos,UserInfoDTO.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(dtos));\n\n        // pos 2 dtos\n        pos = mapperFacade.mapAsList(dtos, UserInfo.class);\n        log.info(&quot;pos 2 dtos =====&gt; &#123;&#125;&quot;, JSON.toJSONString(pos));\n    &#125;\n&#125;</code></pre>\n<h4 id=\"执行结果\"><a href=\"#执行结果\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><pre><code class=\"textmate\">testSimple 执行结果:\n-po 2 dto =====&gt; &#123;&quot;createTime&quot;:&quot;Wed Jun 02 10:11:51 CST 2021&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;\n-dto 2 po =====&gt; &#123;&quot;createTime&quot;:1622650311000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;\n-pos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:&quot;Wed Jun 02 10:11:51 CST 2021&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\n-pos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:1622650311000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\n\ntestDiff 执行结果:\npo 2 dto =====&gt; &#123;&quot;createTime&quot;:&quot;Sat Mar 20 14:30:46 CST 2021&quot;,&quot;dtoName&quot;:&quot;this is po&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;\ndto 2 po =====&gt; &#123;&quot;createTime&quot;:1616272246000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;poName&quot;:&quot;this is po&quot;,&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;\npos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:&quot;Sat Mar 20 14:30:46 CST 2021&quot;,&quot;dtoName&quot;:&quot;this is po&quot;,&quot;ids&quot;:[&quot;1002&quot;,&quot;1003&quot;,&quot;1004&quot;,&quot;1005&quot;],&quot;userId&quot;:&quot;10001&quot;,&quot;userName&quot;:&quot;aaaa&quot;&#125;]\npos 2 dtos =====&gt; [&#123;&quot;createTime&quot;:1616272246000,&quot;ids&quot;:[1002,1003,1004,1005],&quot;poName&quot;:&quot;this is po&quot;,&quot;userId&quot;:10001,&quot;userName&quot;:&quot;aaaa&quot;&#125;]</code></pre>\n"},{"title":"14种常用设计模式","date":"2020-10-02T07:51:46.000Z","_content":"\n> [菜鸟教程](http://www.runoob.com/design-pattern)\n> [设计模式在Spring框架中的良好实践](https://mp.weixin.qq.com/s?__biz=MzI4ODQ3NjE2OA==&mid=2247485687&idx=2&sn=d1a405491311488c576197b556d357ec&chksm=ec3c9590db4b1c86a13ff39894dbeead2bbcee738a58da96bcb1bc404b6a948bd1f38312176a&mpshare=1&scene=1&srcid=&sharer_sharetime=1570684867528&sharer_shareid=4c8872b4436b495590f58ccf1453ba58&rd2werd=1#wechat_redirect)\n> [实现的demo](https://github.com/im-fan/my-design-mode.git)\n\n## 基础\n### 设计模式的类型\n<img class=\"magplus\" title=\"设计模式类型\" src=\"https://im-fan.gitee.io/img/design-model/design-model-type.jpg\" alt=\"设计模式类型\" width=\"700\" height=\"840\">\n\n### 设计模式实践的关系\n<img class=\"magplus\" title=\"设计模式之间的关系\" src=\"http://www.runoob.com/wp-content/uploads/2014/08/the-relationship-between-design-patterns.jpg\" alt=\"设计模式之间的关系\" width=\"700\" height=\"840\">\n\n### 设计模式的六大原则\n```\n1、开闭原则（Open Close Principle）\n    开闭原则的意思是：对扩展开放，对修改关闭。在程序需要进行拓展的时候，不能去修改原有的代码，实现一个热插拔的效果。简言之，是为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类。\n2、里氏代换原则（Liskov Substitution Principle）\n    里氏代换原则是面向对象设计的基本原则之一。 里氏代换原则中说，任何基类可以出现的地方，子类一定可以出现。LSP 是继承复用的基石，只有当派生类可以替换掉基类，且软件单位的功能不受到影响时，基类才能真正被复用，而派生类也能够在基类的基础上增加新的行为。里氏代换原则是对开闭原则的补充。实现开闭原则的关键步骤就是抽象化，而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。\n3、依赖倒转原则（Dependence Inversion Principle）\n    这个原则是开闭原则的基础，具体内容：针对接口编程，依赖于抽象而不依赖于具体。\n4、接口隔离原则（Interface Segregation Principle）\n    这个原则的意思是：使用多个隔离的接口，比使用单个接口要好。它还有另外一个意思是：降低类之间的耦合度。由此可见，其实设计模式就是从大型软件架构出发、便于升级和维护的软件设计思想，它强调降低依赖，降低耦合。\n5、迪米特法则，又称最少知道原则（Demeter Principle）\n    最少知道原则是指：一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。\n6、合成复用原则（Composite Reuse Principle）\n    合成复用原则是指：尽量使用合成/聚合的方式，而不是使用继承。\n```\n\n## 模式详解\n### 1.策略模式(Strategy)\n```\n定义个策略接口，不同的实现类提供不同的具体策略算法，通过context方法确定方法执行时具体执行那个子类的方法，属于行为型模式\n混合使用(https://blog.csdn.net/pengpegV5yaya/article/details/25189253)\n优点： 1、算法可以自由切换。 2、避免使用多重条件判断。 3、扩展性良好。\n缺点： 1、策略类会增多。 2、所有策略类都需要对外暴露。\n注意事项：如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题\n```\n- 示例图片<br/>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/strategy_pattern_uml_diagram.jpg\" />\n\n### 2.简单工厂模式( Simple Factory )\n```\n定义一个用以创建对象的工厂, 根据不同的条件[传参/反射]生成不同的对象，属于创建型模式\n\n- 优点：工厂类是整个模式的关键.包含了必要的逻辑判断,根据外界给定的信息,决定究竟应该创建哪个具体类的对象.通过使用工厂类,外界仅仅需要负责“消费”对象就可以了。而不必管这些对象究竟如何创建及如何组织的。\n- 缺点：由于工厂类集中了所有实例的创建逻辑，违反了高内聚责任分配原则，将全部创建逻辑集中到了一个工厂类中；它所能创建的类只能是事先考虑到的，如果需要添加新的类，则就需要改变工厂类了。当系统中的具体产品类不断增多时候，可能会出现要求工厂类根据不同条件创建不同实例的需求．这种对条件的判断和对具体产品类型的判断交错在一起，很难避免模块功能的蔓延，对系统的维护和扩展非常不利；\n```\n\n### 3.工厂模式( Factory )\n```\n针对每一种产品提供一个工厂类，通过不同的工厂实例来创建不同的产品实例。简单工厂是一种产品，工厂是多种产品\n```\n\n### 4.抽象工厂模式( Abstract Factory )\n```\nhttps://blog.csdn.net/hguisu/article/details/7505909\n应对产品族概念而生，属于创建型模式\n\n区别\n简单工厂 ：用来生产同一等级结构中的任意产品。（对于增加新的产品，无能为力） \n    例：造了一个工厂，只能生产 宝马和比亚迪汽车；如果需要制造其他车系，工厂要改造升级\n工厂方法 ：用来生产同一等级结构中的固定产品。（支持增加任意产品） \n    例：根据工厂图纸造了两个工厂，分别生产宝马和比亚迪汽车；如果需要制造其他车系，按照图纸再造一个工厂； 但无法生产除了车以外的其他产品\n抽象工厂 ：用来生产不同产品族的全部产品。（对于增加新的产品，无能为力；支持增加产品族）\n    例：收购了个汽车空调厂，将工厂图纸和空调厂图纸合并成一个图纸；建新厂时按照新的图纸，先建造出有空调+汽车生产线的厂，在利用不同生产线生产汽车和对应的汽车空调；如果需要一个五菱车厂，不支持单独建五菱车厂，但是可以新建带空调的五菱车厂\n\n1）还没有工厂时代：假如还没有工业革命，如果一个客户要一款宝马车,一般的做法是客户去创建一款宝马车，然后拿来用。\n2）简单工厂模式：后来出现工业革命。用户不用去创建车。因为客户有一个工厂来帮他创建.想要什么车，这个工厂就可以建。比如想要宝马车。工厂就创建这个系列的车。即工厂可以创建产品。\n3）工厂方法模式时代：为了满足客户，车品牌越来越多，如宝马、比亚迪等，一个工厂无法创建所有的车型。于是由单独分出来多个具体的工厂。每个具体工厂创建一种系列。即具体工厂类只能创建一个具体产品。但是轿车工厂还是个抽象。你需要指定某个具体的工厂才能生产车出来。\n4）抽象工厂模式时代：随着客户的要求越来越高，轿车必须配置空调。于是这个工厂开始生产轿车和需要的空调。\n\n最终是客户只要对轿车的销售员说：我要宝马空调车，销售员就直接给他宝马空调车了。而不用自己去创建车.\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/3E13CDD1-2CD2-4C66-BD33-DECBF172AE03.jpg\" alt=\"抽象工厂模式的 UML 图\">\n\n### 5.装饰器模式( Decorator )\n```\n动态的给一个对象添加一些额外的功能，属于结构型模式\n优点：装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。\n缺点：多层装饰比较复杂。\n使用场景： 1、扩展一个类的功能。 2、动态增加功能，动态撤销。\n注意事项：可代替继承。\n\n其他：下图，RedShapeDecorator extends ShapeDecorator\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/decorator_pattern_uml_diagram.jpg\" alt=\"装饰器模式的UML图\"/>\n\n### 6.代理模式( Proxy )\n```\n封装被代理对象并限制外界对被代理对象的访问，属于结构型模式\n关键代码：实现与被代理类组合。\n优点： 1、职责清晰。 2、高扩展性。 3、智能化。\n缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。\n注意事项：\n1、和适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。\n2、和装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-proxy.svg\" alt=\"代理模式的UML图\">\n\n### 7.模板方法模式( Template )\n```\n1.定义一个操作的算法骨架, 并将一些步骤延迟到子类中\n2.一个抽象类公开定义了执行它的方法的方式/模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。属于行为型模式。\n\n优点： 1、封装不变部分，扩展可变部分。 2、提取公共代码，便于维护。 3、行为由父类控制，子类实现。\n缺点：每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。\n使用场景： 1、有多个子类共有的方法，且逻辑相同。 2、重要的、复杂的方法，可以考虑作为模板方法。\n注意事项：为防止恶意操作，一般模板方法都加上 final 关键词，否则扩展类就可以自己实现模板方法。\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/template_pattern_uml_diagram.jpg\" alt=\"模板模式的 UML 图\">\n\n### 8.外观模式( Facade )\n```\n为系统向外界提供一个统一的接口、隐藏系统的复杂性（对使用者来说，只关系需要的结果，不关心怎么实现的）；属于结构型模式\n简单理解：电脑开机关机\n启动电脑（按一下电源键）：启动CPU、启动内存、启动硬盘\n关闭电脑（按一下电源键）：关闭硬盘、关闭内存、关闭CPU\n优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。\n缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。\n使用场景： 1、为复杂的模块或子系统提供外界访问的模块。 2、子系统相对独立。 3、预防低水平人员带来的风险。\n注意事项：在层次化结构中，可以使用外观模式定义系统中每一层的入口。\n```\n\n### 9.适配器模式( Adapter )\n```\n将一个类的接口转换成客户希望的另一个接口。属于结构型模式\n简单理解：用于现有业务维护，整合业务逻辑，根据传入的参数来执行具体某个业务\n优点： 1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。\n缺点：\n1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。\n2.由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。\n\n使用场景：有动机地修改一个正常运行的系统的接口，这时应该考虑使用适配器模式。\n\n注意事项：适配器不是在详细设计时添加的，而是解决正在服役的项目的问题。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201204-adapter.png\" alt=\"适配器模式的UML图\">\n\n### 10.桥接模式( Bridge )\n```\n将抽象部分与实现部分分离，使它们都可以独立的变化。属于结构型模式\n\n优点： 1、抽象和实现的分离。 2、优秀的扩展能力。 3、实现细节对客户透明。\n\n缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。\n\n使用场景： 1、如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 2、对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。 3、一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。\n\n注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-bridge.svg\" alt=\"桥接模式的UML图\">\n\n### 11.建造者模式( Builder )\n```\n使用多个简单的对象一步一步构建成一个复杂的对象。属于创建型模式\n\n优点： 1、建造者独立，易扩展。 2、便于控制细节风险。\n缺点： 1、产品必须有共同点，范围有限制。 2、如内部变化复杂，会有很多的建造类。\n注意事项：与工厂模式的区别是：建造者模式更加关注与零件装配的顺序。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-builder-pattern.svg\" alt=\"建造者模式的UML图\">\n\n### 12.观察者模式( Observer )\n```\n定义了一种一对多的依赖关系,让多个观察者对象同时监听某一主题对象,在它的状态发生变化时,会通知所有的观察者。观察者模式属于行为型模式。\n\n优点： 1、观察者和被观察者是抽象耦合的。 2、建立一套触发机制。\n\n缺点：\n    1、观察者太多时，通知观察者会耗时比较久\n    2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。\n    3、观察者模式仅仅只是知道观察目标发生了变化。\n注意事项：\n    1、JAVA 中已经有了对观察者模式的支持类。\n    2、避免循环引用。\n    3、如果顺序执行，某一观察者错误会导致系统卡壳，一般采用异步方式。\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/observer_pattern_uml_diagram.jpg\" alt=\"观察者模式的 UML 图\">\n\n### 13.单例模式( Singleton )\n```\n保证一个类仅有一个实例,并提供一个访问它的全局控制点.\n优点：\n1、在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。\n2、避免对资源的多重占用（比如写文件操作）。\n   缺点：没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。\n单例模式的几种实现方式\n1.懒汉式，线程不安全\n   不加锁 synchronized，所以严格意义上它并不算单例模式。\n这种方式 lazy loading 很明显，不要求线程安全，在多线程不能正常工作\n2.懒汉式，线程安全\n\t加锁 synchronized，方式具备很好的 lazy loading，能够在多线程中很好的工作，但是，效率很低，99% 情况下不需要同步。\n\t优点：第一次调用才初始化，避免内存浪费。\n\t缺点：必须加锁 synchronized 才能保证单例，但加锁会影响效率。\ngetInstance() 的性能对应用程序不是很关键（该方法使用不太频繁）。\n3、饿汉式\n\t优点：没有加锁，执行效率会提高。\n\t缺点：类加载时就初始化，浪费内存。\n4、双检锁/双重校验锁（DCL，即 double-checked locking）\n\t这种方式采用双锁机制，安全且在多线程情况下能保持高性能。\ngetInstance() 的性能对应用程序很关键。\n5、登记式/静态内部类\n\t这种方式能达到双检锁方式一样的功效，但实现更简单。对静态域使用延迟初始化，应使用这种方式而不是双检锁方式。这种方式只适用于静态域的情况，双检锁方式可在实例域需要延迟初始化时使用。\n6、枚举\n\t这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，自动支持序列化机制，绝对防止多次实例化。\n\n经验之谈：一般情况下，不建议使用第 1 种和第 2 种懒汉方式，建议使用第 3 种饿汉方式。只有在要明确实现 lazy loading 效果时，才会使用第 5 种登记方式。如果涉及到反序列化创建对象时，可以尝试使用第 6 种枚举方式。如果有其他特殊的需求，可以考虑使用第 4 种双检锁方式。\n```\n\n### 14.命令模式( Command )\n```\n将一个请求封装成为一个对象, 使可以用不同的请求对客户进行参数化\n优点：\n1、降低了系统耦合度。\n2、新的命令可以很容易添加到系统中去。\n缺点：使用命令模式可能会导致某些系统有过多的具体命令类。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-command-1.svg\" alt=\"命令模式的 UML 图\">","source":"_posts/framework/design-model.md","raw":"---\ntitle: 14种常用设计模式\ndate: 2020-10-02 15:51:46\ntags: \n- 设计模式\ncategories: \n- 架构\n---\n\n> [菜鸟教程](http://www.runoob.com/design-pattern)\n> [设计模式在Spring框架中的良好实践](https://mp.weixin.qq.com/s?__biz=MzI4ODQ3NjE2OA==&mid=2247485687&idx=2&sn=d1a405491311488c576197b556d357ec&chksm=ec3c9590db4b1c86a13ff39894dbeead2bbcee738a58da96bcb1bc404b6a948bd1f38312176a&mpshare=1&scene=1&srcid=&sharer_sharetime=1570684867528&sharer_shareid=4c8872b4436b495590f58ccf1453ba58&rd2werd=1#wechat_redirect)\n> [实现的demo](https://github.com/im-fan/my-design-mode.git)\n\n## 基础\n### 设计模式的类型\n<img class=\"magplus\" title=\"设计模式类型\" src=\"https://im-fan.gitee.io/img/design-model/design-model-type.jpg\" alt=\"设计模式类型\" width=\"700\" height=\"840\">\n\n### 设计模式实践的关系\n<img class=\"magplus\" title=\"设计模式之间的关系\" src=\"http://www.runoob.com/wp-content/uploads/2014/08/the-relationship-between-design-patterns.jpg\" alt=\"设计模式之间的关系\" width=\"700\" height=\"840\">\n\n### 设计模式的六大原则\n```\n1、开闭原则（Open Close Principle）\n    开闭原则的意思是：对扩展开放，对修改关闭。在程序需要进行拓展的时候，不能去修改原有的代码，实现一个热插拔的效果。简言之，是为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类。\n2、里氏代换原则（Liskov Substitution Principle）\n    里氏代换原则是面向对象设计的基本原则之一。 里氏代换原则中说，任何基类可以出现的地方，子类一定可以出现。LSP 是继承复用的基石，只有当派生类可以替换掉基类，且软件单位的功能不受到影响时，基类才能真正被复用，而派生类也能够在基类的基础上增加新的行为。里氏代换原则是对开闭原则的补充。实现开闭原则的关键步骤就是抽象化，而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。\n3、依赖倒转原则（Dependence Inversion Principle）\n    这个原则是开闭原则的基础，具体内容：针对接口编程，依赖于抽象而不依赖于具体。\n4、接口隔离原则（Interface Segregation Principle）\n    这个原则的意思是：使用多个隔离的接口，比使用单个接口要好。它还有另外一个意思是：降低类之间的耦合度。由此可见，其实设计模式就是从大型软件架构出发、便于升级和维护的软件设计思想，它强调降低依赖，降低耦合。\n5、迪米特法则，又称最少知道原则（Demeter Principle）\n    最少知道原则是指：一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。\n6、合成复用原则（Composite Reuse Principle）\n    合成复用原则是指：尽量使用合成/聚合的方式，而不是使用继承。\n```\n\n## 模式详解\n### 1.策略模式(Strategy)\n```\n定义个策略接口，不同的实现类提供不同的具体策略算法，通过context方法确定方法执行时具体执行那个子类的方法，属于行为型模式\n混合使用(https://blog.csdn.net/pengpegV5yaya/article/details/25189253)\n优点： 1、算法可以自由切换。 2、避免使用多重条件判断。 3、扩展性良好。\n缺点： 1、策略类会增多。 2、所有策略类都需要对外暴露。\n注意事项：如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题\n```\n- 示例图片<br/>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/strategy_pattern_uml_diagram.jpg\" />\n\n### 2.简单工厂模式( Simple Factory )\n```\n定义一个用以创建对象的工厂, 根据不同的条件[传参/反射]生成不同的对象，属于创建型模式\n\n- 优点：工厂类是整个模式的关键.包含了必要的逻辑判断,根据外界给定的信息,决定究竟应该创建哪个具体类的对象.通过使用工厂类,外界仅仅需要负责“消费”对象就可以了。而不必管这些对象究竟如何创建及如何组织的。\n- 缺点：由于工厂类集中了所有实例的创建逻辑，违反了高内聚责任分配原则，将全部创建逻辑集中到了一个工厂类中；它所能创建的类只能是事先考虑到的，如果需要添加新的类，则就需要改变工厂类了。当系统中的具体产品类不断增多时候，可能会出现要求工厂类根据不同条件创建不同实例的需求．这种对条件的判断和对具体产品类型的判断交错在一起，很难避免模块功能的蔓延，对系统的维护和扩展非常不利；\n```\n\n### 3.工厂模式( Factory )\n```\n针对每一种产品提供一个工厂类，通过不同的工厂实例来创建不同的产品实例。简单工厂是一种产品，工厂是多种产品\n```\n\n### 4.抽象工厂模式( Abstract Factory )\n```\nhttps://blog.csdn.net/hguisu/article/details/7505909\n应对产品族概念而生，属于创建型模式\n\n区别\n简单工厂 ：用来生产同一等级结构中的任意产品。（对于增加新的产品，无能为力） \n    例：造了一个工厂，只能生产 宝马和比亚迪汽车；如果需要制造其他车系，工厂要改造升级\n工厂方法 ：用来生产同一等级结构中的固定产品。（支持增加任意产品） \n    例：根据工厂图纸造了两个工厂，分别生产宝马和比亚迪汽车；如果需要制造其他车系，按照图纸再造一个工厂； 但无法生产除了车以外的其他产品\n抽象工厂 ：用来生产不同产品族的全部产品。（对于增加新的产品，无能为力；支持增加产品族）\n    例：收购了个汽车空调厂，将工厂图纸和空调厂图纸合并成一个图纸；建新厂时按照新的图纸，先建造出有空调+汽车生产线的厂，在利用不同生产线生产汽车和对应的汽车空调；如果需要一个五菱车厂，不支持单独建五菱车厂，但是可以新建带空调的五菱车厂\n\n1）还没有工厂时代：假如还没有工业革命，如果一个客户要一款宝马车,一般的做法是客户去创建一款宝马车，然后拿来用。\n2）简单工厂模式：后来出现工业革命。用户不用去创建车。因为客户有一个工厂来帮他创建.想要什么车，这个工厂就可以建。比如想要宝马车。工厂就创建这个系列的车。即工厂可以创建产品。\n3）工厂方法模式时代：为了满足客户，车品牌越来越多，如宝马、比亚迪等，一个工厂无法创建所有的车型。于是由单独分出来多个具体的工厂。每个具体工厂创建一种系列。即具体工厂类只能创建一个具体产品。但是轿车工厂还是个抽象。你需要指定某个具体的工厂才能生产车出来。\n4）抽象工厂模式时代：随着客户的要求越来越高，轿车必须配置空调。于是这个工厂开始生产轿车和需要的空调。\n\n最终是客户只要对轿车的销售员说：我要宝马空调车，销售员就直接给他宝马空调车了。而不用自己去创建车.\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/3E13CDD1-2CD2-4C66-BD33-DECBF172AE03.jpg\" alt=\"抽象工厂模式的 UML 图\">\n\n### 5.装饰器模式( Decorator )\n```\n动态的给一个对象添加一些额外的功能，属于结构型模式\n优点：装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。\n缺点：多层装饰比较复杂。\n使用场景： 1、扩展一个类的功能。 2、动态增加功能，动态撤销。\n注意事项：可代替继承。\n\n其他：下图，RedShapeDecorator extends ShapeDecorator\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/decorator_pattern_uml_diagram.jpg\" alt=\"装饰器模式的UML图\"/>\n\n### 6.代理模式( Proxy )\n```\n封装被代理对象并限制外界对被代理对象的访问，属于结构型模式\n关键代码：实现与被代理类组合。\n优点： 1、职责清晰。 2、高扩展性。 3、智能化。\n缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。\n注意事项：\n1、和适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。\n2、和装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-proxy.svg\" alt=\"代理模式的UML图\">\n\n### 7.模板方法模式( Template )\n```\n1.定义一个操作的算法骨架, 并将一些步骤延迟到子类中\n2.一个抽象类公开定义了执行它的方法的方式/模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。属于行为型模式。\n\n优点： 1、封装不变部分，扩展可变部分。 2、提取公共代码，便于维护。 3、行为由父类控制，子类实现。\n缺点：每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。\n使用场景： 1、有多个子类共有的方法，且逻辑相同。 2、重要的、复杂的方法，可以考虑作为模板方法。\n注意事项：为防止恶意操作，一般模板方法都加上 final 关键词，否则扩展类就可以自己实现模板方法。\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/template_pattern_uml_diagram.jpg\" alt=\"模板模式的 UML 图\">\n\n### 8.外观模式( Facade )\n```\n为系统向外界提供一个统一的接口、隐藏系统的复杂性（对使用者来说，只关系需要的结果，不关心怎么实现的）；属于结构型模式\n简单理解：电脑开机关机\n启动电脑（按一下电源键）：启动CPU、启动内存、启动硬盘\n关闭电脑（按一下电源键）：关闭硬盘、关闭内存、关闭CPU\n优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。\n缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。\n使用场景： 1、为复杂的模块或子系统提供外界访问的模块。 2、子系统相对独立。 3、预防低水平人员带来的风险。\n注意事项：在层次化结构中，可以使用外观模式定义系统中每一层的入口。\n```\n\n### 9.适配器模式( Adapter )\n```\n将一个类的接口转换成客户希望的另一个接口。属于结构型模式\n简单理解：用于现有业务维护，整合业务逻辑，根据传入的参数来执行具体某个业务\n优点： 1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。\n缺点：\n1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。\n2.由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。\n\n使用场景：有动机地修改一个正常运行的系统的接口，这时应该考虑使用适配器模式。\n\n注意事项：适配器不是在详细设计时添加的，而是解决正在服役的项目的问题。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201204-adapter.png\" alt=\"适配器模式的UML图\">\n\n### 10.桥接模式( Bridge )\n```\n将抽象部分与实现部分分离，使它们都可以独立的变化。属于结构型模式\n\n优点： 1、抽象和实现的分离。 2、优秀的扩展能力。 3、实现细节对客户透明。\n\n缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。\n\n使用场景： 1、如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 2、对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。 3、一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。\n\n注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-bridge.svg\" alt=\"桥接模式的UML图\">\n\n### 11.建造者模式( Builder )\n```\n使用多个简单的对象一步一步构建成一个复杂的对象。属于创建型模式\n\n优点： 1、建造者独立，易扩展。 2、便于控制细节风险。\n缺点： 1、产品必须有共同点，范围有限制。 2、如内部变化复杂，会有很多的建造类。\n注意事项：与工厂模式的区别是：建造者模式更加关注与零件装配的顺序。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-builder-pattern.svg\" alt=\"建造者模式的UML图\">\n\n### 12.观察者模式( Observer )\n```\n定义了一种一对多的依赖关系,让多个观察者对象同时监听某一主题对象,在它的状态发生变化时,会通知所有的观察者。观察者模式属于行为型模式。\n\n优点： 1、观察者和被观察者是抽象耦合的。 2、建立一套触发机制。\n\n缺点：\n    1、观察者太多时，通知观察者会耗时比较久\n    2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。\n    3、观察者模式仅仅只是知道观察目标发生了变化。\n注意事项：\n    1、JAVA 中已经有了对观察者模式的支持类。\n    2、避免循环引用。\n    3、如果顺序执行，某一观察者错误会导致系统卡壳，一般采用异步方式。\n```\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/observer_pattern_uml_diagram.jpg\" alt=\"观察者模式的 UML 图\">\n\n### 13.单例模式( Singleton )\n```\n保证一个类仅有一个实例,并提供一个访问它的全局控制点.\n优点：\n1、在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。\n2、避免对资源的多重占用（比如写文件操作）。\n   缺点：没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。\n单例模式的几种实现方式\n1.懒汉式，线程不安全\n   不加锁 synchronized，所以严格意义上它并不算单例模式。\n这种方式 lazy loading 很明显，不要求线程安全，在多线程不能正常工作\n2.懒汉式，线程安全\n\t加锁 synchronized，方式具备很好的 lazy loading，能够在多线程中很好的工作，但是，效率很低，99% 情况下不需要同步。\n\t优点：第一次调用才初始化，避免内存浪费。\n\t缺点：必须加锁 synchronized 才能保证单例，但加锁会影响效率。\ngetInstance() 的性能对应用程序不是很关键（该方法使用不太频繁）。\n3、饿汉式\n\t优点：没有加锁，执行效率会提高。\n\t缺点：类加载时就初始化，浪费内存。\n4、双检锁/双重校验锁（DCL，即 double-checked locking）\n\t这种方式采用双锁机制，安全且在多线程情况下能保持高性能。\ngetInstance() 的性能对应用程序很关键。\n5、登记式/静态内部类\n\t这种方式能达到双检锁方式一样的功效，但实现更简单。对静态域使用延迟初始化，应使用这种方式而不是双检锁方式。这种方式只适用于静态域的情况，双检锁方式可在实例域需要延迟初始化时使用。\n6、枚举\n\t这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，自动支持序列化机制，绝对防止多次实例化。\n\n经验之谈：一般情况下，不建议使用第 1 种和第 2 种懒汉方式，建议使用第 3 种饿汉方式。只有在要明确实现 lazy loading 效果时，才会使用第 5 种登记方式。如果涉及到反序列化创建对象时，可以尝试使用第 6 种枚举方式。如果有其他特殊的需求，可以考虑使用第 4 种双检锁方式。\n```\n\n### 14.命令模式( Command )\n```\n将一个请求封装成为一个对象, 使可以用不同的请求对客户进行参数化\n优点：\n1、降低了系统耦合度。\n2、新的命令可以很容易添加到系统中去。\n缺点：使用命令模式可能会导致某些系统有过多的具体命令类。\n```\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-command-1.svg\" alt=\"命令模式的 UML 图\">","slug":"framework/design-model","published":1,"updated":"2020-12-29T10:01:14.548Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cktds3bgz006afms6ha3p34ka","content":"<blockquote>\n<p><a href=\"http://www.runoob.com/design-pattern\">菜鸟教程</a><br><a href=\"https://mp.weixin.qq.com/s?__biz=MzI4ODQ3NjE2OA==&mid=2247485687&idx=2&sn=d1a405491311488c576197b556d357ec&chksm=ec3c9590db4b1c86a13ff39894dbeead2bbcee738a58da96bcb1bc404b6a948bd1f38312176a&mpshare=1&scene=1&srcid=&sharer_sharetime=1570684867528&sharer_shareid=4c8872b4436b495590f58ccf1453ba58&rd2werd=1#wechat_redirect\">设计模式在Spring框架中的良好实践</a><br><a href=\"https://github.com/im-fan/my-design-mode.git\">实现的demo</a></p>\n</blockquote>\n<h2 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h2><h3 id=\"设计模式的类型\"><a href=\"#设计模式的类型\" class=\"headerlink\" title=\"设计模式的类型\"></a>设计模式的类型</h3><img class=\"magplus\" title=\"设计模式类型\" src=\"https://im-fan.gitee.io/img/design-model/design-model-type.jpg\" alt=\"设计模式类型\" width=\"700\" height=\"840\">\n\n<h3 id=\"设计模式实践的关系\"><a href=\"#设计模式实践的关系\" class=\"headerlink\" title=\"设计模式实践的关系\"></a>设计模式实践的关系</h3><img class=\"magplus\" title=\"设计模式之间的关系\" src=\"http://www.runoob.com/wp-content/uploads/2014/08/the-relationship-between-design-patterns.jpg\" alt=\"设计模式之间的关系\" width=\"700\" height=\"840\">\n\n<h3 id=\"设计模式的六大原则\"><a href=\"#设计模式的六大原则\" class=\"headerlink\" title=\"设计模式的六大原则\"></a>设计模式的六大原则</h3><pre><code>1、开闭原则（Open Close Principle）\n    开闭原则的意思是：对扩展开放，对修改关闭。在程序需要进行拓展的时候，不能去修改原有的代码，实现一个热插拔的效果。简言之，是为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类。\n2、里氏代换原则（Liskov Substitution Principle）\n    里氏代换原则是面向对象设计的基本原则之一。 里氏代换原则中说，任何基类可以出现的地方，子类一定可以出现。LSP 是继承复用的基石，只有当派生类可以替换掉基类，且软件单位的功能不受到影响时，基类才能真正被复用，而派生类也能够在基类的基础上增加新的行为。里氏代换原则是对开闭原则的补充。实现开闭原则的关键步骤就是抽象化，而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。\n3、依赖倒转原则（Dependence Inversion Principle）\n    这个原则是开闭原则的基础，具体内容：针对接口编程，依赖于抽象而不依赖于具体。\n4、接口隔离原则（Interface Segregation Principle）\n    这个原则的意思是：使用多个隔离的接口，比使用单个接口要好。它还有另外一个意思是：降低类之间的耦合度。由此可见，其实设计模式就是从大型软件架构出发、便于升级和维护的软件设计思想，它强调降低依赖，降低耦合。\n5、迪米特法则，又称最少知道原则（Demeter Principle）\n    最少知道原则是指：一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。\n6、合成复用原则（Composite Reuse Principle）\n    合成复用原则是指：尽量使用合成/聚合的方式，而不是使用继承。</code></pre>\n<h2 id=\"模式详解\"><a href=\"#模式详解\" class=\"headerlink\" title=\"模式详解\"></a>模式详解</h2><h3 id=\"1-策略模式-Strategy\"><a href=\"#1-策略模式-Strategy\" class=\"headerlink\" title=\"1.策略模式(Strategy)\"></a>1.策略模式(Strategy)</h3><pre><code>定义个策略接口，不同的实现类提供不同的具体策略算法，通过context方法确定方法执行时具体执行那个子类的方法，属于行为型模式\n混合使用(https://blog.csdn.net/pengpegV5yaya/article/details/25189253)\n优点： 1、算法可以自由切换。 2、避免使用多重条件判断。 3、扩展性良好。\n缺点： 1、策略类会增多。 2、所有策略类都需要对外暴露。\n注意事项：如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题</code></pre>\n<ul>\n<li>示例图片<br/><img src=\"http://www.runoob.com/wp-content/uploads/2014/08/strategy_pattern_uml_diagram.jpg\" />\n\n</li>\n</ul>\n<h3 id=\"2-简单工厂模式-Simple-Factory\"><a href=\"#2-简单工厂模式-Simple-Factory\" class=\"headerlink\" title=\"2.简单工厂模式( Simple Factory )\"></a>2.简单工厂模式( Simple Factory )</h3><pre><code>定义一个用以创建对象的工厂, 根据不同的条件[传参/反射]生成不同的对象，属于创建型模式\n\n- 优点：工厂类是整个模式的关键.包含了必要的逻辑判断,根据外界给定的信息,决定究竟应该创建哪个具体类的对象.通过使用工厂类,外界仅仅需要负责“消费”对象就可以了。而不必管这些对象究竟如何创建及如何组织的。\n- 缺点：由于工厂类集中了所有实例的创建逻辑，违反了高内聚责任分配原则，将全部创建逻辑集中到了一个工厂类中；它所能创建的类只能是事先考虑到的，如果需要添加新的类，则就需要改变工厂类了。当系统中的具体产品类不断增多时候，可能会出现要求工厂类根据不同条件创建不同实例的需求．这种对条件的判断和对具体产品类型的判断交错在一起，很难避免模块功能的蔓延，对系统的维护和扩展非常不利；</code></pre>\n<h3 id=\"3-工厂模式-Factory\"><a href=\"#3-工厂模式-Factory\" class=\"headerlink\" title=\"3.工厂模式( Factory )\"></a>3.工厂模式( Factory )</h3><pre><code>针对每一种产品提供一个工厂类，通过不同的工厂实例来创建不同的产品实例。简单工厂是一种产品，工厂是多种产品</code></pre>\n<h3 id=\"4-抽象工厂模式-Abstract-Factory\"><a href=\"#4-抽象工厂模式-Abstract-Factory\" class=\"headerlink\" title=\"4.抽象工厂模式( Abstract Factory )\"></a>4.抽象工厂模式( Abstract Factory )</h3><pre><code>https://blog.csdn.net/hguisu/article/details/7505909\n应对产品族概念而生，属于创建型模式\n\n区别\n简单工厂 ：用来生产同一等级结构中的任意产品。（对于增加新的产品，无能为力） \n    例：造了一个工厂，只能生产 宝马和比亚迪汽车；如果需要制造其他车系，工厂要改造升级\n工厂方法 ：用来生产同一等级结构中的固定产品。（支持增加任意产品） \n    例：根据工厂图纸造了两个工厂，分别生产宝马和比亚迪汽车；如果需要制造其他车系，按照图纸再造一个工厂； 但无法生产除了车以外的其他产品\n抽象工厂 ：用来生产不同产品族的全部产品。（对于增加新的产品，无能为力；支持增加产品族）\n    例：收购了个汽车空调厂，将工厂图纸和空调厂图纸合并成一个图纸；建新厂时按照新的图纸，先建造出有空调+汽车生产线的厂，在利用不同生产线生产汽车和对应的汽车空调；如果需要一个五菱车厂，不支持单独建五菱车厂，但是可以新建带空调的五菱车厂\n\n1）还没有工厂时代：假如还没有工业革命，如果一个客户要一款宝马车,一般的做法是客户去创建一款宝马车，然后拿来用。\n2）简单工厂模式：后来出现工业革命。用户不用去创建车。因为客户有一个工厂来帮他创建.想要什么车，这个工厂就可以建。比如想要宝马车。工厂就创建这个系列的车。即工厂可以创建产品。\n3）工厂方法模式时代：为了满足客户，车品牌越来越多，如宝马、比亚迪等，一个工厂无法创建所有的车型。于是由单独分出来多个具体的工厂。每个具体工厂创建一种系列。即具体工厂类只能创建一个具体产品。但是轿车工厂还是个抽象。你需要指定某个具体的工厂才能生产车出来。\n4）抽象工厂模式时代：随着客户的要求越来越高，轿车必须配置空调。于是这个工厂开始生产轿车和需要的空调。\n\n最终是客户只要对轿车的销售员说：我要宝马空调车，销售员就直接给他宝马空调车了。而不用自己去创建车.</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/3E13CDD1-2CD2-4C66-BD33-DECBF172AE03.jpg\" alt=\"抽象工厂模式的 UML 图\">\n\n<h3 id=\"5-装饰器模式-Decorator\"><a href=\"#5-装饰器模式-Decorator\" class=\"headerlink\" title=\"5.装饰器模式( Decorator )\"></a>5.装饰器模式( Decorator )</h3><pre><code>动态的给一个对象添加一些额外的功能，属于结构型模式\n优点：装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。\n缺点：多层装饰比较复杂。\n使用场景： 1、扩展一个类的功能。 2、动态增加功能，动态撤销。\n注意事项：可代替继承。\n\n其他：下图，RedShapeDecorator extends ShapeDecorator</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/decorator_pattern_uml_diagram.jpg\" alt=\"装饰器模式的UML图\"/>\n\n<h3 id=\"6-代理模式-Proxy\"><a href=\"#6-代理模式-Proxy\" class=\"headerlink\" title=\"6.代理模式( Proxy )\"></a>6.代理模式( Proxy )</h3><pre><code>封装被代理对象并限制外界对被代理对象的访问，属于结构型模式\n关键代码：实现与被代理类组合。\n优点： 1、职责清晰。 2、高扩展性。 3、智能化。\n缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。\n注意事项：\n1、和适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。\n2、和装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-proxy.svg\" alt=\"代理模式的UML图\">\n\n<h3 id=\"7-模板方法模式-Template\"><a href=\"#7-模板方法模式-Template\" class=\"headerlink\" title=\"7.模板方法模式( Template )\"></a>7.模板方法模式( Template )</h3><pre><code>1.定义一个操作的算法骨架, 并将一些步骤延迟到子类中\n2.一个抽象类公开定义了执行它的方法的方式/模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。属于行为型模式。\n\n优点： 1、封装不变部分，扩展可变部分。 2、提取公共代码，便于维护。 3、行为由父类控制，子类实现。\n缺点：每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。\n使用场景： 1、有多个子类共有的方法，且逻辑相同。 2、重要的、复杂的方法，可以考虑作为模板方法。\n注意事项：为防止恶意操作，一般模板方法都加上 final 关键词，否则扩展类就可以自己实现模板方法。</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/template_pattern_uml_diagram.jpg\" alt=\"模板模式的 UML 图\">\n\n<h3 id=\"8-外观模式-Facade\"><a href=\"#8-外观模式-Facade\" class=\"headerlink\" title=\"8.外观模式( Facade )\"></a>8.外观模式( Facade )</h3><pre><code>为系统向外界提供一个统一的接口、隐藏系统的复杂性（对使用者来说，只关系需要的结果，不关心怎么实现的）；属于结构型模式\n简单理解：电脑开机关机\n启动电脑（按一下电源键）：启动CPU、启动内存、启动硬盘\n关闭电脑（按一下电源键）：关闭硬盘、关闭内存、关闭CPU\n优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。\n缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。\n使用场景： 1、为复杂的模块或子系统提供外界访问的模块。 2、子系统相对独立。 3、预防低水平人员带来的风险。\n注意事项：在层次化结构中，可以使用外观模式定义系统中每一层的入口。</code></pre>\n<h3 id=\"9-适配器模式-Adapter\"><a href=\"#9-适配器模式-Adapter\" class=\"headerlink\" title=\"9.适配器模式( Adapter )\"></a>9.适配器模式( Adapter )</h3><pre><code>将一个类的接口转换成客户希望的另一个接口。属于结构型模式\n简单理解：用于现有业务维护，整合业务逻辑，根据传入的参数来执行具体某个业务\n优点： 1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。\n缺点：\n1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。\n2.由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。\n\n使用场景：有动机地修改一个正常运行的系统的接口，这时应该考虑使用适配器模式。\n\n注意事项：适配器不是在详细设计时添加的，而是解决正在服役的项目的问题。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201204-adapter.png\" alt=\"适配器模式的UML图\">\n\n<h3 id=\"10-桥接模式-Bridge\"><a href=\"#10-桥接模式-Bridge\" class=\"headerlink\" title=\"10.桥接模式( Bridge )\"></a>10.桥接模式( Bridge )</h3><pre><code>将抽象部分与实现部分分离，使它们都可以独立的变化。属于结构型模式\n\n优点： 1、抽象和实现的分离。 2、优秀的扩展能力。 3、实现细节对客户透明。\n\n缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。\n\n使用场景： 1、如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 2、对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。 3、一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。\n\n注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-bridge.svg\" alt=\"桥接模式的UML图\">\n\n<h3 id=\"11-建造者模式-Builder\"><a href=\"#11-建造者模式-Builder\" class=\"headerlink\" title=\"11.建造者模式( Builder )\"></a>11.建造者模式( Builder )</h3><pre><code>使用多个简单的对象一步一步构建成一个复杂的对象。属于创建型模式\n\n优点： 1、建造者独立，易扩展。 2、便于控制细节风险。\n缺点： 1、产品必须有共同点，范围有限制。 2、如内部变化复杂，会有很多的建造类。\n注意事项：与工厂模式的区别是：建造者模式更加关注与零件装配的顺序。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-builder-pattern.svg\" alt=\"建造者模式的UML图\">\n\n<h3 id=\"12-观察者模式-Observer\"><a href=\"#12-观察者模式-Observer\" class=\"headerlink\" title=\"12.观察者模式( Observer )\"></a>12.观察者模式( Observer )</h3><pre><code>定义了一种一对多的依赖关系,让多个观察者对象同时监听某一主题对象,在它的状态发生变化时,会通知所有的观察者。观察者模式属于行为型模式。\n\n优点： 1、观察者和被观察者是抽象耦合的。 2、建立一套触发机制。\n\n缺点：\n    1、观察者太多时，通知观察者会耗时比较久\n    2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。\n    3、观察者模式仅仅只是知道观察目标发生了变化。\n注意事项：\n    1、JAVA 中已经有了对观察者模式的支持类。\n    2、避免循环引用。\n    3、如果顺序执行，某一观察者错误会导致系统卡壳，一般采用异步方式。</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/observer_pattern_uml_diagram.jpg\" alt=\"观察者模式的 UML 图\">\n\n<h3 id=\"13-单例模式-Singleton\"><a href=\"#13-单例模式-Singleton\" class=\"headerlink\" title=\"13.单例模式( Singleton )\"></a>13.单例模式( Singleton )</h3><pre><code>保证一个类仅有一个实例,并提供一个访问它的全局控制点.\n优点：\n1、在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。\n2、避免对资源的多重占用（比如写文件操作）。\n   缺点：没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。\n单例模式的几种实现方式\n1.懒汉式，线程不安全\n   不加锁 synchronized，所以严格意义上它并不算单例模式。\n这种方式 lazy loading 很明显，不要求线程安全，在多线程不能正常工作\n2.懒汉式，线程安全\n    加锁 synchronized，方式具备很好的 lazy loading，能够在多线程中很好的工作，但是，效率很低，99% 情况下不需要同步。\n    优点：第一次调用才初始化，避免内存浪费。\n    缺点：必须加锁 synchronized 才能保证单例，但加锁会影响效率。\ngetInstance() 的性能对应用程序不是很关键（该方法使用不太频繁）。\n3、饿汉式\n    优点：没有加锁，执行效率会提高。\n    缺点：类加载时就初始化，浪费内存。\n4、双检锁/双重校验锁（DCL，即 double-checked locking）\n    这种方式采用双锁机制，安全且在多线程情况下能保持高性能。\ngetInstance() 的性能对应用程序很关键。\n5、登记式/静态内部类\n    这种方式能达到双检锁方式一样的功效，但实现更简单。对静态域使用延迟初始化，应使用这种方式而不是双检锁方式。这种方式只适用于静态域的情况，双检锁方式可在实例域需要延迟初始化时使用。\n6、枚举\n    这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，自动支持序列化机制，绝对防止多次实例化。\n\n经验之谈：一般情况下，不建议使用第 1 种和第 2 种懒汉方式，建议使用第 3 种饿汉方式。只有在要明确实现 lazy loading 效果时，才会使用第 5 种登记方式。如果涉及到反序列化创建对象时，可以尝试使用第 6 种枚举方式。如果有其他特殊的需求，可以考虑使用第 4 种双检锁方式。</code></pre>\n<h3 id=\"14-命令模式-Command\"><a href=\"#14-命令模式-Command\" class=\"headerlink\" title=\"14.命令模式( Command )\"></a>14.命令模式( Command )</h3><pre><code>将一个请求封装成为一个对象, 使可以用不同的请求对客户进行参数化\n优点：\n1、降低了系统耦合度。\n2、新的命令可以很容易添加到系统中去。\n缺点：使用命令模式可能会导致某些系统有过多的具体命令类。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-command-1.svg\" alt=\"命令模式的 UML 图\">","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p><a href=\"http://www.runoob.com/design-pattern\">菜鸟教程</a><br><a href=\"https://mp.weixin.qq.com/s?__biz=MzI4ODQ3NjE2OA==&mid=2247485687&idx=2&sn=d1a405491311488c576197b556d357ec&chksm=ec3c9590db4b1c86a13ff39894dbeead2bbcee738a58da96bcb1bc404b6a948bd1f38312176a&mpshare=1&scene=1&srcid=&sharer_sharetime=1570684867528&sharer_shareid=4c8872b4436b495590f58ccf1453ba58&rd2werd=1#wechat_redirect\">设计模式在Spring框架中的良好实践</a><br><a href=\"https://github.com/im-fan/my-design-mode.git\">实现的demo</a></p>\n</blockquote>\n<h2 id=\"基础\"><a href=\"#基础\" class=\"headerlink\" title=\"基础\"></a>基础</h2><h3 id=\"设计模式的类型\"><a href=\"#设计模式的类型\" class=\"headerlink\" title=\"设计模式的类型\"></a>设计模式的类型</h3><img class=\"magplus\" title=\"设计模式类型\" src=\"https://im-fan.gitee.io/img/design-model/design-model-type.jpg\" alt=\"设计模式类型\" width=\"700\" height=\"840\">\n\n<h3 id=\"设计模式实践的关系\"><a href=\"#设计模式实践的关系\" class=\"headerlink\" title=\"设计模式实践的关系\"></a>设计模式实践的关系</h3><img class=\"magplus\" title=\"设计模式之间的关系\" src=\"http://www.runoob.com/wp-content/uploads/2014/08/the-relationship-between-design-patterns.jpg\" alt=\"设计模式之间的关系\" width=\"700\" height=\"840\">\n\n<h3 id=\"设计模式的六大原则\"><a href=\"#设计模式的六大原则\" class=\"headerlink\" title=\"设计模式的六大原则\"></a>设计模式的六大原则</h3><pre><code>1、开闭原则（Open Close Principle）\n    开闭原则的意思是：对扩展开放，对修改关闭。在程序需要进行拓展的时候，不能去修改原有的代码，实现一个热插拔的效果。简言之，是为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类。\n2、里氏代换原则（Liskov Substitution Principle）\n    里氏代换原则是面向对象设计的基本原则之一。 里氏代换原则中说，任何基类可以出现的地方，子类一定可以出现。LSP 是继承复用的基石，只有当派生类可以替换掉基类，且软件单位的功能不受到影响时，基类才能真正被复用，而派生类也能够在基类的基础上增加新的行为。里氏代换原则是对开闭原则的补充。实现开闭原则的关键步骤就是抽象化，而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。\n3、依赖倒转原则（Dependence Inversion Principle）\n    这个原则是开闭原则的基础，具体内容：针对接口编程，依赖于抽象而不依赖于具体。\n4、接口隔离原则（Interface Segregation Principle）\n    这个原则的意思是：使用多个隔离的接口，比使用单个接口要好。它还有另外一个意思是：降低类之间的耦合度。由此可见，其实设计模式就是从大型软件架构出发、便于升级和维护的软件设计思想，它强调降低依赖，降低耦合。\n5、迪米特法则，又称最少知道原则（Demeter Principle）\n    最少知道原则是指：一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。\n6、合成复用原则（Composite Reuse Principle）\n    合成复用原则是指：尽量使用合成/聚合的方式，而不是使用继承。</code></pre>\n<h2 id=\"模式详解\"><a href=\"#模式详解\" class=\"headerlink\" title=\"模式详解\"></a>模式详解</h2><h3 id=\"1-策略模式-Strategy\"><a href=\"#1-策略模式-Strategy\" class=\"headerlink\" title=\"1.策略模式(Strategy)\"></a>1.策略模式(Strategy)</h3><pre><code>定义个策略接口，不同的实现类提供不同的具体策略算法，通过context方法确定方法执行时具体执行那个子类的方法，属于行为型模式\n混合使用(https://blog.csdn.net/pengpegV5yaya/article/details/25189253)\n优点： 1、算法可以自由切换。 2、避免使用多重条件判断。 3、扩展性良好。\n缺点： 1、策略类会增多。 2、所有策略类都需要对外暴露。\n注意事项：如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题</code></pre>\n<ul>\n<li>示例图片<br/><img src=\"http://www.runoob.com/wp-content/uploads/2014/08/strategy_pattern_uml_diagram.jpg\" />\n\n</li>\n</ul>\n<h3 id=\"2-简单工厂模式-Simple-Factory\"><a href=\"#2-简单工厂模式-Simple-Factory\" class=\"headerlink\" title=\"2.简单工厂模式( Simple Factory )\"></a>2.简单工厂模式( Simple Factory )</h3><pre><code>定义一个用以创建对象的工厂, 根据不同的条件[传参/反射]生成不同的对象，属于创建型模式\n\n- 优点：工厂类是整个模式的关键.包含了必要的逻辑判断,根据外界给定的信息,决定究竟应该创建哪个具体类的对象.通过使用工厂类,外界仅仅需要负责“消费”对象就可以了。而不必管这些对象究竟如何创建及如何组织的。\n- 缺点：由于工厂类集中了所有实例的创建逻辑，违反了高内聚责任分配原则，将全部创建逻辑集中到了一个工厂类中；它所能创建的类只能是事先考虑到的，如果需要添加新的类，则就需要改变工厂类了。当系统中的具体产品类不断增多时候，可能会出现要求工厂类根据不同条件创建不同实例的需求．这种对条件的判断和对具体产品类型的判断交错在一起，很难避免模块功能的蔓延，对系统的维护和扩展非常不利；</code></pre>\n<h3 id=\"3-工厂模式-Factory\"><a href=\"#3-工厂模式-Factory\" class=\"headerlink\" title=\"3.工厂模式( Factory )\"></a>3.工厂模式( Factory )</h3><pre><code>针对每一种产品提供一个工厂类，通过不同的工厂实例来创建不同的产品实例。简单工厂是一种产品，工厂是多种产品</code></pre>\n<h3 id=\"4-抽象工厂模式-Abstract-Factory\"><a href=\"#4-抽象工厂模式-Abstract-Factory\" class=\"headerlink\" title=\"4.抽象工厂模式( Abstract Factory )\"></a>4.抽象工厂模式( Abstract Factory )</h3><pre><code>https://blog.csdn.net/hguisu/article/details/7505909\n应对产品族概念而生，属于创建型模式\n\n区别\n简单工厂 ：用来生产同一等级结构中的任意产品。（对于增加新的产品，无能为力） \n    例：造了一个工厂，只能生产 宝马和比亚迪汽车；如果需要制造其他车系，工厂要改造升级\n工厂方法 ：用来生产同一等级结构中的固定产品。（支持增加任意产品） \n    例：根据工厂图纸造了两个工厂，分别生产宝马和比亚迪汽车；如果需要制造其他车系，按照图纸再造一个工厂； 但无法生产除了车以外的其他产品\n抽象工厂 ：用来生产不同产品族的全部产品。（对于增加新的产品，无能为力；支持增加产品族）\n    例：收购了个汽车空调厂，将工厂图纸和空调厂图纸合并成一个图纸；建新厂时按照新的图纸，先建造出有空调+汽车生产线的厂，在利用不同生产线生产汽车和对应的汽车空调；如果需要一个五菱车厂，不支持单独建五菱车厂，但是可以新建带空调的五菱车厂\n\n1）还没有工厂时代：假如还没有工业革命，如果一个客户要一款宝马车,一般的做法是客户去创建一款宝马车，然后拿来用。\n2）简单工厂模式：后来出现工业革命。用户不用去创建车。因为客户有一个工厂来帮他创建.想要什么车，这个工厂就可以建。比如想要宝马车。工厂就创建这个系列的车。即工厂可以创建产品。\n3）工厂方法模式时代：为了满足客户，车品牌越来越多，如宝马、比亚迪等，一个工厂无法创建所有的车型。于是由单独分出来多个具体的工厂。每个具体工厂创建一种系列。即具体工厂类只能创建一个具体产品。但是轿车工厂还是个抽象。你需要指定某个具体的工厂才能生产车出来。\n4）抽象工厂模式时代：随着客户的要求越来越高，轿车必须配置空调。于是这个工厂开始生产轿车和需要的空调。\n\n最终是客户只要对轿车的销售员说：我要宝马空调车，销售员就直接给他宝马空调车了。而不用自己去创建车.</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/3E13CDD1-2CD2-4C66-BD33-DECBF172AE03.jpg\" alt=\"抽象工厂模式的 UML 图\">\n\n<h3 id=\"5-装饰器模式-Decorator\"><a href=\"#5-装饰器模式-Decorator\" class=\"headerlink\" title=\"5.装饰器模式( Decorator )\"></a>5.装饰器模式( Decorator )</h3><pre><code>动态的给一个对象添加一些额外的功能，属于结构型模式\n优点：装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。\n缺点：多层装饰比较复杂。\n使用场景： 1、扩展一个类的功能。 2、动态增加功能，动态撤销。\n注意事项：可代替继承。\n\n其他：下图，RedShapeDecorator extends ShapeDecorator</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/decorator_pattern_uml_diagram.jpg\" alt=\"装饰器模式的UML图\"/>\n\n<h3 id=\"6-代理模式-Proxy\"><a href=\"#6-代理模式-Proxy\" class=\"headerlink\" title=\"6.代理模式( Proxy )\"></a>6.代理模式( Proxy )</h3><pre><code>封装被代理对象并限制外界对被代理对象的访问，属于结构型模式\n关键代码：实现与被代理类组合。\n优点： 1、职责清晰。 2、高扩展性。 3、智能化。\n缺点： 1、由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。\n注意事项：\n1、和适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。\n2、和装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-proxy.svg\" alt=\"代理模式的UML图\">\n\n<h3 id=\"7-模板方法模式-Template\"><a href=\"#7-模板方法模式-Template\" class=\"headerlink\" title=\"7.模板方法模式( Template )\"></a>7.模板方法模式( Template )</h3><pre><code>1.定义一个操作的算法骨架, 并将一些步骤延迟到子类中\n2.一个抽象类公开定义了执行它的方法的方式/模板。它的子类可以按需要重写方法实现，但调用将以抽象类中定义的方式进行。属于行为型模式。\n\n优点： 1、封装不变部分，扩展可变部分。 2、提取公共代码，便于维护。 3、行为由父类控制，子类实现。\n缺点：每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大。\n使用场景： 1、有多个子类共有的方法，且逻辑相同。 2、重要的、复杂的方法，可以考虑作为模板方法。\n注意事项：为防止恶意操作，一般模板方法都加上 final 关键词，否则扩展类就可以自己实现模板方法。</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/template_pattern_uml_diagram.jpg\" alt=\"模板模式的 UML 图\">\n\n<h3 id=\"8-外观模式-Facade\"><a href=\"#8-外观模式-Facade\" class=\"headerlink\" title=\"8.外观模式( Facade )\"></a>8.外观模式( Facade )</h3><pre><code>为系统向外界提供一个统一的接口、隐藏系统的复杂性（对使用者来说，只关系需要的结果，不关心怎么实现的）；属于结构型模式\n简单理解：电脑开机关机\n启动电脑（按一下电源键）：启动CPU、启动内存、启动硬盘\n关闭电脑（按一下电源键）：关闭硬盘、关闭内存、关闭CPU\n优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。\n缺点：不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。\n使用场景： 1、为复杂的模块或子系统提供外界访问的模块。 2、子系统相对独立。 3、预防低水平人员带来的风险。\n注意事项：在层次化结构中，可以使用外观模式定义系统中每一层的入口。</code></pre>\n<h3 id=\"9-适配器模式-Adapter\"><a href=\"#9-适配器模式-Adapter\" class=\"headerlink\" title=\"9.适配器模式( Adapter )\"></a>9.适配器模式( Adapter )</h3><pre><code>将一个类的接口转换成客户希望的另一个接口。属于结构型模式\n简单理解：用于现有业务维护，整合业务逻辑，根据传入的参数来执行具体某个业务\n优点： 1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。\n缺点：\n1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现。因此如果不是很有必要，可以不使用适配器，而是直接对系统进行重构。\n2.由于 JAVA 至多继承一个类，所以至多只能适配一个适配者类，而且目标类必须是抽象类。\n\n使用场景：有动机地修改一个正常运行的系统的接口，这时应该考虑使用适配器模式。\n\n注意事项：适配器不是在详细设计时添加的，而是解决正在服役的项目的问题。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201204-adapter.png\" alt=\"适配器模式的UML图\">\n\n<h3 id=\"10-桥接模式-Bridge\"><a href=\"#10-桥接模式-Bridge\" class=\"headerlink\" title=\"10.桥接模式( Bridge )\"></a>10.桥接模式( Bridge )</h3><pre><code>将抽象部分与实现部分分离，使它们都可以独立的变化。属于结构型模式\n\n优点： 1、抽象和实现的分离。 2、优秀的扩展能力。 3、实现细节对客户透明。\n\n缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。\n\n使用场景： 1、如果一个系统需要在构件的抽象化角色和具体化角色之间增加更多的灵活性，避免在两个层次之间建立静态的继承联系，通过桥接模式可以使它们在抽象层建立一个关联关系。 2、对于那些不希望使用继承或因为多层次继承导致系统类的个数急剧增加的系统，桥接模式尤为适用。 3、一个类存在两个独立变化的维度，且这两个维度都需要进行扩展。\n\n注意事项：对于两个独立变化的维度，使用桥接模式再适合不过了。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-bridge.svg\" alt=\"桥接模式的UML图\">\n\n<h3 id=\"11-建造者模式-Builder\"><a href=\"#11-建造者模式-Builder\" class=\"headerlink\" title=\"11.建造者模式( Builder )\"></a>11.建造者模式( Builder )</h3><pre><code>使用多个简单的对象一步一步构建成一个复杂的对象。属于创建型模式\n\n优点： 1、建造者独立，易扩展。 2、便于控制细节风险。\n缺点： 1、产品必须有共同点，范围有限制。 2、如内部变化复杂，会有很多的建造类。\n注意事项：与工厂模式的区别是：建造者模式更加关注与零件装配的顺序。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-builder-pattern.svg\" alt=\"建造者模式的UML图\">\n\n<h3 id=\"12-观察者模式-Observer\"><a href=\"#12-观察者模式-Observer\" class=\"headerlink\" title=\"12.观察者模式( Observer )\"></a>12.观察者模式( Observer )</h3><pre><code>定义了一种一对多的依赖关系,让多个观察者对象同时监听某一主题对象,在它的状态发生变化时,会通知所有的观察者。观察者模式属于行为型模式。\n\n优点： 1、观察者和被观察者是抽象耦合的。 2、建立一套触发机制。\n\n缺点：\n    1、观察者太多时，通知观察者会耗时比较久\n    2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。\n    3、观察者模式仅仅只是知道观察目标发生了变化。\n注意事项：\n    1、JAVA 中已经有了对观察者模式的支持类。\n    2、避免循环引用。\n    3、如果顺序执行，某一观察者错误会导致系统卡壳，一般采用异步方式。</code></pre>\n<img src=\"http://www.runoob.com/wp-content/uploads/2014/08/observer_pattern_uml_diagram.jpg\" alt=\"观察者模式的 UML 图\">\n\n<h3 id=\"13-单例模式-Singleton\"><a href=\"#13-单例模式-Singleton\" class=\"headerlink\" title=\"13.单例模式( Singleton )\"></a>13.单例模式( Singleton )</h3><pre><code>保证一个类仅有一个实例,并提供一个访问它的全局控制点.\n优点：\n1、在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。\n2、避免对资源的多重占用（比如写文件操作）。\n   缺点：没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。\n单例模式的几种实现方式\n1.懒汉式，线程不安全\n   不加锁 synchronized，所以严格意义上它并不算单例模式。\n这种方式 lazy loading 很明显，不要求线程安全，在多线程不能正常工作\n2.懒汉式，线程安全\n    加锁 synchronized，方式具备很好的 lazy loading，能够在多线程中很好的工作，但是，效率很低，99% 情况下不需要同步。\n    优点：第一次调用才初始化，避免内存浪费。\n    缺点：必须加锁 synchronized 才能保证单例，但加锁会影响效率。\ngetInstance() 的性能对应用程序不是很关键（该方法使用不太频繁）。\n3、饿汉式\n    优点：没有加锁，执行效率会提高。\n    缺点：类加载时就初始化，浪费内存。\n4、双检锁/双重校验锁（DCL，即 double-checked locking）\n    这种方式采用双锁机制，安全且在多线程情况下能保持高性能。\ngetInstance() 的性能对应用程序很关键。\n5、登记式/静态内部类\n    这种方式能达到双检锁方式一样的功效，但实现更简单。对静态域使用延迟初始化，应使用这种方式而不是双检锁方式。这种方式只适用于静态域的情况，双检锁方式可在实例域需要延迟初始化时使用。\n6、枚举\n    这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，自动支持序列化机制，绝对防止多次实例化。\n\n经验之谈：一般情况下，不建议使用第 1 种和第 2 种懒汉方式，建议使用第 3 种饿汉方式。只有在要明确实现 lazy loading 效果时，才会使用第 5 种登记方式。如果涉及到反序列化创建对象时，可以尝试使用第 6 种枚举方式。如果有其他特殊的需求，可以考虑使用第 4 种双检锁方式。</code></pre>\n<h3 id=\"14-命令模式-Command\"><a href=\"#14-命令模式-Command\" class=\"headerlink\" title=\"14.命令模式( Command )\"></a>14.命令模式( Command )</h3><pre><code>将一个请求封装成为一个对象, 使可以用不同的请求对客户进行参数化\n优点：\n1、降低了系统耦合度。\n2、新的命令可以很容易添加到系统中去。\n缺点：使用命令模式可能会导致某些系统有过多的具体命令类。</code></pre>\n<img src=\"https://www.runoob.com/wp-content/uploads/2014/08/20201015-command-1.svg\" alt=\"命令模式的 UML 图\">"}],"PostAsset":[],"PostCategory":[{"post_id":"cktds3bcv000ffms6fgck34pt","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3bd5000nfms63sfofps0"},{"post_id":"cktds3bcl0006fms687foex7v","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3bdb000rfms61e3d63fd"},{"post_id":"cktds3bcy000hfms66eflafhz","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3bdd000ufms6c0pr4rfu"},{"post_id":"cktds3bcc0001fms6e86ccog4","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bdi000yfms6eyfeai42"},{"post_id":"cktds3bcc0001fms6e86ccog4","category_id":"cktds3bcz000ifms64mw2ehpy","_id":"cktds3bdm0012fms648iv9ji9"},{"post_id":"cktds3bcm0007fms6g4rjdt1n","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3bdx0015fms6hdl76vpj"},{"post_id":"cktds3bcq000bfms62yysh7bs","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3be00019fms632n9c1ed"},{"post_id":"cktds3bcf0002fms6daxn3mrh","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3be4001gfms647t2dyba"},{"post_id":"cktds3bcf0002fms6daxn3mrh","category_id":"cktds3bdn0013fms62gj184vp","_id":"cktds3be6001ifms63ovi7kvf"},{"post_id":"cktds3bcs000cfms64m2dd49k","category_id":"cktds3bct000dfms670abhvg2","_id":"cktds3be9001mfms61mnh27mh"},{"post_id":"cktds3bd2000kfms67y7f3icg","category_id":"cktds3be3001ffms6bbsb9dzt","_id":"cktds3bef001ufms60nn2e5o8"},{"post_id":"cktds3bd4000mfms6585wd6ti","category_id":"cktds3be3001ffms6bbsb9dzt","_id":"cktds3bel001zfms653jv70dx"},{"post_id":"cktds3bd8000qfms6cpkg79qo","category_id":"cktds3be3001ffms6bbsb9dzt","_id":"cktds3bes0024fms622te9xn7"},{"post_id":"cktds3bdc000tfms63nz12wqn","category_id":"cktds3bel001yfms688zw75xo","_id":"cktds3bf0002bfms6bq66dqps"},{"post_id":"cktds3bdg000xfms66t4tf1i4","category_id":"cktds3bel001yfms688zw75xo","_id":"cktds3bf4002gfms6gy7bfy1j"},{"post_id":"cktds3bey0029fms611vdbkma","category_id":"cktds3be3001ffms6bbsb9dzt","_id":"cktds3bf7002kfms690c05lnb"},{"post_id":"cktds3bdj0011fms6czn0ci9v","category_id":"cktds3bez002afms6d7pphj01","_id":"cktds3bfa002nfms6ae007k4l"},{"post_id":"cktds3bdo0014fms6bpg1b805","category_id":"cktds3bf5002hfms6be5k5d83","_id":"cktds3bff002tfms63mz52430"},{"post_id":"cktds3bdz0017fms6cwevh2r6","category_id":"cktds3bfa002ofms6b4lvb3h9","_id":"cktds3bfj0031fms6h9cf5zjp"},{"post_id":"cktds3be0001bfms69ehy9w6i","category_id":"cktds3bfa002ofms6b4lvb3h9","_id":"cktds3bfl0035fms6hftm5si3"},{"post_id":"cktds3be2001dfms61wgq2efr","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfm0038fms60j5r6peb"},{"post_id":"cktds3be2001dfms61wgq2efr","category_id":"cktds3bfj0030fms65w5a0c6n","_id":"cktds3bfn003bfms64ulbas4q"},{"post_id":"cktds3be4001hfms6fayq074o","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfn003efms6dfxea488"},{"post_id":"cktds3be4001hfms6fayq074o","category_id":"cktds3bfl0036fms6bwgz8xfp","_id":"cktds3bfo003hfms69vduasgx"},{"post_id":"cktds3be7001kfms686sdg412","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfp003kfms6gewq28bz"},{"post_id":"cktds3be7001kfms686sdg412","category_id":"cktds3bfm0039fms63gp306vi","_id":"cktds3bfp003lfms68sdndane"},{"post_id":"cktds3be9001nfms68ynk6mua","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfq003mfms6akbpe92b"},{"post_id":"cktds3be9001nfms68ynk6mua","category_id":"cktds3bfm0039fms63gp306vi","_id":"cktds3bfq003pfms67pkjbop0"},{"post_id":"cktds3beb001pfms6fxvz4vqn","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfr003rfms6343m2do8"},{"post_id":"cktds3beb001pfms6fxvz4vqn","category_id":"cktds3bfp003jfms6b9ut0bnl","_id":"cktds3bfs003ufms65d1w1tld"},{"post_id":"cktds3bee001sfms6f8nq1l9b","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bft003xfms633du00ay"},{"post_id":"cktds3bee001sfms6f8nq1l9b","category_id":"cktds3bfp003jfms6b9ut0bnl","_id":"cktds3bfw0040fms68ayl80cx"},{"post_id":"cktds3beg001vfms676r15vm2","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bfy0041fms6aq4o390n"},{"post_id":"cktds3beg001vfms676r15vm2","category_id":"cktds3bfp003jfms6b9ut0bnl","_id":"cktds3bg00044fms6a9iwez9i"},{"post_id":"cktds3bek001xfms66g2q5ko4","category_id":"cktds3bfs003wfms64sv0d5jd","_id":"cktds3bg00046fms68pa368yl"},{"post_id":"cktds3ben0021fms613b14dbl","category_id":"cktds3bfs003wfms64sv0d5jd","_id":"cktds3bg5004afms65cp9ggzu"},{"post_id":"cktds3bep0023fms673740w90","category_id":"cktds3bfs003wfms64sv0d5jd","_id":"cktds3bg6004ffms60pk156c6"},{"post_id":"cktds3bew0027fms6bncugtgv","category_id":"cktds3bfs003wfms64sv0d5jd","_id":"cktds3bgb004jfms680lhhpmd"},{"post_id":"cktds3bf0002dfms6fumi9x4y","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgd004nfms62oal84q7"},{"post_id":"cktds3bf0002dfms6fumi9x4y","category_id":"cktds3bg6004efms65z5r7szy","_id":"cktds3bge004pfms6dyz26q8b"},{"post_id":"cktds3bf3002ffms61zpeai6n","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bge004sfms65lj4ej3d"},{"post_id":"cktds3bf3002ffms61zpeai6n","category_id":"cktds3bgb004kfms6f7r325dv","_id":"cktds3bgf004ufms6hnukcr7n"},{"post_id":"cktds3bf6002jfms67y1agutf","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgg004xfms6cm3f5w57"},{"post_id":"cktds3bf6002jfms67y1agutf","category_id":"cktds3bgd004ofms622v49dcw","_id":"cktds3bgh0050fms64ya45urt"},{"post_id":"cktds3bf8002lfms6fhq03nvc","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgh0053fms6bd8v3pyr"},{"post_id":"cktds3bf8002lfms6fhq03nvc","category_id":"cktds3bgf004tfms64w4u7z7d","_id":"cktds3bgj0055fms6dzz326qp"},{"post_id":"cktds3bfb002qfms67zpd5bn4","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgk0058fms6hb5y0rj8"},{"post_id":"cktds3bfb002qfms67zpd5bn4","category_id":"cktds3bgf004tfms64w4u7z7d","_id":"cktds3bgk0059fms64f5l94jn"},{"post_id":"cktds3bfd002rfms6cpqp2jmo","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgl005cfms6ext7f6m4"},{"post_id":"cktds3bfd002rfms6cpqp2jmo","category_id":"cktds3bgf004tfms64w4u7z7d","_id":"cktds3bgm005dfms683ro5mg1"},{"post_id":"cktds3bff002ufms6doui8fzl","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgm005gfms6bezb1is6"},{"post_id":"cktds3bff002ufms6doui8fzl","category_id":"cktds3bfp003jfms6b9ut0bnl","_id":"cktds3bgn005ifms67r9x88w7"},{"post_id":"cktds3bfh002xfms617sz68x7","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgo005mfms66ubl4kcc"},{"post_id":"cktds3bfh002xfms617sz68x7","category_id":"cktds3bfp003jfms6b9ut0bnl","_id":"cktds3bgp005ofms6c6384u4e"},{"post_id":"cktds3bfi002zfms6heuhb9jc","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgq005qfms64f7q5jla"},{"post_id":"cktds3bfi002zfms6heuhb9jc","category_id":"cktds3bgf004tfms64w4u7z7d","_id":"cktds3bgq005sfms6fp3fc2t9"},{"post_id":"cktds3bfk0033fms63klmdvjs","category_id":"cktds3bch0003fms69xishgw2","_id":"cktds3bgq005tfms62b6wcmu2"},{"post_id":"cktds3bfk0033fms63klmdvjs","category_id":"cktds3bgf004tfms64w4u7z7d","_id":"cktds3bgr005wfms6bxx59hq1"},{"post_id":"cktds3bgz006afms6ha3p34ka","category_id":"cktds3be3001ffms6bbsb9dzt","_id":"cktds3bh2006cfms66q6rftpi"}],"PostTag":[{"post_id":"cktds3bcc0001fms6e86ccog4","tag_id":"cktds3bci0004fms602twd2vr","_id":"cktds3bcp000afms6597v757j"},{"post_id":"cktds3bcf0002fms6daxn3mrh","tag_id":"cktds3bcn0009fms635805e6v","_id":"cktds3bcx000gfms69ou1hw0b"},{"post_id":"cktds3bcl0006fms687foex7v","tag_id":"cktds3bcu000efms64pkr72u3","_id":"cktds3bd4000lfms60yjr2218"},{"post_id":"cktds3bcm0007fms6g4rjdt1n","tag_id":"cktds3bd0000jfms6bu7u9udv","_id":"cktds3bdc000sfms6hu5w3tau"},{"post_id":"cktds3bd8000qfms6cpkg79qo","tag_id":"cktds3bcn0009fms635805e6v","_id":"cktds3bdf000wfms6h7exageu"},{"post_id":"cktds3bcq000bfms62yysh7bs","tag_id":"cktds3bd8000pfms6fsbu5cdd","_id":"cktds3bdj0010fms6dgyoew5n"},{"post_id":"cktds3bcs000cfms64m2dd49k","tag_id":"cktds3bdi000zfms602td4te6","_id":"cktds3be00018fms63jq3835h"},{"post_id":"cktds3bcv000ffms6fgck34pt","tag_id":"cktds3bdy0016fms64f33au9b","_id":"cktds3be3001efms6f1j0ekgy"},{"post_id":"cktds3bcy000hfms66eflafhz","tag_id":"cktds3be2001cfms616qbgw5k","_id":"cktds3be9001lfms68whkczk7"},{"post_id":"cktds3bd2000kfms67y7f3icg","tag_id":"cktds3be6001jfms67ur44c7y","_id":"cktds3bed001rfms65r0r0go5"},{"post_id":"cktds3bd4000mfms6585wd6ti","tag_id":"cktds3bec001qfms67q89aukk","_id":"cktds3bel0020fms6e37hhsqa"},{"post_id":"cktds3bdc000tfms63nz12wqn","tag_id":"cktds3bek001wfms64m0i4xxe","_id":"cktds3bet0026fms61e5g3z26"},{"post_id":"cktds3bdg000xfms66t4tf1i4","tag_id":"cktds3bek001wfms64m0i4xxe","_id":"cktds3bf0002cfms65vsc9d0n"},{"post_id":"cktds3bdj0011fms6czn0ci9v","tag_id":"cktds3bex0028fms62w5q4dk8","_id":"cktds3bf5002ifms67w5ec5lu"},{"post_id":"cktds3bdo0014fms6bpg1b805","tag_id":"cktds3bf3002efms62e1q21ok","_id":"cktds3bfb002pfms6ceqqdl0o"},{"post_id":"cktds3bdz0017fms6cwevh2r6","tag_id":"cktds3bfa002mfms6f5frfw8l","_id":"cktds3bfg002wfms6g8sigfn7"},{"post_id":"cktds3be0001bfms69ehy9w6i","tag_id":"cktds3bff002sfms6ejj9ea4f","_id":"cktds3bfk0032fms67lnrc5o9"},{"post_id":"cktds3be2001dfms61wgq2efr","tag_id":"cktds3bfi002yfms61n053c03","_id":"cktds3bfn003afms6atfh2193"},{"post_id":"cktds3be2001dfms61wgq2efr","tag_id":"cktds3bfl0034fms6e4dd9vga","_id":"cktds3bfn003cfms6bdbe2meg"},{"post_id":"cktds3be4001hfms6fayq074o","tag_id":"cktds3bfm0037fms685jecnkh","_id":"cktds3bfo003gfms6dhqicqax"},{"post_id":"cktds3be7001kfms686sdg412","tag_id":"cktds3bfn003dfms6ex4e691v","_id":"cktds3bfs003tfms6drx7h34a"},{"post_id":"cktds3be7001kfms686sdg412","tag_id":"cktds3bfp003ifms6af2i8u7f","_id":"cktds3bfs003vfms648qwebzc"},{"post_id":"cktds3be7001kfms686sdg412","tag_id":"cktds3bfq003nfms67fhf4m6s","_id":"cktds3bfw003zfms669zd53gx"},{"post_id":"cktds3be9001nfms68ynk6mua","tag_id":"cktds3bfr003sfms6d9ze0jih","_id":"cktds3bg40048fms65sbk1xra"},{"post_id":"cktds3be9001nfms68ynk6mua","tag_id":"cktds3bfq003nfms67fhf4m6s","_id":"cktds3bg5004bfms6hvcj2f7j"},{"post_id":"cktds3be9001nfms68ynk6mua","tag_id":"cktds3bfz0043fms652k17o1s","_id":"cktds3bg6004dfms6fgsc3vms"},{"post_id":"cktds3beb001pfms6fxvz4vqn","tag_id":"cktds3bg30047fms6apwy3e55","_id":"cktds3bg6004gfms64va15c7f"},{"post_id":"cktds3bee001sfms6f8nq1l9b","tag_id":"cktds3bg5004cfms61eufbizr","_id":"cktds3bga004ifms64sc8h287"},{"post_id":"cktds3beg001vfms676r15vm2","tag_id":"cktds3bg9004hfms6fr6s8bwo","_id":"cktds3bgd004mfms60voe7ljg"},{"post_id":"cktds3bek001xfms66g2q5ko4","tag_id":"cktds3bgd004lfms63x2paerx","_id":"cktds3bge004rfms61wxih1og"},{"post_id":"cktds3ben0021fms613b14dbl","tag_id":"cktds3bge004qfms64h5h6ox1","_id":"cktds3bgg004wfms647fpat4f"},{"post_id":"cktds3bep0023fms673740w90","tag_id":"cktds3bgd004lfms63x2paerx","_id":"cktds3bgh0051fms6hav95n13"},{"post_id":"cktds3bew0027fms6bncugtgv","tag_id":"cktds3bgg004zfms67hrw67lh","_id":"cktds3bgj0056fms6h0jk4z7m"},{"post_id":"cktds3bey0029fms611vdbkma","tag_id":"cktds3bgj0054fms60mzt1ol6","_id":"cktds3bgn005hfms65a486y1d"},{"post_id":"cktds3bey0029fms611vdbkma","tag_id":"cktds3bgk005afms6b3voaghf","_id":"cktds3bgn005jfms69jc181ii"},{"post_id":"cktds3bf0002dfms6fumi9x4y","tag_id":"cktds3bgm005efms60yd18fob","_id":"cktds3bgp005nfms627usb0vr"},{"post_id":"cktds3bf3002ffms61zpeai6n","tag_id":"cktds3bgn005kfms60go88vf3","_id":"cktds3bgq005rfms6188sgewz"},{"post_id":"cktds3bf6002jfms67y1agutf","tag_id":"cktds3bgp005pfms60tgf014e","_id":"cktds3bgr005vfms64s301hx5"},{"post_id":"cktds3bf8002lfms6fhq03nvc","tag_id":"cktds3bgq005ufms68dqgf66a","_id":"cktds3bgu005yfms6f4zlev9u"},{"post_id":"cktds3bfb002qfms67zpd5bn4","tag_id":"cktds3bgq005ufms68dqgf66a","_id":"cktds3bgu0060fms69zqy9max"},{"post_id":"cktds3bfd002rfms6cpqp2jmo","tag_id":"cktds3bgq005ufms68dqgf66a","_id":"cktds3bgv0062fms69iux5omo"},{"post_id":"cktds3bff002ufms6doui8fzl","tag_id":"cktds3bgu0061fms6a5fi58ia","_id":"cktds3bgv0064fms62d7lga3k"},{"post_id":"cktds3bfh002xfms617sz68x7","tag_id":"cktds3bgu0061fms6a5fi58ia","_id":"cktds3bgw0066fms639kdevqm"},{"post_id":"cktds3bfi002zfms6heuhb9jc","tag_id":"cktds3bgq005ufms68dqgf66a","_id":"cktds3bgx0068fms600jtbj8v"},{"post_id":"cktds3bfk0033fms63klmdvjs","tag_id":"cktds3bgq005ufms68dqgf66a","_id":"cktds3bgy0069fms6c7ga0ztx"},{"post_id":"cktds3bgz006afms6ha3p34ka","tag_id":"cktds3bh1006bfms6arfs7pck","_id":"cktds3bh2006dfms60qfsgx7u"}],"Tag":[{"name":"java","_id":"cktds3bci0004fms602twd2vr"},{"name":"oauth2","_id":"cktds3bcn0009fms635805e6v"},{"name":"devops","_id":"cktds3bcu000efms64pkr72u3"},{"name":"docker","_id":"cktds3bd0000jfms6bu7u9udv"},{"name":"istio","_id":"cktds3bd8000pfms6fsbu5cdd"},{"name":"ldap","_id":"cktds3bdi000zfms602td4te6"},{"name":"nginx","_id":"cktds3bdy0016fms64f33au9b"},{"name":"skywalking","_id":"cktds3be2001cfms616qbgw5k"},{"name":"COLA","_id":"cktds3be6001jfms67ur44c7y"},{"name":"DDD","_id":"cktds3bec001qfms67q89aukk"},{"name":"tool","_id":"cktds3bek001wfms64m0i4xxe"},{"name":"vue","_id":"cktds3bex0028fms62w5q4dk8"},{"name":"test","_id":"cktds3bf3002efms62e1q21ok"},{"name":"常用语","_id":"cktds3bfa002mfms6f5frfw8l"},{"name":"思维","_id":"cktds3bff002sfms6ejj9ea4f"},{"name":"message","_id":"cktds3bfi002yfms61n053c03"},{"name":"kafka","_id":"cktds3bfl0034fms6e4dd9vga"},{"name":"三方集成","_id":"cktds3bfm0037fms685jecnkh"},{"name":"nacos","_id":"cktds3bfn003dfms6ex4e691v"},{"name":"动态配置","_id":"cktds3bfp003ifms6af2i8u7f"},{"name":"注册中心","_id":"cktds3bfq003nfms67fhf4m6s"},{"name":"zookeeper","_id":"cktds3bfr003sfms6d9ze0jih"},{"name":"分布式锁","_id":"cktds3bfz0043fms652k17o1s"},{"name":"多数据源","_id":"cktds3bg30047fms6apwy3e55"},{"name":"springboot","_id":"cktds3bg5004cfms61eufbizr"},{"name":"gateway","_id":"cktds3bg9004hfms6fr6s8bwo"},{"name":"mysql","_id":"cktds3bgd004lfms63x2paerx"},{"name":"canal","_id":"cktds3bge004qfms64h5h6ox1"},{"name":"cache","_id":"cktds3bgg004zfms67hrw67lh"},{"name":"uml","_id":"cktds3bgj0054fms60mzt1ol6"},{"name":"类图","_id":"cktds3bgk005afms6b3voaghf"},{"name":"项目编译","_id":"cktds3bgm005efms60yd18fob"},{"name":"io","_id":"cktds3bgn005kfms60go88vf3"},{"name":"线程池","_id":"cktds3bgp005pfms60tgf014e"},{"name":"utils","_id":"cktds3bgq005ufms68dqgf66a"},{"name":"SpringFramework","_id":"cktds3bgu0061fms6a5fi58ia"},{"name":"设计模式","_id":"cktds3bh1006bfms6arfs7pck"}]}}